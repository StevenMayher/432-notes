<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 14 Multiple Imputation and Linear Regression | Data Science for Biological, Medical and Health Research: Notes for 432</title>
  <meta name="description" content="Course Notes for PQHS 432 in Spring 2021." />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 14 Multiple Imputation and Linear Regression | Data Science for Biological, Medical and Health Research: Notes for 432" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Course Notes for PQHS 432 in Spring 2021." />
  <meta name="github-repo" content="thomaselove/432-notes" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 14 Multiple Imputation and Linear Regression | Data Science for Biological, Medical and Health Research: Notes for 432" />
  
  <meta name="twitter:description" content="Course Notes for PQHS 432 in Spring 2021." />
  

<meta name="author" content="Thomas E. Love, Ph.D." />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="a-study-of-prostate-cancer.html"/>
<link rel="next" href="using-tidymodels-to-fit-linear-regressions.html"/>
<script src="libs/header-attrs-2.6/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="" data-path="r-packages-used-in-these-notes.html"><a href="r-packages-used-in-these-notes.html"><i class="fa fa-check"></i>R Packages used in these notes</a>
<ul>
<li class="chapter" data-level="" data-path="r-packages-used-in-these-notes.html"><a href="r-packages-used-in-these-notes.html#dealing-with-conflicts"><i class="fa fa-check"></i>Dealing with Conflicts</a></li>
<li><a href="r-packages-used-in-these-notes.html#general-theme-for-ggplot-work">General Theme for <code>ggplot</code> work</a></li>
<li class="chapter" data-level="" data-path="r-packages-used-in-these-notes.html"><a href="r-packages-used-in-these-notes.html#data-used-in-these-notes"><i class="fa fa-check"></i>Data used in these notes</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="building-table-1.html"><a href="building-table-1.html"><i class="fa fa-check"></i><b>1</b> Building Table 1</a>
<ul>
<li class="chapter" data-level="1.1" data-path="building-table-1.html"><a href="building-table-1.html#data-load"><i class="fa fa-check"></i><b>1.1</b> Data load</a></li>
<li class="chapter" data-level="1.2" data-path="building-table-1.html"><a href="building-table-1.html#two-examples-from-the-new-england-journal-of-medicine"><i class="fa fa-check"></i><b>1.2</b> Two examples from the <em>New England Journal of Medicine</em></a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="building-table-1.html"><a href="building-table-1.html#a-simple-table-1"><i class="fa fa-check"></i><b>1.2.1</b> A simple Table 1</a></li>
<li class="chapter" data-level="1.2.2" data-path="building-table-1.html"><a href="building-table-1.html#a-group-comparison"><i class="fa fa-check"></i><b>1.2.2</b> A group comparison</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="building-table-1.html"><a href="building-table-1.html#the-mr-clean-trial"><i class="fa fa-check"></i><b>1.3</b> The MR CLEAN trial</a></li>
<li class="chapter" data-level="1.4" data-path="building-table-1.html"><a href="building-table-1.html#simulated-fakestroke-data"><i class="fa fa-check"></i><b>1.4</b> Simulated <code>fakestroke</code> data</a></li>
<li class="chapter" data-level="1.5" data-path="building-table-1.html"><a href="building-table-1.html#building-table-1-for-fakestroke-attempt-1"><i class="fa fa-check"></i><b>1.5</b> Building Table 1 for <code>fakestroke</code>: Attempt 1</a>
<ul>
<li class="chapter" data-level="1.5.1" data-path="building-table-1.html"><a href="building-table-1.html#some-of-this-is-very-useful-and-other-parts-need-to-be-fixed."><i class="fa fa-check"></i><b>1.5.1</b> Some of this is very useful, and other parts need to be fixed.</a></li>
<li class="chapter" data-level="1.5.2" data-path="building-table-1.html"><a href="building-table-1.html#fakestroke-cleaning-up-categorical-variables"><i class="fa fa-check"></i><b>1.5.2</b> <code>fakestroke</code> Cleaning Up Categorical Variables</a></li>
</ul></li>
<li class="chapter" data-level="1.6" data-path="building-table-1.html"><a href="building-table-1.html#fakestroke-table-1-attempt-2"><i class="fa fa-check"></i><b>1.6</b> <code>fakestroke</code> Table 1: Attempt 2</a>
<ul>
<li class="chapter" data-level="1.6.1" data-path="building-table-1.html"><a href="building-table-1.html#what-summaries-should-we-show"><i class="fa fa-check"></i><b>1.6.1</b> What summaries should we show?</a></li>
</ul></li>
<li class="chapter" data-level="1.7" data-path="building-table-1.html"><a href="building-table-1.html#obtaining-a-more-detailed-summary"><i class="fa fa-check"></i><b>1.7</b> Obtaining a more detailed Summary</a></li>
<li class="chapter" data-level="1.8" data-path="building-table-1.html"><a href="building-table-1.html#exporting-the-completed-table-1-from-r-to-excel-or-word"><i class="fa fa-check"></i><b>1.8</b> Exporting the Completed Table 1 from R to Excel or Word</a>
<ul>
<li class="chapter" data-level="1.8.1" data-path="building-table-1.html"><a href="building-table-1.html#approach-a-save-and-open-in-excel"><i class="fa fa-check"></i><b>1.8.1</b> Approach A: Save and open in Excel</a></li>
<li class="chapter" data-level="1.8.2" data-path="building-table-1.html"><a href="building-table-1.html#approach-b-produce-the-table-so-you-can-cut-and-paste-it"><i class="fa fa-check"></i><b>1.8.2</b> Approach B: Produce the Table so you can cut and paste it</a></li>
</ul></li>
<li class="chapter" data-level="1.9" data-path="building-table-1.html"><a href="building-table-1.html#a-controlled-biological-experiment---the-blood-brain-barrier"><i class="fa fa-check"></i><b>1.9</b> A Controlled Biological Experiment - The Blood-Brain Barrier</a></li>
<li class="chapter" data-level="1.10" data-path="building-table-1.html"><a href="building-table-1.html#the-bloodbrain.csv-file"><i class="fa fa-check"></i><b>1.10</b> The <code>bloodbrain.csv</code> file</a></li>
<li class="chapter" data-level="1.11" data-path="building-table-1.html"><a href="building-table-1.html#a-table-1-for-bloodbrain"><i class="fa fa-check"></i><b>1.11</b> A Table 1 for <code>bloodbrain</code></a>
<ul>
<li class="chapter" data-level="1.11.1" data-path="building-table-1.html"><a href="building-table-1.html#generate-final-table-1-for-bloodbrain"><i class="fa fa-check"></i><b>1.11.1</b> Generate final Table 1 for <code>bloodbrain</code></a></li>
<li class="chapter" data-level="1.11.2" data-path="building-table-1.html"><a href="building-table-1.html#a-more-finished-version-after-cleanup-in-word"><i class="fa fa-check"></i><b>1.11.2</b> A More Finished Version (after Cleanup in Word)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="brfss-smart-data-building.html"><a href="brfss-smart-data-building.html"><i class="fa fa-check"></i><b>2</b> BRFSS SMART Data Building</a>
<ul>
<li class="chapter" data-level="2.1" data-path="brfss-smart-data-building.html"><a href="brfss-smart-data-building.html#key-resources"><i class="fa fa-check"></i><b>2.1</b> Key resources</a></li>
<li class="chapter" data-level="2.2" data-path="brfss-smart-data-building.html"><a href="brfss-smart-data-building.html#ingesting-the-raw-data"><i class="fa fa-check"></i><b>2.2</b> Ingesting the Raw Data</a></li>
<li class="chapter" data-level="2.3" data-path="brfss-smart-data-building.html"><a href="brfss-smart-data-building.html#ingesting-from-our-csv-file"><i class="fa fa-check"></i><b>2.3</b> Ingesting from our CSV file</a></li>
<li class="chapter" data-level="2.4" data-path="brfss-smart-data-building.html"><a href="brfss-smart-data-building.html#what-does-the-raw-data-look-like"><i class="fa fa-check"></i><b>2.4</b> What does the raw data look like?</a></li>
<li class="chapter" data-level="2.5" data-path="brfss-smart-data-building.html"><a href="brfss-smart-data-building.html#cleaning-the-brfss-data"><i class="fa fa-check"></i><b>2.5</b> Cleaning the BRFSS Data</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="brfss-smart-data-building.html"><a href="brfss-smart-data-building.html#identifying-information"><i class="fa fa-check"></i><b>2.5.1</b> Identifying Information</a></li>
<li class="chapter" data-level="2.5.2" data-path="brfss-smart-data-building.html"><a href="brfss-smart-data-building.html#survey-method"><i class="fa fa-check"></i><b>2.5.2</b> Survey Method</a></li>
<li class="chapter" data-level="2.5.3" data-path="brfss-smart-data-building.html"><a href="brfss-smart-data-building.html#health-status-1-item"><i class="fa fa-check"></i><b>2.5.3</b> Health Status (1 item)</a></li>
<li class="chapter" data-level="2.5.4" data-path="brfss-smart-data-building.html"><a href="brfss-smart-data-building.html#healthy-days---health-related-quality-of-life-3-items"><i class="fa fa-check"></i><b>2.5.4</b> Healthy Days - Health-Related Quality of Life (3 items)</a></li>
<li class="chapter" data-level="2.5.5" data-path="brfss-smart-data-building.html"><a href="brfss-smart-data-building.html#health-care-access-4-items"><i class="fa fa-check"></i><b>2.5.5</b> Health Care Access (4 items)</a></li>
<li class="chapter" data-level="2.5.6" data-path="brfss-smart-data-building.html"><a href="brfss-smart-data-building.html#blood-pressure-2-measures"><i class="fa fa-check"></i><b>2.5.6</b> Blood Pressure (2 measures)</a></li>
<li class="chapter" data-level="2.5.7" data-path="brfss-smart-data-building.html"><a href="brfss-smart-data-building.html#cholesterol-3-items"><i class="fa fa-check"></i><b>2.5.7</b> Cholesterol (3 items)</a></li>
<li class="chapter" data-level="2.5.8" data-path="brfss-smart-data-building.html"><a href="brfss-smart-data-building.html#chronic-health-conditions-14-items"><i class="fa fa-check"></i><b>2.5.8</b> Chronic Health Conditions (14 items)</a></li>
<li class="chapter" data-level="2.5.9" data-path="brfss-smart-data-building.html"><a href="brfss-smart-data-building.html#arthritis-burden-4-items"><i class="fa fa-check"></i><b>2.5.9</b> Arthritis Burden (4 items)</a></li>
<li class="chapter" data-level="2.5.10" data-path="brfss-smart-data-building.html"><a href="brfss-smart-data-building.html#demographics-25-items"><i class="fa fa-check"></i><b>2.5.10</b> Demographics (25 items)</a></li>
<li class="chapter" data-level="2.5.11" data-path="brfss-smart-data-building.html"><a href="brfss-smart-data-building.html#tobacco-use-2-items"><i class="fa fa-check"></i><b>2.5.11</b> Tobacco Use (2 items)</a></li>
<li class="chapter" data-level="2.5.12" data-path="brfss-smart-data-building.html"><a href="brfss-smart-data-building.html#e-cigarettes-2-items"><i class="fa fa-check"></i><b>2.5.12</b> E-Cigarettes (2 items)</a></li>
<li class="chapter" data-level="2.5.13" data-path="brfss-smart-data-building.html"><a href="brfss-smart-data-building.html#alcohol-consumption-6-items"><i class="fa fa-check"></i><b>2.5.13</b> Alcohol Consumption (6 items)</a></li>
<li class="chapter" data-level="2.5.14" data-path="brfss-smart-data-building.html"><a href="brfss-smart-data-building.html#fruits-and-vegetables-8-items"><i class="fa fa-check"></i><b>2.5.14</b> Fruits and Vegetables (8 items)</a></li>
<li class="chapter" data-level="2.5.15" data-path="brfss-smart-data-building.html"><a href="brfss-smart-data-building.html#exercise-and-physical-activity-8-items"><i class="fa fa-check"></i><b>2.5.15</b> Exercise and Physical Activity (8 items)</a></li>
<li class="chapter" data-level="2.5.16" data-path="brfss-smart-data-building.html"><a href="brfss-smart-data-building.html#seatbelt-use-1-item"><i class="fa fa-check"></i><b>2.5.16</b> Seatbelt Use (1 item)</a></li>
<li class="chapter" data-level="2.5.17" data-path="brfss-smart-data-building.html"><a href="brfss-smart-data-building.html#immunization-3-items"><i class="fa fa-check"></i><b>2.5.17</b> Immunization (3 items)</a></li>
<li class="chapter" data-level="2.5.18" data-path="brfss-smart-data-building.html"><a href="brfss-smart-data-building.html#hivaids-2-items"><i class="fa fa-check"></i><b>2.5.18</b> HIV/AIDS (2 items)</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="brfss-smart-data-building.html"><a href="brfss-smart-data-building.html#imputing-age-and-income-as-quantitative-from-thin-air"><i class="fa fa-check"></i><b>2.6</b> Imputing Age and Income as Quantitative from Thin Air</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="brfss-smart-data-building.html"><a href="brfss-smart-data-building.html#age_imp-imputing-age-data"><i class="fa fa-check"></i><b>2.6.1</b> <code>age_imp</code>: Imputing Age Data</a></li>
<li class="chapter" data-level="2.6.2" data-path="brfss-smart-data-building.html"><a href="brfss-smart-data-building.html#inc_imp-imputing-income-data"><i class="fa fa-check"></i><b>2.6.2</b> <code>inc_imp</code>: Imputing Income Data</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="brfss-smart-data-building.html"><a href="brfss-smart-data-building.html#clean-data-in-the-state-of-ohio"><i class="fa fa-check"></i><b>2.7</b> Clean Data in the State of Ohio</a></li>
<li class="chapter" data-level="2.8" data-path="brfss-smart-data-building.html"><a href="brfss-smart-data-building.html#clean-cleveland-elyria-data"><i class="fa fa-check"></i><b>2.8</b> Clean Cleveland-Elyria Data</a>
<ul>
<li class="chapter" data-level="2.8.1" data-path="brfss-smart-data-building.html"><a href="brfss-smart-data-building.html#cleveland---elyria-data"><i class="fa fa-check"></i><b>2.8.1</b> Cleveland - Elyria Data</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="dealing-with-missingness-single-imputation.html"><a href="dealing-with-missingness-single-imputation.html"><i class="fa fa-check"></i><b>3</b> Dealing with Missingness: Single Imputation</a>
<ul>
<li class="chapter" data-level="3.1" data-path="dealing-with-missingness-single-imputation.html"><a href="dealing-with-missingness-single-imputation.html#selecting-some-variables-from-the-smart_cle-data"><i class="fa fa-check"></i><b>3.1</b> Selecting Some Variables from the <code>smart_cle</code> data</a></li>
<li class="chapter" data-level="3.2" data-path="dealing-with-missingness-single-imputation.html"><a href="dealing-with-missingness-single-imputation.html#smart_cle1-seeing-our-missing-data"><i class="fa fa-check"></i><b>3.2</b> <code>smart_cle1</code>: Seeing our Missing Data</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="dealing-with-missingness-single-imputation.html"><a href="dealing-with-missingness-single-imputation.html#plotting-missingness"><i class="fa fa-check"></i><b>3.2.1</b> Plotting Missingness</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="dealing-with-missingness-single-imputation.html"><a href="dealing-with-missingness-single-imputation.html#missing-data-mechanisms"><i class="fa fa-check"></i><b>3.3</b> Missing-data mechanisms</a></li>
<li class="chapter" data-level="3.4" data-path="dealing-with-missingness-single-imputation.html"><a href="dealing-with-missingness-single-imputation.html#options-for-dealing-with-missingness"><i class="fa fa-check"></i><b>3.4</b> Options for Dealing with Missingness</a></li>
<li class="chapter" data-level="3.5" data-path="dealing-with-missingness-single-imputation.html"><a href="dealing-with-missingness-single-imputation.html#complete-case-and-available-case-analyses"><i class="fa fa-check"></i><b>3.5</b> Complete Case (and Available Case) analyses</a></li>
<li class="chapter" data-level="3.6" data-path="dealing-with-missingness-single-imputation.html"><a href="dealing-with-missingness-single-imputation.html#single-imputation"><i class="fa fa-check"></i><b>3.6</b> Single Imputation</a></li>
<li class="chapter" data-level="3.7" data-path="dealing-with-missingness-single-imputation.html"><a href="dealing-with-missingness-single-imputation.html#multiple-imputation"><i class="fa fa-check"></i><b>3.7</b> Multiple Imputation</a></li>
<li class="chapter" data-level="3.8" data-path="dealing-with-missingness-single-imputation.html"><a href="dealing-with-missingness-single-imputation.html#approach-1-building-a-complete-case-analysis-smart_cle1_cc"><i class="fa fa-check"></i><b>3.8</b> Approach 1: Building a Complete Case Analysis: <code>smart_cle1_cc</code></a></li>
<li class="chapter" data-level="3.9" data-path="dealing-with-missingness-single-imputation.html"><a href="dealing-with-missingness-single-imputation.html#approach-2-single-imputation-to-create-smart_cle1_sh"><i class="fa fa-check"></i><b>3.9</b> Approach 2: Single Imputation to create <code>smart_cle1_sh</code></a>
<ul>
<li class="chapter" data-level="3.9.1" data-path="dealing-with-missingness-single-imputation.html"><a href="dealing-with-missingness-single-imputation.html#what-type-of-missingness-do-we-have"><i class="fa fa-check"></i><b>3.9.1</b> What Type of Missingness Do We Have?</a></li>
<li class="chapter" data-level="3.9.2" data-path="dealing-with-missingness-single-imputation.html"><a href="dealing-with-missingness-single-imputation.html#single-imputation-into-smart_cle1_sh"><i class="fa fa-check"></i><b>3.9.2</b> Single imputation into <code>smart_cle1_sh</code></a></li>
<li class="chapter" data-level="3.9.3" data-path="dealing-with-missingness-single-imputation.html"><a href="dealing-with-missingness-single-imputation.html#imputing-binary-categorical-variables"><i class="fa fa-check"></i><b>3.9.3</b> Imputing Binary Categorical Variables</a></li>
<li class="chapter" data-level="3.9.4" data-path="dealing-with-missingness-single-imputation.html"><a href="dealing-with-missingness-single-imputation.html#imputing-quantitative-variables"><i class="fa fa-check"></i><b>3.9.4</b> Imputing Quantitative Variables</a></li>
<li class="chapter" data-level="3.9.5" data-path="dealing-with-missingness-single-imputation.html"><a href="dealing-with-missingness-single-imputation.html#imputation-results"><i class="fa fa-check"></i><b>3.9.5</b> Imputation Results</a></li>
<li class="chapter" data-level="3.9.6" data-path="dealing-with-missingness-single-imputation.html"><a href="dealing-with-missingness-single-imputation.html#imputing-multi-categorical-variables"><i class="fa fa-check"></i><b>3.9.6</b> Imputing Multi-Categorical Variables</a></li>
<li class="chapter" data-level="3.9.7" data-path="dealing-with-missingness-single-imputation.html"><a href="dealing-with-missingness-single-imputation.html#saving-the-new-tibbles"><i class="fa fa-check"></i><b>3.9.7</b> Saving the new tibbles</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="summarizing-the-smart-cle1-data.html"><a href="summarizing-the-smart-cle1-data.html"><i class="fa fa-check"></i><b>4</b> Summarizing the <code>smart_cle1</code> data</a>
<ul>
<li class="chapter" data-level="4.1" data-path="summarizing-the-smart-cle1-data.html"><a href="summarizing-the-smart-cle1-data.html#general-approaches-to-obtaining-numeric-summaries"><i class="fa fa-check"></i><b>4.1</b> General Approaches to Obtaining Numeric Summaries</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="summarizing-the-smart-cle1-data.html"><a href="summarizing-the-smart-cle1-data.html#summary-for-a-data-frame"><i class="fa fa-check"></i><b>4.1.1</b> <code>summary</code> for a data frame</a></li>
<li class="chapter" data-level="4.1.2" data-path="summarizing-the-smart-cle1-data.html"><a href="summarizing-the-smart-cle1-data.html#the-inspect-function-from-the-mosaic-package"><i class="fa fa-check"></i><b>4.1.2</b> The <code>inspect</code> function from the <code>mosaic</code> package</a></li>
<li class="chapter" data-level="4.1.3" data-path="summarizing-the-smart-cle1-data.html"><a href="summarizing-the-smart-cle1-data.html#the-describe-function-in-hmisc"><i class="fa fa-check"></i><b>4.1.3</b> The <code>describe</code> function in <code>Hmisc</code></a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="summarizing-the-smart-cle1-data.html"><a href="summarizing-the-smart-cle1-data.html#counting-as-exploratory-data-analysis"><i class="fa fa-check"></i><b>4.2</b> Counting as exploratory data analysis</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="summarizing-the-smart-cle1-data.html"><a href="summarizing-the-smart-cle1-data.html#did-genhealth-vary-by-smoking-status"><i class="fa fa-check"></i><b>4.2.1</b> Did <code>genhealth</code> vary by smoking status?</a></li>
<li class="chapter" data-level="4.2.2" data-path="summarizing-the-smart-cle1-data.html"><a href="summarizing-the-smart-cle1-data.html#whats-the-distribution-of-physhealth"><i class="fa fa-check"></i><b>4.2.2</b> What’s the distribution of <code>physhealth</code>?</a></li>
<li class="chapter" data-level="4.2.3" data-path="summarizing-the-smart-cle1-data.html"><a href="summarizing-the-smart-cle1-data.html#whats-the-distribution-of-bmi"><i class="fa fa-check"></i><b>4.2.3</b> What’s the distribution of <code>bmi</code>?</a></li>
<li class="chapter" data-level="4.2.4" data-path="summarizing-the-smart-cle1-data.html"><a href="summarizing-the-smart-cle1-data.html#how-many-of-the-respondents-have-a-bmi-below-30"><i class="fa fa-check"></i><b>4.2.4</b> How many of the respondents have a BMI below 30?</a></li>
<li class="chapter" data-level="4.2.5" data-path="summarizing-the-smart-cle1-data.html"><a href="summarizing-the-smart-cle1-data.html#how-many-of-the-respondents-with-a-bmi-30-are-highly-active"><i class="fa fa-check"></i><b>4.2.5</b> How many of the respondents with a BMI &lt; 30 are highly active?</a></li>
<li class="chapter" data-level="4.2.6" data-path="summarizing-the-smart-cle1-data.html"><a href="summarizing-the-smart-cle1-data.html#is-obesity-associated-with-smoking-history"><i class="fa fa-check"></i><b>4.2.6</b> Is obesity associated with smoking history?</a></li>
<li class="chapter" data-level="4.2.7" data-path="summarizing-the-smart-cle1-data.html"><a href="summarizing-the-smart-cle1-data.html#comparing-drinks_wk-summaries-by-obesity-status"><i class="fa fa-check"></i><b>4.2.7</b> Comparing <code>drinks_wk</code> summaries by obesity status</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="summarizing-the-smart-cle1-data.html"><a href="summarizing-the-smart-cle1-data.html#can-bmi-predict-physhealth"><i class="fa fa-check"></i><b>4.3</b> Can <code>bmi</code> predict <code>physhealth</code>?</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="summarizing-the-smart-cle1-data.html"><a href="summarizing-the-smart-cle1-data.html#fitting-a-simple-regression-model"><i class="fa fa-check"></i><b>4.3.1</b> Fitting a Simple Regression Model</a></li>
<li class="chapter" data-level="4.3.2" data-path="summarizing-the-smart-cle1-data.html"><a href="summarizing-the-smart-cle1-data.html#model-summary-for-a-simple-one-predictor-regression"><i class="fa fa-check"></i><b>4.3.2</b> Model Summary for a Simple (One-Predictor) Regression</a></li>
<li class="chapter" data-level="4.3.3" data-path="summarizing-the-smart-cle1-data.html"><a href="summarizing-the-smart-cle1-data.html#using-the-broom-package"><i class="fa fa-check"></i><b>4.3.3</b> Using the <code>broom</code> package</a></li>
<li class="chapter" data-level="4.3.4" data-path="summarizing-the-smart-cle1-data.html"><a href="summarizing-the-smart-cle1-data.html#how-does-the-model-do-residuals-vs.-fitted-values"><i class="fa fa-check"></i><b>4.3.4</b> How does the model do? (Residuals vs. Fitted Values)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="analysis-of-variance-with-smart.html"><a href="analysis-of-variance-with-smart.html"><i class="fa fa-check"></i><b>5</b> Analysis of Variance with SMART</a>
<ul>
<li class="chapter" data-level="5.1" data-path="analysis-of-variance-with-smart.html"><a href="analysis-of-variance-with-smart.html#a-one-factor-analysis-of-variance"><i class="fa fa-check"></i><b>5.1</b> A One-Factor Analysis of Variance</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="analysis-of-variance-with-smart.html"><a href="analysis-of-variance-with-smart.html#can-activity-be-used-to-predict-bmi"><i class="fa fa-check"></i><b>5.1.1</b> Can <code>activity</code> be used to predict <code>bmi</code>?</a></li>
<li class="chapter" data-level="5.1.2" data-path="analysis-of-variance-with-smart.html"><a href="analysis-of-variance-with-smart.html#should-we-transform-bmi"><i class="fa fa-check"></i><b>5.1.2</b> Should we transform <code>bmi</code>?</a></li>
<li class="chapter" data-level="5.1.3" data-path="analysis-of-variance-with-smart.html"><a href="analysis-of-variance-with-smart.html#building-the-anova-model"><i class="fa fa-check"></i><b>5.1.3</b> Building the ANOVA model</a></li>
<li class="chapter" data-level="5.1.4" data-path="analysis-of-variance-with-smart.html"><a href="analysis-of-variance-with-smart.html#the-anova-table"><i class="fa fa-check"></i><b>5.1.4</b> The ANOVA table</a></li>
<li class="chapter" data-level="5.1.5" data-path="analysis-of-variance-with-smart.html"><a href="analysis-of-variance-with-smart.html#the-model-coefficients"><i class="fa fa-check"></i><b>5.1.5</b> The Model Coefficients</a></li>
<li class="chapter" data-level="5.1.6" data-path="analysis-of-variance-with-smart.html"><a href="analysis-of-variance-with-smart.html#using-broomtidy-to-explore-the-coefficients"><i class="fa fa-check"></i><b>5.1.6</b> Using <code>broom::tidy</code> to explore the coefficients</a></li>
<li class="chapter" data-level="5.1.7" data-path="analysis-of-variance-with-smart.html"><a href="analysis-of-variance-with-smart.html#using-broomglance-to-summarize-the-models-fit"><i class="fa fa-check"></i><b>5.1.7</b> Using <code>broom::glance</code> to summarize the model’s fit</a></li>
<li class="chapter" data-level="5.1.8" data-path="analysis-of-variance-with-smart.html"><a href="analysis-of-variance-with-smart.html#using-broomaugment-to-make-predictions"><i class="fa fa-check"></i><b>5.1.8</b> Using <code>broom::augment</code> to make predictions</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="analysis-of-variance-with-smart.html"><a href="analysis-of-variance-with-smart.html#a-two-factor-anova-without-interaction"><i class="fa fa-check"></i><b>5.2</b> A Two-Factor ANOVA (without Interaction)</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="analysis-of-variance-with-smart.html"><a href="analysis-of-variance-with-smart.html#model-coefficients"><i class="fa fa-check"></i><b>5.2.1</b> Model Coefficients</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="analysis-of-variance-with-smart.html"><a href="analysis-of-variance-with-smart.html#a-two-factor-anova-with-interaction"><i class="fa fa-check"></i><b>5.3</b> A Two-Factor ANOVA (with Interaction)</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="analysis-of-variance-with-smart.html"><a href="analysis-of-variance-with-smart.html#model-coefficients-1"><i class="fa fa-check"></i><b>5.3.1</b> Model Coefficients</a></li>
<li class="chapter" data-level="5.3.2" data-path="analysis-of-variance-with-smart.html"><a href="analysis-of-variance-with-smart.html#is-the-interaction-term-necessary"><i class="fa fa-check"></i><b>5.3.2</b> Is the interaction term necessary?</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="analysis-of-variance.html"><a href="analysis-of-variance.html"><i class="fa fa-check"></i><b>6</b> Analysis of Variance</a>
<ul>
<li class="chapter" data-level="6.1" data-path="analysis-of-variance.html"><a href="analysis-of-variance.html#the-bonding-data-a-designed-dental-experiment"><i class="fa fa-check"></i><b>6.1</b> The <code>bonding</code> data: A Designed Dental Experiment</a></li>
<li class="chapter" data-level="6.2" data-path="analysis-of-variance.html"><a href="analysis-of-variance.html#a-one-factor-analysis-of-variance-1"><i class="fa fa-check"></i><b>6.2</b> A One-Factor Analysis of Variance</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="analysis-of-variance.html"><a href="analysis-of-variance.html#look-at-the-data"><i class="fa fa-check"></i><b>6.2.1</b> Look at the Data!</a></li>
<li class="chapter" data-level="6.2.2" data-path="analysis-of-variance.html"><a href="analysis-of-variance.html#table-of-summary-statistics"><i class="fa fa-check"></i><b>6.2.2</b> Table of Summary Statistics</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="analysis-of-variance.html"><a href="analysis-of-variance.html#a-two-way-anova-looking-at-two-factors"><i class="fa fa-check"></i><b>6.3</b> A Two-Way ANOVA: Looking at Two Factors</a></li>
<li class="chapter" data-level="6.4" data-path="analysis-of-variance.html"><a href="analysis-of-variance.html#a-means-plot-with-standard-deviations-to-check-for-interaction"><i class="fa fa-check"></i><b>6.4</b> A Means Plot (with standard deviations) to check for interaction</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="analysis-of-variance.html"><a href="analysis-of-variance.html#summarizing-the-data-after-grouping-by-resin-and-light"><i class="fa fa-check"></i><b>6.4.1</b> Summarizing the data after grouping by <code>resin</code> and <code>light</code></a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="analysis-of-variance.html"><a href="analysis-of-variance.html#fitting-the-two-way-anova-model-with-interaction"><i class="fa fa-check"></i><b>6.5</b> Fitting the Two-Way ANOVA model with Interaction</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="analysis-of-variance.html"><a href="analysis-of-variance.html#the-anova-table-for-our-model"><i class="fa fa-check"></i><b>6.5.1</b> The ANOVA table for our model</a></li>
<li class="chapter" data-level="6.5.2" data-path="analysis-of-variance.html"><a href="analysis-of-variance.html#is-the-interaction-important"><i class="fa fa-check"></i><b>6.5.2</b> Is the interaction important?</a></li>
<li class="chapter" data-level="6.5.3" data-path="analysis-of-variance.html"><a href="analysis-of-variance.html#interpreting-the-interaction"><i class="fa fa-check"></i><b>6.5.3</b> Interpreting the Interaction</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="analysis-of-variance.html"><a href="analysis-of-variance.html#comparing-individual-combinations-of-resin-and-light"><i class="fa fa-check"></i><b>6.6</b> Comparing Individual Combinations of <code>resin</code> and <code>light</code></a></li>
<li class="chapter" data-level="6.7" data-path="analysis-of-variance.html"><a href="analysis-of-variance.html#the-bonding-model-without-interaction"><i class="fa fa-check"></i><b>6.7</b> The <code>bonding</code> model without Interaction</a></li>
<li class="chapter" data-level="6.8" data-path="analysis-of-variance.html"><a href="analysis-of-variance.html#cortisol-a-hypothetical-clinical-trial"><i class="fa fa-check"></i><b>6.8</b> <code>cortisol</code>: A Hypothetical Clinical Trial</a>
<ul>
<li class="chapter" data-level="6.8.1" data-path="analysis-of-variance.html"><a href="analysis-of-variance.html#codebook-and-raw-data-for-cortisol"><i class="fa fa-check"></i><b>6.8.1</b> Codebook and Raw Data for <code>cortisol</code></a></li>
</ul></li>
<li class="chapter" data-level="6.9" data-path="analysis-of-variance.html"><a href="analysis-of-variance.html#creating-a-factor-combining-sex-and-waist"><i class="fa fa-check"></i><b>6.9</b> Creating a factor combining sex and waist</a></li>
<li class="chapter" data-level="6.10" data-path="analysis-of-variance.html"><a href="analysis-of-variance.html#a-means-plot-for-the-cortisol-trial-with-standard-errors"><i class="fa fa-check"></i><b>6.10</b> A Means Plot for the <code>cortisol</code> trial (with standard errors)</a></li>
<li class="chapter" data-level="6.11" data-path="analysis-of-variance.html"><a href="analysis-of-variance.html#a-two-way-anova-model-for-cortisol-with-interaction"><i class="fa fa-check"></i><b>6.11</b> A Two-Way ANOVA model for <code>cortisol</code> with Interaction</a></li>
<li class="chapter" data-level="6.12" data-path="analysis-of-variance.html"><a href="analysis-of-variance.html#a-two-way-anova-model-for-cortisol-without-interaction"><i class="fa fa-check"></i><b>6.12</b> A Two-Way ANOVA model for <code>cortisol</code> without Interaction</a>
<ul>
<li class="chapter" data-level="6.12.1" data-path="analysis-of-variance.html"><a href="analysis-of-variance.html#the-graph"><i class="fa fa-check"></i><b>6.12.1</b> The Graph</a></li>
<li class="chapter" data-level="6.12.2" data-path="analysis-of-variance.html"><a href="analysis-of-variance.html#the-anova-model"><i class="fa fa-check"></i><b>6.12.2</b> The ANOVA Model</a></li>
<li class="chapter" data-level="6.12.3" data-path="analysis-of-variance.html"><a href="analysis-of-variance.html#the-regression-summary"><i class="fa fa-check"></i><b>6.12.3</b> The Regression Summary</a></li>
<li class="chapter" data-level="6.12.4" data-path="analysis-of-variance.html"><a href="analysis-of-variance.html#tukey-hsd-comparisons"><i class="fa fa-check"></i><b>6.12.4</b> Tukey HSD Comparisons</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="analysis-of-covariance.html"><a href="analysis-of-covariance.html"><i class="fa fa-check"></i><b>7</b> Analysis of Covariance</a>
<ul>
<li class="chapter" data-level="7.1" data-path="analysis-of-covariance.html"><a href="analysis-of-covariance.html#an-emphysema-study"><i class="fa fa-check"></i><b>7.1</b> An Emphysema Study</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="analysis-of-covariance.html"><a href="analysis-of-covariance.html#codebook"><i class="fa fa-check"></i><b>7.1.1</b> Codebook</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="analysis-of-covariance.html"><a href="analysis-of-covariance.html#does-sex-affect-the-mean-change-in-theophylline"><i class="fa fa-check"></i><b>7.2</b> Does <code>sex</code> affect the mean change in theophylline?</a></li>
<li class="chapter" data-level="7.3" data-path="analysis-of-covariance.html"><a href="analysis-of-covariance.html#is-there-an-association-between-age-and-sex-in-this-study"><i class="fa fa-check"></i><b>7.3</b> Is there an association between <code>age</code> and <code>sex</code> in this study?</a></li>
<li class="chapter" data-level="7.4" data-path="analysis-of-covariance.html"><a href="analysis-of-covariance.html#adding-a-quantitative-covariate-age-to-the-model"><i class="fa fa-check"></i><b>7.4</b> Adding a quantitative covariate, <code>age</code>, to the model</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="analysis-of-covariance.html"><a href="analysis-of-covariance.html#the-ancova-model"><i class="fa fa-check"></i><b>7.4.1</b> The ANCOVA model</a></li>
<li class="chapter" data-level="7.4.2" data-path="analysis-of-covariance.html"><a href="analysis-of-covariance.html#the-ancova-table"><i class="fa fa-check"></i><b>7.4.2</b> The ANCOVA Table</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="analysis-of-covariance.html"><a href="analysis-of-covariance.html#rerunning-the-ancova-model-after-simple-imputation"><i class="fa fa-check"></i><b>7.5</b> Rerunning the ANCOVA model after simple imputation</a></li>
<li class="chapter" data-level="7.6" data-path="analysis-of-covariance.html"><a href="analysis-of-covariance.html#looking-at-a-factor-covariate-interaction"><i class="fa fa-check"></i><b>7.6</b> Looking at a factor-covariate interaction</a></li>
<li class="chapter" data-level="7.7" data-path="analysis-of-covariance.html"><a href="analysis-of-covariance.html#centering-the-covariate-to-facilitate-ancova-interpretation"><i class="fa fa-check"></i><b>7.7</b> Centering the Covariate to Facilitate ANCOVA Interpretation</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="analysis-of-covariance-with-the-smart-data.html"><a href="analysis-of-covariance-with-the-smart-data.html"><i class="fa fa-check"></i><b>8</b> Analysis of Covariance with the SMART data</a>
<ul>
<li class="chapter" data-level="8.1" data-path="analysis-of-covariance-with-the-smart-data.html"><a href="analysis-of-covariance-with-the-smart-data.html#a-new-small-study-predicting-bmi"><i class="fa fa-check"></i><b>8.1</b> A New Small Study: Predicting BMI</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="analysis-of-covariance-with-the-smart-data.html"><a href="analysis-of-covariance-with-the-smart-data.html#does-female-predict-bmi-well"><i class="fa fa-check"></i><b>8.1.1</b> Does <code>female</code> predict <code>bmi</code> well?</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="analysis-of-covariance-with-the-smart-data.html"><a href="analysis-of-covariance-with-the-smart-data.html#c8_m1-a-simple-t-test-model"><i class="fa fa-check"></i><b>8.2</b> <code>c8_m1</code>: A simple t-test model</a></li>
<li class="chapter" data-level="8.3" data-path="analysis-of-covariance-with-the-smart-data.html"><a href="analysis-of-covariance-with-the-smart-data.html#c8_m2-adding-another-predictor-two-way-anova-without-interaction"><i class="fa fa-check"></i><b>8.3</b> <code>c8_m2</code>: Adding another predictor (two-way ANOVA without interaction)</a></li>
<li class="chapter" data-level="8.4" data-path="analysis-of-covariance-with-the-smart-data.html"><a href="analysis-of-covariance-with-the-smart-data.html#c8_m3-adding-the-interaction-term-two-way-anova-with-interaction"><i class="fa fa-check"></i><b>8.4</b> <code>c8_m3</code>: Adding the interaction term (Two-way ANOVA with interaction)</a></li>
<li class="chapter" data-level="8.5" data-path="analysis-of-covariance-with-the-smart-data.html"><a href="analysis-of-covariance-with-the-smart-data.html#c8_m4-using-female-and-physhealth-in-a-model-for-bmi"><i class="fa fa-check"></i><b>8.5</b> <code>c8_m4</code>: Using <code>female</code> and <code>physhealth</code> in a model for <code>bmi</code></a></li>
<li class="chapter" data-level="8.6" data-path="analysis-of-covariance-with-the-smart-data.html"><a href="analysis-of-covariance-with-the-smart-data.html#making-predictions-with-a-linear-regression-model"><i class="fa fa-check"></i><b>8.6</b> Making Predictions with a Linear Regression Model</a>
<ul>
<li class="chapter" data-level="8.6.1" data-path="analysis-of-covariance-with-the-smart-data.html"><a href="analysis-of-covariance-with-the-smart-data.html#fitting-an-individual-prediction-and-95-prediction-interval"><i class="fa fa-check"></i><b>8.6.1</b> Fitting an Individual Prediction and 95% Prediction Interval</a></li>
<li class="chapter" data-level="8.6.2" data-path="analysis-of-covariance-with-the-smart-data.html"><a href="analysis-of-covariance-with-the-smart-data.html#confidence-interval-for-an-average-prediction"><i class="fa fa-check"></i><b>8.6.2</b> Confidence Interval for an Average Prediction</a></li>
<li class="chapter" data-level="8.6.3" data-path="analysis-of-covariance-with-the-smart-data.html"><a href="analysis-of-covariance-with-the-smart-data.html#fitting-multiple-individual-predictions-to-new-data"><i class="fa fa-check"></i><b>8.6.3</b> Fitting Multiple Individual Predictions to New Data</a></li>
</ul></li>
<li class="chapter" data-level="8.7" data-path="analysis-of-covariance-with-the-smart-data.html"><a href="analysis-of-covariance-with-the-smart-data.html#centering-the-model"><i class="fa fa-check"></i><b>8.7</b> Centering the model</a>
<ul>
<li class="chapter" data-level="8.7.1" data-path="analysis-of-covariance-with-the-smart-data.html"><a href="analysis-of-covariance-with-the-smart-data.html#plot-of-model-4-on-centered-physhealth-c8_m4_c"><i class="fa fa-check"></i><b>8.7.1</b> Plot of Model 4 on Centered <code>physhealth</code>: <code>c8_m4_c</code></a></li>
</ul></li>
<li class="chapter" data-level="8.8" data-path="analysis-of-covariance-with-the-smart-data.html"><a href="analysis-of-covariance-with-the-smart-data.html#rescaling-an-input-by-subtracting-the-mean-and-dividing-by-2-standard-deviations"><i class="fa fa-check"></i><b>8.8</b> Rescaling an input by subtracting the mean and dividing by 2 standard deviations</a>
<ul>
<li class="chapter" data-level="8.8.1" data-path="analysis-of-covariance-with-the-smart-data.html"><a href="analysis-of-covariance-with-the-smart-data.html#refitting-model-c8_m4-to-the-rescaled-data"><i class="fa fa-check"></i><b>8.8.1</b> Refitting model <code>c8_m4</code> to the rescaled data</a></li>
<li class="chapter" data-level="8.8.2" data-path="analysis-of-covariance-with-the-smart-data.html"><a href="analysis-of-covariance-with-the-smart-data.html#interpreting-the-model-on-rescaled-data"><i class="fa fa-check"></i><b>8.8.2</b> Interpreting the model on rescaled data</a></li>
<li class="chapter" data-level="8.8.3" data-path="analysis-of-covariance-with-the-smart-data.html"><a href="analysis-of-covariance-with-the-smart-data.html#plot-of-model-on-rescaled-data"><i class="fa fa-check"></i><b>8.8.3</b> Plot of model on rescaled data</a></li>
</ul></li>
<li class="chapter" data-level="8.9" data-path="analysis-of-covariance-with-the-smart-data.html"><a href="analysis-of-covariance-with-the-smart-data.html#c8_m5-what-if-we-add-more-variables"><i class="fa fa-check"></i><b>8.9</b> <code>c8_m5</code>: What if we add more variables?</a></li>
<li class="chapter" data-level="8.10" data-path="analysis-of-covariance-with-the-smart-data.html"><a href="analysis-of-covariance-with-the-smart-data.html#c8_m6-would-adding-self-reported-health-help"><i class="fa fa-check"></i><b>8.10</b> <code>c8_m6</code>: Would adding self-reported health help?</a></li>
<li class="chapter" data-level="8.11" data-path="analysis-of-covariance-with-the-smart-data.html"><a href="analysis-of-covariance-with-the-smart-data.html#key-regression-assumptions-for-building-effective-prediction-models"><i class="fa fa-check"></i><b>8.11</b> Key Regression Assumptions for Building Effective Prediction Models</a>
<ul>
<li class="chapter" data-level="8.11.1" data-path="analysis-of-covariance-with-the-smart-data.html"><a href="analysis-of-covariance-with-the-smart-data.html#checking-assumptions-in-model-c8_m6"><i class="fa fa-check"></i><b>8.11.1</b> Checking Assumptions in model <code>c8_m6</code></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="adding-non-linear-terms-to-a-linear-regression-model.html"><a href="adding-non-linear-terms-to-a-linear-regression-model.html"><i class="fa fa-check"></i><b>9</b> Adding Non-linear Terms to a Linear Regression Model</a>
<ul>
<li class="chapter" data-level="9.1" data-path="adding-non-linear-terms-to-a-linear-regression-model.html"><a href="adding-non-linear-terms-to-a-linear-regression-model.html#the-pollution-data"><i class="fa fa-check"></i><b>9.1</b> The <code>pollution</code> data</a></li>
<li class="chapter" data-level="9.2" data-path="adding-non-linear-terms-to-a-linear-regression-model.html"><a href="adding-non-linear-terms-to-a-linear-regression-model.html#fitting-a-straight-line-model-to-predict-y-from-x2"><i class="fa fa-check"></i><b>9.2</b> Fitting a straight line model to predict <code>y</code> from <code>x2</code></a></li>
<li class="chapter" data-level="9.3" data-path="adding-non-linear-terms-to-a-linear-regression-model.html"><a href="adding-non-linear-terms-to-a-linear-regression-model.html#quadratic-polynomial-model-to-predict-y-using-x2"><i class="fa fa-check"></i><b>9.3</b> Quadratic polynomial model to predict <code>y</code> using <code>x2</code></a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="adding-non-linear-terms-to-a-linear-regression-model.html"><a href="adding-non-linear-terms-to-a-linear-regression-model.html#the-raw-quadratic-model"><i class="fa fa-check"></i><b>9.3.1</b> The raw quadratic model</a></li>
<li class="chapter" data-level="9.3.2" data-path="adding-non-linear-terms-to-a-linear-regression-model.html"><a href="adding-non-linear-terms-to-a-linear-regression-model.html#raw-quadratic-fit-after-centering-x2"><i class="fa fa-check"></i><b>9.3.2</b> Raw quadratic fit after centering <code>x2</code></a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="adding-non-linear-terms-to-a-linear-regression-model.html"><a href="adding-non-linear-terms-to-a-linear-regression-model.html#orthogonal-polynomials"><i class="fa fa-check"></i><b>9.4</b> Orthogonal Polynomials</a></li>
<li class="chapter" data-level="9.5" data-path="adding-non-linear-terms-to-a-linear-regression-model.html"><a href="adding-non-linear-terms-to-a-linear-regression-model.html#fit-a-cubic-polynomial-to-predict-y-from-x3"><i class="fa fa-check"></i><b>9.5</b> Fit a cubic polynomial to predict <code>y</code> from <code>x3</code></a></li>
<li class="chapter" data-level="9.6" data-path="adding-non-linear-terms-to-a-linear-regression-model.html"><a href="adding-non-linear-terms-to-a-linear-regression-model.html#fitting-a-restricted-cubic-spline-in-a-linear-regression"><i class="fa fa-check"></i><b>9.6</b> Fitting a restricted cubic spline in a linear regression</a></li>
<li class="chapter" data-level="9.7" data-path="adding-non-linear-terms-to-a-linear-regression-model.html"><a href="adding-non-linear-terms-to-a-linear-regression-model.html#spending-degrees-of-freedom"><i class="fa fa-check"></i><b>9.7</b> “Spending” Degrees of Freedom</a>
<ul>
<li class="chapter" data-level="9.7.1" data-path="adding-non-linear-terms-to-a-linear-regression-model.html"><a href="adding-non-linear-terms-to-a-linear-regression-model.html#overfitting-and-limits-on-the-of-predictors"><i class="fa fa-check"></i><b>9.7.1</b> Overfitting and Limits on the # of Predictors</a></li>
<li class="chapter" data-level="9.7.2" data-path="adding-non-linear-terms-to-a-linear-regression-model.html"><a href="adding-non-linear-terms-to-a-linear-regression-model.html#the-importance-of-collinearity"><i class="fa fa-check"></i><b>9.7.2</b> The Importance of Collinearity</a></li>
<li class="chapter" data-level="9.7.3" data-path="adding-non-linear-terms-to-a-linear-regression-model.html"><a href="adding-non-linear-terms-to-a-linear-regression-model.html#collinearity-in-an-explanatory-model"><i class="fa fa-check"></i><b>9.7.3</b> Collinearity in an Explanatory Model</a></li>
<li class="chapter" data-level="9.7.4" data-path="adding-non-linear-terms-to-a-linear-regression-model.html"><a href="adding-non-linear-terms-to-a-linear-regression-model.html#collinearity-in-a-prediction-model"><i class="fa fa-check"></i><b>9.7.4</b> Collinearity in a Prediction Model</a></li>
</ul></li>
<li class="chapter" data-level="9.8" data-path="adding-non-linear-terms-to-a-linear-regression-model.html"><a href="adding-non-linear-terms-to-a-linear-regression-model.html#spending-df-on-non-linearity-the-spearman-plot"><i class="fa fa-check"></i><b>9.8</b> Spending DF on Non-Linearity: The Spearman Plot</a>
<ul>
<li class="chapter" data-level="9.8.1" data-path="adding-non-linear-terms-to-a-linear-regression-model.html"><a href="adding-non-linear-terms-to-a-linear-regression-model.html#fitting-a-big-model-to-the-pollution-data"><i class="fa fa-check"></i><b>9.8.1</b> Fitting a Big Model to the <code>pollution</code> data</a></li>
<li class="chapter" data-level="9.8.2" data-path="adding-non-linear-terms-to-a-linear-regression-model.html"><a href="adding-non-linear-terms-to-a-linear-regression-model.html#limitations-of-lm-for-fitting-complex-linear-regression-models"><i class="fa fa-check"></i><b>9.8.2</b> Limitations of <code>lm</code> for fitting complex linear regression models</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="using-ols-from-the-rms-package-to-fit-linear-models.html"><a href="using-ols-from-the-rms-package-to-fit-linear-models.html"><i class="fa fa-check"></i><b>10</b> Using <code>ols</code> from the <code>rms</code> package to fit linear models</a>
<ul>
<li class="chapter" data-level="10.1" data-path="using-ols-from-the-rms-package-to-fit-linear-models.html"><a href="using-ols-from-the-rms-package-to-fit-linear-models.html#fitting-a-model-with-ols"><i class="fa fa-check"></i><b>10.1</b> Fitting a model with <code>ols</code></a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="using-ols-from-the-rms-package-to-fit-linear-models.html"><a href="using-ols-from-the-rms-package-to-fit-linear-models.html#the-model-likelihood-ratio-test"><i class="fa fa-check"></i><b>10.1.1</b> The Model Likelihood Ratio Test</a></li>
<li class="chapter" data-level="10.1.2" data-path="using-ols-from-the-rms-package-to-fit-linear-models.html"><a href="using-ols-from-the-rms-package-to-fit-linear-models.html#the-g-statistic"><i class="fa fa-check"></i><b>10.1.2</b> The g statistic</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="using-ols-from-the-rms-package-to-fit-linear-models.html"><a href="using-ols-from-the-rms-package-to-fit-linear-models.html#anova-for-an-ols-model"><i class="fa fa-check"></i><b>10.2</b> ANOVA for an <code>ols</code> model</a></li>
<li class="chapter" data-level="10.3" data-path="using-ols-from-the-rms-package-to-fit-linear-models.html"><a href="using-ols-from-the-rms-package-to-fit-linear-models.html#effect-estimates"><i class="fa fa-check"></i><b>10.3</b> Effect Estimates</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="using-ols-from-the-rms-package-to-fit-linear-models.html"><a href="using-ols-from-the-rms-package-to-fit-linear-models.html#simultaneous-confidence-intervals"><i class="fa fa-check"></i><b>10.3.1</b> Simultaneous Confidence Intervals</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="using-ols-from-the-rms-package-to-fit-linear-models.html"><a href="using-ols-from-the-rms-package-to-fit-linear-models.html#the-predict-function-for-an-ols-model"><i class="fa fa-check"></i><b>10.4</b> The <code>Predict</code> function for an <code>ols</code> model</a></li>
<li class="chapter" data-level="10.5" data-path="using-ols-from-the-rms-package-to-fit-linear-models.html"><a href="using-ols-from-the-rms-package-to-fit-linear-models.html#checking-influence-via-dfbeta"><i class="fa fa-check"></i><b>10.5</b> Checking Influence via <code>dfbeta</code></a>
<ul>
<li class="chapter" data-level="10.5.1" data-path="using-ols-from-the-rms-package-to-fit-linear-models.html"><a href="using-ols-from-the-rms-package-to-fit-linear-models.html#using-the-residuals-command-for-dfbetas"><i class="fa fa-check"></i><b>10.5.1</b> Using the <code>residuals</code> command for <code>dfbetas</code></a></li>
<li class="chapter" data-level="10.5.2" data-path="using-ols-from-the-rms-package-to-fit-linear-models.html"><a href="using-ols-from-the-rms-package-to-fit-linear-models.html#using-the-residuals-command-for-other-summaries"><i class="fa fa-check"></i><b>10.5.2</b> Using the <code>residuals</code> command for other summaries</a></li>
</ul></li>
<li class="chapter" data-level="10.6" data-path="using-ols-from-the-rms-package-to-fit-linear-models.html"><a href="using-ols-from-the-rms-package-to-fit-linear-models.html#model-validation-and-correcting-for-optimism"><i class="fa fa-check"></i><b>10.6</b> Model Validation and Correcting for Optimism</a></li>
<li class="chapter" data-level="10.7" data-path="using-ols-from-the-rms-package-to-fit-linear-models.html"><a href="using-ols-from-the-rms-package-to-fit-linear-models.html#building-a-nomogram-for-our-model"><i class="fa fa-check"></i><b>10.7</b> Building a Nomogram for Our Model</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="logistic-regression-the-foundations.html"><a href="logistic-regression-the-foundations.html"><i class="fa fa-check"></i><b>11</b> Logistic Regression: The Foundations</a>
<ul>
<li class="chapter" data-level="11.1" data-path="logistic-regression-the-foundations.html"><a href="logistic-regression-the-foundations.html#a-first-attempt-a-linear-probability-model"><i class="fa fa-check"></i><b>11.1</b> A First Attempt: A Linear Probability Model</a></li>
<li class="chapter" data-level="11.2" data-path="logistic-regression-the-foundations.html"><a href="logistic-regression-the-foundations.html#logistic-regression"><i class="fa fa-check"></i><b>11.2</b> Logistic Regression</a></li>
<li class="chapter" data-level="11.3" data-path="logistic-regression-the-foundations.html"><a href="logistic-regression-the-foundations.html#the-logistic-regression-model"><i class="fa fa-check"></i><b>11.3</b> The Logistic Regression Model</a></li>
<li class="chapter" data-level="11.4" data-path="logistic-regression-the-foundations.html"><a href="logistic-regression-the-foundations.html#the-link-function"><i class="fa fa-check"></i><b>11.4</b> The Link Function</a></li>
<li class="chapter" data-level="11.5" data-path="logistic-regression-the-foundations.html"><a href="logistic-regression-the-foundations.html#the-logit-or-log-odds"><i class="fa fa-check"></i><b>11.5</b> The logit or log odds</a></li>
<li class="chapter" data-level="11.6" data-path="logistic-regression-the-foundations.html"><a href="logistic-regression-the-foundations.html#interpreting-the-coefficients-of-a-logistic-regression-model"><i class="fa fa-check"></i><b>11.6</b> Interpreting the Coefficients of a Logistic Regression Model</a></li>
<li class="chapter" data-level="11.7" data-path="logistic-regression-the-foundations.html"><a href="logistic-regression-the-foundations.html#the-logistic-regression-has-non-constant-variance"><i class="fa fa-check"></i><b>11.7</b> The Logistic Regression has non-constant variance</a></li>
<li class="chapter" data-level="11.8" data-path="logistic-regression-the-foundations.html"><a href="logistic-regression-the-foundations.html#fitting-a-logistic-regression-model-to-our-simulated-data"><i class="fa fa-check"></i><b>11.8</b> Fitting a Logistic Regression Model to our Simulated Data</a></li>
<li class="chapter" data-level="11.9" data-path="logistic-regression-the-foundations.html"><a href="logistic-regression-the-foundations.html#plotting-the-logistic-regression-model"><i class="fa fa-check"></i><b>11.9</b> Plotting the Logistic Regression Model</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html"><i class="fa fa-check"></i><b>12</b> Logistic Regression and the <code>resect</code> data</a>
<ul>
<li class="chapter" data-level="12.1" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#the-resect-data"><i class="fa fa-check"></i><b>12.1</b> The <code>resect</code> data</a></li>
<li class="chapter" data-level="12.2" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#running-a-simple-logistic-regression-model"><i class="fa fa-check"></i><b>12.2</b> Running A Simple Logistic Regression Model</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#logistic-regression-can-be-harder-than-linear-regression"><i class="fa fa-check"></i><b>12.2.1</b> Logistic Regression Can Be Harder than Linear Regression</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#logistic-regression-using-glm"><i class="fa fa-check"></i><b>12.3</b> Logistic Regression using <code>glm</code></a>
<ul>
<li class="chapter" data-level="12.3.1" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#interpreting-the-coefficients-of-a-logistic-regression-model-1"><i class="fa fa-check"></i><b>12.3.1</b> Interpreting the Coefficients of a Logistic Regression Model</a></li>
<li class="chapter" data-level="12.3.2" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#using-predict-to-describe-the-models-fits"><i class="fa fa-check"></i><b>12.3.2</b> Using <code>predict</code> to describe the model’s fits</a></li>
<li class="chapter" data-level="12.3.3" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#odds-ratio-interpretation-of-coefficients"><i class="fa fa-check"></i><b>12.3.3</b> Odds Ratio interpretation of Coefficients</a></li>
<li class="chapter" data-level="12.3.4" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#interpreting-the-rest-of-the-model-output-from-glm"><i class="fa fa-check"></i><b>12.3.4</b> Interpreting the rest of the model output from <code>glm</code></a></li>
<li class="chapter" data-level="12.3.5" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#deviance-and-comparing-our-model-to-the-null-model"><i class="fa fa-check"></i><b>12.3.5</b> Deviance and Comparing Our Model to the Null Model</a></li>
<li class="chapter" data-level="12.3.6" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#using-glance-with-a-logistic-regression-model"><i class="fa fa-check"></i><b>12.3.6</b> Using <code>glance</code> with a logistic regression model</a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#interpreting-the-model-summary"><i class="fa fa-check"></i><b>12.4</b> Interpreting the Model Summary</a>
<ul>
<li class="chapter" data-level="12.4.1" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#wald-z-tests-for-coefficients-in-a-logistic-regression"><i class="fa fa-check"></i><b>12.4.1</b> Wald Z tests for Coefficients in a Logistic Regression</a></li>
<li class="chapter" data-level="12.4.2" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#confidence-intervals-for-the-coefficients"><i class="fa fa-check"></i><b>12.4.2</b> Confidence Intervals for the Coefficients</a></li>
<li class="chapter" data-level="12.4.3" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#deviance-residuals"><i class="fa fa-check"></i><b>12.4.3</b> Deviance Residuals</a></li>
<li class="chapter" data-level="12.4.4" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#dispersion-parameter"><i class="fa fa-check"></i><b>12.4.4</b> Dispersion Parameter</a></li>
<li class="chapter" data-level="12.4.5" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#fisher-scoring-iterations"><i class="fa fa-check"></i><b>12.4.5</b> Fisher Scoring iterations</a></li>
</ul></li>
<li class="chapter" data-level="12.5" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#plotting-a-simple-logistic-regression-model"><i class="fa fa-check"></i><b>12.5</b> Plotting a Simple Logistic Regression Model</a>
<ul>
<li class="chapter" data-level="12.5.1" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#using-augment-to-capture-the-fitted-probabilities"><i class="fa fa-check"></i><b>12.5.1</b> Using <code>augment</code> to capture the fitted probabilities</a></li>
<li class="chapter" data-level="12.5.2" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#plotting-a-logistic-regression-models-fitted-values"><i class="fa fa-check"></i><b>12.5.2</b> Plotting a Logistic Regression Model’s Fitted Values</a></li>
<li class="chapter" data-level="12.5.3" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#plotting-a-simple-logistic-model-using-binomial_smooth"><i class="fa fa-check"></i><b>12.5.3</b> Plotting a Simple Logistic Model using <code>binomial_smooth</code></a></li>
</ul></li>
<li class="chapter" data-level="12.6" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#how-well-does-model-a-classify-subjects"><i class="fa fa-check"></i><b>12.6</b> How well does Model A classify subjects?</a></li>
<li class="chapter" data-level="12.7" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#the-confusion-matrix"><i class="fa fa-check"></i><b>12.7</b> The Confusion Matrix</a></li>
<li class="chapter" data-level="12.8" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#using-the-confusionmatrix-tool-from-the-caret-package"><i class="fa fa-check"></i><b>12.8</b> Using the <code>confusionMatrix</code> tool from the <code>caret</code> package</a></li>
<li class="chapter" data-level="12.9" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#receiver-operating-characteristic-curve-analysis"><i class="fa fa-check"></i><b>12.9</b> Receiver Operating Characteristic Curve Analysis</a>
<ul>
<li class="chapter" data-level="12.9.1" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#interpreting-the-area-under-the-roc-curve"><i class="fa fa-check"></i><b>12.9.1</b> Interpreting the Area under the ROC curve</a></li>
</ul></li>
<li class="chapter" data-level="12.10" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#the-roc-plot-for-res_moda"><i class="fa fa-check"></i><b>12.10</b> The ROC Plot for <code>res_modA</code></a>
<ul>
<li class="chapter" data-level="12.10.1" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#another-way-to-plot-the-roc-curve"><i class="fa fa-check"></i><b>12.10.1</b> Another way to plot the ROC Curve</a></li>
</ul></li>
<li class="chapter" data-level="12.11" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#assessing-residual-plots-from-model-a"><i class="fa fa-check"></i><b>12.11</b> Assessing Residual Plots from Model A</a></li>
<li class="chapter" data-level="12.12" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#model-b-a-kitchen-sink-logistic-regression-model"><i class="fa fa-check"></i><b>12.12</b> Model B: A “Kitchen Sink” Logistic Regression Model</a>
<ul>
<li class="chapter" data-level="12.12.1" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#comparing-model-a-to-model-b"><i class="fa fa-check"></i><b>12.12.1</b> Comparing Model A to Model B</a></li>
<li class="chapter" data-level="12.12.2" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#interpreting-model-b"><i class="fa fa-check"></i><b>12.12.2</b> Interpreting Model B</a></li>
</ul></li>
<li class="chapter" data-level="12.13" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#plotting-model-b"><i class="fa fa-check"></i><b>12.13</b> Plotting Model B</a>
<ul>
<li class="chapter" data-level="12.13.1" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#using-augment-to-capture-the-fitted-probabilities-1"><i class="fa fa-check"></i><b>12.13.1</b> Using <code>augment</code> to capture the fitted probabilities</a></li>
<li class="chapter" data-level="12.13.2" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#plotting-model-b-fits-by-observed-mortality"><i class="fa fa-check"></i><b>12.13.2</b> Plotting Model B Fits by Observed Mortality</a></li>
<li class="chapter" data-level="12.13.3" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#confusion-matrix-for-model-b"><i class="fa fa-check"></i><b>12.13.3</b> Confusion Matrix for Model B</a></li>
<li class="chapter" data-level="12.13.4" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#the-roc-curve-for-model-b"><i class="fa fa-check"></i><b>12.13.4</b> The ROC curve for Model B</a></li>
<li class="chapter" data-level="12.13.5" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#residuals-leverage-and-influence"><i class="fa fa-check"></i><b>12.13.5</b> Residuals, Leverage and Influence</a></li>
</ul></li>
<li class="chapter" data-level="12.14" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#logistic-regression-using-lrm"><i class="fa fa-check"></i><b>12.14</b> Logistic Regression using <code>lrm</code></a>
<ul>
<li class="chapter" data-level="12.14.1" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#interpreting-nagelkerke-r2"><i class="fa fa-check"></i><b>12.14.1</b> Interpreting Nagelkerke R<sup>2</sup></a></li>
<li class="chapter" data-level="12.14.2" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#interpreting-the-c-statistic-and-plotting-the-roc-curve"><i class="fa fa-check"></i><b>12.14.2</b> Interpreting the C statistic and Plotting the ROC Curve</a></li>
<li class="chapter" data-level="12.14.3" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#the-c-statistic-and-somers-d"><i class="fa fa-check"></i><b>12.14.3</b> The C statistic and Somers’ D</a></li>
<li class="chapter" data-level="12.14.4" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#validating-the-logistic-regression-model-summary-statistics"><i class="fa fa-check"></i><b>12.14.4</b> Validating the Logistic Regression Model Summary Statistics</a></li>
<li class="chapter" data-level="12.14.5" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#plotting-the-summary-of-the-lrm-approach"><i class="fa fa-check"></i><b>12.14.5</b> Plotting the Summary of the <code>lrm</code> approach</a></li>
<li class="chapter" data-level="12.14.6" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#plot-in-sample-predictions-for-model-c"><i class="fa fa-check"></i><b>12.14.6</b> Plot In-Sample Predictions for Model C</a></li>
<li class="chapter" data-level="12.14.7" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#anova-from-the-lrm-approach"><i class="fa fa-check"></i><b>12.14.7</b> ANOVA from the <code>lrm</code> approach</a></li>
<li class="chapter" data-level="12.14.8" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#are-any-points-particularly-influential"><i class="fa fa-check"></i><b>12.14.8</b> Are any points particularly influential?</a></li>
<li class="chapter" data-level="12.14.9" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#a-nomogram-for-model-c"><i class="fa fa-check"></i><b>12.14.9</b> A Nomogram for Model C</a></li>
</ul></li>
<li class="chapter" data-level="12.15" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#model-d-an-augmented-kitchen-sink-model"><i class="fa fa-check"></i><b>12.15</b> Model D: An Augmented Kitchen Sink Model</a>
<ul>
<li class="chapter" data-level="12.15.1" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#spearman-rho2-plot"><i class="fa fa-check"></i><b>12.15.1</b> Spearman <span class="math inline">\(\rho^2\)</span> Plot</a></li>
<li class="chapter" data-level="12.15.2" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#fitting-model-d-using-lrm"><i class="fa fa-check"></i><b>12.15.2</b> Fitting Model D using <code>lrm</code></a></li>
<li class="chapter" data-level="12.15.3" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#assessing-model-d-using-lrms-tools"><i class="fa fa-check"></i><b>12.15.3</b> Assessing Model D using <code>lrm</code>’s tools</a></li>
<li class="chapter" data-level="12.15.4" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#anova-and-wald-tests-for-model-d"><i class="fa fa-check"></i><b>12.15.4</b> ANOVA and Wald Tests for Model D</a></li>
<li class="chapter" data-level="12.15.5" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#effect-sizes-in-model-d"><i class="fa fa-check"></i><b>12.15.5</b> Effect Sizes in Model D</a></li>
<li class="chapter" data-level="12.15.6" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#plot-in-sample-predictions-for-model-d"><i class="fa fa-check"></i><b>12.15.6</b> Plot In-Sample Predictions for Model D</a></li>
<li class="chapter" data-level="12.15.7" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#plotting-the-roc-curve-for-model-d"><i class="fa fa-check"></i><b>12.15.7</b> Plotting the ROC curve for Model D</a></li>
<li class="chapter" data-level="12.15.8" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#validation-of-model-d-summaries"><i class="fa fa-check"></i><b>12.15.8</b> Validation of Model D summaries</a></li>
</ul></li>
<li class="chapter" data-level="12.16" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#model-e-fitting-a-reduced-model-in-light-of-model-d"><i class="fa fa-check"></i><b>12.16</b> Model E: Fitting a Reduced Model in light of Model D</a>
<ul>
<li class="chapter" data-level="12.16.1" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#a-plot-comparing-the-two-intubation-groups"><i class="fa fa-check"></i><b>12.16.1</b> A Plot comparing the two intubation groups</a></li>
<li class="chapter" data-level="12.16.2" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#nomogram-for-model-e"><i class="fa fa-check"></i><b>12.16.2</b> Nomogram for Model E</a></li>
<li class="chapter" data-level="12.16.3" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#effect-sizes-from-model-e"><i class="fa fa-check"></i><b>12.16.3</b> Effect Sizes from Model E</a></li>
<li class="chapter" data-level="12.16.4" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#plot-in-sample-predictions-for-model-e"><i class="fa fa-check"></i><b>12.16.4</b> Plot In-Sample Predictions for Model E</a></li>
<li class="chapter" data-level="12.16.5" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#anova-for-model-e"><i class="fa fa-check"></i><b>12.16.5</b> ANOVA for Model E</a></li>
<li class="chapter" data-level="12.16.6" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#validation-of-model-e"><i class="fa fa-check"></i><b>12.16.6</b> Validation of Model E</a></li>
<li class="chapter" data-level="12.16.7" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#do-any-points-seem-particularly-influential"><i class="fa fa-check"></i><b>12.16.7</b> Do any points seem particularly influential?</a></li>
<li class="chapter" data-level="12.16.8" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#fitting-model-e-using-glm-to-get-plots-about-influence"><i class="fa fa-check"></i><b>12.16.8</b> Fitting Model E using <code>glm</code> to get plots about influence</a></li>
</ul></li>
<li class="chapter" data-level="12.17" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#concordance-comparing-model-c-d-and-es-predictions"><i class="fa fa-check"></i><b>12.17</b> Concordance: Comparing Model C, D and E’s predictions</a></li>
<li class="chapter" data-level="12.18" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#conclusions"><i class="fa fa-check"></i><b>12.18</b> Conclusions</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="a-study-of-prostate-cancer.html"><a href="a-study-of-prostate-cancer.html"><i class="fa fa-check"></i><b>13</b> A Study of Prostate Cancer</a>
<ul>
<li class="chapter" data-level="13.1" data-path="a-study-of-prostate-cancer.html"><a href="a-study-of-prostate-cancer.html#data-load-and-background"><i class="fa fa-check"></i><b>13.1</b> Data Load and Background</a></li>
<li class="chapter" data-level="13.2" data-path="a-study-of-prostate-cancer.html"><a href="a-study-of-prostate-cancer.html#code-book"><i class="fa fa-check"></i><b>13.2</b> Code Book</a></li>
<li class="chapter" data-level="13.3" data-path="a-study-of-prostate-cancer.html"><a href="a-study-of-prostate-cancer.html#additions-for-later-use"><i class="fa fa-check"></i><b>13.3</b> Additions for Later Use</a></li>
<li class="chapter" data-level="13.4" data-path="a-study-of-prostate-cancer.html"><a href="a-study-of-prostate-cancer.html#fitting-and-evaluating-a-two-predictor-model"><i class="fa fa-check"></i><b>13.4</b> Fitting and Evaluating a Two-Predictor Model</a>
<ul>
<li class="chapter" data-level="13.4.1" data-path="a-study-of-prostate-cancer.html"><a href="a-study-of-prostate-cancer.html#using-tidy"><i class="fa fa-check"></i><b>13.4.1</b> Using <code>tidy</code></a></li>
<li class="chapter" data-level="13.4.2" data-path="a-study-of-prostate-cancer.html"><a href="a-study-of-prostate-cancer.html#interpretation"><i class="fa fa-check"></i><b>13.4.2</b> Interpretation</a></li>
</ul></li>
<li class="chapter" data-level="13.5" data-path="a-study-of-prostate-cancer.html"><a href="a-study-of-prostate-cancer.html#exploring-model-c11_prost_a"><i class="fa fa-check"></i><b>13.5</b> Exploring Model <code>c11_prost_A</code></a>
<ul>
<li class="chapter" data-level="13.5.1" data-path="a-study-of-prostate-cancer.html"><a href="a-study-of-prostate-cancer.html#summary-for-model-c11_prost_a"><i class="fa fa-check"></i><b>13.5.1</b> <code>summary</code> for Model <code>c11_prost_A</code></a></li>
<li class="chapter" data-level="13.5.2" data-path="a-study-of-prostate-cancer.html"><a href="a-study-of-prostate-cancer.html#adjusted-r2"><i class="fa fa-check"></i><b>13.5.2</b> Adjusted R<sup>2</sup></a></li>
<li class="chapter" data-level="13.5.3" data-path="a-study-of-prostate-cancer.html"><a href="a-study-of-prostate-cancer.html#coefficient-confidence-intervals"><i class="fa fa-check"></i><b>13.5.3</b> Coefficient Confidence Intervals</a></li>
<li class="chapter" data-level="13.5.4" data-path="a-study-of-prostate-cancer.html"><a href="a-study-of-prostate-cancer.html#anova-for-model-c11_prost_a"><i class="fa fa-check"></i><b>13.5.4</b> ANOVA for Model <code>c11_prost_A</code></a></li>
<li class="chapter" data-level="13.5.5" data-path="a-study-of-prostate-cancer.html"><a href="a-study-of-prostate-cancer.html#residuals-fitted-values-and-standard-errors-with-augment"><i class="fa fa-check"></i><b>13.5.5</b> Residuals, Fitted Values and Standard Errors with <code>augment</code></a></li>
<li class="chapter" data-level="13.5.6" data-path="a-study-of-prostate-cancer.html"><a href="a-study-of-prostate-cancer.html#making-predictions-with-c11_prost_a"><i class="fa fa-check"></i><b>13.5.6</b> Making Predictions with <code>c11_prost_A</code></a></li>
</ul></li>
<li class="chapter" data-level="13.6" data-path="a-study-of-prostate-cancer.html"><a href="a-study-of-prostate-cancer.html#plotting-model-c11_prost_a"><i class="fa fa-check"></i><b>13.6</b> Plotting Model <code>c11_prost_A</code></a>
<ul>
<li class="chapter" data-level="13.6.1" data-path="a-study-of-prostate-cancer.html"><a href="a-study-of-prostate-cancer.html#residual-plots-of-c11_prost_a"><i class="fa fa-check"></i><b>13.6.1</b> Residual Plots of <code>c11_prost_A</code></a></li>
</ul></li>
<li class="chapter" data-level="13.7" data-path="a-study-of-prostate-cancer.html"><a href="a-study-of-prostate-cancer.html#cross-validation-of-model-c11_prost_a"><i class="fa fa-check"></i><b>13.7</b> Cross-Validation of Model <code>c11_prost_A</code></a>
<ul>
<li class="chapter" data-level="13.7.1" data-path="a-study-of-prostate-cancer.html"><a href="a-study-of-prostate-cancer.html#a-validation-split-approach"><i class="fa fa-check"></i><b>13.7.1</b> A Validation Split Approach</a></li>
<li class="chapter" data-level="13.7.2" data-path="a-study-of-prostate-cancer.html"><a href="a-study-of-prostate-cancer.html#k-fold-cross-validation"><i class="fa fa-check"></i><b>13.7.2</b> K-Fold Cross-Validation</a></li>
<li class="chapter" data-level="13.7.3" data-path="a-study-of-prostate-cancer.html"><a href="a-study-of-prostate-cancer.html#comparing-models-with-5-fold-cross-validation"><i class="fa fa-check"></i><b>13.7.3</b> Comparing Models with 5-fold Cross-Validation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="14" data-path="multiple-imputation-and-linear-regression.html"><a href="multiple-imputation-and-linear-regression.html"><i class="fa fa-check"></i><b>14</b> Multiple Imputation and Linear Regression</a>
<ul>
<li class="chapter" data-level="14.1" data-path="multiple-imputation-and-linear-regression.html"><a href="multiple-imputation-and-linear-regression.html#developing-a-smart_16-data-set"><i class="fa fa-check"></i><b>14.1</b> Developing a <code>smart_16</code> data set</a>
<ul>
<li class="chapter" data-level="14.1.1" data-path="multiple-imputation-and-linear-regression.html"><a href="multiple-imputation-and-linear-regression.html#any-missing-values"><i class="fa fa-check"></i><b>14.1.1</b> Any missing values?</a></li>
</ul></li>
<li class="chapter" data-level="14.2" data-path="multiple-imputation-and-linear-regression.html"><a href="multiple-imputation-and-linear-regression.html#obtaining-a-simple-imputation-with-mice"><i class="fa fa-check"></i><b>14.2</b> Obtaining a Simple Imputation with <code>mice</code></a></li>
<li class="chapter" data-level="14.3" data-path="multiple-imputation-and-linear-regression.html"><a href="multiple-imputation-and-linear-regression.html#linear-regression-considering-a-transformation-of-the-outcome"><i class="fa fa-check"></i><b>14.3</b> Linear Regression: Considering a Transformation of the Outcome</a></li>
<li class="chapter" data-level="14.4" data-path="multiple-imputation-and-linear-regression.html"><a href="multiple-imputation-and-linear-regression.html#linear-regression-considering-non-linearity-in-the-predictors"><i class="fa fa-check"></i><b>14.4</b> Linear Regression: Considering Non-Linearity in the Predictors</a></li>
<li class="chapter" data-level="14.5" data-path="multiple-imputation-and-linear-regression.html"><a href="multiple-imputation-and-linear-regression.html#main-effects-linear-regression-with-lm-on-the-complete-cases"><i class="fa fa-check"></i><b>14.5</b> “Main Effects” Linear Regression with <code>lm</code> on the Complete Cases</a>
<ul>
<li class="chapter" data-level="14.5.1" data-path="multiple-imputation-and-linear-regression.html"><a href="multiple-imputation-and-linear-regression.html#quality-of-fit-statistics"><i class="fa fa-check"></i><b>14.5.1</b> Quality of Fit Statistics</a></li>
<li class="chapter" data-level="14.5.2" data-path="multiple-imputation-and-linear-regression.html"><a href="multiple-imputation-and-linear-regression.html#interpreting-effect-sizes"><i class="fa fa-check"></i><b>14.5.2</b> Interpreting Effect Sizes</a></li>
<li class="chapter" data-level="14.5.3" data-path="multiple-imputation-and-linear-regression.html"><a href="multiple-imputation-and-linear-regression.html#making-predictions-with-the-model"><i class="fa fa-check"></i><b>14.5.3</b> Making Predictions with the Model</a></li>
</ul></li>
<li class="chapter" data-level="14.6" data-path="multiple-imputation-and-linear-regression.html"><a href="multiple-imputation-and-linear-regression.html#augmented-linear-regression-with-lm-on-the-complete-cases"><i class="fa fa-check"></i><b>14.6</b> “Augmented” Linear Regression with <code>lm</code> on the Complete Cases</a>
<ul>
<li class="chapter" data-level="14.6.1" data-path="multiple-imputation-and-linear-regression.html"><a href="multiple-imputation-and-linear-regression.html#quality-of-fit-statistics-1"><i class="fa fa-check"></i><b>14.6.1</b> Quality of Fit Statistics</a></li>
<li class="chapter" data-level="14.6.2" data-path="multiple-imputation-and-linear-regression.html"><a href="multiple-imputation-and-linear-regression.html#anova-assessing-the-impact-of-the-non-linear-terms"><i class="fa fa-check"></i><b>14.6.2</b> ANOVA assessing the impact of the non-linear terms</a></li>
<li class="chapter" data-level="14.6.3" data-path="multiple-imputation-and-linear-regression.html"><a href="multiple-imputation-and-linear-regression.html#interpreting-effect-sizes-1"><i class="fa fa-check"></i><b>14.6.3</b> Interpreting Effect Sizes</a></li>
<li class="chapter" data-level="14.6.4" data-path="multiple-imputation-and-linear-regression.html"><a href="multiple-imputation-and-linear-regression.html#making-predictions-with-the-model-1"><i class="fa fa-check"></i><b>14.6.4</b> Making Predictions with the Model</a></li>
</ul></li>
<li class="chapter" data-level="14.7" data-path="multiple-imputation-and-linear-regression.html"><a href="multiple-imputation-and-linear-regression.html#using-mice-to-perform-multiple-imputation"><i class="fa fa-check"></i><b>14.7</b> Using <code>mice</code> to perform Multiple Imputation</a></li>
<li class="chapter" data-level="14.8" data-path="multiple-imputation-and-linear-regression.html"><a href="multiple-imputation-and-linear-regression.html#running-the-linear-regression-in-lm-with-multiple-imputation"><i class="fa fa-check"></i><b>14.8</b> Running the Linear Regression in <code>lm</code> with Multiple Imputation</a></li>
<li class="chapter" data-level="14.9" data-path="multiple-imputation-and-linear-regression.html"><a href="multiple-imputation-and-linear-regression.html#fit-the-multiple-imputation-model-with-aregimpute"><i class="fa fa-check"></i><b>14.9</b> Fit the Multiple Imputation Model with <code>aregImpute</code></a></li>
<li class="chapter" data-level="14.10" data-path="multiple-imputation-and-linear-regression.html"><a href="multiple-imputation-and-linear-regression.html#fit-linear-regression-using-ols-and-fit.mult.impute"><i class="fa fa-check"></i><b>14.10</b> Fit Linear Regression using <code>ols</code> and <code>fit.mult.impute</code></a>
<ul>
<li class="chapter" data-level="14.10.1" data-path="multiple-imputation-and-linear-regression.html"><a href="multiple-imputation-and-linear-regression.html#summaries-and-coefficients"><i class="fa fa-check"></i><b>14.10.1</b> Summaries and Coefficients</a></li>
<li class="chapter" data-level="14.10.2" data-path="multiple-imputation-and-linear-regression.html"><a href="multiple-imputation-and-linear-regression.html#effect-sizes"><i class="fa fa-check"></i><b>14.10.2</b> Effect Sizes</a></li>
<li class="chapter" data-level="14.10.3" data-path="multiple-imputation-and-linear-regression.html"><a href="multiple-imputation-and-linear-regression.html#making-predictions-with-this-model"><i class="fa fa-check"></i><b>14.10.3</b> Making Predictions with this Model</a></li>
<li class="chapter" data-level="14.10.4" data-path="multiple-imputation-and-linear-regression.html"><a href="multiple-imputation-and-linear-regression.html#nomogram"><i class="fa fa-check"></i><b>14.10.4</b> Nomogram</a></li>
<li class="chapter" data-level="14.10.5" data-path="multiple-imputation-and-linear-regression.html"><a href="multiple-imputation-and-linear-regression.html#validating-summary-statistics"><i class="fa fa-check"></i><b>14.10.5</b> Validating Summary Statistics</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="15" data-path="using-tidymodels-to-fit-linear-regressions.html"><a href="using-tidymodels-to-fit-linear-regressions.html"><i class="fa fa-check"></i><b>15</b> Using tidymodels to fit linear regressions</a></li>
<li class="chapter" data-level="16" data-path="using-tidymodels-to-fit-logistic-regressions.html"><a href="using-tidymodels-to-fit-logistic-regressions.html"><i class="fa fa-check"></i><b>16</b> Using tidymodels to fit logistic regressions</a></li>
<li class="chapter" data-level="17" data-path="using-tidymodels-approaches-next-steps.html"><a href="using-tidymodels-approaches-next-steps.html"><i class="fa fa-check"></i><b>17</b> Using tidymodels approaches: Next Steps</a></li>
<li class="chapter" data-level="18" data-path="colorectal-cancer-screening-and-some-special-cases.html"><a href="colorectal-cancer-screening-and-some-special-cases.html"><i class="fa fa-check"></i><b>18</b> Colorectal Cancer Screening and Some Special Cases</a>
<ul>
<li class="chapter" data-level="18.1" data-path="colorectal-cancer-screening-and-some-special-cases.html"><a href="colorectal-cancer-screening-and-some-special-cases.html#logistic-regression-for-aggregated-data"><i class="fa fa-check"></i><b>18.1</b> Logistic Regression for Aggregated Data</a>
<ul>
<li class="chapter" data-level="18.1.1" data-path="colorectal-cancer-screening-and-some-special-cases.html"><a href="colorectal-cancer-screening-and-some-special-cases.html#colorectal-cancer-screening-data"><i class="fa fa-check"></i><b>18.1.1</b> Colorectal Cancer Screening Data</a></li>
<li class="chapter" data-level="18.1.2" data-path="colorectal-cancer-screening-and-some-special-cases.html"><a href="colorectal-cancer-screening-and-some-special-cases.html#fitting-a-logistic-regression-model-to-proportion-data"><i class="fa fa-check"></i><b>18.1.2</b> Fitting a Logistic Regression Model to Proportion Data</a></li>
<li class="chapter" data-level="18.1.3" data-path="colorectal-cancer-screening-and-some-special-cases.html"><a href="colorectal-cancer-screening-and-some-special-cases.html#fitting-a-logistic-regression-model-to-counts-of-successes-and-failures"><i class="fa fa-check"></i><b>18.1.3</b> Fitting a Logistic Regression Model to Counts of Successes and Failures</a></li>
<li class="chapter" data-level="18.1.4" data-path="colorectal-cancer-screening-and-some-special-cases.html"><a href="colorectal-cancer-screening-and-some-special-cases.html#how-does-one-address-this-problem-in-rms"><i class="fa fa-check"></i><b>18.1.4</b> How does one address this problem in <code>rms</code>?</a></li>
</ul></li>
<li class="chapter" data-level="18.2" data-path="colorectal-cancer-screening-and-some-special-cases.html"><a href="colorectal-cancer-screening-and-some-special-cases.html#probit-regression"><i class="fa fa-check"></i><b>18.2</b> Probit Regression</a>
<ul>
<li class="chapter" data-level="18.2.1" data-path="colorectal-cancer-screening-and-some-special-cases.html"><a href="colorectal-cancer-screening-and-some-special-cases.html#colorectal-cancer-screening-data-on-individuals"><i class="fa fa-check"></i><b>18.2.1</b> Colorectal Cancer Screening Data on Individuals</a></li>
<li class="chapter" data-level="18.2.2" data-path="colorectal-cancer-screening-and-some-special-cases.html"><a href="colorectal-cancer-screening-and-some-special-cases.html#a-logistic-regression-model"><i class="fa fa-check"></i><b>18.2.2</b> A logistic regression model</a></li>
<li class="chapter" data-level="18.2.3" data-path="colorectal-cancer-screening-and-some-special-cases.html"><a href="colorectal-cancer-screening-and-some-special-cases.html#predicting-status-for-harry-and-sally"><i class="fa fa-check"></i><b>18.2.3</b> Predicting status for Harry and Sally</a></li>
<li class="chapter" data-level="18.2.4" data-path="colorectal-cancer-screening-and-some-special-cases.html"><a href="colorectal-cancer-screening-and-some-special-cases.html#a-probit-regression-model"><i class="fa fa-check"></i><b>18.2.4</b> A probit regression model</a></li>
<li class="chapter" data-level="18.2.5" data-path="colorectal-cancer-screening-and-some-special-cases.html"><a href="colorectal-cancer-screening-and-some-special-cases.html#interpreting-the-probit-models-coefficients"><i class="fa fa-check"></i><b>18.2.5</b> Interpreting the Probit Model’s Coefficients</a></li>
<li class="chapter" data-level="18.2.6" data-path="colorectal-cancer-screening-and-some-special-cases.html"><a href="colorectal-cancer-screening-and-some-special-cases.html#what-about-harry-and-sally"><i class="fa fa-check"></i><b>18.2.6</b> What about Harry and Sally?</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="19" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html"><i class="fa fa-check"></i><b>19</b> Modeling a Count Outcome in Ohio SMART</a>
<ul>
<li class="chapter" data-level="19.1" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#preliminaries"><i class="fa fa-check"></i><b>19.1</b> Preliminaries</a></li>
<li class="chapter" data-level="19.2" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#a-subset-of-the-ohio-smart-data"><i class="fa fa-check"></i><b>19.2</b> A subset of the Ohio SMART data</a>
<ul>
<li class="chapter" data-level="19.2.1" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#is-age-group-associated-with-physhealth"><i class="fa fa-check"></i><b>19.2.1</b> Is age group associated with <code>physhealth</code>?</a></li>
</ul></li>
<li class="chapter" data-level="19.3" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#exploratory-data-analysis-in-the-18-49-group"><i class="fa fa-check"></i><b>19.3</b> Exploratory Data Analysis (in the 18-49 group)</a>
<ul>
<li class="chapter" data-level="19.3.1" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#build-a-subset-of-those-ages-18-49"><i class="fa fa-check"></i><b>19.3.1</b> Build a subset of those ages 18-49</a></li>
<li class="chapter" data-level="19.3.2" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#centering-bmi"><i class="fa fa-check"></i><b>19.3.2</b> Centering <code>bmi</code></a></li>
<li class="chapter" data-level="19.3.3" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#distribution-of-the-outcome"><i class="fa fa-check"></i><b>19.3.3</b> Distribution of the Outcome</a></li>
<li class="chapter" data-level="19.3.4" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#scatterplot-matrix"><i class="fa fa-check"></i><b>19.3.4</b> Scatterplot Matrix</a></li>
<li class="chapter" data-level="19.3.5" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#summary-of-the-final-subset-of-data"><i class="fa fa-check"></i><b>19.3.5</b> Summary of the final subset of data</a></li>
</ul></li>
<li class="chapter" data-level="19.4" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#modeling-strategies-explored-here"><i class="fa fa-check"></i><b>19.4</b> Modeling Strategies Explored Here</a>
<ul>
<li class="chapter" data-level="19.4.1" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#what-will-we-demonstrate"><i class="fa fa-check"></i><b>19.4.1</b> What Will We Demonstrate?</a></li>
<li class="chapter" data-level="19.4.2" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#extra-data-file-for-harry-and-sally"><i class="fa fa-check"></i><b>19.4.2</b> Extra Data File for Harry and Sally</a></li>
</ul></li>
<li class="chapter" data-level="19.5" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#the-ols-approach"><i class="fa fa-check"></i><b>19.5</b> The OLS Approach</a>
<ul>
<li class="chapter" data-level="19.5.1" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#interpreting-the-coefficients"><i class="fa fa-check"></i><b>19.5.1</b> Interpreting the Coefficients</a></li>
<li class="chapter" data-level="19.5.2" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#store-fitted-values-and-residuals"><i class="fa fa-check"></i><b>19.5.2</b> Store fitted values and residuals</a></li>
<li class="chapter" data-level="19.5.3" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#specify-the-r2-and-loglikelihood-values"><i class="fa fa-check"></i><b>19.5.3</b> Specify the R<sup>2</sup> and log(likelihood) values</a></li>
<li class="chapter" data-level="19.5.4" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#check-model-assumptions"><i class="fa fa-check"></i><b>19.5.4</b> Check model assumptions</a></li>
<li class="chapter" data-level="19.5.5" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#predictions-for-harry-and-sally"><i class="fa fa-check"></i><b>19.5.5</b> Predictions for Harry and Sally</a></li>
<li class="chapter" data-level="19.5.6" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#notes"><i class="fa fa-check"></i><b>19.5.6</b> Notes</a></li>
</ul></li>
<li class="chapter" data-level="19.6" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#ols-model-on-logphyshealth-1-days"><i class="fa fa-check"></i><b>19.6</b> OLS model on log(<code>physhealth</code> + 1) days</a>
<ul>
<li class="chapter" data-level="19.6.1" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#interpreting-the-coefficients-1"><i class="fa fa-check"></i><b>19.6.1</b> Interpreting the Coefficients</a></li>
<li class="chapter" data-level="19.6.2" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#store-fitted-values-and-residuals-1"><i class="fa fa-check"></i><b>19.6.2</b> Store fitted values and residuals</a></li>
<li class="chapter" data-level="19.6.3" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#specify-the-r2-and-loglikelihood-values-1"><i class="fa fa-check"></i><b>19.6.3</b> Specify the R<sup>2</sup> and log(likelihood) values</a></li>
<li class="chapter" data-level="19.6.4" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#getting-r2-on-the-scale-of-physhealth"><i class="fa fa-check"></i><b>19.6.4</b> Getting R<sup>2</sup> on the scale of <code>physhealth</code></a></li>
<li class="chapter" data-level="19.6.5" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#check-model-assumptions-1"><i class="fa fa-check"></i><b>19.6.5</b> Check model assumptions</a></li>
<li class="chapter" data-level="19.6.6" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#predictions-for-harry-and-sally-1"><i class="fa fa-check"></i><b>19.6.6</b> Predictions for Harry and Sally</a></li>
</ul></li>
<li class="chapter" data-level="19.7" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#a-poisson-regression-model"><i class="fa fa-check"></i><b>19.7</b> A Poisson Regression Model</a>
<ul>
<li class="chapter" data-level="19.7.1" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#the-fitted-equation"><i class="fa fa-check"></i><b>19.7.1</b> The Fitted Equation</a></li>
<li class="chapter" data-level="19.7.2" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#interpreting-the-coefficients-2"><i class="fa fa-check"></i><b>19.7.2</b> Interpreting the Coefficients</a></li>
<li class="chapter" data-level="19.7.3" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#testing-the-predictors"><i class="fa fa-check"></i><b>19.7.3</b> Testing the Predictors</a></li>
<li class="chapter" data-level="19.7.4" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#correcting-for-overdispersion-with-coeftestcoefci"><i class="fa fa-check"></i><b>19.7.4</b> Correcting for Overdispersion with <code>coeftest</code>/<code>coefci</code></a></li>
<li class="chapter" data-level="19.7.5" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#store-fitted-values-and-residuals-2"><i class="fa fa-check"></i><b>19.7.5</b> Store fitted values and residuals</a></li>
<li class="chapter" data-level="19.7.6" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#rootogram-see-the-fit-of-a-count-regression-model"><i class="fa fa-check"></i><b>19.7.6</b> Rootogram: see the fit of a count regression model</a></li>
<li class="chapter" data-level="19.7.7" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#specify-the-r2-and-loglikelihood-values-2"><i class="fa fa-check"></i><b>19.7.7</b> Specify the R<sup>2</sup> and log(likelihood) values</a></li>
<li class="chapter" data-level="19.7.8" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#check-model-assumptions-2"><i class="fa fa-check"></i><b>19.7.8</b> Check model assumptions</a></li>
<li class="chapter" data-level="19.7.9" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#using-glm.diag.plots-from-the-boot-package"><i class="fa fa-check"></i><b>19.7.9</b> Using <code>glm.diag.plots</code> from the <code>boot</code> package</a></li>
<li class="chapter" data-level="19.7.10" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#predictions-for-harry-and-sally-2"><i class="fa fa-check"></i><b>19.7.10</b> Predictions for Harry and Sally</a></li>
</ul></li>
<li class="chapter" data-level="19.8" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#overdispersion-in-a-poisson-model"><i class="fa fa-check"></i><b>19.8</b> Overdispersion in a Poisson Model</a>
<ul>
<li class="chapter" data-level="19.8.1" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#testing-for-overdispersion"><i class="fa fa-check"></i><b>19.8.1</b> Testing for Overdispersion?</a></li>
</ul></li>
<li class="chapter" data-level="19.9" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#fitting-the-quasi-poisson-model"><i class="fa fa-check"></i><b>19.9</b> Fitting the Quasi-Poisson Model</a>
<ul>
<li class="chapter" data-level="19.9.1" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#the-fitted-equation-1"><i class="fa fa-check"></i><b>19.9.1</b> The Fitted Equation</a></li>
<li class="chapter" data-level="19.9.2" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#interpreting-the-coefficients-3"><i class="fa fa-check"></i><b>19.9.2</b> Interpreting the Coefficients</a></li>
<li class="chapter" data-level="19.9.3" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#testing-the-predictors-1"><i class="fa fa-check"></i><b>19.9.3</b> Testing the Predictors</a></li>
<li class="chapter" data-level="19.9.4" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#store-fitted-values-and-residuals-3"><i class="fa fa-check"></i><b>19.9.4</b> Store fitted values and residuals</a></li>
<li class="chapter" data-level="19.9.5" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#specify-the-r2-and-loglikelihood-values-3"><i class="fa fa-check"></i><b>19.9.5</b> Specify the R<sup>2</sup> and log(likelihood) values</a></li>
<li class="chapter" data-level="19.9.6" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#check-model-assumptions-3"><i class="fa fa-check"></i><b>19.9.6</b> Check model assumptions</a></li>
<li class="chapter" data-level="19.9.7" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#predictions-for-harry-and-sally-3"><i class="fa fa-check"></i><b>19.9.7</b> Predictions for Harry and Sally</a></li>
</ul></li>
<li class="chapter" data-level="19.10" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#poisson-and-quasi-poisson-models-using-glm-from-the-rms-package"><i class="fa fa-check"></i><b>19.10</b> Poisson and Quasi-Poisson models using <code>Glm</code> from the <code>rms</code> package</a>
<ul>
<li class="chapter" data-level="19.10.1" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#refitting-the-original-poisson-regression-with-glm"><i class="fa fa-check"></i><b>19.10.1</b> Refitting the original Poisson regression with <code>Glm</code></a></li>
<li class="chapter" data-level="19.10.2" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#refitting-the-overdispersed-poisson-regression-with-glm"><i class="fa fa-check"></i><b>19.10.2</b> Refitting the overdispersed Poisson regression with <code>Glm</code></a></li>
<li class="chapter" data-level="19.10.3" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#anova-on-a-glm-fit"><i class="fa fa-check"></i><b>19.10.3</b> ANOVA on a <code>Glm</code> fit</a></li>
<li class="chapter" data-level="19.10.4" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#ggplots-from-glm-fit"><i class="fa fa-check"></i><b>19.10.4</b> ggplots from <code>Glm</code> fit</a></li>
<li class="chapter" data-level="19.10.5" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#summary-of-a-glm-fit"><i class="fa fa-check"></i><b>19.10.5</b> Summary of a <code>Glm</code> fit</a></li>
<li class="chapter" data-level="19.10.6" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#plot-of-the-summary"><i class="fa fa-check"></i><b>19.10.6</b> Plot of the Summary</a></li>
<li class="chapter" data-level="19.10.7" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#nomogram-of-a-glm-fit"><i class="fa fa-check"></i><b>19.10.7</b> Nomogram of a <code>Glm</code> fit</a></li>
</ul></li>
<li class="chapter" data-level="19.11" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#negative-binomial-model"><i class="fa fa-check"></i><b>19.11</b> Negative Binomial Model</a>
<ul>
<li class="chapter" data-level="19.11.1" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#the-fitted-equation-2"><i class="fa fa-check"></i><b>19.11.1</b> The Fitted Equation</a></li>
<li class="chapter" data-level="19.11.2" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#comparison-with-the-raw-poisson-model"><i class="fa fa-check"></i><b>19.11.2</b> Comparison with the (raw) Poisson model</a></li>
<li class="chapter" data-level="19.11.3" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#interpreting-the-coefficients-4"><i class="fa fa-check"></i><b>19.11.3</b> Interpreting the Coefficients</a></li>
<li class="chapter" data-level="19.11.4" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#interpretation-of-coefficients-in-terms-of-irrs"><i class="fa fa-check"></i><b>19.11.4</b> Interpretation of Coefficients in terms of IRRs</a></li>
<li class="chapter" data-level="19.11.5" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#testing-the-predictors-2"><i class="fa fa-check"></i><b>19.11.5</b> Testing the Predictors</a></li>
<li class="chapter" data-level="19.11.6" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#store-fitted-values-and-residuals-4"><i class="fa fa-check"></i><b>19.11.6</b> Store fitted values and residuals</a></li>
<li class="chapter" data-level="19.11.7" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#rootogram-for-negative-binomial-model"><i class="fa fa-check"></i><b>19.11.7</b> Rootogram for Negative Binomial model</a></li>
<li class="chapter" data-level="19.11.8" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#simulating-what-the-negative-binomial-model-predicts"><i class="fa fa-check"></i><b>19.11.8</b> Simulating what the Negative Binomial model predicts</a></li>
<li class="chapter" data-level="19.11.9" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#specify-the-r2-and-loglikelihood-values-4"><i class="fa fa-check"></i><b>19.11.9</b> Specify the R<sup>2</sup> and log(likelihood) values</a></li>
<li class="chapter" data-level="19.11.10" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#check-model-assumptions-4"><i class="fa fa-check"></i><b>19.11.10</b> Check model assumptions</a></li>
<li class="chapter" data-level="19.11.11" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#predictions-for-harry-and-sally-4"><i class="fa fa-check"></i><b>19.11.11</b> Predictions for Harry and Sally</a></li>
</ul></li>
<li class="chapter" data-level="19.12" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#the-problem-too-few-zeros"><i class="fa fa-check"></i><b>19.12</b> The Problem: Too Few Zeros</a></li>
<li class="chapter" data-level="19.13" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#the-zero-inflated-poisson-regression-model"><i class="fa fa-check"></i><b>19.13</b> The Zero-Inflated Poisson Regression Model</a>
<ul>
<li class="chapter" data-level="19.13.1" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#comparison-to-a-null-model"><i class="fa fa-check"></i><b>19.13.1</b> Comparison to a null model</a></li>
<li class="chapter" data-level="19.13.2" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#comparison-to-a-poisson-model-with-the-vuong-test"><i class="fa fa-check"></i><b>19.13.2</b> Comparison to a Poisson Model with the Vuong test</a></li>
<li class="chapter" data-level="19.13.3" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#the-fitted-equation-3"><i class="fa fa-check"></i><b>19.13.3</b> The Fitted Equation</a></li>
<li class="chapter" data-level="19.13.4" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#interpreting-the-coefficients-5"><i class="fa fa-check"></i><b>19.13.4</b> Interpreting the Coefficients</a></li>
<li class="chapter" data-level="19.13.5" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#testing-the-predictors-3"><i class="fa fa-check"></i><b>19.13.5</b> Testing the Predictors</a></li>
<li class="chapter" data-level="19.13.6" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#store-fitted-values-and-residuals-5"><i class="fa fa-check"></i><b>19.13.6</b> Store fitted values and residuals</a></li>
<li class="chapter" data-level="19.13.7" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#modeled-number-of-zero-counts"><i class="fa fa-check"></i><b>19.13.7</b> Modeled Number of Zero Counts</a></li>
<li class="chapter" data-level="19.13.8" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#rootogram-for-zip-model"><i class="fa fa-check"></i><b>19.13.8</b> Rootogram for ZIP model</a></li>
<li class="chapter" data-level="19.13.9" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#specify-the-r2-and-log-likelihood-values"><i class="fa fa-check"></i><b>19.13.9</b> Specify the R<sup>2</sup> and log (likelihood) values</a></li>
<li class="chapter" data-level="19.13.10" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#check-model-assumptions-5"><i class="fa fa-check"></i><b>19.13.10</b> Check model assumptions</a></li>
<li class="chapter" data-level="19.13.11" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#predictions-for-harry-and-sally-5"><i class="fa fa-check"></i><b>19.13.11</b> Predictions for Harry and Sally</a></li>
</ul></li>
<li class="chapter" data-level="19.14" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#the-zero-inflated-negative-binomial-regression-model"><i class="fa fa-check"></i><b>19.14</b> The Zero-Inflated Negative Binomial Regression Model</a>
<ul>
<li class="chapter" data-level="19.14.1" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#comparison-to-a-null-model-1"><i class="fa fa-check"></i><b>19.14.1</b> Comparison to a null model</a></li>
<li class="chapter" data-level="19.14.2" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#comparison-to-a-negative-binomial-model-vuong-test"><i class="fa fa-check"></i><b>19.14.2</b> Comparison to a Negative Binomial Model: Vuong test</a></li>
<li class="chapter" data-level="19.14.3" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#the-fitted-equation-4"><i class="fa fa-check"></i><b>19.14.3</b> The Fitted Equation</a></li>
<li class="chapter" data-level="19.14.4" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#interpreting-the-coefficients-6"><i class="fa fa-check"></i><b>19.14.4</b> Interpreting the Coefficients</a></li>
<li class="chapter" data-level="19.14.5" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#testing-the-predictors-4"><i class="fa fa-check"></i><b>19.14.5</b> Testing the Predictors</a></li>
<li class="chapter" data-level="19.14.6" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#store-fitted-values-and-residuals-6"><i class="fa fa-check"></i><b>19.14.6</b> Store fitted values and residuals</a></li>
<li class="chapter" data-level="19.14.7" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#modeled-number-of-zero-counts-1"><i class="fa fa-check"></i><b>19.14.7</b> Modeled Number of Zero Counts</a></li>
<li class="chapter" data-level="19.14.8" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#rootogram-for-zero-inflated-negative-binomial-model"><i class="fa fa-check"></i><b>19.14.8</b> Rootogram for Zero-Inflated Negative Binomial model</a></li>
<li class="chapter" data-level="19.14.9" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#specify-the-r2-and-log-likelihood-values-1"><i class="fa fa-check"></i><b>19.14.9</b> Specify the R<sup>2</sup> and log (likelihood) values</a></li>
<li class="chapter" data-level="19.14.10" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#check-model-assumptions-6"><i class="fa fa-check"></i><b>19.14.10</b> Check model assumptions</a></li>
<li class="chapter" data-level="19.14.11" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#predictions-for-harry-and-sally-6"><i class="fa fa-check"></i><b>19.14.11</b> Predictions for Harry and Sally</a></li>
</ul></li>
<li class="chapter" data-level="19.15" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#a-hurdle-model-with-poisson"><i class="fa fa-check"></i><b>19.15</b> A “hurdle” model (with Poisson)</a>
<ul>
<li class="chapter" data-level="19.15.1" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#comparison-to-a-null-model-2"><i class="fa fa-check"></i><b>19.15.1</b> Comparison to a null model</a></li>
<li class="chapter" data-level="19.15.2" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#comparison-to-a-poisson-model-vuong-test"><i class="fa fa-check"></i><b>19.15.2</b> Comparison to a Poisson Model: Vuong test</a></li>
<li class="chapter" data-level="19.15.3" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#comparison-to-a-zero-inflated-poisson-model-vuong-test"><i class="fa fa-check"></i><b>19.15.3</b> Comparison to a Zero-Inflated Poisson Model: Vuong test</a></li>
<li class="chapter" data-level="19.15.4" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#the-fitted-equation-5"><i class="fa fa-check"></i><b>19.15.4</b> The Fitted Equation</a></li>
<li class="chapter" data-level="19.15.5" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#interpreting-the-coefficients-7"><i class="fa fa-check"></i><b>19.15.5</b> Interpreting the Coefficients</a></li>
<li class="chapter" data-level="19.15.6" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#testing-the-predictors-5"><i class="fa fa-check"></i><b>19.15.6</b> Testing the Predictors</a></li>
<li class="chapter" data-level="19.15.7" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#store-fitted-values-and-residuals-7"><i class="fa fa-check"></i><b>19.15.7</b> Store fitted values and residuals</a></li>
<li class="chapter" data-level="19.15.8" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#modeled-number-of-zero-counts-2"><i class="fa fa-check"></i><b>19.15.8</b> Modeled Number of Zero Counts</a></li>
<li class="chapter" data-level="19.15.9" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#rootogram-for-hurdle-model"><i class="fa fa-check"></i><b>19.15.9</b> Rootogram for Hurdle Model</a></li>
<li class="chapter" data-level="19.15.10" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#understanding-the-modeled-counts-in-detail"><i class="fa fa-check"></i><b>19.15.10</b> Understanding the Modeled Counts in Detail</a></li>
<li class="chapter" data-level="19.15.11" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#specify-the-r2-and-log-likelihood-values-2"><i class="fa fa-check"></i><b>19.15.11</b> Specify the R<sup>2</sup> and log (likelihood) values</a></li>
<li class="chapter" data-level="19.15.12" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#check-model-assumptions-7"><i class="fa fa-check"></i><b>19.15.12</b> Check model assumptions</a></li>
<li class="chapter" data-level="19.15.13" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#predictions-for-harry-and-sally-7"><i class="fa fa-check"></i><b>19.15.13</b> Predictions for Harry and Sally</a></li>
</ul></li>
<li class="chapter" data-level="19.16" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#a-hurdle-model-with-negative-binomial-for-overdispersion"><i class="fa fa-check"></i><b>19.16</b> A “hurdle” model (with negative binomial for overdispersion)</a>
<ul>
<li class="chapter" data-level="19.16.1" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#comparison-to-a-null-model-3"><i class="fa fa-check"></i><b>19.16.1</b> Comparison to a null model</a></li>
<li class="chapter" data-level="19.16.2" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#comparison-to-a-negative-binomial-model-vuong-test-1"><i class="fa fa-check"></i><b>19.16.2</b> Comparison to a Negative Binomial Model: Vuong test</a></li>
<li class="chapter" data-level="19.16.3" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#comparison-to-a-zero-inflated-nb-model-vuong-test"><i class="fa fa-check"></i><b>19.16.3</b> Comparison to a Zero-Inflated NB Model: Vuong test</a></li>
<li class="chapter" data-level="19.16.4" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#comparing-the-hurdle-models-with-aic-and-bic"><i class="fa fa-check"></i><b>19.16.4</b> Comparing the Hurdle Models with AIC and BIC</a></li>
<li class="chapter" data-level="19.16.5" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#the-fitted-equation-6"><i class="fa fa-check"></i><b>19.16.5</b> The Fitted Equation</a></li>
<li class="chapter" data-level="19.16.6" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#interpreting-the-coefficients-8"><i class="fa fa-check"></i><b>19.16.6</b> Interpreting the Coefficients</a></li>
<li class="chapter" data-level="19.16.7" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#testing-the-predictors-6"><i class="fa fa-check"></i><b>19.16.7</b> Testing the Predictors</a></li>
<li class="chapter" data-level="19.16.8" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#store-fitted-values-and-residuals-8"><i class="fa fa-check"></i><b>19.16.8</b> Store fitted values and residuals</a></li>
<li class="chapter" data-level="19.16.9" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#rootogram-for-nb-hurdle-model"><i class="fa fa-check"></i><b>19.16.9</b> Rootogram for NB Hurdle Model</a></li>
<li class="chapter" data-level="19.16.10" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#specify-the-r2-and-log-likelihood-values-3"><i class="fa fa-check"></i><b>19.16.10</b> Specify the R<sup>2</sup> and log (likelihood) values</a></li>
<li class="chapter" data-level="19.16.11" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#check-model-assumptions-8"><i class="fa fa-check"></i><b>19.16.11</b> Check model assumptions</a></li>
<li class="chapter" data-level="19.16.12" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#predictions-for-harry-and-sally-8"><i class="fa fa-check"></i><b>19.16.12</b> Predictions for Harry and Sally</a></li>
<li class="chapter" data-level="19.16.13" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#note-fitting-a-different-hurdle-model-for-counts-and-przero"><i class="fa fa-check"></i><b>19.16.13</b> Note: Fitting a Different Hurdle Model for Counts and Pr(zero)</a></li>
<li class="chapter" data-level="19.16.14" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#hanging-rootogram-for-this-new-hurdle-model"><i class="fa fa-check"></i><b>19.16.14</b> Hanging Rootogram for this new Hurdle Model</a></li>
</ul></li>
<li class="chapter" data-level="19.17" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#a-tobit-censored-regression-model"><i class="fa fa-check"></i><b>19.17</b> A Tobit (Censored) Regression Model</a>
<ul>
<li class="chapter" data-level="19.17.1" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#the-fitted-equation-7"><i class="fa fa-check"></i><b>19.17.1</b> The Fitted Equation</a></li>
<li class="chapter" data-level="19.17.2" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#interpreting-the-coefficients-9"><i class="fa fa-check"></i><b>19.17.2</b> Interpreting the Coefficients</a></li>
<li class="chapter" data-level="19.17.3" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#testing-the-predictors-7"><i class="fa fa-check"></i><b>19.17.3</b> Testing the Predictors</a></li>
<li class="chapter" data-level="19.17.4" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#store-fitted-values-and-residuals-9"><i class="fa fa-check"></i><b>19.17.4</b> Store fitted values and residuals</a></li>
<li class="chapter" data-level="19.17.5" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#building-something-like-a-rootogram"><i class="fa fa-check"></i><b>19.17.5</b> Building Something Like a Rootogram</a></li>
<li class="chapter" data-level="19.17.6" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#tables-of-the-observed-and-fitted-physhealth-from-tobit"><i class="fa fa-check"></i><b>19.17.6</b> Tables of the Observed and Fitted <code>physhealth</code> from Tobit</a></li>
<li class="chapter" data-level="19.17.7" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#specify-the-r2-and-log-likelihood-values-4"><i class="fa fa-check"></i><b>19.17.7</b> Specify the R<sup>2</sup> and log (likelihood) values</a></li>
<li class="chapter" data-level="19.17.8" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#check-model-assumptions-9"><i class="fa fa-check"></i><b>19.17.8</b> Check model assumptions</a></li>
<li class="chapter" data-level="19.17.9" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#predictions-for-harry-and-sally-9"><i class="fa fa-check"></i><b>19.17.9</b> Predictions for Harry and Sally</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="20" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><i class="fa fa-check"></i><b>20</b> Modeling an Ordinal Categorical Outcome in Ohio SMART</a>
<ul>
<li class="chapter" data-level="20.1" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#preliminaries-1"><i class="fa fa-check"></i><b>20.1</b> Preliminaries</a></li>
<li class="chapter" data-level="20.2" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#a-subset-of-the-ohio-smart-data-1"><i class="fa fa-check"></i><b>20.2</b> A subset of the Ohio SMART data</a>
<ul>
<li class="chapter" data-level="20.2.1" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#several-ways-of-storing-multi-categorical-data"><i class="fa fa-check"></i><b>20.2.1</b> Several Ways of Storing Multi-Categorical data</a></li>
</ul></li>
<li class="chapter" data-level="20.3" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#building-cross-tabulations"><i class="fa fa-check"></i><b>20.3</b> Building Cross-Tabulations</a>
<ul>
<li class="chapter" data-level="20.3.1" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#using-base-table-functions"><i class="fa fa-check"></i><b>20.3.1</b> Using base <code>table</code> functions</a></li>
<li class="chapter" data-level="20.3.2" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#using-xtabs"><i class="fa fa-check"></i><b>20.3.2</b> Using <code>xtabs</code></a></li>
<li class="chapter" data-level="20.3.3" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#storing-a-table-in-a-tibble"><i class="fa fa-check"></i><b>20.3.3</b> Storing a table in a tibble</a></li>
<li class="chapter" data-level="20.3.4" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#using-crosstable-from-the-gmodels-package"><i class="fa fa-check"></i><b>20.3.4</b> Using <code>CrossTable</code> from the <code>gmodels</code> package</a></li>
</ul></li>
<li class="chapter" data-level="20.4" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#graphing-categorical-data"><i class="fa fa-check"></i><b>20.4</b> Graphing Categorical Data</a>
<ul>
<li class="chapter" data-level="20.4.1" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#a-bar-chart-for-a-single-variable"><i class="fa fa-check"></i><b>20.4.1</b> A Bar Chart for a Single Variable</a></li>
<li class="chapter" data-level="20.4.2" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#a-counts-chart-for-a-2-way-cross-tabulation"><i class="fa fa-check"></i><b>20.4.2</b> A Counts Chart for a 2-Way Cross-Tabulation</a></li>
</ul></li>
<li class="chapter" data-level="20.5" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#building-a-model-for-genh-using-veg_day"><i class="fa fa-check"></i><b>20.5</b> Building a Model for <code>genh</code> using <code>veg_day</code></a>
<ul>
<li class="chapter" data-level="20.5.1" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#a-little-eda"><i class="fa fa-check"></i><b>20.5.1</b> A little EDA</a></li>
<li class="chapter" data-level="20.5.2" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#describing-the-proportional-odds-cumulative-logit-model"><i class="fa fa-check"></i><b>20.5.2</b> Describing the Proportional-Odds Cumulative Logit Model</a></li>
<li class="chapter" data-level="20.5.3" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#fitting-a-proportional-odds-logistic-regression-with-polr"><i class="fa fa-check"></i><b>20.5.3</b> Fitting a Proportional Odds Logistic Regression with <code>polr</code></a></li>
</ul></li>
<li class="chapter" data-level="20.6" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#interpreting-model-m1"><i class="fa fa-check"></i><b>20.6</b> Interpreting Model <code>m1</code></a>
<ul>
<li class="chapter" data-level="20.6.1" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#looking-at-predictions"><i class="fa fa-check"></i><b>20.6.1</b> Looking at Predictions</a></li>
<li class="chapter" data-level="20.6.2" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#making-predictions-for-harry-and-sally-with-predict"><i class="fa fa-check"></i><b>20.6.2</b> Making Predictions for Harry (and Sally) with <code>predict</code></a></li>
<li class="chapter" data-level="20.6.3" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#predicting-the-actual-classification-of-genh"><i class="fa fa-check"></i><b>20.6.3</b> Predicting the actual classification of <code>genh</code></a></li>
<li class="chapter" data-level="20.6.4" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#a-cross-tabulation-of-predictions"><i class="fa fa-check"></i><b>20.6.4</b> A Cross-Tabulation of Predictions?</a></li>
<li class="chapter" data-level="20.6.5" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#the-fitted-model-equations"><i class="fa fa-check"></i><b>20.6.5</b> The Fitted Model Equations</a></li>
<li class="chapter" data-level="20.6.6" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#interpreting-the-veg_day-coefficient"><i class="fa fa-check"></i><b>20.6.6</b> Interpreting the <code>veg_day</code> coefficient</a></li>
<li class="chapter" data-level="20.6.7" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#exponentiating-the-slope-coefficient-to-facilitate-interpretation"><i class="fa fa-check"></i><b>20.6.7</b> Exponentiating the Slope Coefficient to facilitate Interpretation</a></li>
<li class="chapter" data-level="20.6.8" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#comparison-to-a-null-model-4"><i class="fa fa-check"></i><b>20.6.8</b> Comparison to a Null Model</a></li>
</ul></li>
<li class="chapter" data-level="20.7" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#the-assumption-of-proportional-odds"><i class="fa fa-check"></i><b>20.7</b> The Assumption of Proportional Odds</a>
<ul>
<li class="chapter" data-level="20.7.1" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#testing-the-proportional-odds-assumption"><i class="fa fa-check"></i><b>20.7.1</b> Testing the Proportional Odds Assumption</a></li>
</ul></li>
<li class="chapter" data-level="20.8" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#can-model-m1-be-fit-using-rms-tools"><i class="fa fa-check"></i><b>20.8</b> Can model <code>m1</code> be fit using <code>rms</code> tools?</a></li>
<li class="chapter" data-level="20.9" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#building-a-three-predictor-model"><i class="fa fa-check"></i><b>20.9</b> Building a Three-Predictor Model</a>
<ul>
<li class="chapter" data-level="20.9.1" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#scatterplot-matrix-1"><i class="fa fa-check"></i><b>20.9.1</b> Scatterplot Matrix</a></li>
<li class="chapter" data-level="20.9.2" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#our-three-predictor-model-m2"><i class="fa fa-check"></i><b>20.9.2</b> Our Three-Predictor Model, <code>m2</code></a></li>
<li class="chapter" data-level="20.9.3" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#does-the-three-predictor-model-outperform-m1"><i class="fa fa-check"></i><b>20.9.3</b> Does the three-predictor model outperform <code>m1</code>?</a></li>
<li class="chapter" data-level="20.9.4" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#wald-tests-for-individual-predictors"><i class="fa fa-check"></i><b>20.9.4</b> Wald tests for individual predictors</a></li>
<li class="chapter" data-level="20.9.5" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#a-cross-tabulation-of-predictions-1"><i class="fa fa-check"></i><b>20.9.5</b> A Cross-Tabulation of Predictions?</a></li>
<li class="chapter" data-level="20.9.6" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#interpreting-the-effect-sizes"><i class="fa fa-check"></i><b>20.9.6</b> Interpreting the Effect Sizes</a></li>
<li class="chapter" data-level="20.9.7" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#quality-of-the-model-fit"><i class="fa fa-check"></i><b>20.9.7</b> Quality of the Model Fit</a></li>
<li class="chapter" data-level="20.9.8" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#validating-the-summary-statistics-in-m2_lrm"><i class="fa fa-check"></i><b>20.9.8</b> Validating the Summary Statistics in <code>m2_lrm</code></a></li>
<li class="chapter" data-level="20.9.9" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#testing-the-proportional-odds-assumption-1"><i class="fa fa-check"></i><b>20.9.9</b> Testing the Proportional Odds Assumption</a></li>
<li class="chapter" data-level="20.9.10" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#plotting-the-fitted-model"><i class="fa fa-check"></i><b>20.9.10</b> Plotting the Fitted Model</a></li>
</ul></li>
<li class="chapter" data-level="20.10" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#a-larger-model-including-income-group"><i class="fa fa-check"></i><b>20.10</b> A Larger Model, including income group</a>
<ul>
<li class="chapter" data-level="20.10.1" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#cross-tabulation-of-predictedobserved-classifications"><i class="fa fa-check"></i><b>20.10.1</b> Cross-Tabulation of Predicted/Observed Classifications</a></li>
<li class="chapter" data-level="20.10.2" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#nomogram-2"><i class="fa fa-check"></i><b>20.10.2</b> Nomogram</a></li>
<li class="chapter" data-level="20.10.3" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#using-predict-and-showing-mean-prediction-on-1-5-scale-1"><i class="fa fa-check"></i><b>20.10.3</b> Using Predict and showing mean prediction on 1-5 scale</a></li>
<li class="chapter" data-level="20.10.4" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#validating-the-summary-statistics-in-m3_lrm"><i class="fa fa-check"></i><b>20.10.4</b> Validating the Summary Statistics in <code>m3_lrm</code></a></li>
</ul></li>
<li class="chapter" data-level="20.11" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#references-for-this-chapter"><i class="fa fa-check"></i><b>20.11</b> References for this Chapter</a></li>
</ul></li>
<li class="chapter" data-level="21" data-path="analyzing-literary-styles-with-multinomial-logistic-regression.html"><a href="analyzing-literary-styles-with-multinomial-logistic-regression.html"><i class="fa fa-check"></i><b>21</b> Analyzing Literary Styles with Multinomial Logistic Regression</a>
<ul>
<li class="chapter" data-level="21.1" data-path="analyzing-literary-styles-with-multinomial-logistic-regression.html"><a href="analyzing-literary-styles-with-multinomial-logistic-regression.html#the-authorship-example"><i class="fa fa-check"></i><b>21.1</b> The Authorship Example</a></li>
<li class="chapter" data-level="21.2" data-path="analyzing-literary-styles-with-multinomial-logistic-regression.html"><a href="analyzing-literary-styles-with-multinomial-logistic-regression.html#focus-on-11-key-words"><i class="fa fa-check"></i><b>21.2</b> Focus on 11 key words</a>
<ul>
<li class="chapter" data-level="21.2.1" data-path="analyzing-literary-styles-with-multinomial-logistic-regression.html"><a href="analyzing-literary-styles-with-multinomial-logistic-regression.html#side-by-side-boxplots"><i class="fa fa-check"></i><b>21.2.1</b> Side by Side Boxplots</a></li>
</ul></li>
<li class="chapter" data-level="21.3" data-path="analyzing-literary-styles-with-multinomial-logistic-regression.html"><a href="analyzing-literary-styles-with-multinomial-logistic-regression.html#a-multinomial-logistic-regression-model"><i class="fa fa-check"></i><b>21.3</b> A Multinomial Logistic Regression Model</a>
<ul>
<li class="chapter" data-level="21.3.1" data-path="analyzing-literary-styles-with-multinomial-logistic-regression.html"><a href="analyzing-literary-styles-with-multinomial-logistic-regression.html#testing-model-1"><i class="fa fa-check"></i><b>21.3.1</b> Testing Model 1</a></li>
</ul></li>
<li class="chapter" data-level="21.4" data-path="analyzing-literary-styles-with-multinomial-logistic-regression.html"><a href="analyzing-literary-styles-with-multinomial-logistic-regression.html#model-2"><i class="fa fa-check"></i><b>21.4</b> Model 2</a>
<ul>
<li class="chapter" data-level="21.4.1" data-path="analyzing-literary-styles-with-multinomial-logistic-regression.html"><a href="analyzing-literary-styles-with-multinomial-logistic-regression.html#comparing-model-2-to-model-1"><i class="fa fa-check"></i><b>21.4.1</b> Comparing Model 2 to Model 1</a></li>
<li class="chapter" data-level="21.4.2" data-path="analyzing-literary-styles-with-multinomial-logistic-regression.html"><a href="analyzing-literary-styles-with-multinomial-logistic-regression.html#testing-model-2"><i class="fa fa-check"></i><b>21.4.2</b> Testing Model 2</a></li>
<li class="chapter" data-level="21.4.3" data-path="analyzing-literary-styles-with-multinomial-logistic-regression.html"><a href="analyzing-literary-styles-with-multinomial-logistic-regression.html#a-little-history"><i class="fa fa-check"></i><b>21.4.3</b> A little history</a></li>
</ul></li>
<li class="chapter" data-level="21.5" data-path="analyzing-literary-styles-with-multinomial-logistic-regression.html"><a href="analyzing-literary-styles-with-multinomial-logistic-regression.html#classification-table"><i class="fa fa-check"></i><b>21.5</b> Classification Table</a></li>
<li class="chapter" data-level="21.6" data-path="analyzing-literary-styles-with-multinomial-logistic-regression.html"><a href="analyzing-literary-styles-with-multinomial-logistic-regression.html#probability-curves-based-on-a-single-predictor"><i class="fa fa-check"></i><b>21.6</b> Probability Curves based on a Single Predictor</a>
<ul>
<li class="chapter" data-level="21.6.1" data-path="analyzing-literary-styles-with-multinomial-logistic-regression.html"><a href="analyzing-literary-styles-with-multinomial-logistic-regression.html#produce-the-plot-of-estimated-probabilities-based-on-been-counts"><i class="fa fa-check"></i><b>21.6.1</b> Produce the Plot of Estimated Probabilities based on “been” counts</a></li>
<li class="chapter" data-level="21.6.2" data-path="analyzing-literary-styles-with-multinomial-logistic-regression.html"><a href="analyzing-literary-styles-with-multinomial-logistic-regression.html#boxplot-of-been-counts"><i class="fa fa-check"></i><b>21.6.2</b> Boxplot of “been” counts</a></li>
<li class="chapter" data-level="21.6.3" data-path="analyzing-literary-styles-with-multinomial-logistic-regression.html"><a href="analyzing-literary-styles-with-multinomial-logistic-regression.html#quote-sources"><i class="fa fa-check"></i><b>21.6.3</b> Quote Sources</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Data Science for Biological, Medical and Health Research: Notes for 432</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="multiple-imputation-and-linear-regression" class="section level1" number="14">
<h1><span class="header-section-number">Chapter 14</span> Multiple Imputation and Linear Regression</h1>
<div id="developing-a-smart_16-data-set" class="section level2" number="14.1">
<h2><span class="header-section-number">14.1</span> Developing a <code>smart_16</code> data set</h2>
<p>In this chapter, we’ll return to the <code>smart_ohio</code> file based on data from BRFSS 2017 that we built and cleaned back at the start of these Notes.</p>
<div class="sourceCode" id="cb884"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb884-1"><a href="multiple-imputation-and-linear-regression.html#cb884-1" aria-hidden="true" tabindex="-1"></a>smart_ohio <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="fu">here</span>(<span class="st">&quot;data&quot;</span>, <span class="st">&quot;smart_ohio.Rds&quot;</span>))</span></code></pre></div>
<p>We’re going to look at a selection of variables from this tibble, among subjects who have been told they have diabetes, and who also provided a response to our <code>physhealth</code> (Number of Days Physical Health Not Good) variable, which asks “Now thinking about your physical health, which includes physical illness and injury, for how many days during the past 30 days was your physical health not good?” We’ll build two models. In this chapter, we’ll look at a linear model for <code>physhealth</code> and in the next chapter, we’ll look at a logistic regression describing whether or not the subject’s <code>physhealth</code> response was at least 1.</p>
<div class="sourceCode" id="cb885"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb885-1"><a href="multiple-imputation-and-linear-regression.html#cb885-1" aria-hidden="true" tabindex="-1"></a>smart_16 <span class="ot">&lt;-</span> smart_ohio <span class="sc">%&gt;%</span></span>
<span id="cb885-2"><a href="multiple-imputation-and-linear-regression.html#cb885-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(dm_status <span class="sc">==</span> <span class="st">&quot;Diabetes&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb885-3"><a href="multiple-imputation-and-linear-regression.html#cb885-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="fu">complete.cases</span>(physhealth)) <span class="sc">%&gt;%</span></span>
<span id="cb885-4"><a href="multiple-imputation-and-linear-regression.html#cb885-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">bad_phys =</span> <span class="fu">ifelse</span>(physhealth <span class="sc">&gt;</span> <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb885-5"><a href="multiple-imputation-and-linear-regression.html#cb885-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">comor =</span> hx_mi <span class="sc">+</span> hx_chd <span class="sc">+</span> hx_stroke <span class="sc">+</span> hx_asthma <span class="sc">+</span></span>
<span id="cb885-6"><a href="multiple-imputation-and-linear-regression.html#cb885-6" aria-hidden="true" tabindex="-1"></a>               hx_skinc <span class="sc">+</span> hx_otherc <span class="sc">+</span> hx_copd <span class="sc">+</span> hx_arthr) <span class="sc">%&gt;%</span></span>
<span id="cb885-7"><a href="multiple-imputation-and-linear-regression.html#cb885-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(SEQNO, mmsa, physhealth, bad_phys, age_imp, smoke100,</span>
<span id="cb885-8"><a href="multiple-imputation-and-linear-regression.html#cb885-8" aria-hidden="true" tabindex="-1"></a>           comor, hx_depress, bmi, activity)</span></code></pre></div>
<p>The variables included in this <code>smart_16</code> tibble are:</p>
<table>
<colgroup>
<col width="15%" />
<col width="84%" />
</colgroup>
<thead>
<tr class="header">
<th align="right">Variable</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right"><code>SEQNO</code></td>
<td>respondent identification number (all begin with 2016)</td>
</tr>
<tr class="even">
<td align="right"><code>mmsa</code></td>
<td></td>
</tr>
<tr class="odd">
<td align="right"><code>physhealth</code></td>
<td>Now thinking about your physical health, which includes physical illness and injury, for how many days during the past 30 days was your physical health not good?</td>
</tr>
<tr class="even">
<td align="right"><code>bad_phys</code></td>
<td>Is <code>physhealth</code> 1 or more?</td>
</tr>
<tr class="odd">
<td align="right"><code>age_imp</code></td>
<td>Age in years (imputed from age categories)</td>
</tr>
<tr class="even">
<td align="right"><code>smoke100</code></td>
<td>Have you smoked at least 100 cigarettes in your life? (1 = yes, 0 = no)</td>
</tr>
<tr class="odd">
<td align="right"><code>hx_depress</code></td>
<td>Has a doctor, nurse, or other health professional ever told you that you have a depressive disorder, including depression, major depression, dysthymia, or minor depression?</td>
</tr>
<tr class="even">
<td align="right"><code>bmi</code></td>
<td>Body mass index, in kg/m<sup>2</sup></td>
</tr>
<tr class="odd">
<td align="right"><code>activity</code></td>
<td>Physical activity (Highly Active, Active, Insufficiently Active, Inactive)</td>
</tr>
<tr class="even">
<td align="right"><code>comor</code></td>
<td>Sum of 8 potential groups of comorbidities (see below)</td>
</tr>
</tbody>
</table>
<p>The <code>comor</code> variable is the sum of the following 8 variables, each of which is measured on a 1 = Yes, 0 = No scale, and begin with “Has a doctor, nurse, or other health professional ever told you that you had …”</p>
<ul>
<li><code>hx_mi</code>: a heart attack, also called a myocardial infarction?</li>
<li><code>hx_chd</code>: angina or coronary heart disease?</li>
<li><code>hx_stroke</code>: a stroke?</li>
<li><code>hx_asthma</code>: asthma?</li>
<li><code>hx_skinc</code>: skin cancer?</li>
<li><code>hx_otherc</code>: any other types of cancer?</li>
<li><code>hx_copd</code>: Chronic Obstructive Pulmonary Disease or COPD, emphysema or chronic bronchitis?</li>
<li><code>hx_arthr</code>: some form of arthritis, rheumatoid arthritis, gout, lupus, or fibromyalgia?</li>
</ul>
<div class="sourceCode" id="cb886"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb886-1"><a href="multiple-imputation-and-linear-regression.html#cb886-1" aria-hidden="true" tabindex="-1"></a>smart_16 <span class="sc">%&gt;%</span> <span class="fu">tabyl</span>(comor)</span></code></pre></div>
<pre><code> comor   n     percent valid_percent
     0 224 0.211920530   0.221782178
     1 315 0.298013245   0.311881188
     2 228 0.215704825   0.225742574
     3 130 0.122989593   0.128712871
     4  72 0.068117313   0.071287129
     5  29 0.027436140   0.028712871
     6   9 0.008514664   0.008910891
     7   3 0.002838221   0.002970297
    NA  47 0.044465468            NA</code></pre>
<div id="any-missing-values" class="section level3" number="14.1.1">
<h3><span class="header-section-number">14.1.1</span> Any missing values?</h3>
<p>We have 1057 observations (rows) in the <code>smart_16</code> data set, of whom 860 have complete data on all variables.</p>
<div class="sourceCode" id="cb888"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb888-1"><a href="multiple-imputation-and-linear-regression.html#cb888-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(smart_16)</span></code></pre></div>
<pre><code>[1] 1057   10</code></pre>
<div class="sourceCode" id="cb890"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb890-1"><a href="multiple-imputation-and-linear-regression.html#cb890-1" aria-hidden="true" tabindex="-1"></a><span class="fu">n_case_complete</span>(smart_16)</span></code></pre></div>
<pre><code>[1] 860</code></pre>
<p>Which variables are missing?</p>
<div class="sourceCode" id="cb892"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb892-1"><a href="multiple-imputation-and-linear-regression.html#cb892-1" aria-hidden="true" tabindex="-1"></a><span class="fu">miss_var_summary</span>(smart_16)</span></code></pre></div>
<pre><code># A tibble: 10 x 3
   variable   n_miss pct_miss
   &lt;chr&gt;       &lt;int&gt;    &lt;dbl&gt;
 1 activity       85    8.04 
 2 bmi            84    7.95 
 3 comor          47    4.45 
 4 smoke100       24    2.27 
 5 age_imp        12    1.14 
 6 hx_depress      3    0.284
 7 SEQNO           0    0    
 8 mmsa            0    0    
 9 physhealth      0    0    
10 bad_phys        0    0    </code></pre>
<p>Note that our outcomes (<code>physhealth</code> and the derived <code>bad_phys</code>) have no missing values here, by design. We will be performing multiple imputation to account appropriately for missingness in the predictors with missing values.</p>
</div>
</div>
<div id="obtaining-a-simple-imputation-with-mice" class="section level2" number="14.2">
<h2><span class="header-section-number">14.2</span> Obtaining a Simple Imputation with <code>mice</code></h2>
<p>The <code>mice</code> package provides several approaches we can use for imputation in building models of all kinds. Here, we’ll use it just to obtain a single set of imputed results that we can apply to “complete” our data for the purposes of thinking about (a) transforming our outcome and (b) considering the addition of non-linear predictor terms.</p>
<div class="sourceCode" id="cb894"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb894-1"><a href="multiple-imputation-and-linear-regression.html#cb894-1" aria-hidden="true" tabindex="-1"></a><span class="co"># requires library(mice)</span></span>
<span id="cb894-2"><a href="multiple-imputation-and-linear-regression.html#cb894-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb894-3"><a href="multiple-imputation-and-linear-regression.html#cb894-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">432</span>)</span>
<span id="cb894-4"><a href="multiple-imputation-and-linear-regression.html#cb894-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb894-5"><a href="multiple-imputation-and-linear-regression.html#cb894-5" aria-hidden="true" tabindex="-1"></a><span class="co"># create small data set including only variables to</span></span>
<span id="cb894-6"><a href="multiple-imputation-and-linear-regression.html#cb894-6" aria-hidden="true" tabindex="-1"></a><span class="co"># be used in building the imputation model</span></span>
<span id="cb894-7"><a href="multiple-imputation-and-linear-regression.html#cb894-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb894-8"><a href="multiple-imputation-and-linear-regression.html#cb894-8" aria-hidden="true" tabindex="-1"></a>sm16 <span class="ot">&lt;-</span> smart_16 <span class="sc">%&gt;%</span> </span>
<span id="cb894-9"><a href="multiple-imputation-and-linear-regression.html#cb894-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(physhealth, activity, age_imp, bmi, comor, </span>
<span id="cb894-10"><a href="multiple-imputation-and-linear-regression.html#cb894-10" aria-hidden="true" tabindex="-1"></a>           hx_depress, smoke100)</span>
<span id="cb894-11"><a href="multiple-imputation-and-linear-regression.html#cb894-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb894-12"><a href="multiple-imputation-and-linear-regression.html#cb894-12" aria-hidden="true" tabindex="-1"></a>smart_16_mice1 <span class="ot">&lt;-</span> <span class="fu">mice</span>(sm16, <span class="at">m =</span> <span class="dv">1</span>)</span></code></pre></div>
<pre><code>
 iter imp variable
  1   1  activity  age_imp  bmi  comor  hx_depress  smoke100
  2   1  activity  age_imp  bmi  comor  hx_depress  smoke100
  3   1  activity  age_imp  bmi  comor  hx_depress  smoke100
  4   1  activity  age_imp  bmi  comor  hx_depress  smoke100
  5   1  activity  age_imp  bmi  comor  hx_depress  smoke100</code></pre>
<div class="sourceCode" id="cb896"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb896-1"><a href="multiple-imputation-and-linear-regression.html#cb896-1" aria-hidden="true" tabindex="-1"></a>smart_16_imp1 <span class="ot">&lt;-</span> mice<span class="sc">::</span><span class="fu">complete</span>(smart_16_mice1)</span>
<span id="cb896-2"><a href="multiple-imputation-and-linear-regression.html#cb896-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb896-3"><a href="multiple-imputation-and-linear-regression.html#cb896-3" aria-hidden="true" tabindex="-1"></a><span class="fu">n_case_miss</span>(smart_16_imp1)</span></code></pre></div>
<pre><code>[1] 0</code></pre>
<p>And now we’ll use this completed <code>smart_16_imp1</code> data set (the product of just a single imputation) to help us address the next two issues.</p>
</div>
<div id="linear-regression-considering-a-transformation-of-the-outcome" class="section level2" number="14.3">
<h2><span class="header-section-number">14.3</span> Linear Regression: Considering a Transformation of the Outcome</h2>
<p>A plausible strategy here would be to try to identify an outcome transformation only after some accounting for missing predictor values, perhaps through a simple imputation approach. However, to keep things simple here, I’ll just use the complete cases in this section.</p>
<p>Recall that our outcome here, <code>physhealth</code> can take the value 0, and is thus not strictly positive.</p>
<div class="sourceCode" id="cb898"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb898-1"><a href="multiple-imputation-and-linear-regression.html#cb898-1" aria-hidden="true" tabindex="-1"></a>mosaic<span class="sc">::</span><span class="fu">favstats</span>(<span class="sc">~</span> physhealth, <span class="at">data =</span> smart_16_imp1)</span></code></pre></div>
<pre><code> min Q1 median Q3 max     mean       sd    n missing
   0  0      2 20  30 9.227058 11.92676 1057       0</code></pre>
<p>So, if we want to investigate a potential transformation with a Box-Cox plot, we’ll have to add a small value to each <code>physhealth</code> value. We’ll add 1, so that the range of potential values is now from 1-31.</p>
<div class="sourceCode" id="cb900"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb900-1"><a href="multiple-imputation-and-linear-regression.html#cb900-1" aria-hidden="true" tabindex="-1"></a><span class="co"># requires library(car)</span></span>
<span id="cb900-2"><a href="multiple-imputation-and-linear-regression.html#cb900-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb900-3"><a href="multiple-imputation-and-linear-regression.html#cb900-3" aria-hidden="true" tabindex="-1"></a>smart_16_imp1 <span class="sc">%$%</span> </span>
<span id="cb900-4"><a href="multiple-imputation-and-linear-regression.html#cb900-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">boxCox</span>((physhealth <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">~</span> age_imp <span class="sc">+</span> comor <span class="sc">+</span> smoke100 <span class="sc">+</span> </span>
<span id="cb900-5"><a href="multiple-imputation-and-linear-regression.html#cb900-5" aria-hidden="true" tabindex="-1"></a>               hx_depress <span class="sc">+</span> bmi <span class="sc">+</span> activity)</span></code></pre></div>
<p><img src="432-notes_files/figure-html/unnamed-chunk-344-1.png" width="672" /></p>
<p>It looks like the logarithm is a reasonable transformation in this setting. So we’ll create a new outcome, that is the natural logarithm of (<code>physhealth</code> + 1), which we’ll call <code>phys_tr</code> to remind us that a transformation is involved that we’ll eventually need to back out of to make predictions. We’ll build this new variable in both our original <code>smart_16</code> data set and in the simply imputed data set we’re using for just these early stages.</p>
<div class="sourceCode" id="cb901"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb901-1"><a href="multiple-imputation-and-linear-regression.html#cb901-1" aria-hidden="true" tabindex="-1"></a>smart_16_imp1 <span class="ot">&lt;-</span> smart_16_imp1 <span class="sc">%&gt;%</span></span>
<span id="cb901-2"><a href="multiple-imputation-and-linear-regression.html#cb901-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">phys_tr =</span> <span class="fu">log</span>(physhealth <span class="sc">+</span> <span class="dv">1</span>))</span>
<span id="cb901-3"><a href="multiple-imputation-and-linear-regression.html#cb901-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb901-4"><a href="multiple-imputation-and-linear-regression.html#cb901-4" aria-hidden="true" tabindex="-1"></a>smart_16 <span class="ot">&lt;-</span> smart_16 <span class="sc">%&gt;%</span></span>
<span id="cb901-5"><a href="multiple-imputation-and-linear-regression.html#cb901-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">phys_tr =</span> <span class="fu">log</span>(physhealth <span class="sc">+</span> <span class="dv">1</span>))</span></code></pre></div>
<p>So we have <code>phys_tr</code> = log(<code>physhealth</code> + 1)</p>
<ul>
<li>where we are referring above to the natural (base <span class="math inline">\(e\)</span> logarithm).</li>
</ul>
<p>We can also specify our back-transformation to the original <code>physhealth</code> values from our new <code>phys_tr</code> as <code>physhealth</code> = exp(<code>phys_tr</code>) - 1.</p>
</div>
<div id="linear-regression-considering-non-linearity-in-the-predictors" class="section level2" number="14.4">
<h2><span class="header-section-number">14.4</span> Linear Regression: Considering Non-Linearity in the Predictors</h2>
<p>Consider the following Spearman <span class="math inline">\(\rho^2\)</span> plot.</p>
<div class="sourceCode" id="cb902"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb902-1"><a href="multiple-imputation-and-linear-regression.html#cb902-1" aria-hidden="true" tabindex="-1"></a><span class="co"># requires rms package </span></span>
<span id="cb902-2"><a href="multiple-imputation-and-linear-regression.html#cb902-2" aria-hidden="true" tabindex="-1"></a><span class="co"># (technically Hmisc, which is loaded by rms)</span></span>
<span id="cb902-3"><a href="multiple-imputation-and-linear-regression.html#cb902-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb902-4"><a href="multiple-imputation-and-linear-regression.html#cb902-4" aria-hidden="true" tabindex="-1"></a>smart_16_imp1 <span class="sc">%$%</span> </span>
<span id="cb902-5"><a href="multiple-imputation-and-linear-regression.html#cb902-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">plot</span>(<span class="fu">spearman2</span>(phys_tr <span class="sc">~</span> age_imp <span class="sc">+</span> comor <span class="sc">+</span> smoke100 <span class="sc">+</span> </span>
<span id="cb902-6"><a href="multiple-imputation-and-linear-regression.html#cb902-6" aria-hidden="true" tabindex="-1"></a>           hx_depress <span class="sc">+</span> bmi <span class="sc">+</span> activity))</span></code></pre></div>
<p><img src="432-notes_files/figure-html/unnamed-chunk-346-1.png" width="672" /></p>
<p>After our single imputation, we have the same <code>N</code> value in all rows of this plot, which is what we want to see. It appears that in considering potential non-linear terms, <code>comor</code> and <code>hx_depress</code> and perhaps <code>activity</code> are worthy of increased attention. I’ll make a couple of arbitrary choices, to add a raw cubic polynomial to represent the <code>comor</code> information, and we’ll add an interaction term between <code>hx_depress</code> and <code>activity</code>.</p>
</div>
<div id="main-effects-linear-regression-with-lm-on-the-complete-cases" class="section level2" number="14.5">
<h2><span class="header-section-number">14.5</span> “Main Effects” Linear Regression with <code>lm</code> on the Complete Cases</h2>
<p>Recall that we have 860 complete cases in our <code>smart_16</code> data, out of a total of 1057 observations in total. A model using only the complete cases should thus drop the remaining 197 subjects. Let’s see if a main effects only model for our newly transformed <code>phys_tr</code> outcome does in fact do this.</p>
<div class="sourceCode" id="cb903"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb903-1"><a href="multiple-imputation-and-linear-regression.html#cb903-1" aria-hidden="true" tabindex="-1"></a>m_1cc <span class="ot">&lt;-</span> smart_16 <span class="sc">%$%</span> </span>
<span id="cb903-2"><a href="multiple-imputation-and-linear-regression.html#cb903-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">lm</span>(phys_tr <span class="sc">~</span> age_imp <span class="sc">+</span> comor <span class="sc">+</span> smoke100 <span class="sc">+</span> </span>
<span id="cb903-3"><a href="multiple-imputation-and-linear-regression.html#cb903-3" aria-hidden="true" tabindex="-1"></a>           hx_depress <span class="sc">+</span> bmi <span class="sc">+</span> activity)</span>
<span id="cb903-4"><a href="multiple-imputation-and-linear-regression.html#cb903-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb903-5"><a href="multiple-imputation-and-linear-regression.html#cb903-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m_1cc)</span></code></pre></div>
<pre><code>
Call:
lm(formula = phys_tr ~ age_imp + comor + smoke100 + hx_depress + 
    bmi + activity)

Residuals:
    Min      1Q  Median      3Q     Max 
-3.0801 -1.0389 -0.2918  1.1029  2.8478 

Coefficients:
                               Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)                    0.581959   0.370847   1.569  0.11696    
age_imp                       -0.007043   0.003813  -1.847  0.06511 .  
comor                          0.301773   0.033105   9.116  &lt; 2e-16 ***
smoke100                       0.099038   0.090280   1.097  0.27295    
hx_depress                     0.471949   0.104232   4.528 6.81e-06 ***
bmi                            0.016375   0.006295   2.601  0.00945 ** 
activityActive                -0.229927   0.154912  -1.484  0.13812    
activityInsufficiently_Active -0.116998   0.139440  -0.839  0.40168    
activityInactive               0.256118   0.115266   2.222  0.02655 *  
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 1.303 on 851 degrees of freedom
  (197 observations deleted due to missingness)
Multiple R-squared:  0.1806,    Adjusted R-squared:  0.1729 
F-statistic: 23.45 on 8 and 851 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>Note that the appropriate number of observations are listed as “deleted due to missingness.”</p>
<div id="quality-of-fit-statistics" class="section level3" number="14.5.1">
<h3><span class="header-section-number">14.5.1</span> Quality of Fit Statistics</h3>
<div class="sourceCode" id="cb905"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb905-1"><a href="multiple-imputation-and-linear-regression.html#cb905-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(m_1cc) <span class="sc">%&gt;%</span></span>
<span id="cb905-2"><a href="multiple-imputation-and-linear-regression.html#cb905-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(r.squared, adj.r.squared, sigma, AIC, BIC) <span class="sc">%&gt;%</span></span>
<span id="cb905-3"><a href="multiple-imputation-and-linear-regression.html#cb905-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">kable</span>(<span class="at">digits =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>))</span></code></pre></div>
<table>
<thead>
<tr>
<th style="text-align:right;">
r.squared
</th>
<th style="text-align:right;">
adj.r.squared
</th>
<th style="text-align:right;">
sigma
</th>
<th style="text-align:right;">
AIC
</th>
<th style="text-align:right;">
BIC
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
0.181
</td>
<td style="text-align:right;">
0.173
</td>
<td style="text-align:right;">
1.3
</td>
<td style="text-align:right;">
2906.3
</td>
<td style="text-align:right;">
2953.8
</td>
</tr>
</tbody>
</table>
</div>
<div id="interpreting-effect-sizes" class="section level3" number="14.5.2">
<h3><span class="header-section-number">14.5.2</span> Interpreting Effect Sizes</h3>
<div class="sourceCode" id="cb906"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb906-1"><a href="multiple-imputation-and-linear-regression.html#cb906-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(m_1cc, <span class="at">conf.int =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb906-2"><a href="multiple-imputation-and-linear-regression.html#cb906-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(term, estimate, std.error, conf.low, conf.high) <span class="sc">%&gt;%</span></span>
<span id="cb906-3"><a href="multiple-imputation-and-linear-regression.html#cb906-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">kable</span>(<span class="at">digits =</span> <span class="dv">3</span>)</span></code></pre></div>
<table>
<thead>
<tr>
<th style="text-align:left;">
term
</th>
<th style="text-align:right;">
estimate
</th>
<th style="text-align:right;">
std.error
</th>
<th style="text-align:right;">
conf.low
</th>
<th style="text-align:right;">
conf.high
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
(Intercept)
</td>
<td style="text-align:right;">
0.582
</td>
<td style="text-align:right;">
0.371
</td>
<td style="text-align:right;">
-0.146
</td>
<td style="text-align:right;">
1.310
</td>
</tr>
<tr>
<td style="text-align:left;">
age_imp
</td>
<td style="text-align:right;">
-0.007
</td>
<td style="text-align:right;">
0.004
</td>
<td style="text-align:right;">
-0.015
</td>
<td style="text-align:right;">
0.000
</td>
</tr>
<tr>
<td style="text-align:left;">
comor
</td>
<td style="text-align:right;">
0.302
</td>
<td style="text-align:right;">
0.033
</td>
<td style="text-align:right;">
0.237
</td>
<td style="text-align:right;">
0.367
</td>
</tr>
<tr>
<td style="text-align:left;">
smoke100
</td>
<td style="text-align:right;">
0.099
</td>
<td style="text-align:right;">
0.090
</td>
<td style="text-align:right;">
-0.078
</td>
<td style="text-align:right;">
0.276
</td>
</tr>
<tr>
<td style="text-align:left;">
hx_depress
</td>
<td style="text-align:right;">
0.472
</td>
<td style="text-align:right;">
0.104
</td>
<td style="text-align:right;">
0.267
</td>
<td style="text-align:right;">
0.677
</td>
</tr>
<tr>
<td style="text-align:left;">
bmi
</td>
<td style="text-align:right;">
0.016
</td>
<td style="text-align:right;">
0.006
</td>
<td style="text-align:right;">
0.004
</td>
<td style="text-align:right;">
0.029
</td>
</tr>
<tr>
<td style="text-align:left;">
activityActive
</td>
<td style="text-align:right;">
-0.230
</td>
<td style="text-align:right;">
0.155
</td>
<td style="text-align:right;">
-0.534
</td>
<td style="text-align:right;">
0.074
</td>
</tr>
<tr>
<td style="text-align:left;">
activityInsufficiently_Active
</td>
<td style="text-align:right;">
-0.117
</td>
<td style="text-align:right;">
0.139
</td>
<td style="text-align:right;">
-0.391
</td>
<td style="text-align:right;">
0.157
</td>
</tr>
<tr>
<td style="text-align:left;">
activityInactive
</td>
<td style="text-align:right;">
0.256
</td>
<td style="text-align:right;">
0.115
</td>
<td style="text-align:right;">
0.030
</td>
<td style="text-align:right;">
0.482
</td>
</tr>
</tbody>
</table>
<p>We’ll interpret three of the predictors here to demonstrate ideas: <code>comor</code>, <code>hx_depress</code> and <code>activity</code>.</p>
<ul>
<li><p>If we have two subjects with the same values of <code>age_imp</code>, <code>smoke100</code>, <code>hx_depress</code>, <code>bmi</code>, and <code>activity</code>, but Harry has a <code>comor</code> score that is one point higher than Sally’s, then the model predicts that Harry’s transformed outcome (specifically the natural logarithm of (his <code>physhealth</code> days + 1)) will be 0.302 higher than Sally’s, with a 95% confidence interval around that estimate ranging from (<code>round(a$conf.low,3)</code>, <code>round(a$conf.high,3)</code>).</p></li>
<li><p>If we have two subjects with the same values of <code>age_imp</code>, <code>comor</code>, <code>smoke100</code>, <code>bmi</code>, and <code>activity</code>, but Harry has a history of depression (<code>hx_depress</code> = 1) while Sally does not have such a history (so Sally’s <code>hx_depress</code> = 0), then the model predicts that Harry’s transformed outcome (specifically the natural logarithm of (his <code>physhealth</code> days + 1)) will be 0.472 higher than Sally’s, with a 95% confidence interval around that estimate ranging from (<code>round(a$conf.low,3)</code>, <code>round(a$conf.high,3)</code>).</p></li>
<li><p>The <code>activity</code> variable has four categories as indicated in the table below. The model uses the “Highly_Active” category as the reference group.</p></li>
</ul>
<div class="sourceCode" id="cb907"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb907-1"><a href="multiple-imputation-and-linear-regression.html#cb907-1" aria-hidden="true" tabindex="-1"></a>smart_16_imp1 <span class="sc">%&gt;%</span> <span class="fu">tabyl</span>(activity)</span></code></pre></div>
<pre><code>              activity   n   percent
         Highly_Active 252 0.2384106
                Active 135 0.1277200
 Insufficiently_Active 193 0.1825922
              Inactive 477 0.4512772</code></pre>
<ul>
<li>From the tidied set of coefficients, we can describe the <code>activity</code> effects as follows.
<ul>
<li>If Sally is “Highly Active” and Harry is “Active” but they otherwise have the same values of all predictors, then our prediction is that Harry’s transformed outcome (specifically the natural logarithm of (his <code>physhealth</code> days + 1)) will be 0.23 lower than Sally’s, with a 95% confidence interval around that estimate ranging from (<code>round(a$conf.low,3)</code>, <code>round(a$conf.high,3)</code>).</li>
<li>If instead Harry is “Insufficiently Active” but nothing else changes, then our prediction is that Harry’s transformed outcome will be 0.117 lower than Sally’s, with a 95% confidence interval around that estimate ranging from (<code>round(a2$conf.low,3)</code>, <code>round(a2$conf.high,3)</code>).</li>
<li>If instead Harry is “Inactive” but nothing else changes, then our prediction is that Harry’s transformed outcome will be -0.117 higher than Sally’s, with a 95% confidence interval around that estimate ranging from (<code>round(a2$conf.low,3)</code>, <code>round(a2$conf.high,3)</code>).</li>
</ul></li>
</ul>
</div>
<div id="making-predictions-with-the-model" class="section level3" number="14.5.3">
<h3><span class="header-section-number">14.5.3</span> Making Predictions with the Model</h3>
<p>Let’s describe two subjects, and use this model (and the ones that follow) to predict their <code>physhealth</code> values.</p>
<ul>
<li>Sheena is age 50, has 2 comorbidities, has smoked 100 cigarettes in her life, has no history of depression, a BMI of 25, and is Highly Active.</li>
<li>Jacob is age 65, has 4 comorbidities, has never smoked, has a history of depression, a BMI of 32 and is Inactive.</li>
</ul>
<p>We’ll first build predictions for Sheena and Jacob (with 95% prediction intervals) for <code>phys_tr</code>.</p>
<div class="sourceCode" id="cb909"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb909-1"><a href="multiple-imputation-and-linear-regression.html#cb909-1" aria-hidden="true" tabindex="-1"></a>new2 <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb909-2"><a href="multiple-imputation-and-linear-regression.html#cb909-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="fu">c</span>(<span class="st">&quot;Sheena&quot;</span>, <span class="st">&quot;Jacob&quot;</span>),</span>
<span id="cb909-3"><a href="multiple-imputation-and-linear-regression.html#cb909-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">age_imp =</span> <span class="fu">c</span>(<span class="dv">50</span>, <span class="dv">65</span>),</span>
<span id="cb909-4"><a href="multiple-imputation-and-linear-regression.html#cb909-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">comor =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">4</span>),</span>
<span id="cb909-5"><a href="multiple-imputation-and-linear-regression.html#cb909-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">smoke100 =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb909-6"><a href="multiple-imputation-and-linear-regression.html#cb909-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">hx_depress =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb909-7"><a href="multiple-imputation-and-linear-regression.html#cb909-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">bmi =</span> <span class="fu">c</span>(<span class="dv">25</span>, <span class="dv">32</span>),</span>
<span id="cb909-8"><a href="multiple-imputation-and-linear-regression.html#cb909-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">activity =</span> <span class="fu">c</span>(<span class="st">&quot;Highly_Active&quot;</span>, <span class="st">&quot;Inactive&quot;</span>)</span>
<span id="cb909-9"><a href="multiple-imputation-and-linear-regression.html#cb909-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb909-10"><a href="multiple-imputation-and-linear-regression.html#cb909-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb909-11"><a href="multiple-imputation-and-linear-regression.html#cb909-11" aria-hidden="true" tabindex="-1"></a>preds_m_1cc <span class="ot">&lt;-</span> <span class="fu">predict</span>(m_1cc, <span class="at">newdata =</span> new2, </span>
<span id="cb909-12"><a href="multiple-imputation-and-linear-regression.html#cb909-12" aria-hidden="true" tabindex="-1"></a>                       <span class="at">interval =</span> <span class="st">&quot;prediction&quot;</span>)</span>
<span id="cb909-13"><a href="multiple-imputation-and-linear-regression.html#cb909-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb909-14"><a href="multiple-imputation-and-linear-regression.html#cb909-14" aria-hidden="true" tabindex="-1"></a>preds_m_1cc</span></code></pre></div>
<pre><code>       fit      lwr      upr
1 1.341778 -1.22937 3.912925
2 2.583336  0.01399 5.152681</code></pre>
<p>The model makes predictions for our transformed outcome, <code>phys_tr</code>. Now, we need to back-transform the predictions and the confidence intervals to build predictions for <code>physhealth</code>.</p>
<div class="sourceCode" id="cb911"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb911-1"><a href="multiple-imputation-and-linear-regression.html#cb911-1" aria-hidden="true" tabindex="-1"></a>preds_m_1cc <span class="ot">&lt;-</span> preds_m_1cc <span class="sc">%&gt;%</span></span>
<span id="cb911-2"><a href="multiple-imputation-and-linear-regression.html#cb911-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tbl_df</span>() <span class="sc">%&gt;%</span></span>
<span id="cb911-3"><a href="multiple-imputation-and-linear-regression.html#cb911-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">names =</span> <span class="fu">c</span>(<span class="st">&quot;Sheena&quot;</span>, <span class="st">&quot;Jacob&quot;</span>),</span>
<span id="cb911-4"><a href="multiple-imputation-and-linear-regression.html#cb911-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">pred_physhealth =</span> <span class="fu">exp</span>(fit) <span class="sc">-</span> <span class="dv">1</span>,</span>
<span id="cb911-5"><a href="multiple-imputation-and-linear-regression.html#cb911-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">conf_low =</span> <span class="fu">exp</span>(lwr) <span class="sc">-</span> <span class="dv">1</span>,</span>
<span id="cb911-6"><a href="multiple-imputation-and-linear-regression.html#cb911-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">conf_high =</span> <span class="fu">exp</span>(upr) <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb911-7"><a href="multiple-imputation-and-linear-regression.html#cb911-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(names, pred_physhealth, conf_low, conf_high, </span>
<span id="cb911-8"><a href="multiple-imputation-and-linear-regression.html#cb911-8" aria-hidden="true" tabindex="-1"></a>           <span class="fu">everything</span>())</span>
<span id="cb911-9"><a href="multiple-imputation-and-linear-regression.html#cb911-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb911-10"><a href="multiple-imputation-and-linear-regression.html#cb911-10" aria-hidden="true" tabindex="-1"></a>preds_m_1cc <span class="sc">%&gt;%</span> <span class="fu">kable</span>(<span class="at">digits =</span> <span class="dv">3</span>)</span></code></pre></div>
<table>
<thead>
<tr>
<th style="text-align:left;">
names
</th>
<th style="text-align:right;">
pred_physhealth
</th>
<th style="text-align:right;">
conf_low
</th>
<th style="text-align:right;">
conf_high
</th>
<th style="text-align:right;">
fit
</th>
<th style="text-align:right;">
lwr
</th>
<th style="text-align:right;">
upr
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Sheena
</td>
<td style="text-align:right;">
2.826
</td>
<td style="text-align:right;">
-0.708
</td>
<td style="text-align:right;">
49.045
</td>
<td style="text-align:right;">
1.342
</td>
<td style="text-align:right;">
-1.229
</td>
<td style="text-align:right;">
3.913
</td>
</tr>
<tr>
<td style="text-align:left;">
Jacob
</td>
<td style="text-align:right;">
12.241
</td>
<td style="text-align:right;">
0.014
</td>
<td style="text-align:right;">
171.894
</td>
<td style="text-align:right;">
2.583
</td>
<td style="text-align:right;">
0.014
</td>
<td style="text-align:right;">
5.153
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="augmented-linear-regression-with-lm-on-the-complete-cases" class="section level2" number="14.6">
<h2><span class="header-section-number">14.6</span> “Augmented” Linear Regression with <code>lm</code> on the Complete Cases</h2>
<p>Now, we’ll add the non-linear terms we discussed earlier. We’ll add a (raw) cubic polynomial to represent the <code>comor</code> information, and we’ll add an interaction term between <code>hx_depress</code> and <code>activity</code>.</p>
<div class="sourceCode" id="cb912"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb912-1"><a href="multiple-imputation-and-linear-regression.html#cb912-1" aria-hidden="true" tabindex="-1"></a><span class="co"># requires rms package (and co-loading Hmisc)</span></span>
<span id="cb912-2"><a href="multiple-imputation-and-linear-regression.html#cb912-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb912-3"><a href="multiple-imputation-and-linear-regression.html#cb912-3" aria-hidden="true" tabindex="-1"></a>m_2cc <span class="ot">&lt;-</span> smart_16 <span class="sc">%$%</span> </span>
<span id="cb912-4"><a href="multiple-imputation-and-linear-regression.html#cb912-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">lm</span>(phys_tr <span class="sc">~</span> age_imp <span class="sc">+</span> <span class="fu">pol</span>(comor, <span class="dv">3</span>) <span class="sc">+</span> smoke100 <span class="sc">+</span> </span>
<span id="cb912-5"><a href="multiple-imputation-and-linear-regression.html#cb912-5" aria-hidden="true" tabindex="-1"></a>           bmi <span class="sc">+</span> hx_depress<span class="sc">*</span>activity)</span>
<span id="cb912-6"><a href="multiple-imputation-and-linear-regression.html#cb912-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb912-7"><a href="multiple-imputation-and-linear-regression.html#cb912-7" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m_2cc)</span></code></pre></div>
<pre><code>
Call:
lm(formula = phys_tr ~ age_imp + pol(comor, 3) + smoke100 + bmi + 
    hx_depress * activity)

Residuals:
   Min     1Q Median     3Q    Max 
-2.907 -1.063 -0.267  1.143  2.924 

Coefficients:
                                          Estimate Std. Error t value Pr(&gt;|t|)
(Intercept)                               0.514823   0.376203   1.368  0.17153
age_imp                                  -0.008100   0.003865  -2.096  0.03640
pol(comor, 3)comor                        0.634274   0.160630   3.949 8.51e-05
pol(comor, 3)comor^2                     -0.130626   0.073525  -1.777  0.07599
pol(comor, 3)comor^3                      0.012508   0.008977   1.393  0.16386
smoke100                                  0.089345   0.090336   0.989  0.32294
bmi                                       0.015203   0.006315   2.408  0.01627
hx_depress                                0.647054   0.229696   2.817  0.00496
activityActive                           -0.202196   0.172300  -1.174  0.24092
activityInsufficiently_Active            -0.005815   0.166221  -0.035  0.97210
activityInactive                          0.290380   0.132198   2.197  0.02832
hx_depress:activityActive                -0.124836   0.395415  -0.316  0.75230
hx_depress:activityInsufficiently_Active -0.376355   0.310160  -1.213  0.22531
hx_depress:activityInactive              -0.172952   0.267427  -0.647  0.51798
                                            
(Intercept)                                 
age_imp                                  *  
pol(comor, 3)comor                       ***
pol(comor, 3)comor^2                     .  
pol(comor, 3)comor^3                        
smoke100                                    
bmi                                      *  
hx_depress                               ** 
activityActive                              
activityInsufficiently_Active               
activityInactive                         *  
hx_depress:activityActive                   
hx_depress:activityInsufficiently_Active    
hx_depress:activityInactive                 
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 1.301 on 846 degrees of freedom
  (197 observations deleted due to missingness)
Multiple R-squared:  0.187, Adjusted R-squared:  0.1745 
F-statistic: 14.97 on 13 and 846 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>Note again that the appropriate number of observations are listed as “deleted due to missingness.”</p>
<div id="quality-of-fit-statistics-1" class="section level3" number="14.6.1">
<h3><span class="header-section-number">14.6.1</span> Quality of Fit Statistics</h3>
<div class="sourceCode" id="cb914"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb914-1"><a href="multiple-imputation-and-linear-regression.html#cb914-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(m_2cc) <span class="sc">%&gt;%</span></span>
<span id="cb914-2"><a href="multiple-imputation-and-linear-regression.html#cb914-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(r.squared, adj.r.squared, sigma, AIC, BIC) <span class="sc">%&gt;%</span></span>
<span id="cb914-3"><a href="multiple-imputation-and-linear-regression.html#cb914-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">kable</span>(<span class="at">digits =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>))</span></code></pre></div>
<table>
<thead>
<tr>
<th style="text-align:right;">
r.squared
</th>
<th style="text-align:right;">
adj.r.squared
</th>
<th style="text-align:right;">
sigma
</th>
<th style="text-align:right;">
AIC
</th>
<th style="text-align:right;">
BIC
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
0.187
</td>
<td style="text-align:right;">
0.175
</td>
<td style="text-align:right;">
1.3
</td>
<td style="text-align:right;">
2909.5
</td>
<td style="text-align:right;">
2980.9
</td>
</tr>
</tbody>
</table>
</div>
<div id="anova-assessing-the-impact-of-the-non-linear-terms" class="section level3" number="14.6.2">
<h3><span class="header-section-number">14.6.2</span> ANOVA assessing the impact of the non-linear terms</h3>
<div class="sourceCode" id="cb915"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb915-1"><a href="multiple-imputation-and-linear-regression.html#cb915-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(m_1cc, m_2cc)</span></code></pre></div>
<pre><code>Analysis of Variance Table

Model 1: phys_tr ~ age_imp + comor + smoke100 + hx_depress + bmi + activity
Model 2: phys_tr ~ age_imp + pol(comor, 3) + smoke100 + bmi + hx_depress * 
    activity
  Res.Df    RSS Df Sum of Sq      F Pr(&gt;F)
1    851 1444.0                           
2    846 1432.8  5    11.265 1.3303  0.249</code></pre>
<p>The difference between the models doesn’t meet the standard for statistical detectabilty at our usual <span class="math inline">\(\alpha\)</span> levels.</p>
</div>
<div id="interpreting-effect-sizes-1" class="section level3" number="14.6.3">
<h3><span class="header-section-number">14.6.3</span> Interpreting Effect Sizes</h3>
<div class="sourceCode" id="cb917"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb917-1"><a href="multiple-imputation-and-linear-regression.html#cb917-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(m_2cc, <span class="at">conf.int =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb917-2"><a href="multiple-imputation-and-linear-regression.html#cb917-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(term, estimate, std.error, conf.low, conf.high) <span class="sc">%&gt;%</span></span>
<span id="cb917-3"><a href="multiple-imputation-and-linear-regression.html#cb917-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">kable</span>(<span class="at">digits =</span> <span class="dv">3</span>)</span></code></pre></div>
<table>
<thead>
<tr>
<th style="text-align:left;">
term
</th>
<th style="text-align:right;">
estimate
</th>
<th style="text-align:right;">
std.error
</th>
<th style="text-align:right;">
conf.low
</th>
<th style="text-align:right;">
conf.high
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
(Intercept)
</td>
<td style="text-align:right;">
0.515
</td>
<td style="text-align:right;">
0.376
</td>
<td style="text-align:right;">
-0.224
</td>
<td style="text-align:right;">
1.253
</td>
</tr>
<tr>
<td style="text-align:left;">
age_imp
</td>
<td style="text-align:right;">
-0.008
</td>
<td style="text-align:right;">
0.004
</td>
<td style="text-align:right;">
-0.016
</td>
<td style="text-align:right;">
-0.001
</td>
</tr>
<tr>
<td style="text-align:left;">
pol(comor, 3)comor
</td>
<td style="text-align:right;">
0.634
</td>
<td style="text-align:right;">
0.161
</td>
<td style="text-align:right;">
0.319
</td>
<td style="text-align:right;">
0.950
</td>
</tr>
<tr>
<td style="text-align:left;">
pol(comor, 3)comor^2
</td>
<td style="text-align:right;">
-0.131
</td>
<td style="text-align:right;">
0.074
</td>
<td style="text-align:right;">
-0.275
</td>
<td style="text-align:right;">
0.014
</td>
</tr>
<tr>
<td style="text-align:left;">
pol(comor, 3)comor^3
</td>
<td style="text-align:right;">
0.013
</td>
<td style="text-align:right;">
0.009
</td>
<td style="text-align:right;">
-0.005
</td>
<td style="text-align:right;">
0.030
</td>
</tr>
<tr>
<td style="text-align:left;">
smoke100
</td>
<td style="text-align:right;">
0.089
</td>
<td style="text-align:right;">
0.090
</td>
<td style="text-align:right;">
-0.088
</td>
<td style="text-align:right;">
0.267
</td>
</tr>
<tr>
<td style="text-align:left;">
bmi
</td>
<td style="text-align:right;">
0.015
</td>
<td style="text-align:right;">
0.006
</td>
<td style="text-align:right;">
0.003
</td>
<td style="text-align:right;">
0.028
</td>
</tr>
<tr>
<td style="text-align:left;">
hx_depress
</td>
<td style="text-align:right;">
0.647
</td>
<td style="text-align:right;">
0.230
</td>
<td style="text-align:right;">
0.196
</td>
<td style="text-align:right;">
1.098
</td>
</tr>
<tr>
<td style="text-align:left;">
activityActive
</td>
<td style="text-align:right;">
-0.202
</td>
<td style="text-align:right;">
0.172
</td>
<td style="text-align:right;">
-0.540
</td>
<td style="text-align:right;">
0.136
</td>
</tr>
<tr>
<td style="text-align:left;">
activityInsufficiently_Active
</td>
<td style="text-align:right;">
-0.006
</td>
<td style="text-align:right;">
0.166
</td>
<td style="text-align:right;">
-0.332
</td>
<td style="text-align:right;">
0.320
</td>
</tr>
<tr>
<td style="text-align:left;">
activityInactive
</td>
<td style="text-align:right;">
0.290
</td>
<td style="text-align:right;">
0.132
</td>
<td style="text-align:right;">
0.031
</td>
<td style="text-align:right;">
0.550
</td>
</tr>
<tr>
<td style="text-align:left;">
hx_depress:activityActive
</td>
<td style="text-align:right;">
-0.125
</td>
<td style="text-align:right;">
0.395
</td>
<td style="text-align:right;">
-0.901
</td>
<td style="text-align:right;">
0.651
</td>
</tr>
<tr>
<td style="text-align:left;">
hx_depress:activityInsufficiently_Active
</td>
<td style="text-align:right;">
-0.376
</td>
<td style="text-align:right;">
0.310
</td>
<td style="text-align:right;">
-0.985
</td>
<td style="text-align:right;">
0.232
</td>
</tr>
<tr>
<td style="text-align:left;">
hx_depress:activityInactive
</td>
<td style="text-align:right;">
-0.173
</td>
<td style="text-align:right;">
0.267
</td>
<td style="text-align:right;">
-0.698
</td>
<td style="text-align:right;">
0.352
</td>
</tr>
</tbody>
</table>
<p>Let’s focus first on interpreting the interaction terms between <code>hx_depress</code> and <code>activity</code>.</p>
<p>Assume first that we have a set of subjects with the same values of <code>age_imp</code>, <code>smoke100</code>, <code>bmi</code>, and <code>comor</code>.</p>
<ul>
<li>Arnold has <code>hx_depress</code> = 1 and is Inactive</li>
<li>Betty has <code>hx_depress</code> = 1 and is Insufficiently Active</li>
<li>Carlos has <code>hx_depress</code> = 1 and is Active</li>
<li>Debbie has <code>hx_depress</code> = 1 and is Highly Active</li>
<li>Eamon has <code>hx_depress</code> = 0 and is Inactive</li>
<li>Florence has <code>hx_depress</code> = 0 and is Insufficiently Active</li>
<li>Garry has <code>hx_depress</code> = 0 and is Active</li>
<li>Harry has <code>hx_depress</code> = 0 and is Highly Active</li>
</ul>
<p>So the model, essentially can be used to compare each of the first seven people on that list to Harry (who has the reference levels of both <code>hx_depress</code> and <code>activity</code>.) Let’s compare Arnold to Harry.</p>
<p>For instance, as compared to Harry, Arnold is expected to have a transformed outcome (specifically the natural logarithm of (his <code>physhealth</code> days + 1)) that is:</p>
<ul>
<li>0.647 higher because Arnold’s <code>hx_depress</code> = 1, and</li>
<li>0.29 higher still because Arnold’s <code>activity</code> is “Inactive,” and</li>
<li>0.173 lower because of the combination (see the `hx_depress:activityInactive" row)</li>
</ul>
<p>So, in total, we expect Arnold’s transformed outcome to be 0.647 + 0.29 + (-0.173), or 0.764 higher than Harry’s.</p>
<p>If we want to compare Arnold to, for instance, Betty, we first calculate Betty’s difference from Harry, and then compare the two differences.</p>
<p>As compared to Harry, Betty is expected to have a transformed outcome (specifically the natural logarithm of (her <code>physhealth</code> days + 1)) that is:</p>
<ul>
<li>0.647 higher because Betty’s <code>hx_depress</code> = 1, and</li>
<li>0.006 lower still because Betty’s <code>activity</code> is “Insufficiently Active,” and</li>
<li>0.376 lower because of the combination (see the `hx_depress:activityInsufficiently_Active" row)</li>
</ul>
<p>So, in total, we expect Betty’s transformed outcome to be 0.647 + (-0.006) + (-0.376), or 0.265 higher than Harry’s.</p>
<p>And thus we can compare Betty and Arnold directly.</p>
<ul>
<li>Arnold is predicted to have an outcome that is 0.764 higher than Harry’s.</li>
<li>Betty is predicted to have an outcome that is 0.265 higher than Harry’s.</li>
<li>And so Arnold’s predicted outcome (<code>phys_tr</code>) is 0.499 larger than Betty’s.</li>
</ul>
<p>Now, suppose we want to look at our cubic polynomial in <code>comor</code>.</p>
<ul>
<li>Suppose Harry and Sally have the same values for all other predictors in the model, but Harry has 1 comorbidity where Sally has none. Then the three terms in the model related to <code>comor</code> will be 1 for Harry and 0 for Sally, and the interpretation becomes pretty straightforward.</li>
<li>But suppose instead that nothing has changed except Harry has 2 comorbidities and Sally has just 1. The size of the impact of this Harry - Sally difference is far larger in this situation, because the <code>comor</code> variable enters the model in a non-linear way. This is an area where fitting the model using <code>ols</code> can be helpful because of the ability to generate plots (of effects, nomograms, etc.) that can show this non-linearity in a clear way.</li>
</ul>
<p>Suppose for instance, that Harry and Sally share the following values for the other predictors: each is age 40, has never smoked, has no history of depression, a BMI of 30 and is Highly Active.</p>
<ul>
<li>Now, if Harry has 1 comorbidity and Sally has none, the predicted <code>phys_tr</code> values for Harry and Sally are as indicated below.</li>
</ul>
<div class="sourceCode" id="cb918"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb918-1"><a href="multiple-imputation-and-linear-regression.html#cb918-1" aria-hidden="true" tabindex="-1"></a>hands1 <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb918-2"><a href="multiple-imputation-and-linear-regression.html#cb918-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="fu">c</span>(<span class="st">&quot;Harry&quot;</span>, <span class="st">&quot;Sally&quot;</span>),</span>
<span id="cb918-3"><a href="multiple-imputation-and-linear-regression.html#cb918-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">age_imp =</span> <span class="fu">c</span>(<span class="dv">40</span>, <span class="dv">40</span>),</span>
<span id="cb918-4"><a href="multiple-imputation-and-linear-regression.html#cb918-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">comor =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb918-5"><a href="multiple-imputation-and-linear-regression.html#cb918-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">smoke100 =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb918-6"><a href="multiple-imputation-and-linear-regression.html#cb918-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">hx_depress =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb918-7"><a href="multiple-imputation-and-linear-regression.html#cb918-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">bmi =</span> <span class="fu">c</span>(<span class="dv">30</span>, <span class="dv">30</span>),</span>
<span id="cb918-8"><a href="multiple-imputation-and-linear-regression.html#cb918-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">activity =</span> <span class="fu">c</span>(<span class="st">&quot;Highly_Active&quot;</span>, <span class="st">&quot;Highly_Active&quot;</span>)</span>
<span id="cb918-9"><a href="multiple-imputation-and-linear-regression.html#cb918-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb918-10"><a href="multiple-imputation-and-linear-regression.html#cb918-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb918-11"><a href="multiple-imputation-and-linear-regression.html#cb918-11" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(m_2cc, <span class="at">newdata =</span> hands1)</span></code></pre></div>
<pre><code>        1         2 
1.1630840 0.6469282 </code></pre>
<p>But if Harry has 2 comorbidities and Sally 1, the predictions are:</p>
<div class="sourceCode" id="cb920"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb920-1"><a href="multiple-imputation-and-linear-regression.html#cb920-1" aria-hidden="true" tabindex="-1"></a>hands2 <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb920-2"><a href="multiple-imputation-and-linear-regression.html#cb920-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="fu">c</span>(<span class="st">&quot;Harry&quot;</span>, <span class="st">&quot;Sally&quot;</span>),</span>
<span id="cb920-3"><a href="multiple-imputation-and-linear-regression.html#cb920-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">age_imp =</span> <span class="fu">c</span>(<span class="dv">40</span>, <span class="dv">40</span>),</span>
<span id="cb920-4"><a href="multiple-imputation-and-linear-regression.html#cb920-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">comor =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">1</span>), <span class="co"># only thing that changes</span></span>
<span id="cb920-5"><a href="multiple-imputation-and-linear-regression.html#cb920-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">smoke100 =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb920-6"><a href="multiple-imputation-and-linear-regression.html#cb920-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">hx_depress =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb920-7"><a href="multiple-imputation-and-linear-regression.html#cb920-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">bmi =</span> <span class="fu">c</span>(<span class="dv">30</span>, <span class="dv">30</span>),</span>
<span id="cb920-8"><a href="multiple-imputation-and-linear-regression.html#cb920-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">activity =</span> <span class="fu">c</span>(<span class="st">&quot;Highly_Active&quot;</span>, <span class="st">&quot;Highly_Active&quot;</span>)</span>
<span id="cb920-9"><a href="multiple-imputation-and-linear-regression.html#cb920-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb920-10"><a href="multiple-imputation-and-linear-regression.html#cb920-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb920-11"><a href="multiple-imputation-and-linear-regression.html#cb920-11" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(m_2cc, <span class="at">newdata =</span> hands2)</span></code></pre></div>
<pre><code>       1        2 
1.493035 1.163084 </code></pre>
<p>Note that the difference in predictions between Harry and Sally is much smaller now than it was previously.</p>
</div>
<div id="making-predictions-with-the-model-1" class="section level3" number="14.6.4">
<h3><span class="header-section-number">14.6.4</span> Making Predictions with the Model</h3>
<p>As before, we’ll use the new model to predict <code>physhealth</code> values for Sheena and Jacob.</p>
<ul>
<li>Sheena is age 50, has 2 comorbidities, has smoked 100 cigarettes in her life, has no history of depression, a BMI of 25, and is Highly Active.</li>
<li>Jacob is age 65, has 4 comorbidities, has never smoked, has a history of depression, a BMI of 32 and is Inactive.</li>
</ul>
<p>We’ll first build predictions for Sheena and Jacob (with 95% prediction intervals) for <code>phys_tr</code>.</p>
<div class="sourceCode" id="cb922"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb922-1"><a href="multiple-imputation-and-linear-regression.html#cb922-1" aria-hidden="true" tabindex="-1"></a>new2 <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb922-2"><a href="multiple-imputation-and-linear-regression.html#cb922-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="fu">c</span>(<span class="st">&quot;Sheena&quot;</span>, <span class="st">&quot;Jacob&quot;</span>),</span>
<span id="cb922-3"><a href="multiple-imputation-and-linear-regression.html#cb922-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">age_imp =</span> <span class="fu">c</span>(<span class="dv">50</span>, <span class="dv">65</span>),</span>
<span id="cb922-4"><a href="multiple-imputation-and-linear-regression.html#cb922-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">comor =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">4</span>),</span>
<span id="cb922-5"><a href="multiple-imputation-and-linear-regression.html#cb922-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">smoke100 =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb922-6"><a href="multiple-imputation-and-linear-regression.html#cb922-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">hx_depress =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb922-7"><a href="multiple-imputation-and-linear-regression.html#cb922-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">bmi =</span> <span class="fu">c</span>(<span class="dv">25</span>, <span class="dv">32</span>),</span>
<span id="cb922-8"><a href="multiple-imputation-and-linear-regression.html#cb922-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">activity =</span> <span class="fu">c</span>(<span class="st">&quot;Highly_Active&quot;</span>, <span class="st">&quot;Inactive&quot;</span>)</span>
<span id="cb922-9"><a href="multiple-imputation-and-linear-regression.html#cb922-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb922-10"><a href="multiple-imputation-and-linear-regression.html#cb922-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb922-11"><a href="multiple-imputation-and-linear-regression.html#cb922-11" aria-hidden="true" tabindex="-1"></a>preds_m_2cc <span class="ot">&lt;-</span> <span class="fu">predict</span>(m_2cc, <span class="at">newdata =</span> new2, </span>
<span id="cb922-12"><a href="multiple-imputation-and-linear-regression.html#cb922-12" aria-hidden="true" tabindex="-1"></a>                       <span class="at">interval =</span> <span class="st">&quot;prediction&quot;</span>)</span>
<span id="cb922-13"><a href="multiple-imputation-and-linear-regression.html#cb922-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb922-14"><a href="multiple-imputation-and-linear-regression.html#cb922-14" aria-hidden="true" tabindex="-1"></a>preds_m_2cc</span></code></pre></div>
<pre><code>       fit         lwr      upr
1 1.425362 -1.14707613 3.997801
2 2.486907 -0.08635658 5.060171</code></pre>
<p>Now, we need to back-transform the predictions and the confidence intervals that describe <code>phys_tr</code> to build predictions for <code>physhealth</code>.</p>
<div class="sourceCode" id="cb924"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb924-1"><a href="multiple-imputation-and-linear-regression.html#cb924-1" aria-hidden="true" tabindex="-1"></a>preds_m_2cc <span class="ot">&lt;-</span> preds_m_2cc <span class="sc">%&gt;%</span></span>
<span id="cb924-2"><a href="multiple-imputation-and-linear-regression.html#cb924-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tbl_df</span>() <span class="sc">%&gt;%</span></span>
<span id="cb924-3"><a href="multiple-imputation-and-linear-regression.html#cb924-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">names =</span> <span class="fu">c</span>(<span class="st">&quot;Sheena&quot;</span>, <span class="st">&quot;Jacob&quot;</span>),</span>
<span id="cb924-4"><a href="multiple-imputation-and-linear-regression.html#cb924-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">pred_physhealth =</span> <span class="fu">exp</span>(fit) <span class="sc">-</span> <span class="dv">1</span>,</span>
<span id="cb924-5"><a href="multiple-imputation-and-linear-regression.html#cb924-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">conf_low =</span> <span class="fu">exp</span>(lwr) <span class="sc">-</span> <span class="dv">1</span>,</span>
<span id="cb924-6"><a href="multiple-imputation-and-linear-regression.html#cb924-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">conf_high =</span> <span class="fu">exp</span>(upr) <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb924-7"><a href="multiple-imputation-and-linear-regression.html#cb924-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(names, pred_physhealth, conf_low, conf_high, </span>
<span id="cb924-8"><a href="multiple-imputation-and-linear-regression.html#cb924-8" aria-hidden="true" tabindex="-1"></a>           <span class="fu">everything</span>())</span>
<span id="cb924-9"><a href="multiple-imputation-and-linear-regression.html#cb924-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb924-10"><a href="multiple-imputation-and-linear-regression.html#cb924-10" aria-hidden="true" tabindex="-1"></a>preds_m_2cc <span class="sc">%&gt;%</span> <span class="fu">kable</span>(<span class="at">digits =</span> <span class="dv">3</span>)</span></code></pre></div>
<table>
<thead>
<tr>
<th style="text-align:left;">
names
</th>
<th style="text-align:right;">
pred_physhealth
</th>
<th style="text-align:right;">
conf_low
</th>
<th style="text-align:right;">
conf_high
</th>
<th style="text-align:right;">
fit
</th>
<th style="text-align:right;">
lwr
</th>
<th style="text-align:right;">
upr
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Sheena
</td>
<td style="text-align:right;">
3.159
</td>
<td style="text-align:right;">
-0.682
</td>
<td style="text-align:right;">
53.478
</td>
<td style="text-align:right;">
1.425
</td>
<td style="text-align:right;">
-1.147
</td>
<td style="text-align:right;">
3.998
</td>
</tr>
<tr>
<td style="text-align:left;">
Jacob
</td>
<td style="text-align:right;">
11.024
</td>
<td style="text-align:right;">
-0.083
</td>
<td style="text-align:right;">
156.617
</td>
<td style="text-align:right;">
2.487
</td>
<td style="text-align:right;">
-0.086
</td>
<td style="text-align:right;">
5.060
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="using-mice-to-perform-multiple-imputation" class="section level2" number="14.7">
<h2><span class="header-section-number">14.7</span> Using <code>mice</code> to perform Multiple Imputation</h2>
<p>Let’s focus on the main effects model, and look at the impact of performing multiple imputation to account for the missing data. Recall that in our <code>smart_16</code> data, the most “missingness” is shown in the <code>activity</code> variable, which is still missing less than 10% of the time. So we’ll try a set of 10 imputations, using the default settings in the <code>mice</code> package.</p>
<div class="sourceCode" id="cb925"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb925-1"><a href="multiple-imputation-and-linear-regression.html#cb925-1" aria-hidden="true" tabindex="-1"></a><span class="co"># requires library(mice)</span></span>
<span id="cb925-2"><a href="multiple-imputation-and-linear-regression.html#cb925-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb925-3"><a href="multiple-imputation-and-linear-regression.html#cb925-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">432</span>)</span>
<span id="cb925-4"><a href="multiple-imputation-and-linear-regression.html#cb925-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb925-5"><a href="multiple-imputation-and-linear-regression.html#cb925-5" aria-hidden="true" tabindex="-1"></a><span class="co"># create small data set including only variables to</span></span>
<span id="cb925-6"><a href="multiple-imputation-and-linear-regression.html#cb925-6" aria-hidden="true" tabindex="-1"></a><span class="co"># be used in building the imputation model</span></span>
<span id="cb925-7"><a href="multiple-imputation-and-linear-regression.html#cb925-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb925-8"><a href="multiple-imputation-and-linear-regression.html#cb925-8" aria-hidden="true" tabindex="-1"></a>sm16 <span class="ot">&lt;-</span> smart_16 <span class="sc">%&gt;%</span> </span>
<span id="cb925-9"><a href="multiple-imputation-and-linear-regression.html#cb925-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(physhealth, phys_tr, activity, age_imp, bmi, comor, </span>
<span id="cb925-10"><a href="multiple-imputation-and-linear-regression.html#cb925-10" aria-hidden="true" tabindex="-1"></a>           hx_depress, smoke100)</span>
<span id="cb925-11"><a href="multiple-imputation-and-linear-regression.html#cb925-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb925-12"><a href="multiple-imputation-and-linear-regression.html#cb925-12" aria-hidden="true" tabindex="-1"></a>smart_16_mice10 <span class="ot">&lt;-</span> <span class="fu">mice</span>(sm16, <span class="at">m =</span> <span class="dv">10</span>)</span></code></pre></div>
<pre><code>
 iter imp variable
  1   1  activity  age_imp  bmi  comor  hx_depress  smoke100
  1   2  activity  age_imp  bmi  comor  hx_depress  smoke100
  1   3  activity  age_imp  bmi  comor  hx_depress  smoke100
  1   4  activity  age_imp  bmi  comor  hx_depress  smoke100
  1   5  activity  age_imp  bmi  comor  hx_depress  smoke100
  1   6  activity  age_imp  bmi  comor  hx_depress  smoke100
  1   7  activity  age_imp  bmi  comor  hx_depress  smoke100
  1   8  activity  age_imp  bmi  comor  hx_depress  smoke100
  1   9  activity  age_imp  bmi  comor  hx_depress  smoke100
  1   10  activity  age_imp  bmi  comor  hx_depress  smoke100
  2   1  activity  age_imp  bmi  comor  hx_depress  smoke100
  2   2  activity  age_imp  bmi  comor  hx_depress  smoke100
  2   3  activity  age_imp  bmi  comor  hx_depress  smoke100
  2   4  activity  age_imp  bmi  comor  hx_depress  smoke100
  2   5  activity  age_imp  bmi  comor  hx_depress  smoke100
  2   6  activity  age_imp  bmi  comor  hx_depress  smoke100
  2   7  activity  age_imp  bmi  comor  hx_depress  smoke100
  2   8  activity  age_imp  bmi  comor  hx_depress  smoke100
  2   9  activity  age_imp  bmi  comor  hx_depress  smoke100
  2   10  activity  age_imp  bmi  comor  hx_depress  smoke100
  3   1  activity  age_imp  bmi  comor  hx_depress  smoke100
  3   2  activity  age_imp  bmi  comor  hx_depress  smoke100
  3   3  activity  age_imp  bmi  comor  hx_depress  smoke100
  3   4  activity  age_imp  bmi  comor  hx_depress  smoke100
  3   5  activity  age_imp  bmi  comor  hx_depress  smoke100
  3   6  activity  age_imp  bmi  comor  hx_depress  smoke100
  3   7  activity  age_imp  bmi  comor  hx_depress  smoke100
  3   8  activity  age_imp  bmi  comor  hx_depress  smoke100
  3   9  activity  age_imp  bmi  comor  hx_depress  smoke100
  3   10  activity  age_imp  bmi  comor  hx_depress  smoke100
  4   1  activity  age_imp  bmi  comor  hx_depress  smoke100
  4   2  activity  age_imp  bmi  comor  hx_depress  smoke100
  4   3  activity  age_imp  bmi  comor  hx_depress  smoke100
  4   4  activity  age_imp  bmi  comor  hx_depress  smoke100
  4   5  activity  age_imp  bmi  comor  hx_depress  smoke100
  4   6  activity  age_imp  bmi  comor  hx_depress  smoke100
  4   7  activity  age_imp  bmi  comor  hx_depress  smoke100
  4   8  activity  age_imp  bmi  comor  hx_depress  smoke100
  4   9  activity  age_imp  bmi  comor  hx_depress  smoke100
  4   10  activity  age_imp  bmi  comor  hx_depress  smoke100
  5   1  activity  age_imp  bmi  comor  hx_depress  smoke100
  5   2  activity  age_imp  bmi  comor  hx_depress  smoke100
  5   3  activity  age_imp  bmi  comor  hx_depress  smoke100
  5   4  activity  age_imp  bmi  comor  hx_depress  smoke100
  5   5  activity  age_imp  bmi  comor  hx_depress  smoke100
  5   6  activity  age_imp  bmi  comor  hx_depress  smoke100
  5   7  activity  age_imp  bmi  comor  hx_depress  smoke100
  5   8  activity  age_imp  bmi  comor  hx_depress  smoke100
  5   9  activity  age_imp  bmi  comor  hx_depress  smoke100
  5   10  activity  age_imp  bmi  comor  hx_depress  smoke100</code></pre>
<div class="sourceCode" id="cb927"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb927-1"><a href="multiple-imputation-and-linear-regression.html#cb927-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(smart_16_mice10)</span></code></pre></div>
<pre><code>Class: mids
Number of multiple imputations:  10 
Imputation methods:
physhealth    phys_tr   activity    age_imp        bmi      comor hx_depress 
        &quot;&quot;         &quot;&quot;  &quot;polyreg&quot;      &quot;pmm&quot;      &quot;pmm&quot;      &quot;pmm&quot;      &quot;pmm&quot; 
  smoke100 
     &quot;pmm&quot; 
PredictorMatrix:
           physhealth phys_tr activity age_imp bmi comor hx_depress smoke100
physhealth          0       1        1       1   1     1          1        1
phys_tr             1       0        1       1   1     1          1        1
activity            1       1        0       1   1     1          1        1
age_imp             1       1        1       0   1     1          1        1
bmi                 1       1        1       1   0     1          1        1
comor               1       1        1       1   1     0          1        1</code></pre>
</div>
<div id="running-the-linear-regression-in-lm-with-multiple-imputation" class="section level2" number="14.8">
<h2><span class="header-section-number">14.8</span> Running the Linear Regression in <code>lm</code> with Multiple Imputation</h2>
<p>Next, we’ll run the linear model (main effects) on each of the 10 imputed data sets.</p>
<div class="sourceCode" id="cb929"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb929-1"><a href="multiple-imputation-and-linear-regression.html#cb929-1" aria-hidden="true" tabindex="-1"></a>m10_mods <span class="ot">&lt;-</span> </span>
<span id="cb929-2"><a href="multiple-imputation-and-linear-regression.html#cb929-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">with</span>(smart_16_mice10, <span class="fu">lm</span>(phys_tr <span class="sc">~</span> age_imp <span class="sc">+</span> comor <span class="sc">+</span> </span>
<span id="cb929-3"><a href="multiple-imputation-and-linear-regression.html#cb929-3" aria-hidden="true" tabindex="-1"></a>                                 smoke100 <span class="sc">+</span> hx_depress <span class="sc">+</span> </span>
<span id="cb929-4"><a href="multiple-imputation-and-linear-regression.html#cb929-4" aria-hidden="true" tabindex="-1"></a>                                 bmi <span class="sc">+</span> activity))</span>
<span id="cb929-5"><a href="multiple-imputation-and-linear-regression.html#cb929-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb929-6"><a href="multiple-imputation-and-linear-regression.html#cb929-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m10_mods)</span></code></pre></div>
<pre><code># A tibble: 90 x 6
   term                          estimate std.error statistic  p.value  nobs
   &lt;chr&gt;                            &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt; &lt;int&gt;
 1 (Intercept)                    0.317     0.326       0.971 3.32e- 1  1057
 2 age_imp                       -0.00489   0.00334    -1.47  1.43e- 1  1057
 3 comor                          0.313     0.0295     10.6   4.72e-25  1057
 4 smoke100                       0.135     0.0799      1.69  9.22e- 2  1057
 5 hx_depress                     0.500     0.0929      5.38  9.14e- 8  1057
 6 bmi                            0.0187    0.00564     3.31  9.64e- 4  1057
 7 activityActive                -0.202     0.138      -1.46  1.44e- 1  1057
 8 activityInsufficiently_Active -0.0695    0.124      -0.561 5.75e- 1  1057
 9 activityInactive               0.262     0.103       2.54  1.11e- 2  1057
10 (Intercept)                    0.363     0.332       1.10  2.74e- 1  1057
# ... with 80 more rows</code></pre>
<p>Then, we’ll pool results across the 10 imputations</p>
<div class="sourceCode" id="cb931"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb931-1"><a href="multiple-imputation-and-linear-regression.html#cb931-1" aria-hidden="true" tabindex="-1"></a>m10_pool <span class="ot">&lt;-</span> <span class="fu">pool</span>(m10_mods)</span>
<span id="cb931-2"><a href="multiple-imputation-and-linear-regression.html#cb931-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m10_pool, <span class="at">conf.int =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb931-3"><a href="multiple-imputation-and-linear-regression.html#cb931-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="sc">-</span>statistic, <span class="sc">-</span>df) <span class="sc">%&gt;%</span></span>
<span id="cb931-4"><a href="multiple-imputation-and-linear-regression.html#cb931-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">kable</span>(<span class="at">digits =</span> <span class="dv">3</span>)</span></code></pre></div>
<table>
<thead>
<tr>
<th style="text-align:left;">
term
</th>
<th style="text-align:right;">
estimate
</th>
<th style="text-align:right;">
std.error
</th>
<th style="text-align:right;">
p.value
</th>
<th style="text-align:right;">
2.5 %
</th>
<th style="text-align:right;">
97.5 %
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
(Intercept)
</td>
<td style="text-align:right;">
0.444
</td>
<td style="text-align:right;">
0.342
</td>
<td style="text-align:right;">
0.194
</td>
<td style="text-align:right;">
-0.227
</td>
<td style="text-align:right;">
1.114
</td>
</tr>
<tr>
<td style="text-align:left;">
age_imp
</td>
<td style="text-align:right;">
-0.005
</td>
<td style="text-align:right;">
0.003
</td>
<td style="text-align:right;">
0.128
</td>
<td style="text-align:right;">
-0.012
</td>
<td style="text-align:right;">
0.002
</td>
</tr>
<tr>
<td style="text-align:left;">
comor
</td>
<td style="text-align:right;">
0.309
</td>
<td style="text-align:right;">
0.031
</td>
<td style="text-align:right;">
0.000
</td>
<td style="text-align:right;">
0.249
</td>
<td style="text-align:right;">
0.369
</td>
</tr>
<tr>
<td style="text-align:left;">
smoke100
</td>
<td style="text-align:right;">
0.114
</td>
<td style="text-align:right;">
0.083
</td>
<td style="text-align:right;">
0.171
</td>
<td style="text-align:right;">
-0.049
</td>
<td style="text-align:right;">
0.278
</td>
</tr>
<tr>
<td style="text-align:left;">
hx_depress
</td>
<td style="text-align:right;">
0.512
</td>
<td style="text-align:right;">
0.094
</td>
<td style="text-align:right;">
0.000
</td>
<td style="text-align:right;">
0.327
</td>
<td style="text-align:right;">
0.696
</td>
</tr>
<tr>
<td style="text-align:left;">
bmi
</td>
<td style="text-align:right;">
0.016
</td>
<td style="text-align:right;">
0.006
</td>
<td style="text-align:right;">
0.009
</td>
<td style="text-align:right;">
0.004
</td>
<td style="text-align:right;">
0.027
</td>
</tr>
<tr>
<td style="text-align:left;">
activityActive
</td>
<td style="text-align:right;">
-0.204
</td>
<td style="text-align:right;">
0.140
</td>
<td style="text-align:right;">
0.146
</td>
<td style="text-align:right;">
-0.479
</td>
<td style="text-align:right;">
0.071
</td>
</tr>
<tr>
<td style="text-align:left;">
activityInsufficiently_Active
</td>
<td style="text-align:right;">
-0.044
</td>
<td style="text-align:right;">
0.129
</td>
<td style="text-align:right;">
0.735
</td>
<td style="text-align:right;">
-0.298
</td>
<td style="text-align:right;">
0.210
</td>
</tr>
<tr>
<td style="text-align:left;">
activityInactive
</td>
<td style="text-align:right;">
0.260
</td>
<td style="text-align:right;">
0.106
</td>
<td style="text-align:right;">
0.014
</td>
<td style="text-align:right;">
0.052
</td>
<td style="text-align:right;">
0.469
</td>
</tr>
</tbody>
</table>
<p>And we can compare these results to the complete case analysis we completed earlier.</p>
<div class="sourceCode" id="cb932"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb932-1"><a href="multiple-imputation-and-linear-regression.html#cb932-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(m_1cc, <span class="at">conf.int =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb932-2"><a href="multiple-imputation-and-linear-regression.html#cb932-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(term, estimate, std.error, p.value, conf.low, conf.high) <span class="sc">%&gt;%</span></span>
<span id="cb932-3"><a href="multiple-imputation-and-linear-regression.html#cb932-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">kable</span>(<span class="at">digits =</span> <span class="dv">3</span>)</span></code></pre></div>
<table>
<thead>
<tr>
<th style="text-align:left;">
term
</th>
<th style="text-align:right;">
estimate
</th>
<th style="text-align:right;">
std.error
</th>
<th style="text-align:right;">
p.value
</th>
<th style="text-align:right;">
conf.low
</th>
<th style="text-align:right;">
conf.high
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
(Intercept)
</td>
<td style="text-align:right;">
0.582
</td>
<td style="text-align:right;">
0.371
</td>
<td style="text-align:right;">
0.117
</td>
<td style="text-align:right;">
-0.146
</td>
<td style="text-align:right;">
1.310
</td>
</tr>
<tr>
<td style="text-align:left;">
age_imp
</td>
<td style="text-align:right;">
-0.007
</td>
<td style="text-align:right;">
0.004
</td>
<td style="text-align:right;">
0.065
</td>
<td style="text-align:right;">
-0.015
</td>
<td style="text-align:right;">
0.000
</td>
</tr>
<tr>
<td style="text-align:left;">
comor
</td>
<td style="text-align:right;">
0.302
</td>
<td style="text-align:right;">
0.033
</td>
<td style="text-align:right;">
0.000
</td>
<td style="text-align:right;">
0.237
</td>
<td style="text-align:right;">
0.367
</td>
</tr>
<tr>
<td style="text-align:left;">
smoke100
</td>
<td style="text-align:right;">
0.099
</td>
<td style="text-align:right;">
0.090
</td>
<td style="text-align:right;">
0.273
</td>
<td style="text-align:right;">
-0.078
</td>
<td style="text-align:right;">
0.276
</td>
</tr>
<tr>
<td style="text-align:left;">
hx_depress
</td>
<td style="text-align:right;">
0.472
</td>
<td style="text-align:right;">
0.104
</td>
<td style="text-align:right;">
0.000
</td>
<td style="text-align:right;">
0.267
</td>
<td style="text-align:right;">
0.677
</td>
</tr>
<tr>
<td style="text-align:left;">
bmi
</td>
<td style="text-align:right;">
0.016
</td>
<td style="text-align:right;">
0.006
</td>
<td style="text-align:right;">
0.009
</td>
<td style="text-align:right;">
0.004
</td>
<td style="text-align:right;">
0.029
</td>
</tr>
<tr>
<td style="text-align:left;">
activityActive
</td>
<td style="text-align:right;">
-0.230
</td>
<td style="text-align:right;">
0.155
</td>
<td style="text-align:right;">
0.138
</td>
<td style="text-align:right;">
-0.534
</td>
<td style="text-align:right;">
0.074
</td>
</tr>
<tr>
<td style="text-align:left;">
activityInsufficiently_Active
</td>
<td style="text-align:right;">
-0.117
</td>
<td style="text-align:right;">
0.139
</td>
<td style="text-align:right;">
0.402
</td>
<td style="text-align:right;">
-0.391
</td>
<td style="text-align:right;">
0.157
</td>
</tr>
<tr>
<td style="text-align:left;">
activityInactive
</td>
<td style="text-align:right;">
0.256
</td>
<td style="text-align:right;">
0.115
</td>
<td style="text-align:right;">
0.027
</td>
<td style="text-align:right;">
0.030
</td>
<td style="text-align:right;">
0.482
</td>
</tr>
</tbody>
</table>
<p>Note that there are some sizeable differences here, although nothing enormous.</p>
<p>If we want the pooled <span class="math inline">\(R^2\)</span> or pooled adjusted <span class="math inline">\(R^2\)</span> after imputation, R will provide it (and a 95% confidence interval around the estimate) with …</p>
<div class="sourceCode" id="cb933"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb933-1"><a href="multiple-imputation-and-linear-regression.html#cb933-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pool.r.squared</span>(m10_mods)</span></code></pre></div>
<pre><code>          est     lo 95     hi 95 fmi
R^2 0.1912561 0.1482819 0.2369623 NaN</code></pre>
<div class="sourceCode" id="cb935"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb935-1"><a href="multiple-imputation-and-linear-regression.html#cb935-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pool.r.squared</span>(m10_mods, <span class="at">adjusted =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>              est     lo 95     hi 95 fmi
adj R^2 0.1850807 0.1425132 0.2305277 NaN</code></pre>
<p>We can see the fraction of missing information about each coefficient due to non-response (<code>fmi</code>) and other details with the following code…</p>
<div class="sourceCode" id="cb937"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb937-1"><a href="multiple-imputation-and-linear-regression.html#cb937-1" aria-hidden="true" tabindex="-1"></a>m10_pool</span></code></pre></div>
<pre><code>Class: mipo    m = 10 
                           term  m    estimate         ubar            b
1                   (Intercept) 10  0.44377168 1.078194e-01 8.002900e-03
2                       age_imp 10 -0.00522810 1.123668e-05 4.824290e-07
3                         comor 10  0.30871888 8.801039e-04 5.466082e-05
4                      smoke100 10  0.11415718 6.474388e-03 4.130673e-04
5                    hx_depress 10  0.51155722 8.669413e-03 1.582684e-04
6                           bmi 10  0.01576150 3.182381e-05 3.425191e-06
7                activityActive 10 -0.20412627 1.914250e-02 4.851040e-04
8 activityInsufficiently_Active 10 -0.04383739 1.565925e-02 9.855183e-04
9              activityInactive 10  0.26046070 1.069627e-02 5.023887e-04
             t dfcom       df        riv     lambda        fmi
1 1.166226e-01  1048 599.8172 0.08164758 0.07548446 0.07855177
2 1.176735e-05  1048 814.9042 0.04722675 0.04509697 0.04743197
3 9.402308e-04  1048 677.6361 0.06831796 0.06394909 0.06669961
4 6.928762e-03  1048 666.2487 0.07018023 0.06557795 0.06837041
5 8.843508e-03  1048 982.0512 0.02008154 0.01968621 0.02167660
6 3.559152e-05  1048 432.0874 0.11839279 0.10585976 0.10996992
7 1.967611e-02  1048 939.5064 0.02787591 0.02711992 0.02918437
8 1.674332e-02  1048 672.0473 0.06922874 0.06474643 0.06751736
9 1.124890e-02  1048 785.1905 0.05166545 0.04912727 0.05154007</code></pre>
</div>
<div id="fit-the-multiple-imputation-model-with-aregimpute" class="section level2" number="14.9">
<h2><span class="header-section-number">14.9</span> Fit the Multiple Imputation Model with <code>aregImpute</code></h2>
<p>Here, we’ll use <code>aregImpute</code> to deal with missing values through multiple imputation, and use the <code>ols</code> function in the <code>rms</code> package to fit the model.</p>
<p>The first step is to fit the multiple imputation model. We’ll use <code>n.impute</code> = 10 imputations, with <code>B</code> = 10 bootstrap samples for the preditive mean matching, and fit both linear models and models with restricted cubic splines with 3 knots (<code>nk = c(0, 3)</code>) allowing the target variable to have a non-linear transformation when <code>nk</code> is 3, via <code>tlinear = FALSE</code>.</p>
<div class="sourceCode" id="cb939"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb939-1"><a href="multiple-imputation-and-linear-regression.html#cb939-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">43201602</span>)</span>
<span id="cb939-2"><a href="multiple-imputation-and-linear-regression.html#cb939-2" aria-hidden="true" tabindex="-1"></a>dd <span class="ot">&lt;-</span> <span class="fu">datadist</span>(smart_16)</span>
<span id="cb939-3"><a href="multiple-imputation-and-linear-regression.html#cb939-3" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">datadist =</span> <span class="st">&quot;dd&quot;</span>)</span>
<span id="cb939-4"><a href="multiple-imputation-and-linear-regression.html#cb939-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb939-5"><a href="multiple-imputation-and-linear-regression.html#cb939-5" aria-hidden="true" tabindex="-1"></a>fit16_imp <span class="ot">&lt;-</span> </span>
<span id="cb939-6"><a href="multiple-imputation-and-linear-regression.html#cb939-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aregImpute</span>(<span class="sc">~</span> phys_tr <span class="sc">+</span> age_imp <span class="sc">+</span> comor <span class="sc">+</span> smoke100 <span class="sc">+</span> </span>
<span id="cb939-7"><a href="multiple-imputation-and-linear-regression.html#cb939-7" aria-hidden="true" tabindex="-1"></a>                   hx_depress <span class="sc">+</span> bmi <span class="sc">+</span> activity,</span>
<span id="cb939-8"><a href="multiple-imputation-and-linear-regression.html#cb939-8" aria-hidden="true" tabindex="-1"></a>               <span class="at">nk =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">3</span>), <span class="at">tlinear =</span> <span class="cn">FALSE</span>, </span>
<span id="cb939-9"><a href="multiple-imputation-and-linear-regression.html#cb939-9" aria-hidden="true" tabindex="-1"></a>               <span class="at">data =</span> smart_16, <span class="at">B =</span> <span class="dv">10</span>, <span class="at">n.impute =</span> <span class="dv">10</span>)</span></code></pre></div>
<pre><code>Iteration 1 
Iteration 2 
Iteration 3 
Iteration 4 
Iteration 5 
Iteration 6 
Iteration 7 
Iteration 8 
Iteration 9 
Iteration 10 
Iteration 11 
Iteration 12 
Iteration 13 </code></pre>
<p>Here are the results of that imputation model.</p>
<div class="sourceCode" id="cb941"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb941-1"><a href="multiple-imputation-and-linear-regression.html#cb941-1" aria-hidden="true" tabindex="-1"></a>fit16_imp</span></code></pre></div>
<pre><code>
Multiple Imputation using Bootstrap and PMM

aregImpute(formula = ~phys_tr + age_imp + comor + smoke100 + 
    hx_depress + bmi + activity, data = smart_16, n.impute = 10, 
    nk = c(0, 3), tlinear = FALSE, B = 10)

n: 1057     p: 7    Imputations: 10     nk: 0 

Number of NAs:
   phys_tr    age_imp      comor   smoke100 hx_depress        bmi   activity 
         0         12         47         24          3         84         85 

           type d.f.
phys_tr       s    1
age_imp       s    1
comor         s    1
smoke100      l    1
hx_depress    l    1
bmi           s    1
activity      c    3

R-squares for Predicting Non-Missing Values for Each Variable
Using Last Imputations of Predictors
   age_imp      comor   smoke100 hx_depress        bmi   activity 
     0.224      0.206      0.059      0.167      0.169      0.057 

Resampling results for determining the complexity of imputation models

Variable being imputed: age_imp 
                                          nk=0   nk=3
Bootstrap bias-corrected R^2             0.186  0.215
10-fold cross-validated  R^2             0.211  0.215
Bootstrap bias-corrected mean   |error|  9.108 10.894
10-fold cross-validated  mean   |error| 65.169 10.919
Bootstrap bias-corrected median |error|  7.290  8.784
10-fold cross-validated  median |error| 66.006  8.613

Variable being imputed: comor 
                                         nk=0  nk=3
Bootstrap bias-corrected R^2            0.183 0.182
10-fold cross-validated  R^2            0.184 0.193
Bootstrap bias-corrected mean   |error| 0.987 1.184
10-fold cross-validated  mean   |error| 1.759 1.171
Bootstrap bias-corrected median |error| 0.828 0.910
10-fold cross-validated  median |error| 1.574 0.892

Variable being imputed: smoke100 
                                          nk=0   nk=3
Bootstrap bias-corrected R^2            0.0224 0.0187
10-fold cross-validated  R^2            0.0358 0.0217
Bootstrap bias-corrected mean   |error| 0.4853 0.4866
10-fold cross-validated  mean   |error| 0.9462 0.9561
Bootstrap bias-corrected median |error| 0.4788 0.4772
10-fold cross-validated  median |error| 0.8479 0.8706

Variable being imputed: hx_depress 
                                         nk=0  nk=3
Bootstrap bias-corrected R^2            0.157 0.138
10-fold cross-validated  R^2            0.147 0.148
Bootstrap bias-corrected mean   |error| 0.355 0.360
10-fold cross-validated  mean   |error| 0.801 0.783
Bootstrap bias-corrected median |error| 0.333 0.337
10-fold cross-validated  median |error| 0.711 0.673

Variable being imputed: bmi 
                                          nk=0  nk=3
Bootstrap bias-corrected R^2             0.125 0.122
10-fold cross-validated  R^2             0.134 0.133
Bootstrap bias-corrected mean   |error|  5.221 6.822
10-fold cross-validated  mean   |error| 32.458 6.884
Bootstrap bias-corrected median |error|  4.178 5.782
10-fold cross-validated  median |error| 31.330 5.932

Variable being imputed: activity 
                                          nk=0   nk=3
Bootstrap bias-corrected R^2            0.0312 0.0275
10-fold cross-validated  R^2            0.0450 0.0402
Bootstrap bias-corrected mean   |error| 1.8774 1.8884
10-fold cross-validated  mean   |error| 1.1121 1.1043
Bootstrap bias-corrected median |error| 2.0000 2.0000
10-fold cross-validated  median |error| 1.0000 1.0000</code></pre>
<div class="sourceCode" id="cb943"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb943-1"><a href="multiple-imputation-and-linear-regression.html#cb943-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">2</span>))</span>
<span id="cb943-2"><a href="multiple-imputation-and-linear-regression.html#cb943-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fit16_imp)</span></code></pre></div>
<p><img src="432-notes_files/figure-html/unnamed-chunk-376-1.png" width="672" /></p>
<div class="sourceCode" id="cb944"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb944-1"><a href="multiple-imputation-and-linear-regression.html#cb944-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span></code></pre></div>
<p>The plot helps us see where the imputations are happening.</p>
</div>
<div id="fit-linear-regression-using-ols-and-fit.mult.impute" class="section level2" number="14.10">
<h2><span class="header-section-number">14.10</span> Fit Linear Regression using <code>ols</code> and <code>fit.mult.impute</code></h2>
<div class="sourceCode" id="cb945"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb945-1"><a href="multiple-imputation-and-linear-regression.html#cb945-1" aria-hidden="true" tabindex="-1"></a>m16_imp <span class="ot">&lt;-</span> </span>
<span id="cb945-2"><a href="multiple-imputation-and-linear-regression.html#cb945-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">fit.mult.impute</span>(phys_tr <span class="sc">~</span> age_imp <span class="sc">+</span> comor <span class="sc">+</span> smoke100 <span class="sc">+</span></span>
<span id="cb945-3"><a href="multiple-imputation-and-linear-regression.html#cb945-3" aria-hidden="true" tabindex="-1"></a>                        hx_depress <span class="sc">+</span> bmi <span class="sc">+</span> activity,</span>
<span id="cb945-4"><a href="multiple-imputation-and-linear-regression.html#cb945-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">fitter =</span> ols, <span class="at">xtrans =</span> fit16_imp,</span>
<span id="cb945-5"><a href="multiple-imputation-and-linear-regression.html#cb945-5" aria-hidden="true" tabindex="-1"></a>                    <span class="at">data =</span> smart_16, <span class="at">x =</span> <span class="cn">TRUE</span>, <span class="at">y =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>
Variance Inflation Factors Due to Imputation:

                     Intercept                        age_imp 
                          1.03                           1.01 
                         comor                       smoke100 
                          1.03                           1.06 
                    hx_depress                            bmi 
                          1.02                           1.06 
               activity=Active activity=Insufficiently_Active 
                          1.19                           1.14 
             activity=Inactive 
                          1.23 

Rate of Missing Information:

                     Intercept                        age_imp 
                          0.03                           0.01 
                         comor                       smoke100 
                          0.03                           0.06 
                    hx_depress                            bmi 
                          0.02                           0.06 
               activity=Active activity=Insufficiently_Active 
                          0.16                           0.13 
             activity=Inactive 
                          0.19 

d.f. for t-distribution for Tests of Single Coefficients:

                     Intercept                        age_imp 
                       8176.67                       45410.80 
                         comor                       smoke100 
                      13030.27                        2670.64 
                    hx_depress                            bmi 
                      28199.30                        2935.89 
               activity=Active activity=Insufficiently_Active 
                        354.62                         571.56 
             activity=Inactive 
                        258.42 

The following fit components were averaged over the 10 model fits:

  fitted.values stats linear.predictors </code></pre>
<div id="summaries-and-coefficients" class="section level3" number="14.10.1">
<h3><span class="header-section-number">14.10.1</span> Summaries and Coefficients</h3>
<p>Here are the results:</p>
<div class="sourceCode" id="cb947"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb947-1"><a href="multiple-imputation-and-linear-regression.html#cb947-1" aria-hidden="true" tabindex="-1"></a>m16_imp</span></code></pre></div>
<pre><code>Linear Regression Model
 
 fit.mult.impute(formula = phys_tr ~ age_imp + comor + smoke100 + 
     hx_depress + bmi + activity, fitter = ols, xtrans = fit16_imp, 
     data = smart_16, x = TRUE, y = TRUE)
 
                 Model Likelihood    Discrimination    
                       Ratio Test           Indexes    
 Obs    1057    LR chi2    219.94    R2       0.188    
 sigma1.2881    d.f.            8    R2 adj   0.182    
 d.f.   1048    Pr(&gt; chi2) 0.0000    g        0.687    
 
 Residuals
 
     Min      1Q  Median      3Q     Max 
 -3.0621 -1.0327 -0.2878  1.1104  2.8018 
 
 
                                Coef    S.E.   t     Pr(&gt;|t|)
 Intercept                       0.4052 0.3352  1.21 0.2271  
 age_imp                        -0.0049 0.0034 -1.46 0.1437  
 comor                           0.3078 0.0302 10.20 &lt;0.0001 
 smoke100                        0.1259 0.0830  1.52 0.1296  
 hx_depress                      0.5120 0.0940  5.45 &lt;0.0001 
 bmi                             0.0164 0.0058  2.83 0.0048  
 activity=Active                -0.1773 0.1513 -1.17 0.2416  
 activity=Insufficiently_Active -0.0396 0.1342 -0.30 0.7680  
 activity=Inactive               0.2401 0.1144  2.10 0.0360  
 </code></pre>
</div>
<div id="effect-sizes" class="section level3" number="14.10.2">
<h3><span class="header-section-number">14.10.2</span> Effect Sizes</h3>
<p>We can plot and summarize the effect sizes using the usual <code>ols</code> tools:</p>
<div class="sourceCode" id="cb949"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb949-1"><a href="multiple-imputation-and-linear-regression.html#cb949-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m16_imp)</span></code></pre></div>
<pre><code>             Effects              Response : phys_tr 

 Factor                                    Low   High  Diff. Effect    S.E.    
 age_imp                                   57.00 73.00 16.00 -0.079163 0.054107
 comor                                      1.00  2.00  1.00  0.307790 0.030171
 smoke100                                   0.00  1.00  1.00  0.125890 0.083000
 hx_depress                                 0.00  1.00  1.00  0.511980 0.094007
 bmi                                       27.29 36.65  9.36  0.153530 0.054322
 activity - Highly_Active:Inactive          4.00  1.00    NA -0.240070 0.114350
 activity - Active:Inactive                 4.00  2.00    NA -0.417320 0.137640
 activity - Insufficiently_Active:Inactive  4.00  3.00    NA -0.279650 0.115000
 Lower 0.95 Upper 0.95
 -0.185330   0.027008 
  0.248590   0.366990 
 -0.036973   0.288760 
  0.327520   0.696450 
  0.046932   0.260120 
 -0.464450  -0.015686 
 -0.687400  -0.147250 
 -0.505310  -0.054002 </code></pre>
<div class="sourceCode" id="cb951"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb951-1"><a href="multiple-imputation-and-linear-regression.html#cb951-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">summary</span>(m16_imp))</span></code></pre></div>
<p><img src="432-notes_files/figure-html/unnamed-chunk-379-1.png" width="672" /></p>
</div>
<div id="making-predictions-with-this-model" class="section level3" number="14.10.3">
<h3><span class="header-section-number">14.10.3</span> Making Predictions with this Model</h3>
<p>Once again, let’s make predictions for our two subjects, and use this model (and the ones that follow) to predict their <code>physhealth</code> values.</p>
<ul>
<li>Sheena is age 50, has 2 comorbidities, has smoked 100 cigarettes in her life, has no history of depression, a BMI of 25, and is Highly Active.</li>
<li>Jacob is age 65, has 4 comorbidities, has never smoked, has a history of depression, a BMI of 32 and is Inactive.</li>
</ul>
<div class="sourceCode" id="cb952"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb952-1"><a href="multiple-imputation-and-linear-regression.html#cb952-1" aria-hidden="true" tabindex="-1"></a>new2 <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb952-2"><a href="multiple-imputation-and-linear-regression.html#cb952-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="fu">c</span>(<span class="st">&quot;Sheena&quot;</span>, <span class="st">&quot;Jacob&quot;</span>),</span>
<span id="cb952-3"><a href="multiple-imputation-and-linear-regression.html#cb952-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">age_imp =</span> <span class="fu">c</span>(<span class="dv">50</span>, <span class="dv">65</span>),</span>
<span id="cb952-4"><a href="multiple-imputation-and-linear-regression.html#cb952-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">comor =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">4</span>),</span>
<span id="cb952-5"><a href="multiple-imputation-and-linear-regression.html#cb952-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">smoke100 =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb952-6"><a href="multiple-imputation-and-linear-regression.html#cb952-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">hx_depress =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb952-7"><a href="multiple-imputation-and-linear-regression.html#cb952-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">bmi =</span> <span class="fu">c</span>(<span class="dv">25</span>, <span class="dv">32</span>),</span>
<span id="cb952-8"><a href="multiple-imputation-and-linear-regression.html#cb952-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">activity =</span> <span class="fu">c</span>(<span class="st">&quot;Highly_Active&quot;</span>, <span class="st">&quot;Inactive&quot;</span>)</span>
<span id="cb952-9"><a href="multiple-imputation-and-linear-regression.html#cb952-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb952-10"><a href="multiple-imputation-and-linear-regression.html#cb952-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb952-11"><a href="multiple-imputation-and-linear-regression.html#cb952-11" aria-hidden="true" tabindex="-1"></a>preds_m_16imp <span class="ot">&lt;-</span> <span class="fu">predict</span>(m16_imp, </span>
<span id="cb952-12"><a href="multiple-imputation-and-linear-regression.html#cb952-12" aria-hidden="true" tabindex="-1"></a>                         <span class="at">newdata =</span> <span class="fu">data.frame</span>(new2))</span>
<span id="cb952-13"><a href="multiple-imputation-and-linear-regression.html#cb952-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb952-14"><a href="multiple-imputation-and-linear-regression.html#cb952-14" aria-hidden="true" tabindex="-1"></a>preds_m_16imp</span></code></pre></div>
<pre><code>       1        2 
1.309306 2.591649 </code></pre>
<div class="sourceCode" id="cb954"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb954-1"><a href="multiple-imputation-and-linear-regression.html#cb954-1" aria-hidden="true" tabindex="-1"></a>preds_m_16imp <span class="ot">&lt;-</span> preds_m_16imp <span class="sc">%&gt;%</span></span>
<span id="cb954-2"><a href="multiple-imputation-and-linear-regression.html#cb954-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tbl_df</span>() <span class="sc">%&gt;%</span></span>
<span id="cb954-3"><a href="multiple-imputation-and-linear-regression.html#cb954-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">names =</span> <span class="fu">c</span>(<span class="st">&quot;Sheena&quot;</span>, <span class="st">&quot;Jacob&quot;</span>),</span>
<span id="cb954-4"><a href="multiple-imputation-and-linear-regression.html#cb954-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">pred_physhealth =</span> <span class="fu">exp</span>(value) <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb954-5"><a href="multiple-imputation-and-linear-regression.html#cb954-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(names, pred_physhealth)</span>
<span id="cb954-6"><a href="multiple-imputation-and-linear-regression.html#cb954-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb954-7"><a href="multiple-imputation-and-linear-regression.html#cb954-7" aria-hidden="true" tabindex="-1"></a>preds_m_16imp <span class="sc">%&gt;%</span> <span class="fu">kable</span>(<span class="at">digits =</span> <span class="dv">3</span>)</span></code></pre></div>
<table>
<thead>
<tr>
<th style="text-align:left;">
names
</th>
<th style="text-align:right;">
pred_physhealth
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Sheena
</td>
<td style="text-align:right;">
2.704
</td>
</tr>
<tr>
<td style="text-align:left;">
Jacob
</td>
<td style="text-align:right;">
12.352
</td>
</tr>
</tbody>
</table>
</div>
<div id="nomogram" class="section level3" number="14.10.4">
<h3><span class="header-section-number">14.10.4</span> Nomogram</h3>
<p>We can also develop a nomogram, if we like. As a special touch, we’ll add a prediction at the bottom which back-transforms out of the predicted <code>phys_tr</code> back to the <code>physhealth</code> days.</p>
<div class="sourceCode" id="cb955"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb955-1"><a href="multiple-imputation-and-linear-regression.html#cb955-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">nomogram</span>(m16_imp, </span>
<span id="cb955-2"><a href="multiple-imputation-and-linear-regression.html#cb955-2" aria-hidden="true" tabindex="-1"></a>              <span class="at">fun =</span> <span class="fu">list</span>(<span class="cf">function</span>(x) <span class="fu">exp</span>(x) <span class="sc">-</span> <span class="dv">1</span>),</span>
<span id="cb955-3"><a href="multiple-imputation-and-linear-regression.html#cb955-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">funlabel =</span> <span class="st">&quot;Predicted physhealth days&quot;</span>,</span>
<span id="cb955-4"><a href="multiple-imputation-and-linear-regression.html#cb955-4" aria-hidden="true" tabindex="-1"></a>              <span class="at">fun.at =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">30</span>, <span class="dv">3</span>)))</span></code></pre></div>
<p><img src="432-notes_files/figure-html/unnamed-chunk-382-1.png" width="672" /></p>
<p>We can see the big role of <code>comor</code> and <code>hx_depress</code> in this model.</p>
</div>
<div id="validating-summary-statistics" class="section level3" number="14.10.5">
<h3><span class="header-section-number">14.10.5</span> Validating Summary Statistics</h3>
<p>We can cross-validate summary measures, like <span class="math inline">\(R^2\)</span>…</p>
<div class="sourceCode" id="cb956"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb956-1"><a href="multiple-imputation-and-linear-regression.html#cb956-1" aria-hidden="true" tabindex="-1"></a><span class="fu">validate</span>(m16_imp)</span></code></pre></div>
<pre><code>          index.orig training   test optimism index.corrected  n
R-square      0.1867   0.1984 0.1793   0.0192          0.1676 40
MSE           1.6472   1.6168 1.6623  -0.0455          1.6927 40
g             0.6876   0.7031 0.6749   0.0282          0.6594 40
Intercept     0.0000   0.0000 0.0677  -0.0677          0.0677 40
Slope         1.0000   1.0000 0.9636   0.0364          0.9636 40</code></pre>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="a-study-of-prostate-cancer.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="using-tidymodels-to-fit-linear-regressions.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["432-notes.pdf"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
