<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 19 Modeling a Count Outcome in Ohio SMART | Data Science for Biological, Medical and Health Research: Notes for 432</title>
  <meta name="description" content="Course Notes for PQHS 432 in Spring 2021." />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 19 Modeling a Count Outcome in Ohio SMART | Data Science for Biological, Medical and Health Research: Notes for 432" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Course Notes for PQHS 432 in Spring 2021." />
  <meta name="github-repo" content="thomaselove/432-notes" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 19 Modeling a Count Outcome in Ohio SMART | Data Science for Biological, Medical and Health Research: Notes for 432" />
  
  <meta name="twitter:description" content="Course Notes for PQHS 432 in Spring 2021." />
  

<meta name="author" content="Thomas E. Love, Ph.D." />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="colorectal-cancer-screening-and-some-special-cases.html"/>
<link rel="next" href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"/>
<script src="libs/header-attrs-2.6/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="" data-path="r-packages-used-in-these-notes.html"><a href="r-packages-used-in-these-notes.html"><i class="fa fa-check"></i>R Packages used in these notes</a>
<ul>
<li class="chapter" data-level="" data-path="r-packages-used-in-these-notes.html"><a href="r-packages-used-in-these-notes.html#dealing-with-conflicts"><i class="fa fa-check"></i>Dealing with Conflicts</a></li>
<li><a href="r-packages-used-in-these-notes.html#general-theme-for-ggplot-work">General Theme for <code>ggplot</code> work</a></li>
<li class="chapter" data-level="" data-path="r-packages-used-in-these-notes.html"><a href="r-packages-used-in-these-notes.html#data-used-in-these-notes"><i class="fa fa-check"></i>Data used in these notes</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="building-table-1.html"><a href="building-table-1.html"><i class="fa fa-check"></i><b>1</b> Building Table 1</a>
<ul>
<li class="chapter" data-level="1.1" data-path="building-table-1.html"><a href="building-table-1.html#data-load"><i class="fa fa-check"></i><b>1.1</b> Data load</a></li>
<li class="chapter" data-level="1.2" data-path="building-table-1.html"><a href="building-table-1.html#two-examples-from-the-new-england-journal-of-medicine"><i class="fa fa-check"></i><b>1.2</b> Two examples from the <em>New England Journal of Medicine</em></a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="building-table-1.html"><a href="building-table-1.html#a-simple-table-1"><i class="fa fa-check"></i><b>1.2.1</b> A simple Table 1</a></li>
<li class="chapter" data-level="1.2.2" data-path="building-table-1.html"><a href="building-table-1.html#a-group-comparison"><i class="fa fa-check"></i><b>1.2.2</b> A group comparison</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="building-table-1.html"><a href="building-table-1.html#the-mr-clean-trial"><i class="fa fa-check"></i><b>1.3</b> The MR CLEAN trial</a></li>
<li class="chapter" data-level="1.4" data-path="building-table-1.html"><a href="building-table-1.html#simulated-fakestroke-data"><i class="fa fa-check"></i><b>1.4</b> Simulated <code>fakestroke</code> data</a></li>
<li class="chapter" data-level="1.5" data-path="building-table-1.html"><a href="building-table-1.html#building-table-1-for-fakestroke-attempt-1"><i class="fa fa-check"></i><b>1.5</b> Building Table 1 for <code>fakestroke</code>: Attempt 1</a>
<ul>
<li class="chapter" data-level="1.5.1" data-path="building-table-1.html"><a href="building-table-1.html#some-of-this-is-very-useful-and-other-parts-need-to-be-fixed."><i class="fa fa-check"></i><b>1.5.1</b> Some of this is very useful, and other parts need to be fixed.</a></li>
<li class="chapter" data-level="1.5.2" data-path="building-table-1.html"><a href="building-table-1.html#fakestroke-cleaning-up-categorical-variables"><i class="fa fa-check"></i><b>1.5.2</b> <code>fakestroke</code> Cleaning Up Categorical Variables</a></li>
</ul></li>
<li class="chapter" data-level="1.6" data-path="building-table-1.html"><a href="building-table-1.html#fakestroke-table-1-attempt-2"><i class="fa fa-check"></i><b>1.6</b> <code>fakestroke</code> Table 1: Attempt 2</a>
<ul>
<li class="chapter" data-level="1.6.1" data-path="building-table-1.html"><a href="building-table-1.html#what-summaries-should-we-show"><i class="fa fa-check"></i><b>1.6.1</b> What summaries should we show?</a></li>
</ul></li>
<li class="chapter" data-level="1.7" data-path="building-table-1.html"><a href="building-table-1.html#obtaining-a-more-detailed-summary"><i class="fa fa-check"></i><b>1.7</b> Obtaining a more detailed Summary</a></li>
<li class="chapter" data-level="1.8" data-path="building-table-1.html"><a href="building-table-1.html#exporting-the-completed-table-1-from-r-to-excel-or-word"><i class="fa fa-check"></i><b>1.8</b> Exporting the Completed Table 1 from R to Excel or Word</a>
<ul>
<li class="chapter" data-level="1.8.1" data-path="building-table-1.html"><a href="building-table-1.html#approach-a-save-and-open-in-excel"><i class="fa fa-check"></i><b>1.8.1</b> Approach A: Save and open in Excel</a></li>
<li class="chapter" data-level="1.8.2" data-path="building-table-1.html"><a href="building-table-1.html#approach-b-produce-the-table-so-you-can-cut-and-paste-it"><i class="fa fa-check"></i><b>1.8.2</b> Approach B: Produce the Table so you can cut and paste it</a></li>
</ul></li>
<li class="chapter" data-level="1.9" data-path="building-table-1.html"><a href="building-table-1.html#a-controlled-biological-experiment---the-blood-brain-barrier"><i class="fa fa-check"></i><b>1.9</b> A Controlled Biological Experiment - The Blood-Brain Barrier</a></li>
<li class="chapter" data-level="1.10" data-path="building-table-1.html"><a href="building-table-1.html#the-bloodbrain.csv-file"><i class="fa fa-check"></i><b>1.10</b> The <code>bloodbrain.csv</code> file</a></li>
<li class="chapter" data-level="1.11" data-path="building-table-1.html"><a href="building-table-1.html#a-table-1-for-bloodbrain"><i class="fa fa-check"></i><b>1.11</b> A Table 1 for <code>bloodbrain</code></a>
<ul>
<li class="chapter" data-level="1.11.1" data-path="building-table-1.html"><a href="building-table-1.html#generate-final-table-1-for-bloodbrain"><i class="fa fa-check"></i><b>1.11.1</b> Generate final Table 1 for <code>bloodbrain</code></a></li>
<li class="chapter" data-level="1.11.2" data-path="building-table-1.html"><a href="building-table-1.html#a-more-finished-version-after-cleanup-in-word"><i class="fa fa-check"></i><b>1.11.2</b> A More Finished Version (after Cleanup in Word)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="brfss-smart-data-building.html"><a href="brfss-smart-data-building.html"><i class="fa fa-check"></i><b>2</b> BRFSS SMART Data Building</a>
<ul>
<li class="chapter" data-level="2.1" data-path="brfss-smart-data-building.html"><a href="brfss-smart-data-building.html#key-resources"><i class="fa fa-check"></i><b>2.1</b> Key resources</a></li>
<li class="chapter" data-level="2.2" data-path="brfss-smart-data-building.html"><a href="brfss-smart-data-building.html#ingesting-the-raw-data"><i class="fa fa-check"></i><b>2.2</b> Ingesting the Raw Data</a></li>
<li class="chapter" data-level="2.3" data-path="brfss-smart-data-building.html"><a href="brfss-smart-data-building.html#ingesting-from-our-csv-file"><i class="fa fa-check"></i><b>2.3</b> Ingesting from our CSV file</a></li>
<li class="chapter" data-level="2.4" data-path="brfss-smart-data-building.html"><a href="brfss-smart-data-building.html#what-does-the-raw-data-look-like"><i class="fa fa-check"></i><b>2.4</b> What does the raw data look like?</a></li>
<li class="chapter" data-level="2.5" data-path="brfss-smart-data-building.html"><a href="brfss-smart-data-building.html#cleaning-the-brfss-data"><i class="fa fa-check"></i><b>2.5</b> Cleaning the BRFSS Data</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="brfss-smart-data-building.html"><a href="brfss-smart-data-building.html#identifying-information"><i class="fa fa-check"></i><b>2.5.1</b> Identifying Information</a></li>
<li class="chapter" data-level="2.5.2" data-path="brfss-smart-data-building.html"><a href="brfss-smart-data-building.html#survey-method"><i class="fa fa-check"></i><b>2.5.2</b> Survey Method</a></li>
<li class="chapter" data-level="2.5.3" data-path="brfss-smart-data-building.html"><a href="brfss-smart-data-building.html#health-status-1-item"><i class="fa fa-check"></i><b>2.5.3</b> Health Status (1 item)</a></li>
<li class="chapter" data-level="2.5.4" data-path="brfss-smart-data-building.html"><a href="brfss-smart-data-building.html#healthy-days---health-related-quality-of-life-3-items"><i class="fa fa-check"></i><b>2.5.4</b> Healthy Days - Health-Related Quality of Life (3 items)</a></li>
<li class="chapter" data-level="2.5.5" data-path="brfss-smart-data-building.html"><a href="brfss-smart-data-building.html#health-care-access-4-items"><i class="fa fa-check"></i><b>2.5.5</b> Health Care Access (4 items)</a></li>
<li class="chapter" data-level="2.5.6" data-path="brfss-smart-data-building.html"><a href="brfss-smart-data-building.html#blood-pressure-2-measures"><i class="fa fa-check"></i><b>2.5.6</b> Blood Pressure (2 measures)</a></li>
<li class="chapter" data-level="2.5.7" data-path="brfss-smart-data-building.html"><a href="brfss-smart-data-building.html#cholesterol-3-items"><i class="fa fa-check"></i><b>2.5.7</b> Cholesterol (3 items)</a></li>
<li class="chapter" data-level="2.5.8" data-path="brfss-smart-data-building.html"><a href="brfss-smart-data-building.html#chronic-health-conditions-14-items"><i class="fa fa-check"></i><b>2.5.8</b> Chronic Health Conditions (14 items)</a></li>
<li class="chapter" data-level="2.5.9" data-path="brfss-smart-data-building.html"><a href="brfss-smart-data-building.html#arthritis-burden-4-items"><i class="fa fa-check"></i><b>2.5.9</b> Arthritis Burden (4 items)</a></li>
<li class="chapter" data-level="2.5.10" data-path="brfss-smart-data-building.html"><a href="brfss-smart-data-building.html#demographics-25-items"><i class="fa fa-check"></i><b>2.5.10</b> Demographics (25 items)</a></li>
<li class="chapter" data-level="2.5.11" data-path="brfss-smart-data-building.html"><a href="brfss-smart-data-building.html#tobacco-use-2-items"><i class="fa fa-check"></i><b>2.5.11</b> Tobacco Use (2 items)</a></li>
<li class="chapter" data-level="2.5.12" data-path="brfss-smart-data-building.html"><a href="brfss-smart-data-building.html#e-cigarettes-2-items"><i class="fa fa-check"></i><b>2.5.12</b> E-Cigarettes (2 items)</a></li>
<li class="chapter" data-level="2.5.13" data-path="brfss-smart-data-building.html"><a href="brfss-smart-data-building.html#alcohol-consumption-6-items"><i class="fa fa-check"></i><b>2.5.13</b> Alcohol Consumption (6 items)</a></li>
<li class="chapter" data-level="2.5.14" data-path="brfss-smart-data-building.html"><a href="brfss-smart-data-building.html#fruits-and-vegetables-8-items"><i class="fa fa-check"></i><b>2.5.14</b> Fruits and Vegetables (8 items)</a></li>
<li class="chapter" data-level="2.5.15" data-path="brfss-smart-data-building.html"><a href="brfss-smart-data-building.html#exercise-and-physical-activity-8-items"><i class="fa fa-check"></i><b>2.5.15</b> Exercise and Physical Activity (8 items)</a></li>
<li class="chapter" data-level="2.5.16" data-path="brfss-smart-data-building.html"><a href="brfss-smart-data-building.html#seatbelt-use-1-item"><i class="fa fa-check"></i><b>2.5.16</b> Seatbelt Use (1 item)</a></li>
<li class="chapter" data-level="2.5.17" data-path="brfss-smart-data-building.html"><a href="brfss-smart-data-building.html#immunization-3-items"><i class="fa fa-check"></i><b>2.5.17</b> Immunization (3 items)</a></li>
<li class="chapter" data-level="2.5.18" data-path="brfss-smart-data-building.html"><a href="brfss-smart-data-building.html#hivaids-2-items"><i class="fa fa-check"></i><b>2.5.18</b> HIV/AIDS (2 items)</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="brfss-smart-data-building.html"><a href="brfss-smart-data-building.html#imputing-age-and-income-as-quantitative-from-thin-air"><i class="fa fa-check"></i><b>2.6</b> Imputing Age and Income as Quantitative from Thin Air</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="brfss-smart-data-building.html"><a href="brfss-smart-data-building.html#age_imp-imputing-age-data"><i class="fa fa-check"></i><b>2.6.1</b> <code>age_imp</code>: Imputing Age Data</a></li>
<li class="chapter" data-level="2.6.2" data-path="brfss-smart-data-building.html"><a href="brfss-smart-data-building.html#inc_imp-imputing-income-data"><i class="fa fa-check"></i><b>2.6.2</b> <code>inc_imp</code>: Imputing Income Data</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="brfss-smart-data-building.html"><a href="brfss-smart-data-building.html#clean-data-in-the-state-of-ohio"><i class="fa fa-check"></i><b>2.7</b> Clean Data in the State of Ohio</a></li>
<li class="chapter" data-level="2.8" data-path="brfss-smart-data-building.html"><a href="brfss-smart-data-building.html#clean-cleveland-elyria-data"><i class="fa fa-check"></i><b>2.8</b> Clean Cleveland-Elyria Data</a>
<ul>
<li class="chapter" data-level="2.8.1" data-path="brfss-smart-data-building.html"><a href="brfss-smart-data-building.html#cleveland---elyria-data"><i class="fa fa-check"></i><b>2.8.1</b> Cleveland - Elyria Data</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="dealing-with-missingness-single-imputation.html"><a href="dealing-with-missingness-single-imputation.html"><i class="fa fa-check"></i><b>3</b> Dealing with Missingness: Single Imputation</a>
<ul>
<li class="chapter" data-level="3.1" data-path="dealing-with-missingness-single-imputation.html"><a href="dealing-with-missingness-single-imputation.html#selecting-some-variables-from-the-smart_cle-data"><i class="fa fa-check"></i><b>3.1</b> Selecting Some Variables from the <code>smart_cle</code> data</a></li>
<li class="chapter" data-level="3.2" data-path="dealing-with-missingness-single-imputation.html"><a href="dealing-with-missingness-single-imputation.html#smart_cle1-seeing-our-missing-data"><i class="fa fa-check"></i><b>3.2</b> <code>smart_cle1</code>: Seeing our Missing Data</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="dealing-with-missingness-single-imputation.html"><a href="dealing-with-missingness-single-imputation.html#plotting-missingness"><i class="fa fa-check"></i><b>3.2.1</b> Plotting Missingness</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="dealing-with-missingness-single-imputation.html"><a href="dealing-with-missingness-single-imputation.html#missing-data-mechanisms"><i class="fa fa-check"></i><b>3.3</b> Missing-data mechanisms</a></li>
<li class="chapter" data-level="3.4" data-path="dealing-with-missingness-single-imputation.html"><a href="dealing-with-missingness-single-imputation.html#options-for-dealing-with-missingness"><i class="fa fa-check"></i><b>3.4</b> Options for Dealing with Missingness</a></li>
<li class="chapter" data-level="3.5" data-path="dealing-with-missingness-single-imputation.html"><a href="dealing-with-missingness-single-imputation.html#complete-case-and-available-case-analyses"><i class="fa fa-check"></i><b>3.5</b> Complete Case (and Available Case) analyses</a></li>
<li class="chapter" data-level="3.6" data-path="dealing-with-missingness-single-imputation.html"><a href="dealing-with-missingness-single-imputation.html#single-imputation"><i class="fa fa-check"></i><b>3.6</b> Single Imputation</a></li>
<li class="chapter" data-level="3.7" data-path="dealing-with-missingness-single-imputation.html"><a href="dealing-with-missingness-single-imputation.html#multiple-imputation"><i class="fa fa-check"></i><b>3.7</b> Multiple Imputation</a></li>
<li class="chapter" data-level="3.8" data-path="dealing-with-missingness-single-imputation.html"><a href="dealing-with-missingness-single-imputation.html#approach-1-building-a-complete-case-analysis-smart_cle1_cc"><i class="fa fa-check"></i><b>3.8</b> Approach 1: Building a Complete Case Analysis: <code>smart_cle1_cc</code></a></li>
<li class="chapter" data-level="3.9" data-path="dealing-with-missingness-single-imputation.html"><a href="dealing-with-missingness-single-imputation.html#approach-2-single-imputation-to-create-smart_cle1_sh"><i class="fa fa-check"></i><b>3.9</b> Approach 2: Single Imputation to create <code>smart_cle1_sh</code></a>
<ul>
<li class="chapter" data-level="3.9.1" data-path="dealing-with-missingness-single-imputation.html"><a href="dealing-with-missingness-single-imputation.html#what-type-of-missingness-do-we-have"><i class="fa fa-check"></i><b>3.9.1</b> What Type of Missingness Do We Have?</a></li>
<li class="chapter" data-level="3.9.2" data-path="dealing-with-missingness-single-imputation.html"><a href="dealing-with-missingness-single-imputation.html#single-imputation-into-smart_cle1_sh"><i class="fa fa-check"></i><b>3.9.2</b> Single imputation into <code>smart_cle1_sh</code></a></li>
<li class="chapter" data-level="3.9.3" data-path="dealing-with-missingness-single-imputation.html"><a href="dealing-with-missingness-single-imputation.html#imputing-binary-categorical-variables"><i class="fa fa-check"></i><b>3.9.3</b> Imputing Binary Categorical Variables</a></li>
<li class="chapter" data-level="3.9.4" data-path="dealing-with-missingness-single-imputation.html"><a href="dealing-with-missingness-single-imputation.html#imputing-quantitative-variables"><i class="fa fa-check"></i><b>3.9.4</b> Imputing Quantitative Variables</a></li>
<li class="chapter" data-level="3.9.5" data-path="dealing-with-missingness-single-imputation.html"><a href="dealing-with-missingness-single-imputation.html#imputation-results"><i class="fa fa-check"></i><b>3.9.5</b> Imputation Results</a></li>
<li class="chapter" data-level="3.9.6" data-path="dealing-with-missingness-single-imputation.html"><a href="dealing-with-missingness-single-imputation.html#imputing-multi-categorical-variables"><i class="fa fa-check"></i><b>3.9.6</b> Imputing Multi-Categorical Variables</a></li>
<li class="chapter" data-level="3.9.7" data-path="dealing-with-missingness-single-imputation.html"><a href="dealing-with-missingness-single-imputation.html#saving-the-new-tibbles"><i class="fa fa-check"></i><b>3.9.7</b> Saving the new tibbles</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="summarizing-the-smart-cle1-data.html"><a href="summarizing-the-smart-cle1-data.html"><i class="fa fa-check"></i><b>4</b> Summarizing the <code>smart_cle1</code> data</a>
<ul>
<li class="chapter" data-level="4.1" data-path="summarizing-the-smart-cle1-data.html"><a href="summarizing-the-smart-cle1-data.html#general-approaches-to-obtaining-numeric-summaries"><i class="fa fa-check"></i><b>4.1</b> General Approaches to Obtaining Numeric Summaries</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="summarizing-the-smart-cle1-data.html"><a href="summarizing-the-smart-cle1-data.html#summary-for-a-data-frame"><i class="fa fa-check"></i><b>4.1.1</b> <code>summary</code> for a data frame</a></li>
<li class="chapter" data-level="4.1.2" data-path="summarizing-the-smart-cle1-data.html"><a href="summarizing-the-smart-cle1-data.html#the-inspect-function-from-the-mosaic-package"><i class="fa fa-check"></i><b>4.1.2</b> The <code>inspect</code> function from the <code>mosaic</code> package</a></li>
<li class="chapter" data-level="4.1.3" data-path="summarizing-the-smart-cle1-data.html"><a href="summarizing-the-smart-cle1-data.html#the-describe-function-in-hmisc"><i class="fa fa-check"></i><b>4.1.3</b> The <code>describe</code> function in <code>Hmisc</code></a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="summarizing-the-smart-cle1-data.html"><a href="summarizing-the-smart-cle1-data.html#counting-as-exploratory-data-analysis"><i class="fa fa-check"></i><b>4.2</b> Counting as exploratory data analysis</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="summarizing-the-smart-cle1-data.html"><a href="summarizing-the-smart-cle1-data.html#did-genhealth-vary-by-smoking-status"><i class="fa fa-check"></i><b>4.2.1</b> Did <code>genhealth</code> vary by smoking status?</a></li>
<li class="chapter" data-level="4.2.2" data-path="summarizing-the-smart-cle1-data.html"><a href="summarizing-the-smart-cle1-data.html#whats-the-distribution-of-physhealth"><i class="fa fa-check"></i><b>4.2.2</b> What’s the distribution of <code>physhealth</code>?</a></li>
<li class="chapter" data-level="4.2.3" data-path="summarizing-the-smart-cle1-data.html"><a href="summarizing-the-smart-cle1-data.html#whats-the-distribution-of-bmi"><i class="fa fa-check"></i><b>4.2.3</b> What’s the distribution of <code>bmi</code>?</a></li>
<li class="chapter" data-level="4.2.4" data-path="summarizing-the-smart-cle1-data.html"><a href="summarizing-the-smart-cle1-data.html#how-many-of-the-respondents-have-a-bmi-below-30"><i class="fa fa-check"></i><b>4.2.4</b> How many of the respondents have a BMI below 30?</a></li>
<li class="chapter" data-level="4.2.5" data-path="summarizing-the-smart-cle1-data.html"><a href="summarizing-the-smart-cle1-data.html#how-many-of-the-respondents-with-a-bmi-30-are-highly-active"><i class="fa fa-check"></i><b>4.2.5</b> How many of the respondents with a BMI &lt; 30 are highly active?</a></li>
<li class="chapter" data-level="4.2.6" data-path="summarizing-the-smart-cle1-data.html"><a href="summarizing-the-smart-cle1-data.html#is-obesity-associated-with-smoking-history"><i class="fa fa-check"></i><b>4.2.6</b> Is obesity associated with smoking history?</a></li>
<li class="chapter" data-level="4.2.7" data-path="summarizing-the-smart-cle1-data.html"><a href="summarizing-the-smart-cle1-data.html#comparing-drinks_wk-summaries-by-obesity-status"><i class="fa fa-check"></i><b>4.2.7</b> Comparing <code>drinks_wk</code> summaries by obesity status</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="summarizing-the-smart-cle1-data.html"><a href="summarizing-the-smart-cle1-data.html#can-bmi-predict-physhealth"><i class="fa fa-check"></i><b>4.3</b> Can <code>bmi</code> predict <code>physhealth</code>?</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="summarizing-the-smart-cle1-data.html"><a href="summarizing-the-smart-cle1-data.html#fitting-a-simple-regression-model"><i class="fa fa-check"></i><b>4.3.1</b> Fitting a Simple Regression Model</a></li>
<li class="chapter" data-level="4.3.2" data-path="summarizing-the-smart-cle1-data.html"><a href="summarizing-the-smart-cle1-data.html#model-summary-for-a-simple-one-predictor-regression"><i class="fa fa-check"></i><b>4.3.2</b> Model Summary for a Simple (One-Predictor) Regression</a></li>
<li class="chapter" data-level="4.3.3" data-path="summarizing-the-smart-cle1-data.html"><a href="summarizing-the-smart-cle1-data.html#using-the-broom-package"><i class="fa fa-check"></i><b>4.3.3</b> Using the <code>broom</code> package</a></li>
<li class="chapter" data-level="4.3.4" data-path="summarizing-the-smart-cle1-data.html"><a href="summarizing-the-smart-cle1-data.html#how-does-the-model-do-residuals-vs.-fitted-values"><i class="fa fa-check"></i><b>4.3.4</b> How does the model do? (Residuals vs. Fitted Values)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="analysis-of-variance-with-smart.html"><a href="analysis-of-variance-with-smart.html"><i class="fa fa-check"></i><b>5</b> Analysis of Variance with SMART</a>
<ul>
<li class="chapter" data-level="5.1" data-path="analysis-of-variance-with-smart.html"><a href="analysis-of-variance-with-smart.html#a-one-factor-analysis-of-variance"><i class="fa fa-check"></i><b>5.1</b> A One-Factor Analysis of Variance</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="analysis-of-variance-with-smart.html"><a href="analysis-of-variance-with-smart.html#can-activity-be-used-to-predict-bmi"><i class="fa fa-check"></i><b>5.1.1</b> Can <code>activity</code> be used to predict <code>bmi</code>?</a></li>
<li class="chapter" data-level="5.1.2" data-path="analysis-of-variance-with-smart.html"><a href="analysis-of-variance-with-smart.html#should-we-transform-bmi"><i class="fa fa-check"></i><b>5.1.2</b> Should we transform <code>bmi</code>?</a></li>
<li class="chapter" data-level="5.1.3" data-path="analysis-of-variance-with-smart.html"><a href="analysis-of-variance-with-smart.html#building-the-anova-model"><i class="fa fa-check"></i><b>5.1.3</b> Building the ANOVA model</a></li>
<li class="chapter" data-level="5.1.4" data-path="analysis-of-variance-with-smart.html"><a href="analysis-of-variance-with-smart.html#the-anova-table"><i class="fa fa-check"></i><b>5.1.4</b> The ANOVA table</a></li>
<li class="chapter" data-level="5.1.5" data-path="analysis-of-variance-with-smart.html"><a href="analysis-of-variance-with-smart.html#the-model-coefficients"><i class="fa fa-check"></i><b>5.1.5</b> The Model Coefficients</a></li>
<li class="chapter" data-level="5.1.6" data-path="analysis-of-variance-with-smart.html"><a href="analysis-of-variance-with-smart.html#using-broomtidy-to-explore-the-coefficients"><i class="fa fa-check"></i><b>5.1.6</b> Using <code>broom::tidy</code> to explore the coefficients</a></li>
<li class="chapter" data-level="5.1.7" data-path="analysis-of-variance-with-smart.html"><a href="analysis-of-variance-with-smart.html#using-broomglance-to-summarize-the-models-fit"><i class="fa fa-check"></i><b>5.1.7</b> Using <code>broom::glance</code> to summarize the model’s fit</a></li>
<li class="chapter" data-level="5.1.8" data-path="analysis-of-variance-with-smart.html"><a href="analysis-of-variance-with-smart.html#using-broomaugment-to-make-predictions"><i class="fa fa-check"></i><b>5.1.8</b> Using <code>broom::augment</code> to make predictions</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="analysis-of-variance-with-smart.html"><a href="analysis-of-variance-with-smart.html#a-two-factor-anova-without-interaction"><i class="fa fa-check"></i><b>5.2</b> A Two-Factor ANOVA (without Interaction)</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="analysis-of-variance-with-smart.html"><a href="analysis-of-variance-with-smart.html#model-coefficients"><i class="fa fa-check"></i><b>5.2.1</b> Model Coefficients</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="analysis-of-variance-with-smart.html"><a href="analysis-of-variance-with-smart.html#a-two-factor-anova-with-interaction"><i class="fa fa-check"></i><b>5.3</b> A Two-Factor ANOVA (with Interaction)</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="analysis-of-variance-with-smart.html"><a href="analysis-of-variance-with-smart.html#model-coefficients-1"><i class="fa fa-check"></i><b>5.3.1</b> Model Coefficients</a></li>
<li class="chapter" data-level="5.3.2" data-path="analysis-of-variance-with-smart.html"><a href="analysis-of-variance-with-smart.html#is-the-interaction-term-necessary"><i class="fa fa-check"></i><b>5.3.2</b> Is the interaction term necessary?</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="analysis-of-variance.html"><a href="analysis-of-variance.html"><i class="fa fa-check"></i><b>6</b> Analysis of Variance</a>
<ul>
<li class="chapter" data-level="6.1" data-path="analysis-of-variance.html"><a href="analysis-of-variance.html#the-bonding-data-a-designed-dental-experiment"><i class="fa fa-check"></i><b>6.1</b> The <code>bonding</code> data: A Designed Dental Experiment</a></li>
<li class="chapter" data-level="6.2" data-path="analysis-of-variance.html"><a href="analysis-of-variance.html#a-one-factor-analysis-of-variance-1"><i class="fa fa-check"></i><b>6.2</b> A One-Factor Analysis of Variance</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="analysis-of-variance.html"><a href="analysis-of-variance.html#look-at-the-data"><i class="fa fa-check"></i><b>6.2.1</b> Look at the Data!</a></li>
<li class="chapter" data-level="6.2.2" data-path="analysis-of-variance.html"><a href="analysis-of-variance.html#table-of-summary-statistics"><i class="fa fa-check"></i><b>6.2.2</b> Table of Summary Statistics</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="analysis-of-variance.html"><a href="analysis-of-variance.html#a-two-way-anova-looking-at-two-factors"><i class="fa fa-check"></i><b>6.3</b> A Two-Way ANOVA: Looking at Two Factors</a></li>
<li class="chapter" data-level="6.4" data-path="analysis-of-variance.html"><a href="analysis-of-variance.html#a-means-plot-with-standard-deviations-to-check-for-interaction"><i class="fa fa-check"></i><b>6.4</b> A Means Plot (with standard deviations) to check for interaction</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="analysis-of-variance.html"><a href="analysis-of-variance.html#summarizing-the-data-after-grouping-by-resin-and-light"><i class="fa fa-check"></i><b>6.4.1</b> Summarizing the data after grouping by <code>resin</code> and <code>light</code></a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="analysis-of-variance.html"><a href="analysis-of-variance.html#fitting-the-two-way-anova-model-with-interaction"><i class="fa fa-check"></i><b>6.5</b> Fitting the Two-Way ANOVA model with Interaction</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="analysis-of-variance.html"><a href="analysis-of-variance.html#the-anova-table-for-our-model"><i class="fa fa-check"></i><b>6.5.1</b> The ANOVA table for our model</a></li>
<li class="chapter" data-level="6.5.2" data-path="analysis-of-variance.html"><a href="analysis-of-variance.html#is-the-interaction-important"><i class="fa fa-check"></i><b>6.5.2</b> Is the interaction important?</a></li>
<li class="chapter" data-level="6.5.3" data-path="analysis-of-variance.html"><a href="analysis-of-variance.html#interpreting-the-interaction"><i class="fa fa-check"></i><b>6.5.3</b> Interpreting the Interaction</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="analysis-of-variance.html"><a href="analysis-of-variance.html#comparing-individual-combinations-of-resin-and-light"><i class="fa fa-check"></i><b>6.6</b> Comparing Individual Combinations of <code>resin</code> and <code>light</code></a></li>
<li class="chapter" data-level="6.7" data-path="analysis-of-variance.html"><a href="analysis-of-variance.html#the-bonding-model-without-interaction"><i class="fa fa-check"></i><b>6.7</b> The <code>bonding</code> model without Interaction</a></li>
<li class="chapter" data-level="6.8" data-path="analysis-of-variance.html"><a href="analysis-of-variance.html#cortisol-a-hypothetical-clinical-trial"><i class="fa fa-check"></i><b>6.8</b> <code>cortisol</code>: A Hypothetical Clinical Trial</a>
<ul>
<li class="chapter" data-level="6.8.1" data-path="analysis-of-variance.html"><a href="analysis-of-variance.html#codebook-and-raw-data-for-cortisol"><i class="fa fa-check"></i><b>6.8.1</b> Codebook and Raw Data for <code>cortisol</code></a></li>
</ul></li>
<li class="chapter" data-level="6.9" data-path="analysis-of-variance.html"><a href="analysis-of-variance.html#creating-a-factor-combining-sex-and-waist"><i class="fa fa-check"></i><b>6.9</b> Creating a factor combining sex and waist</a></li>
<li class="chapter" data-level="6.10" data-path="analysis-of-variance.html"><a href="analysis-of-variance.html#a-means-plot-for-the-cortisol-trial-with-standard-errors"><i class="fa fa-check"></i><b>6.10</b> A Means Plot for the <code>cortisol</code> trial (with standard errors)</a></li>
<li class="chapter" data-level="6.11" data-path="analysis-of-variance.html"><a href="analysis-of-variance.html#a-two-way-anova-model-for-cortisol-with-interaction"><i class="fa fa-check"></i><b>6.11</b> A Two-Way ANOVA model for <code>cortisol</code> with Interaction</a></li>
<li class="chapter" data-level="6.12" data-path="analysis-of-variance.html"><a href="analysis-of-variance.html#a-two-way-anova-model-for-cortisol-without-interaction"><i class="fa fa-check"></i><b>6.12</b> A Two-Way ANOVA model for <code>cortisol</code> without Interaction</a>
<ul>
<li class="chapter" data-level="6.12.1" data-path="analysis-of-variance.html"><a href="analysis-of-variance.html#the-graph"><i class="fa fa-check"></i><b>6.12.1</b> The Graph</a></li>
<li class="chapter" data-level="6.12.2" data-path="analysis-of-variance.html"><a href="analysis-of-variance.html#the-anova-model"><i class="fa fa-check"></i><b>6.12.2</b> The ANOVA Model</a></li>
<li class="chapter" data-level="6.12.3" data-path="analysis-of-variance.html"><a href="analysis-of-variance.html#the-regression-summary"><i class="fa fa-check"></i><b>6.12.3</b> The Regression Summary</a></li>
<li class="chapter" data-level="6.12.4" data-path="analysis-of-variance.html"><a href="analysis-of-variance.html#tukey-hsd-comparisons"><i class="fa fa-check"></i><b>6.12.4</b> Tukey HSD Comparisons</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="analysis-of-covariance.html"><a href="analysis-of-covariance.html"><i class="fa fa-check"></i><b>7</b> Analysis of Covariance</a>
<ul>
<li class="chapter" data-level="7.1" data-path="analysis-of-covariance.html"><a href="analysis-of-covariance.html#an-emphysema-study"><i class="fa fa-check"></i><b>7.1</b> An Emphysema Study</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="analysis-of-covariance.html"><a href="analysis-of-covariance.html#codebook"><i class="fa fa-check"></i><b>7.1.1</b> Codebook</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="analysis-of-covariance.html"><a href="analysis-of-covariance.html#does-sex-affect-the-mean-change-in-theophylline"><i class="fa fa-check"></i><b>7.2</b> Does <code>sex</code> affect the mean change in theophylline?</a></li>
<li class="chapter" data-level="7.3" data-path="analysis-of-covariance.html"><a href="analysis-of-covariance.html#is-there-an-association-between-age-and-sex-in-this-study"><i class="fa fa-check"></i><b>7.3</b> Is there an association between <code>age</code> and <code>sex</code> in this study?</a></li>
<li class="chapter" data-level="7.4" data-path="analysis-of-covariance.html"><a href="analysis-of-covariance.html#adding-a-quantitative-covariate-age-to-the-model"><i class="fa fa-check"></i><b>7.4</b> Adding a quantitative covariate, <code>age</code>, to the model</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="analysis-of-covariance.html"><a href="analysis-of-covariance.html#the-ancova-model"><i class="fa fa-check"></i><b>7.4.1</b> The ANCOVA model</a></li>
<li class="chapter" data-level="7.4.2" data-path="analysis-of-covariance.html"><a href="analysis-of-covariance.html#the-ancova-table"><i class="fa fa-check"></i><b>7.4.2</b> The ANCOVA Table</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="analysis-of-covariance.html"><a href="analysis-of-covariance.html#rerunning-the-ancova-model-after-simple-imputation"><i class="fa fa-check"></i><b>7.5</b> Rerunning the ANCOVA model after simple imputation</a></li>
<li class="chapter" data-level="7.6" data-path="analysis-of-covariance.html"><a href="analysis-of-covariance.html#looking-at-a-factor-covariate-interaction"><i class="fa fa-check"></i><b>7.6</b> Looking at a factor-covariate interaction</a></li>
<li class="chapter" data-level="7.7" data-path="analysis-of-covariance.html"><a href="analysis-of-covariance.html#centering-the-covariate-to-facilitate-ancova-interpretation"><i class="fa fa-check"></i><b>7.7</b> Centering the Covariate to Facilitate ANCOVA Interpretation</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="analysis-of-covariance-with-the-smart-data.html"><a href="analysis-of-covariance-with-the-smart-data.html"><i class="fa fa-check"></i><b>8</b> Analysis of Covariance with the SMART data</a>
<ul>
<li class="chapter" data-level="8.1" data-path="analysis-of-covariance-with-the-smart-data.html"><a href="analysis-of-covariance-with-the-smart-data.html#a-new-small-study-predicting-bmi"><i class="fa fa-check"></i><b>8.1</b> A New Small Study: Predicting BMI</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="analysis-of-covariance-with-the-smart-data.html"><a href="analysis-of-covariance-with-the-smart-data.html#does-female-predict-bmi-well"><i class="fa fa-check"></i><b>8.1.1</b> Does <code>female</code> predict <code>bmi</code> well?</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="analysis-of-covariance-with-the-smart-data.html"><a href="analysis-of-covariance-with-the-smart-data.html#c8_m1-a-simple-t-test-model"><i class="fa fa-check"></i><b>8.2</b> <code>c8_m1</code>: A simple t-test model</a></li>
<li class="chapter" data-level="8.3" data-path="analysis-of-covariance-with-the-smart-data.html"><a href="analysis-of-covariance-with-the-smart-data.html#c8_m2-adding-another-predictor-two-way-anova-without-interaction"><i class="fa fa-check"></i><b>8.3</b> <code>c8_m2</code>: Adding another predictor (two-way ANOVA without interaction)</a></li>
<li class="chapter" data-level="8.4" data-path="analysis-of-covariance-with-the-smart-data.html"><a href="analysis-of-covariance-with-the-smart-data.html#c8_m3-adding-the-interaction-term-two-way-anova-with-interaction"><i class="fa fa-check"></i><b>8.4</b> <code>c8_m3</code>: Adding the interaction term (Two-way ANOVA with interaction)</a></li>
<li class="chapter" data-level="8.5" data-path="analysis-of-covariance-with-the-smart-data.html"><a href="analysis-of-covariance-with-the-smart-data.html#c8_m4-using-female-and-physhealth-in-a-model-for-bmi"><i class="fa fa-check"></i><b>8.5</b> <code>c8_m4</code>: Using <code>female</code> and <code>physhealth</code> in a model for <code>bmi</code></a></li>
<li class="chapter" data-level="8.6" data-path="analysis-of-covariance-with-the-smart-data.html"><a href="analysis-of-covariance-with-the-smart-data.html#making-predictions-with-a-linear-regression-model"><i class="fa fa-check"></i><b>8.6</b> Making Predictions with a Linear Regression Model</a>
<ul>
<li class="chapter" data-level="8.6.1" data-path="analysis-of-covariance-with-the-smart-data.html"><a href="analysis-of-covariance-with-the-smart-data.html#fitting-an-individual-prediction-and-95-prediction-interval"><i class="fa fa-check"></i><b>8.6.1</b> Fitting an Individual Prediction and 95% Prediction Interval</a></li>
<li class="chapter" data-level="8.6.2" data-path="analysis-of-covariance-with-the-smart-data.html"><a href="analysis-of-covariance-with-the-smart-data.html#confidence-interval-for-an-average-prediction"><i class="fa fa-check"></i><b>8.6.2</b> Confidence Interval for an Average Prediction</a></li>
<li class="chapter" data-level="8.6.3" data-path="analysis-of-covariance-with-the-smart-data.html"><a href="analysis-of-covariance-with-the-smart-data.html#fitting-multiple-individual-predictions-to-new-data"><i class="fa fa-check"></i><b>8.6.3</b> Fitting Multiple Individual Predictions to New Data</a></li>
</ul></li>
<li class="chapter" data-level="8.7" data-path="analysis-of-covariance-with-the-smart-data.html"><a href="analysis-of-covariance-with-the-smart-data.html#centering-the-model"><i class="fa fa-check"></i><b>8.7</b> Centering the model</a>
<ul>
<li class="chapter" data-level="8.7.1" data-path="analysis-of-covariance-with-the-smart-data.html"><a href="analysis-of-covariance-with-the-smart-data.html#plot-of-model-4-on-centered-physhealth-c8_m4_c"><i class="fa fa-check"></i><b>8.7.1</b> Plot of Model 4 on Centered <code>physhealth</code>: <code>c8_m4_c</code></a></li>
</ul></li>
<li class="chapter" data-level="8.8" data-path="analysis-of-covariance-with-the-smart-data.html"><a href="analysis-of-covariance-with-the-smart-data.html#rescaling-an-input-by-subtracting-the-mean-and-dividing-by-2-standard-deviations"><i class="fa fa-check"></i><b>8.8</b> Rescaling an input by subtracting the mean and dividing by 2 standard deviations</a>
<ul>
<li class="chapter" data-level="8.8.1" data-path="analysis-of-covariance-with-the-smart-data.html"><a href="analysis-of-covariance-with-the-smart-data.html#refitting-model-c8_m4-to-the-rescaled-data"><i class="fa fa-check"></i><b>8.8.1</b> Refitting model <code>c8_m4</code> to the rescaled data</a></li>
<li class="chapter" data-level="8.8.2" data-path="analysis-of-covariance-with-the-smart-data.html"><a href="analysis-of-covariance-with-the-smart-data.html#interpreting-the-model-on-rescaled-data"><i class="fa fa-check"></i><b>8.8.2</b> Interpreting the model on rescaled data</a></li>
<li class="chapter" data-level="8.8.3" data-path="analysis-of-covariance-with-the-smart-data.html"><a href="analysis-of-covariance-with-the-smart-data.html#plot-of-model-on-rescaled-data"><i class="fa fa-check"></i><b>8.8.3</b> Plot of model on rescaled data</a></li>
</ul></li>
<li class="chapter" data-level="8.9" data-path="analysis-of-covariance-with-the-smart-data.html"><a href="analysis-of-covariance-with-the-smart-data.html#c8_m5-what-if-we-add-more-variables"><i class="fa fa-check"></i><b>8.9</b> <code>c8_m5</code>: What if we add more variables?</a></li>
<li class="chapter" data-level="8.10" data-path="analysis-of-covariance-with-the-smart-data.html"><a href="analysis-of-covariance-with-the-smart-data.html#c8_m6-would-adding-self-reported-health-help"><i class="fa fa-check"></i><b>8.10</b> <code>c8_m6</code>: Would adding self-reported health help?</a></li>
<li class="chapter" data-level="8.11" data-path="analysis-of-covariance-with-the-smart-data.html"><a href="analysis-of-covariance-with-the-smart-data.html#key-regression-assumptions-for-building-effective-prediction-models"><i class="fa fa-check"></i><b>8.11</b> Key Regression Assumptions for Building Effective Prediction Models</a>
<ul>
<li class="chapter" data-level="8.11.1" data-path="analysis-of-covariance-with-the-smart-data.html"><a href="analysis-of-covariance-with-the-smart-data.html#checking-assumptions-in-model-c8_m6"><i class="fa fa-check"></i><b>8.11.1</b> Checking Assumptions in model <code>c8_m6</code></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="adding-non-linear-terms-to-a-linear-regression-model.html"><a href="adding-non-linear-terms-to-a-linear-regression-model.html"><i class="fa fa-check"></i><b>9</b> Adding Non-linear Terms to a Linear Regression Model</a>
<ul>
<li class="chapter" data-level="9.1" data-path="adding-non-linear-terms-to-a-linear-regression-model.html"><a href="adding-non-linear-terms-to-a-linear-regression-model.html#the-pollution-data"><i class="fa fa-check"></i><b>9.1</b> The <code>pollution</code> data</a></li>
<li class="chapter" data-level="9.2" data-path="adding-non-linear-terms-to-a-linear-regression-model.html"><a href="adding-non-linear-terms-to-a-linear-regression-model.html#fitting-a-straight-line-model-to-predict-y-from-x2"><i class="fa fa-check"></i><b>9.2</b> Fitting a straight line model to predict <code>y</code> from <code>x2</code></a></li>
<li class="chapter" data-level="9.3" data-path="adding-non-linear-terms-to-a-linear-regression-model.html"><a href="adding-non-linear-terms-to-a-linear-regression-model.html#quadratic-polynomial-model-to-predict-y-using-x2"><i class="fa fa-check"></i><b>9.3</b> Quadratic polynomial model to predict <code>y</code> using <code>x2</code></a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="adding-non-linear-terms-to-a-linear-regression-model.html"><a href="adding-non-linear-terms-to-a-linear-regression-model.html#the-raw-quadratic-model"><i class="fa fa-check"></i><b>9.3.1</b> The raw quadratic model</a></li>
<li class="chapter" data-level="9.3.2" data-path="adding-non-linear-terms-to-a-linear-regression-model.html"><a href="adding-non-linear-terms-to-a-linear-regression-model.html#raw-quadratic-fit-after-centering-x2"><i class="fa fa-check"></i><b>9.3.2</b> Raw quadratic fit after centering <code>x2</code></a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="adding-non-linear-terms-to-a-linear-regression-model.html"><a href="adding-non-linear-terms-to-a-linear-regression-model.html#orthogonal-polynomials"><i class="fa fa-check"></i><b>9.4</b> Orthogonal Polynomials</a></li>
<li class="chapter" data-level="9.5" data-path="adding-non-linear-terms-to-a-linear-regression-model.html"><a href="adding-non-linear-terms-to-a-linear-regression-model.html#fit-a-cubic-polynomial-to-predict-y-from-x3"><i class="fa fa-check"></i><b>9.5</b> Fit a cubic polynomial to predict <code>y</code> from <code>x3</code></a></li>
<li class="chapter" data-level="9.6" data-path="adding-non-linear-terms-to-a-linear-regression-model.html"><a href="adding-non-linear-terms-to-a-linear-regression-model.html#fitting-a-restricted-cubic-spline-in-a-linear-regression"><i class="fa fa-check"></i><b>9.6</b> Fitting a restricted cubic spline in a linear regression</a></li>
<li class="chapter" data-level="9.7" data-path="adding-non-linear-terms-to-a-linear-regression-model.html"><a href="adding-non-linear-terms-to-a-linear-regression-model.html#spending-degrees-of-freedom"><i class="fa fa-check"></i><b>9.7</b> “Spending” Degrees of Freedom</a>
<ul>
<li class="chapter" data-level="9.7.1" data-path="adding-non-linear-terms-to-a-linear-regression-model.html"><a href="adding-non-linear-terms-to-a-linear-regression-model.html#overfitting-and-limits-on-the-of-predictors"><i class="fa fa-check"></i><b>9.7.1</b> Overfitting and Limits on the # of Predictors</a></li>
<li class="chapter" data-level="9.7.2" data-path="adding-non-linear-terms-to-a-linear-regression-model.html"><a href="adding-non-linear-terms-to-a-linear-regression-model.html#the-importance-of-collinearity"><i class="fa fa-check"></i><b>9.7.2</b> The Importance of Collinearity</a></li>
<li class="chapter" data-level="9.7.3" data-path="adding-non-linear-terms-to-a-linear-regression-model.html"><a href="adding-non-linear-terms-to-a-linear-regression-model.html#collinearity-in-an-explanatory-model"><i class="fa fa-check"></i><b>9.7.3</b> Collinearity in an Explanatory Model</a></li>
<li class="chapter" data-level="9.7.4" data-path="adding-non-linear-terms-to-a-linear-regression-model.html"><a href="adding-non-linear-terms-to-a-linear-regression-model.html#collinearity-in-a-prediction-model"><i class="fa fa-check"></i><b>9.7.4</b> Collinearity in a Prediction Model</a></li>
</ul></li>
<li class="chapter" data-level="9.8" data-path="adding-non-linear-terms-to-a-linear-regression-model.html"><a href="adding-non-linear-terms-to-a-linear-regression-model.html#spending-df-on-non-linearity-the-spearman-plot"><i class="fa fa-check"></i><b>9.8</b> Spending DF on Non-Linearity: The Spearman Plot</a>
<ul>
<li class="chapter" data-level="9.8.1" data-path="adding-non-linear-terms-to-a-linear-regression-model.html"><a href="adding-non-linear-terms-to-a-linear-regression-model.html#fitting-a-big-model-to-the-pollution-data"><i class="fa fa-check"></i><b>9.8.1</b> Fitting a Big Model to the <code>pollution</code> data</a></li>
<li class="chapter" data-level="9.8.2" data-path="adding-non-linear-terms-to-a-linear-regression-model.html"><a href="adding-non-linear-terms-to-a-linear-regression-model.html#limitations-of-lm-for-fitting-complex-linear-regression-models"><i class="fa fa-check"></i><b>9.8.2</b> Limitations of <code>lm</code> for fitting complex linear regression models</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="using-ols-from-the-rms-package-to-fit-linear-models.html"><a href="using-ols-from-the-rms-package-to-fit-linear-models.html"><i class="fa fa-check"></i><b>10</b> Using <code>ols</code> from the <code>rms</code> package to fit linear models</a>
<ul>
<li class="chapter" data-level="10.1" data-path="using-ols-from-the-rms-package-to-fit-linear-models.html"><a href="using-ols-from-the-rms-package-to-fit-linear-models.html#fitting-a-model-with-ols"><i class="fa fa-check"></i><b>10.1</b> Fitting a model with <code>ols</code></a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="using-ols-from-the-rms-package-to-fit-linear-models.html"><a href="using-ols-from-the-rms-package-to-fit-linear-models.html#the-model-likelihood-ratio-test"><i class="fa fa-check"></i><b>10.1.1</b> The Model Likelihood Ratio Test</a></li>
<li class="chapter" data-level="10.1.2" data-path="using-ols-from-the-rms-package-to-fit-linear-models.html"><a href="using-ols-from-the-rms-package-to-fit-linear-models.html#the-g-statistic"><i class="fa fa-check"></i><b>10.1.2</b> The g statistic</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="using-ols-from-the-rms-package-to-fit-linear-models.html"><a href="using-ols-from-the-rms-package-to-fit-linear-models.html#anova-for-an-ols-model"><i class="fa fa-check"></i><b>10.2</b> ANOVA for an <code>ols</code> model</a></li>
<li class="chapter" data-level="10.3" data-path="using-ols-from-the-rms-package-to-fit-linear-models.html"><a href="using-ols-from-the-rms-package-to-fit-linear-models.html#effect-estimates"><i class="fa fa-check"></i><b>10.3</b> Effect Estimates</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="using-ols-from-the-rms-package-to-fit-linear-models.html"><a href="using-ols-from-the-rms-package-to-fit-linear-models.html#simultaneous-confidence-intervals"><i class="fa fa-check"></i><b>10.3.1</b> Simultaneous Confidence Intervals</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="using-ols-from-the-rms-package-to-fit-linear-models.html"><a href="using-ols-from-the-rms-package-to-fit-linear-models.html#the-predict-function-for-an-ols-model"><i class="fa fa-check"></i><b>10.4</b> The <code>Predict</code> function for an <code>ols</code> model</a></li>
<li class="chapter" data-level="10.5" data-path="using-ols-from-the-rms-package-to-fit-linear-models.html"><a href="using-ols-from-the-rms-package-to-fit-linear-models.html#checking-influence-via-dfbeta"><i class="fa fa-check"></i><b>10.5</b> Checking Influence via <code>dfbeta</code></a>
<ul>
<li class="chapter" data-level="10.5.1" data-path="using-ols-from-the-rms-package-to-fit-linear-models.html"><a href="using-ols-from-the-rms-package-to-fit-linear-models.html#using-the-residuals-command-for-dfbetas"><i class="fa fa-check"></i><b>10.5.1</b> Using the <code>residuals</code> command for <code>dfbetas</code></a></li>
<li class="chapter" data-level="10.5.2" data-path="using-ols-from-the-rms-package-to-fit-linear-models.html"><a href="using-ols-from-the-rms-package-to-fit-linear-models.html#using-the-residuals-command-for-other-summaries"><i class="fa fa-check"></i><b>10.5.2</b> Using the <code>residuals</code> command for other summaries</a></li>
</ul></li>
<li class="chapter" data-level="10.6" data-path="using-ols-from-the-rms-package-to-fit-linear-models.html"><a href="using-ols-from-the-rms-package-to-fit-linear-models.html#model-validation-and-correcting-for-optimism"><i class="fa fa-check"></i><b>10.6</b> Model Validation and Correcting for Optimism</a></li>
<li class="chapter" data-level="10.7" data-path="using-ols-from-the-rms-package-to-fit-linear-models.html"><a href="using-ols-from-the-rms-package-to-fit-linear-models.html#building-a-nomogram-for-our-model"><i class="fa fa-check"></i><b>10.7</b> Building a Nomogram for Our Model</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="logistic-regression-the-foundations.html"><a href="logistic-regression-the-foundations.html"><i class="fa fa-check"></i><b>11</b> Logistic Regression: The Foundations</a>
<ul>
<li class="chapter" data-level="11.1" data-path="logistic-regression-the-foundations.html"><a href="logistic-regression-the-foundations.html#a-first-attempt-a-linear-probability-model"><i class="fa fa-check"></i><b>11.1</b> A First Attempt: A Linear Probability Model</a></li>
<li class="chapter" data-level="11.2" data-path="logistic-regression-the-foundations.html"><a href="logistic-regression-the-foundations.html#logistic-regression"><i class="fa fa-check"></i><b>11.2</b> Logistic Regression</a></li>
<li class="chapter" data-level="11.3" data-path="logistic-regression-the-foundations.html"><a href="logistic-regression-the-foundations.html#the-logistic-regression-model"><i class="fa fa-check"></i><b>11.3</b> The Logistic Regression Model</a></li>
<li class="chapter" data-level="11.4" data-path="logistic-regression-the-foundations.html"><a href="logistic-regression-the-foundations.html#the-link-function"><i class="fa fa-check"></i><b>11.4</b> The Link Function</a></li>
<li class="chapter" data-level="11.5" data-path="logistic-regression-the-foundations.html"><a href="logistic-regression-the-foundations.html#the-logit-or-log-odds"><i class="fa fa-check"></i><b>11.5</b> The logit or log odds</a></li>
<li class="chapter" data-level="11.6" data-path="logistic-regression-the-foundations.html"><a href="logistic-regression-the-foundations.html#interpreting-the-coefficients-of-a-logistic-regression-model"><i class="fa fa-check"></i><b>11.6</b> Interpreting the Coefficients of a Logistic Regression Model</a></li>
<li class="chapter" data-level="11.7" data-path="logistic-regression-the-foundations.html"><a href="logistic-regression-the-foundations.html#the-logistic-regression-has-non-constant-variance"><i class="fa fa-check"></i><b>11.7</b> The Logistic Regression has non-constant variance</a></li>
<li class="chapter" data-level="11.8" data-path="logistic-regression-the-foundations.html"><a href="logistic-regression-the-foundations.html#fitting-a-logistic-regression-model-to-our-simulated-data"><i class="fa fa-check"></i><b>11.8</b> Fitting a Logistic Regression Model to our Simulated Data</a></li>
<li class="chapter" data-level="11.9" data-path="logistic-regression-the-foundations.html"><a href="logistic-regression-the-foundations.html#plotting-the-logistic-regression-model"><i class="fa fa-check"></i><b>11.9</b> Plotting the Logistic Regression Model</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html"><i class="fa fa-check"></i><b>12</b> Logistic Regression and the <code>resect</code> data</a>
<ul>
<li class="chapter" data-level="12.1" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#the-resect-data"><i class="fa fa-check"></i><b>12.1</b> The <code>resect</code> data</a></li>
<li class="chapter" data-level="12.2" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#running-a-simple-logistic-regression-model"><i class="fa fa-check"></i><b>12.2</b> Running A Simple Logistic Regression Model</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#logistic-regression-can-be-harder-than-linear-regression"><i class="fa fa-check"></i><b>12.2.1</b> Logistic Regression Can Be Harder than Linear Regression</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#logistic-regression-using-glm"><i class="fa fa-check"></i><b>12.3</b> Logistic Regression using <code>glm</code></a>
<ul>
<li class="chapter" data-level="12.3.1" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#interpreting-the-coefficients-of-a-logistic-regression-model-1"><i class="fa fa-check"></i><b>12.3.1</b> Interpreting the Coefficients of a Logistic Regression Model</a></li>
<li class="chapter" data-level="12.3.2" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#using-predict-to-describe-the-models-fits"><i class="fa fa-check"></i><b>12.3.2</b> Using <code>predict</code> to describe the model’s fits</a></li>
<li class="chapter" data-level="12.3.3" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#odds-ratio-interpretation-of-coefficients"><i class="fa fa-check"></i><b>12.3.3</b> Odds Ratio interpretation of Coefficients</a></li>
<li class="chapter" data-level="12.3.4" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#interpreting-the-rest-of-the-model-output-from-glm"><i class="fa fa-check"></i><b>12.3.4</b> Interpreting the rest of the model output from <code>glm</code></a></li>
<li class="chapter" data-level="12.3.5" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#deviance-and-comparing-our-model-to-the-null-model"><i class="fa fa-check"></i><b>12.3.5</b> Deviance and Comparing Our Model to the Null Model</a></li>
<li class="chapter" data-level="12.3.6" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#using-glance-with-a-logistic-regression-model"><i class="fa fa-check"></i><b>12.3.6</b> Using <code>glance</code> with a logistic regression model</a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#interpreting-the-model-summary"><i class="fa fa-check"></i><b>12.4</b> Interpreting the Model Summary</a>
<ul>
<li class="chapter" data-level="12.4.1" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#wald-z-tests-for-coefficients-in-a-logistic-regression"><i class="fa fa-check"></i><b>12.4.1</b> Wald Z tests for Coefficients in a Logistic Regression</a></li>
<li class="chapter" data-level="12.4.2" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#confidence-intervals-for-the-coefficients"><i class="fa fa-check"></i><b>12.4.2</b> Confidence Intervals for the Coefficients</a></li>
<li class="chapter" data-level="12.4.3" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#deviance-residuals"><i class="fa fa-check"></i><b>12.4.3</b> Deviance Residuals</a></li>
<li class="chapter" data-level="12.4.4" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#dispersion-parameter"><i class="fa fa-check"></i><b>12.4.4</b> Dispersion Parameter</a></li>
<li class="chapter" data-level="12.4.5" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#fisher-scoring-iterations"><i class="fa fa-check"></i><b>12.4.5</b> Fisher Scoring iterations</a></li>
</ul></li>
<li class="chapter" data-level="12.5" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#plotting-a-simple-logistic-regression-model"><i class="fa fa-check"></i><b>12.5</b> Plotting a Simple Logistic Regression Model</a>
<ul>
<li class="chapter" data-level="12.5.1" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#using-augment-to-capture-the-fitted-probabilities"><i class="fa fa-check"></i><b>12.5.1</b> Using <code>augment</code> to capture the fitted probabilities</a></li>
<li class="chapter" data-level="12.5.2" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#plotting-a-logistic-regression-models-fitted-values"><i class="fa fa-check"></i><b>12.5.2</b> Plotting a Logistic Regression Model’s Fitted Values</a></li>
<li class="chapter" data-level="12.5.3" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#plotting-a-simple-logistic-model-using-binomial_smooth"><i class="fa fa-check"></i><b>12.5.3</b> Plotting a Simple Logistic Model using <code>binomial_smooth</code></a></li>
</ul></li>
<li class="chapter" data-level="12.6" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#how-well-does-model-a-classify-subjects"><i class="fa fa-check"></i><b>12.6</b> How well does Model A classify subjects?</a></li>
<li class="chapter" data-level="12.7" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#the-confusion-matrix"><i class="fa fa-check"></i><b>12.7</b> The Confusion Matrix</a></li>
<li class="chapter" data-level="12.8" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#using-the-confusionmatrix-tool-from-the-caret-package"><i class="fa fa-check"></i><b>12.8</b> Using the <code>confusionMatrix</code> tool from the <code>caret</code> package</a></li>
<li class="chapter" data-level="12.9" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#receiver-operating-characteristic-curve-analysis"><i class="fa fa-check"></i><b>12.9</b> Receiver Operating Characteristic Curve Analysis</a>
<ul>
<li class="chapter" data-level="12.9.1" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#interpreting-the-area-under-the-roc-curve"><i class="fa fa-check"></i><b>12.9.1</b> Interpreting the Area under the ROC curve</a></li>
</ul></li>
<li class="chapter" data-level="12.10" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#the-roc-plot-for-res_moda"><i class="fa fa-check"></i><b>12.10</b> The ROC Plot for <code>res_modA</code></a>
<ul>
<li class="chapter" data-level="12.10.1" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#another-way-to-plot-the-roc-curve"><i class="fa fa-check"></i><b>12.10.1</b> Another way to plot the ROC Curve</a></li>
</ul></li>
<li class="chapter" data-level="12.11" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#assessing-residual-plots-from-model-a"><i class="fa fa-check"></i><b>12.11</b> Assessing Residual Plots from Model A</a></li>
<li class="chapter" data-level="12.12" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#model-b-a-kitchen-sink-logistic-regression-model"><i class="fa fa-check"></i><b>12.12</b> Model B: A “Kitchen Sink” Logistic Regression Model</a>
<ul>
<li class="chapter" data-level="12.12.1" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#comparing-model-a-to-model-b"><i class="fa fa-check"></i><b>12.12.1</b> Comparing Model A to Model B</a></li>
<li class="chapter" data-level="12.12.2" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#interpreting-model-b"><i class="fa fa-check"></i><b>12.12.2</b> Interpreting Model B</a></li>
</ul></li>
<li class="chapter" data-level="12.13" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#plotting-model-b"><i class="fa fa-check"></i><b>12.13</b> Plotting Model B</a>
<ul>
<li class="chapter" data-level="12.13.1" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#using-augment-to-capture-the-fitted-probabilities-1"><i class="fa fa-check"></i><b>12.13.1</b> Using <code>augment</code> to capture the fitted probabilities</a></li>
<li class="chapter" data-level="12.13.2" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#plotting-model-b-fits-by-observed-mortality"><i class="fa fa-check"></i><b>12.13.2</b> Plotting Model B Fits by Observed Mortality</a></li>
<li class="chapter" data-level="12.13.3" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#confusion-matrix-for-model-b"><i class="fa fa-check"></i><b>12.13.3</b> Confusion Matrix for Model B</a></li>
<li class="chapter" data-level="12.13.4" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#the-roc-curve-for-model-b"><i class="fa fa-check"></i><b>12.13.4</b> The ROC curve for Model B</a></li>
<li class="chapter" data-level="12.13.5" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#residuals-leverage-and-influence"><i class="fa fa-check"></i><b>12.13.5</b> Residuals, Leverage and Influence</a></li>
</ul></li>
<li class="chapter" data-level="12.14" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#logistic-regression-using-lrm"><i class="fa fa-check"></i><b>12.14</b> Logistic Regression using <code>lrm</code></a>
<ul>
<li class="chapter" data-level="12.14.1" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#interpreting-nagelkerke-r2"><i class="fa fa-check"></i><b>12.14.1</b> Interpreting Nagelkerke R<sup>2</sup></a></li>
<li class="chapter" data-level="12.14.2" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#interpreting-the-c-statistic-and-plotting-the-roc-curve"><i class="fa fa-check"></i><b>12.14.2</b> Interpreting the C statistic and Plotting the ROC Curve</a></li>
<li class="chapter" data-level="12.14.3" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#the-c-statistic-and-somers-d"><i class="fa fa-check"></i><b>12.14.3</b> The C statistic and Somers’ D</a></li>
<li class="chapter" data-level="12.14.4" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#validating-the-logistic-regression-model-summary-statistics"><i class="fa fa-check"></i><b>12.14.4</b> Validating the Logistic Regression Model Summary Statistics</a></li>
<li class="chapter" data-level="12.14.5" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#plotting-the-summary-of-the-lrm-approach"><i class="fa fa-check"></i><b>12.14.5</b> Plotting the Summary of the <code>lrm</code> approach</a></li>
<li class="chapter" data-level="12.14.6" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#plot-in-sample-predictions-for-model-c"><i class="fa fa-check"></i><b>12.14.6</b> Plot In-Sample Predictions for Model C</a></li>
<li class="chapter" data-level="12.14.7" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#anova-from-the-lrm-approach"><i class="fa fa-check"></i><b>12.14.7</b> ANOVA from the <code>lrm</code> approach</a></li>
<li class="chapter" data-level="12.14.8" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#are-any-points-particularly-influential"><i class="fa fa-check"></i><b>12.14.8</b> Are any points particularly influential?</a></li>
<li class="chapter" data-level="12.14.9" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#a-nomogram-for-model-c"><i class="fa fa-check"></i><b>12.14.9</b> A Nomogram for Model C</a></li>
</ul></li>
<li class="chapter" data-level="12.15" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#model-d-an-augmented-kitchen-sink-model"><i class="fa fa-check"></i><b>12.15</b> Model D: An Augmented Kitchen Sink Model</a>
<ul>
<li class="chapter" data-level="12.15.1" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#spearman-rho2-plot"><i class="fa fa-check"></i><b>12.15.1</b> Spearman <span class="math inline">\(\rho^2\)</span> Plot</a></li>
<li class="chapter" data-level="12.15.2" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#fitting-model-d-using-lrm"><i class="fa fa-check"></i><b>12.15.2</b> Fitting Model D using <code>lrm</code></a></li>
<li class="chapter" data-level="12.15.3" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#assessing-model-d-using-lrms-tools"><i class="fa fa-check"></i><b>12.15.3</b> Assessing Model D using <code>lrm</code>’s tools</a></li>
<li class="chapter" data-level="12.15.4" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#anova-and-wald-tests-for-model-d"><i class="fa fa-check"></i><b>12.15.4</b> ANOVA and Wald Tests for Model D</a></li>
<li class="chapter" data-level="12.15.5" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#effect-sizes-in-model-d"><i class="fa fa-check"></i><b>12.15.5</b> Effect Sizes in Model D</a></li>
<li class="chapter" data-level="12.15.6" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#plot-in-sample-predictions-for-model-d"><i class="fa fa-check"></i><b>12.15.6</b> Plot In-Sample Predictions for Model D</a></li>
<li class="chapter" data-level="12.15.7" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#plotting-the-roc-curve-for-model-d"><i class="fa fa-check"></i><b>12.15.7</b> Plotting the ROC curve for Model D</a></li>
<li class="chapter" data-level="12.15.8" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#validation-of-model-d-summaries"><i class="fa fa-check"></i><b>12.15.8</b> Validation of Model D summaries</a></li>
</ul></li>
<li class="chapter" data-level="12.16" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#model-e-fitting-a-reduced-model-in-light-of-model-d"><i class="fa fa-check"></i><b>12.16</b> Model E: Fitting a Reduced Model in light of Model D</a>
<ul>
<li class="chapter" data-level="12.16.1" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#a-plot-comparing-the-two-intubation-groups"><i class="fa fa-check"></i><b>12.16.1</b> A Plot comparing the two intubation groups</a></li>
<li class="chapter" data-level="12.16.2" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#nomogram-for-model-e"><i class="fa fa-check"></i><b>12.16.2</b> Nomogram for Model E</a></li>
<li class="chapter" data-level="12.16.3" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#effect-sizes-from-model-e"><i class="fa fa-check"></i><b>12.16.3</b> Effect Sizes from Model E</a></li>
<li class="chapter" data-level="12.16.4" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#plot-in-sample-predictions-for-model-e"><i class="fa fa-check"></i><b>12.16.4</b> Plot In-Sample Predictions for Model E</a></li>
<li class="chapter" data-level="12.16.5" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#anova-for-model-e"><i class="fa fa-check"></i><b>12.16.5</b> ANOVA for Model E</a></li>
<li class="chapter" data-level="12.16.6" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#validation-of-model-e"><i class="fa fa-check"></i><b>12.16.6</b> Validation of Model E</a></li>
<li class="chapter" data-level="12.16.7" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#do-any-points-seem-particularly-influential"><i class="fa fa-check"></i><b>12.16.7</b> Do any points seem particularly influential?</a></li>
<li class="chapter" data-level="12.16.8" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#fitting-model-e-using-glm-to-get-plots-about-influence"><i class="fa fa-check"></i><b>12.16.8</b> Fitting Model E using <code>glm</code> to get plots about influence</a></li>
</ul></li>
<li class="chapter" data-level="12.17" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#concordance-comparing-model-c-d-and-es-predictions"><i class="fa fa-check"></i><b>12.17</b> Concordance: Comparing Model C, D and E’s predictions</a></li>
<li class="chapter" data-level="12.18" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#conclusions"><i class="fa fa-check"></i><b>12.18</b> Conclusions</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="a-study-of-prostate-cancer.html"><a href="a-study-of-prostate-cancer.html"><i class="fa fa-check"></i><b>13</b> A Study of Prostate Cancer</a>
<ul>
<li class="chapter" data-level="13.1" data-path="a-study-of-prostate-cancer.html"><a href="a-study-of-prostate-cancer.html#data-load-and-background"><i class="fa fa-check"></i><b>13.1</b> Data Load and Background</a></li>
<li class="chapter" data-level="13.2" data-path="a-study-of-prostate-cancer.html"><a href="a-study-of-prostate-cancer.html#code-book"><i class="fa fa-check"></i><b>13.2</b> Code Book</a></li>
<li class="chapter" data-level="13.3" data-path="a-study-of-prostate-cancer.html"><a href="a-study-of-prostate-cancer.html#additions-for-later-use"><i class="fa fa-check"></i><b>13.3</b> Additions for Later Use</a></li>
<li class="chapter" data-level="13.4" data-path="a-study-of-prostate-cancer.html"><a href="a-study-of-prostate-cancer.html#fitting-and-evaluating-a-two-predictor-model"><i class="fa fa-check"></i><b>13.4</b> Fitting and Evaluating a Two-Predictor Model</a>
<ul>
<li class="chapter" data-level="13.4.1" data-path="a-study-of-prostate-cancer.html"><a href="a-study-of-prostate-cancer.html#using-tidy"><i class="fa fa-check"></i><b>13.4.1</b> Using <code>tidy</code></a></li>
<li class="chapter" data-level="13.4.2" data-path="a-study-of-prostate-cancer.html"><a href="a-study-of-prostate-cancer.html#interpretation"><i class="fa fa-check"></i><b>13.4.2</b> Interpretation</a></li>
</ul></li>
<li class="chapter" data-level="13.5" data-path="a-study-of-prostate-cancer.html"><a href="a-study-of-prostate-cancer.html#exploring-model-c11_prost_a"><i class="fa fa-check"></i><b>13.5</b> Exploring Model <code>c11_prost_A</code></a>
<ul>
<li class="chapter" data-level="13.5.1" data-path="a-study-of-prostate-cancer.html"><a href="a-study-of-prostate-cancer.html#summary-for-model-c11_prost_a"><i class="fa fa-check"></i><b>13.5.1</b> <code>summary</code> for Model <code>c11_prost_A</code></a></li>
<li class="chapter" data-level="13.5.2" data-path="a-study-of-prostate-cancer.html"><a href="a-study-of-prostate-cancer.html#adjusted-r2"><i class="fa fa-check"></i><b>13.5.2</b> Adjusted R<sup>2</sup></a></li>
<li class="chapter" data-level="13.5.3" data-path="a-study-of-prostate-cancer.html"><a href="a-study-of-prostate-cancer.html#coefficient-confidence-intervals"><i class="fa fa-check"></i><b>13.5.3</b> Coefficient Confidence Intervals</a></li>
<li class="chapter" data-level="13.5.4" data-path="a-study-of-prostate-cancer.html"><a href="a-study-of-prostate-cancer.html#anova-for-model-c11_prost_a"><i class="fa fa-check"></i><b>13.5.4</b> ANOVA for Model <code>c11_prost_A</code></a></li>
<li class="chapter" data-level="13.5.5" data-path="a-study-of-prostate-cancer.html"><a href="a-study-of-prostate-cancer.html#residuals-fitted-values-and-standard-errors-with-augment"><i class="fa fa-check"></i><b>13.5.5</b> Residuals, Fitted Values and Standard Errors with <code>augment</code></a></li>
<li class="chapter" data-level="13.5.6" data-path="a-study-of-prostate-cancer.html"><a href="a-study-of-prostate-cancer.html#making-predictions-with-c11_prost_a"><i class="fa fa-check"></i><b>13.5.6</b> Making Predictions with <code>c11_prost_A</code></a></li>
</ul></li>
<li class="chapter" data-level="13.6" data-path="a-study-of-prostate-cancer.html"><a href="a-study-of-prostate-cancer.html#plotting-model-c11_prost_a"><i class="fa fa-check"></i><b>13.6</b> Plotting Model <code>c11_prost_A</code></a>
<ul>
<li class="chapter" data-level="13.6.1" data-path="a-study-of-prostate-cancer.html"><a href="a-study-of-prostate-cancer.html#residual-plots-of-c11_prost_a"><i class="fa fa-check"></i><b>13.6.1</b> Residual Plots of <code>c11_prost_A</code></a></li>
</ul></li>
<li class="chapter" data-level="13.7" data-path="a-study-of-prostate-cancer.html"><a href="a-study-of-prostate-cancer.html#cross-validation-of-model-c11_prost_a"><i class="fa fa-check"></i><b>13.7</b> Cross-Validation of Model <code>c11_prost_A</code></a>
<ul>
<li class="chapter" data-level="13.7.1" data-path="a-study-of-prostate-cancer.html"><a href="a-study-of-prostate-cancer.html#a-validation-split-approach"><i class="fa fa-check"></i><b>13.7.1</b> A Validation Split Approach</a></li>
<li class="chapter" data-level="13.7.2" data-path="a-study-of-prostate-cancer.html"><a href="a-study-of-prostate-cancer.html#k-fold-cross-validation"><i class="fa fa-check"></i><b>13.7.2</b> K-Fold Cross-Validation</a></li>
<li class="chapter" data-level="13.7.3" data-path="a-study-of-prostate-cancer.html"><a href="a-study-of-prostate-cancer.html#comparing-models-with-5-fold-cross-validation"><i class="fa fa-check"></i><b>13.7.3</b> Comparing Models with 5-fold Cross-Validation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="14" data-path="multiple-imputation-and-linear-regression.html"><a href="multiple-imputation-and-linear-regression.html"><i class="fa fa-check"></i><b>14</b> Multiple Imputation and Linear Regression</a>
<ul>
<li class="chapter" data-level="14.1" data-path="multiple-imputation-and-linear-regression.html"><a href="multiple-imputation-and-linear-regression.html#developing-a-smart_16-data-set"><i class="fa fa-check"></i><b>14.1</b> Developing a <code>smart_16</code> data set</a>
<ul>
<li class="chapter" data-level="14.1.1" data-path="multiple-imputation-and-linear-regression.html"><a href="multiple-imputation-and-linear-regression.html#any-missing-values"><i class="fa fa-check"></i><b>14.1.1</b> Any missing values?</a></li>
</ul></li>
<li class="chapter" data-level="14.2" data-path="multiple-imputation-and-linear-regression.html"><a href="multiple-imputation-and-linear-regression.html#obtaining-a-simple-imputation-with-mice"><i class="fa fa-check"></i><b>14.2</b> Obtaining a Simple Imputation with <code>mice</code></a></li>
<li class="chapter" data-level="14.3" data-path="multiple-imputation-and-linear-regression.html"><a href="multiple-imputation-and-linear-regression.html#linear-regression-considering-a-transformation-of-the-outcome"><i class="fa fa-check"></i><b>14.3</b> Linear Regression: Considering a Transformation of the Outcome</a></li>
<li class="chapter" data-level="14.4" data-path="multiple-imputation-and-linear-regression.html"><a href="multiple-imputation-and-linear-regression.html#linear-regression-considering-non-linearity-in-the-predictors"><i class="fa fa-check"></i><b>14.4</b> Linear Regression: Considering Non-Linearity in the Predictors</a></li>
<li class="chapter" data-level="14.5" data-path="multiple-imputation-and-linear-regression.html"><a href="multiple-imputation-and-linear-regression.html#main-effects-linear-regression-with-lm-on-the-complete-cases"><i class="fa fa-check"></i><b>14.5</b> “Main Effects” Linear Regression with <code>lm</code> on the Complete Cases</a>
<ul>
<li class="chapter" data-level="14.5.1" data-path="multiple-imputation-and-linear-regression.html"><a href="multiple-imputation-and-linear-regression.html#quality-of-fit-statistics"><i class="fa fa-check"></i><b>14.5.1</b> Quality of Fit Statistics</a></li>
<li class="chapter" data-level="14.5.2" data-path="multiple-imputation-and-linear-regression.html"><a href="multiple-imputation-and-linear-regression.html#interpreting-effect-sizes"><i class="fa fa-check"></i><b>14.5.2</b> Interpreting Effect Sizes</a></li>
<li class="chapter" data-level="14.5.3" data-path="multiple-imputation-and-linear-regression.html"><a href="multiple-imputation-and-linear-regression.html#making-predictions-with-the-model"><i class="fa fa-check"></i><b>14.5.3</b> Making Predictions with the Model</a></li>
</ul></li>
<li class="chapter" data-level="14.6" data-path="multiple-imputation-and-linear-regression.html"><a href="multiple-imputation-and-linear-regression.html#augmented-linear-regression-with-lm-on-the-complete-cases"><i class="fa fa-check"></i><b>14.6</b> “Augmented” Linear Regression with <code>lm</code> on the Complete Cases</a>
<ul>
<li class="chapter" data-level="14.6.1" data-path="multiple-imputation-and-linear-regression.html"><a href="multiple-imputation-and-linear-regression.html#quality-of-fit-statistics-1"><i class="fa fa-check"></i><b>14.6.1</b> Quality of Fit Statistics</a></li>
<li class="chapter" data-level="14.6.2" data-path="multiple-imputation-and-linear-regression.html"><a href="multiple-imputation-and-linear-regression.html#anova-assessing-the-impact-of-the-non-linear-terms"><i class="fa fa-check"></i><b>14.6.2</b> ANOVA assessing the impact of the non-linear terms</a></li>
<li class="chapter" data-level="14.6.3" data-path="multiple-imputation-and-linear-regression.html"><a href="multiple-imputation-and-linear-regression.html#interpreting-effect-sizes-1"><i class="fa fa-check"></i><b>14.6.3</b> Interpreting Effect Sizes</a></li>
<li class="chapter" data-level="14.6.4" data-path="multiple-imputation-and-linear-regression.html"><a href="multiple-imputation-and-linear-regression.html#making-predictions-with-the-model-1"><i class="fa fa-check"></i><b>14.6.4</b> Making Predictions with the Model</a></li>
</ul></li>
<li class="chapter" data-level="14.7" data-path="multiple-imputation-and-linear-regression.html"><a href="multiple-imputation-and-linear-regression.html#using-mice-to-perform-multiple-imputation"><i class="fa fa-check"></i><b>14.7</b> Using <code>mice</code> to perform Multiple Imputation</a></li>
<li class="chapter" data-level="14.8" data-path="multiple-imputation-and-linear-regression.html"><a href="multiple-imputation-and-linear-regression.html#running-the-linear-regression-in-lm-with-multiple-imputation"><i class="fa fa-check"></i><b>14.8</b> Running the Linear Regression in <code>lm</code> with Multiple Imputation</a></li>
<li class="chapter" data-level="14.9" data-path="multiple-imputation-and-linear-regression.html"><a href="multiple-imputation-and-linear-regression.html#fit-the-multiple-imputation-model-with-aregimpute"><i class="fa fa-check"></i><b>14.9</b> Fit the Multiple Imputation Model with <code>aregImpute</code></a></li>
<li class="chapter" data-level="14.10" data-path="multiple-imputation-and-linear-regression.html"><a href="multiple-imputation-and-linear-regression.html#fit-linear-regression-using-ols-and-fit.mult.impute"><i class="fa fa-check"></i><b>14.10</b> Fit Linear Regression using <code>ols</code> and <code>fit.mult.impute</code></a>
<ul>
<li class="chapter" data-level="14.10.1" data-path="multiple-imputation-and-linear-regression.html"><a href="multiple-imputation-and-linear-regression.html#summaries-and-coefficients"><i class="fa fa-check"></i><b>14.10.1</b> Summaries and Coefficients</a></li>
<li class="chapter" data-level="14.10.2" data-path="multiple-imputation-and-linear-regression.html"><a href="multiple-imputation-and-linear-regression.html#effect-sizes"><i class="fa fa-check"></i><b>14.10.2</b> Effect Sizes</a></li>
<li class="chapter" data-level="14.10.3" data-path="multiple-imputation-and-linear-regression.html"><a href="multiple-imputation-and-linear-regression.html#making-predictions-with-this-model"><i class="fa fa-check"></i><b>14.10.3</b> Making Predictions with this Model</a></li>
<li class="chapter" data-level="14.10.4" data-path="multiple-imputation-and-linear-regression.html"><a href="multiple-imputation-and-linear-regression.html#nomogram"><i class="fa fa-check"></i><b>14.10.4</b> Nomogram</a></li>
<li class="chapter" data-level="14.10.5" data-path="multiple-imputation-and-linear-regression.html"><a href="multiple-imputation-and-linear-regression.html#validating-summary-statistics"><i class="fa fa-check"></i><b>14.10.5</b> Validating Summary Statistics</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="15" data-path="using-tidymodels-to-fit-linear-regressions.html"><a href="using-tidymodels-to-fit-linear-regressions.html"><i class="fa fa-check"></i><b>15</b> Using tidymodels to fit linear regressions</a></li>
<li class="chapter" data-level="16" data-path="using-tidymodels-to-fit-logistic-regressions.html"><a href="using-tidymodels-to-fit-logistic-regressions.html"><i class="fa fa-check"></i><b>16</b> Using tidymodels to fit logistic regressions</a></li>
<li class="chapter" data-level="17" data-path="using-tidymodels-approaches-next-steps.html"><a href="using-tidymodels-approaches-next-steps.html"><i class="fa fa-check"></i><b>17</b> Using tidymodels approaches: Next Steps</a></li>
<li class="chapter" data-level="18" data-path="colorectal-cancer-screening-and-some-special-cases.html"><a href="colorectal-cancer-screening-and-some-special-cases.html"><i class="fa fa-check"></i><b>18</b> Colorectal Cancer Screening and Some Special Cases</a>
<ul>
<li class="chapter" data-level="18.1" data-path="colorectal-cancer-screening-and-some-special-cases.html"><a href="colorectal-cancer-screening-and-some-special-cases.html#logistic-regression-for-aggregated-data"><i class="fa fa-check"></i><b>18.1</b> Logistic Regression for Aggregated Data</a>
<ul>
<li class="chapter" data-level="18.1.1" data-path="colorectal-cancer-screening-and-some-special-cases.html"><a href="colorectal-cancer-screening-and-some-special-cases.html#colorectal-cancer-screening-data"><i class="fa fa-check"></i><b>18.1.1</b> Colorectal Cancer Screening Data</a></li>
<li class="chapter" data-level="18.1.2" data-path="colorectal-cancer-screening-and-some-special-cases.html"><a href="colorectal-cancer-screening-and-some-special-cases.html#fitting-a-logistic-regression-model-to-proportion-data"><i class="fa fa-check"></i><b>18.1.2</b> Fitting a Logistic Regression Model to Proportion Data</a></li>
<li class="chapter" data-level="18.1.3" data-path="colorectal-cancer-screening-and-some-special-cases.html"><a href="colorectal-cancer-screening-and-some-special-cases.html#fitting-a-logistic-regression-model-to-counts-of-successes-and-failures"><i class="fa fa-check"></i><b>18.1.3</b> Fitting a Logistic Regression Model to Counts of Successes and Failures</a></li>
<li class="chapter" data-level="18.1.4" data-path="colorectal-cancer-screening-and-some-special-cases.html"><a href="colorectal-cancer-screening-and-some-special-cases.html#how-does-one-address-this-problem-in-rms"><i class="fa fa-check"></i><b>18.1.4</b> How does one address this problem in <code>rms</code>?</a></li>
</ul></li>
<li class="chapter" data-level="18.2" data-path="colorectal-cancer-screening-and-some-special-cases.html"><a href="colorectal-cancer-screening-and-some-special-cases.html#probit-regression"><i class="fa fa-check"></i><b>18.2</b> Probit Regression</a>
<ul>
<li class="chapter" data-level="18.2.1" data-path="colorectal-cancer-screening-and-some-special-cases.html"><a href="colorectal-cancer-screening-and-some-special-cases.html#colorectal-cancer-screening-data-on-individuals"><i class="fa fa-check"></i><b>18.2.1</b> Colorectal Cancer Screening Data on Individuals</a></li>
<li class="chapter" data-level="18.2.2" data-path="colorectal-cancer-screening-and-some-special-cases.html"><a href="colorectal-cancer-screening-and-some-special-cases.html#a-logistic-regression-model"><i class="fa fa-check"></i><b>18.2.2</b> A logistic regression model</a></li>
<li class="chapter" data-level="18.2.3" data-path="colorectal-cancer-screening-and-some-special-cases.html"><a href="colorectal-cancer-screening-and-some-special-cases.html#predicting-status-for-harry-and-sally"><i class="fa fa-check"></i><b>18.2.3</b> Predicting status for Harry and Sally</a></li>
<li class="chapter" data-level="18.2.4" data-path="colorectal-cancer-screening-and-some-special-cases.html"><a href="colorectal-cancer-screening-and-some-special-cases.html#a-probit-regression-model"><i class="fa fa-check"></i><b>18.2.4</b> A probit regression model</a></li>
<li class="chapter" data-level="18.2.5" data-path="colorectal-cancer-screening-and-some-special-cases.html"><a href="colorectal-cancer-screening-and-some-special-cases.html#interpreting-the-probit-models-coefficients"><i class="fa fa-check"></i><b>18.2.5</b> Interpreting the Probit Model’s Coefficients</a></li>
<li class="chapter" data-level="18.2.6" data-path="colorectal-cancer-screening-and-some-special-cases.html"><a href="colorectal-cancer-screening-and-some-special-cases.html#what-about-harry-and-sally"><i class="fa fa-check"></i><b>18.2.6</b> What about Harry and Sally?</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="19" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html"><i class="fa fa-check"></i><b>19</b> Modeling a Count Outcome in Ohio SMART</a>
<ul>
<li class="chapter" data-level="19.1" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#preliminaries"><i class="fa fa-check"></i><b>19.1</b> Preliminaries</a></li>
<li class="chapter" data-level="19.2" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#a-subset-of-the-ohio-smart-data"><i class="fa fa-check"></i><b>19.2</b> A subset of the Ohio SMART data</a>
<ul>
<li class="chapter" data-level="19.2.1" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#is-age-group-associated-with-physhealth"><i class="fa fa-check"></i><b>19.2.1</b> Is age group associated with <code>physhealth</code>?</a></li>
</ul></li>
<li class="chapter" data-level="19.3" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#exploratory-data-analysis-in-the-18-49-group"><i class="fa fa-check"></i><b>19.3</b> Exploratory Data Analysis (in the 18-49 group)</a>
<ul>
<li class="chapter" data-level="19.3.1" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#build-a-subset-of-those-ages-18-49"><i class="fa fa-check"></i><b>19.3.1</b> Build a subset of those ages 18-49</a></li>
<li class="chapter" data-level="19.3.2" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#centering-bmi"><i class="fa fa-check"></i><b>19.3.2</b> Centering <code>bmi</code></a></li>
<li class="chapter" data-level="19.3.3" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#distribution-of-the-outcome"><i class="fa fa-check"></i><b>19.3.3</b> Distribution of the Outcome</a></li>
<li class="chapter" data-level="19.3.4" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#scatterplot-matrix"><i class="fa fa-check"></i><b>19.3.4</b> Scatterplot Matrix</a></li>
<li class="chapter" data-level="19.3.5" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#summary-of-the-final-subset-of-data"><i class="fa fa-check"></i><b>19.3.5</b> Summary of the final subset of data</a></li>
</ul></li>
<li class="chapter" data-level="19.4" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#modeling-strategies-explored-here"><i class="fa fa-check"></i><b>19.4</b> Modeling Strategies Explored Here</a>
<ul>
<li class="chapter" data-level="19.4.1" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#what-will-we-demonstrate"><i class="fa fa-check"></i><b>19.4.1</b> What Will We Demonstrate?</a></li>
<li class="chapter" data-level="19.4.2" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#extra-data-file-for-harry-and-sally"><i class="fa fa-check"></i><b>19.4.2</b> Extra Data File for Harry and Sally</a></li>
</ul></li>
<li class="chapter" data-level="19.5" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#the-ols-approach"><i class="fa fa-check"></i><b>19.5</b> The OLS Approach</a>
<ul>
<li class="chapter" data-level="19.5.1" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#interpreting-the-coefficients"><i class="fa fa-check"></i><b>19.5.1</b> Interpreting the Coefficients</a></li>
<li class="chapter" data-level="19.5.2" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#store-fitted-values-and-residuals"><i class="fa fa-check"></i><b>19.5.2</b> Store fitted values and residuals</a></li>
<li class="chapter" data-level="19.5.3" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#specify-the-r2-and-loglikelihood-values"><i class="fa fa-check"></i><b>19.5.3</b> Specify the R<sup>2</sup> and log(likelihood) values</a></li>
<li class="chapter" data-level="19.5.4" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#check-model-assumptions"><i class="fa fa-check"></i><b>19.5.4</b> Check model assumptions</a></li>
<li class="chapter" data-level="19.5.5" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#predictions-for-harry-and-sally"><i class="fa fa-check"></i><b>19.5.5</b> Predictions for Harry and Sally</a></li>
<li class="chapter" data-level="19.5.6" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#notes"><i class="fa fa-check"></i><b>19.5.6</b> Notes</a></li>
</ul></li>
<li class="chapter" data-level="19.6" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#ols-model-on-logphyshealth-1-days"><i class="fa fa-check"></i><b>19.6</b> OLS model on log(<code>physhealth</code> + 1) days</a>
<ul>
<li class="chapter" data-level="19.6.1" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#interpreting-the-coefficients-1"><i class="fa fa-check"></i><b>19.6.1</b> Interpreting the Coefficients</a></li>
<li class="chapter" data-level="19.6.2" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#store-fitted-values-and-residuals-1"><i class="fa fa-check"></i><b>19.6.2</b> Store fitted values and residuals</a></li>
<li class="chapter" data-level="19.6.3" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#specify-the-r2-and-loglikelihood-values-1"><i class="fa fa-check"></i><b>19.6.3</b> Specify the R<sup>2</sup> and log(likelihood) values</a></li>
<li class="chapter" data-level="19.6.4" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#getting-r2-on-the-scale-of-physhealth"><i class="fa fa-check"></i><b>19.6.4</b> Getting R<sup>2</sup> on the scale of <code>physhealth</code></a></li>
<li class="chapter" data-level="19.6.5" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#check-model-assumptions-1"><i class="fa fa-check"></i><b>19.6.5</b> Check model assumptions</a></li>
<li class="chapter" data-level="19.6.6" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#predictions-for-harry-and-sally-1"><i class="fa fa-check"></i><b>19.6.6</b> Predictions for Harry and Sally</a></li>
</ul></li>
<li class="chapter" data-level="19.7" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#a-poisson-regression-model"><i class="fa fa-check"></i><b>19.7</b> A Poisson Regression Model</a>
<ul>
<li class="chapter" data-level="19.7.1" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#the-fitted-equation"><i class="fa fa-check"></i><b>19.7.1</b> The Fitted Equation</a></li>
<li class="chapter" data-level="19.7.2" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#interpreting-the-coefficients-2"><i class="fa fa-check"></i><b>19.7.2</b> Interpreting the Coefficients</a></li>
<li class="chapter" data-level="19.7.3" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#testing-the-predictors"><i class="fa fa-check"></i><b>19.7.3</b> Testing the Predictors</a></li>
<li class="chapter" data-level="19.7.4" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#correcting-for-overdispersion-with-coeftestcoefci"><i class="fa fa-check"></i><b>19.7.4</b> Correcting for Overdispersion with <code>coeftest</code>/<code>coefci</code></a></li>
<li class="chapter" data-level="19.7.5" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#store-fitted-values-and-residuals-2"><i class="fa fa-check"></i><b>19.7.5</b> Store fitted values and residuals</a></li>
<li class="chapter" data-level="19.7.6" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#rootogram-see-the-fit-of-a-count-regression-model"><i class="fa fa-check"></i><b>19.7.6</b> Rootogram: see the fit of a count regression model</a></li>
<li class="chapter" data-level="19.7.7" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#specify-the-r2-and-loglikelihood-values-2"><i class="fa fa-check"></i><b>19.7.7</b> Specify the R<sup>2</sup> and log(likelihood) values</a></li>
<li class="chapter" data-level="19.7.8" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#check-model-assumptions-2"><i class="fa fa-check"></i><b>19.7.8</b> Check model assumptions</a></li>
<li class="chapter" data-level="19.7.9" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#using-glm.diag.plots-from-the-boot-package"><i class="fa fa-check"></i><b>19.7.9</b> Using <code>glm.diag.plots</code> from the <code>boot</code> package</a></li>
<li class="chapter" data-level="19.7.10" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#predictions-for-harry-and-sally-2"><i class="fa fa-check"></i><b>19.7.10</b> Predictions for Harry and Sally</a></li>
</ul></li>
<li class="chapter" data-level="19.8" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#overdispersion-in-a-poisson-model"><i class="fa fa-check"></i><b>19.8</b> Overdispersion in a Poisson Model</a>
<ul>
<li class="chapter" data-level="19.8.1" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#testing-for-overdispersion"><i class="fa fa-check"></i><b>19.8.1</b> Testing for Overdispersion?</a></li>
</ul></li>
<li class="chapter" data-level="19.9" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#fitting-the-quasi-poisson-model"><i class="fa fa-check"></i><b>19.9</b> Fitting the Quasi-Poisson Model</a>
<ul>
<li class="chapter" data-level="19.9.1" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#the-fitted-equation-1"><i class="fa fa-check"></i><b>19.9.1</b> The Fitted Equation</a></li>
<li class="chapter" data-level="19.9.2" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#interpreting-the-coefficients-3"><i class="fa fa-check"></i><b>19.9.2</b> Interpreting the Coefficients</a></li>
<li class="chapter" data-level="19.9.3" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#testing-the-predictors-1"><i class="fa fa-check"></i><b>19.9.3</b> Testing the Predictors</a></li>
<li class="chapter" data-level="19.9.4" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#store-fitted-values-and-residuals-3"><i class="fa fa-check"></i><b>19.9.4</b> Store fitted values and residuals</a></li>
<li class="chapter" data-level="19.9.5" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#specify-the-r2-and-loglikelihood-values-3"><i class="fa fa-check"></i><b>19.9.5</b> Specify the R<sup>2</sup> and log(likelihood) values</a></li>
<li class="chapter" data-level="19.9.6" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#check-model-assumptions-3"><i class="fa fa-check"></i><b>19.9.6</b> Check model assumptions</a></li>
<li class="chapter" data-level="19.9.7" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#predictions-for-harry-and-sally-3"><i class="fa fa-check"></i><b>19.9.7</b> Predictions for Harry and Sally</a></li>
</ul></li>
<li class="chapter" data-level="19.10" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#poisson-and-quasi-poisson-models-using-glm-from-the-rms-package"><i class="fa fa-check"></i><b>19.10</b> Poisson and Quasi-Poisson models using <code>Glm</code> from the <code>rms</code> package</a>
<ul>
<li class="chapter" data-level="19.10.1" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#refitting-the-original-poisson-regression-with-glm"><i class="fa fa-check"></i><b>19.10.1</b> Refitting the original Poisson regression with <code>Glm</code></a></li>
<li class="chapter" data-level="19.10.2" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#refitting-the-overdispersed-poisson-regression-with-glm"><i class="fa fa-check"></i><b>19.10.2</b> Refitting the overdispersed Poisson regression with <code>Glm</code></a></li>
<li class="chapter" data-level="19.10.3" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#anova-on-a-glm-fit"><i class="fa fa-check"></i><b>19.10.3</b> ANOVA on a <code>Glm</code> fit</a></li>
<li class="chapter" data-level="19.10.4" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#ggplots-from-glm-fit"><i class="fa fa-check"></i><b>19.10.4</b> ggplots from <code>Glm</code> fit</a></li>
<li class="chapter" data-level="19.10.5" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#summary-of-a-glm-fit"><i class="fa fa-check"></i><b>19.10.5</b> Summary of a <code>Glm</code> fit</a></li>
<li class="chapter" data-level="19.10.6" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#plot-of-the-summary"><i class="fa fa-check"></i><b>19.10.6</b> Plot of the Summary</a></li>
<li class="chapter" data-level="19.10.7" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#nomogram-of-a-glm-fit"><i class="fa fa-check"></i><b>19.10.7</b> Nomogram of a <code>Glm</code> fit</a></li>
</ul></li>
<li class="chapter" data-level="19.11" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#negative-binomial-model"><i class="fa fa-check"></i><b>19.11</b> Negative Binomial Model</a>
<ul>
<li class="chapter" data-level="19.11.1" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#the-fitted-equation-2"><i class="fa fa-check"></i><b>19.11.1</b> The Fitted Equation</a></li>
<li class="chapter" data-level="19.11.2" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#comparison-with-the-raw-poisson-model"><i class="fa fa-check"></i><b>19.11.2</b> Comparison with the (raw) Poisson model</a></li>
<li class="chapter" data-level="19.11.3" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#interpreting-the-coefficients-4"><i class="fa fa-check"></i><b>19.11.3</b> Interpreting the Coefficients</a></li>
<li class="chapter" data-level="19.11.4" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#interpretation-of-coefficients-in-terms-of-irrs"><i class="fa fa-check"></i><b>19.11.4</b> Interpretation of Coefficients in terms of IRRs</a></li>
<li class="chapter" data-level="19.11.5" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#testing-the-predictors-2"><i class="fa fa-check"></i><b>19.11.5</b> Testing the Predictors</a></li>
<li class="chapter" data-level="19.11.6" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#store-fitted-values-and-residuals-4"><i class="fa fa-check"></i><b>19.11.6</b> Store fitted values and residuals</a></li>
<li class="chapter" data-level="19.11.7" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#rootogram-for-negative-binomial-model"><i class="fa fa-check"></i><b>19.11.7</b> Rootogram for Negative Binomial model</a></li>
<li class="chapter" data-level="19.11.8" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#simulating-what-the-negative-binomial-model-predicts"><i class="fa fa-check"></i><b>19.11.8</b> Simulating what the Negative Binomial model predicts</a></li>
<li class="chapter" data-level="19.11.9" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#specify-the-r2-and-loglikelihood-values-4"><i class="fa fa-check"></i><b>19.11.9</b> Specify the R<sup>2</sup> and log(likelihood) values</a></li>
<li class="chapter" data-level="19.11.10" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#check-model-assumptions-4"><i class="fa fa-check"></i><b>19.11.10</b> Check model assumptions</a></li>
<li class="chapter" data-level="19.11.11" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#predictions-for-harry-and-sally-4"><i class="fa fa-check"></i><b>19.11.11</b> Predictions for Harry and Sally</a></li>
</ul></li>
<li class="chapter" data-level="19.12" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#the-problem-too-few-zeros"><i class="fa fa-check"></i><b>19.12</b> The Problem: Too Few Zeros</a></li>
<li class="chapter" data-level="19.13" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#the-zero-inflated-poisson-regression-model"><i class="fa fa-check"></i><b>19.13</b> The Zero-Inflated Poisson Regression Model</a>
<ul>
<li class="chapter" data-level="19.13.1" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#comparison-to-a-null-model"><i class="fa fa-check"></i><b>19.13.1</b> Comparison to a null model</a></li>
<li class="chapter" data-level="19.13.2" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#comparison-to-a-poisson-model-with-the-vuong-test"><i class="fa fa-check"></i><b>19.13.2</b> Comparison to a Poisson Model with the Vuong test</a></li>
<li class="chapter" data-level="19.13.3" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#the-fitted-equation-3"><i class="fa fa-check"></i><b>19.13.3</b> The Fitted Equation</a></li>
<li class="chapter" data-level="19.13.4" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#interpreting-the-coefficients-5"><i class="fa fa-check"></i><b>19.13.4</b> Interpreting the Coefficients</a></li>
<li class="chapter" data-level="19.13.5" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#testing-the-predictors-3"><i class="fa fa-check"></i><b>19.13.5</b> Testing the Predictors</a></li>
<li class="chapter" data-level="19.13.6" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#store-fitted-values-and-residuals-5"><i class="fa fa-check"></i><b>19.13.6</b> Store fitted values and residuals</a></li>
<li class="chapter" data-level="19.13.7" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#modeled-number-of-zero-counts"><i class="fa fa-check"></i><b>19.13.7</b> Modeled Number of Zero Counts</a></li>
<li class="chapter" data-level="19.13.8" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#rootogram-for-zip-model"><i class="fa fa-check"></i><b>19.13.8</b> Rootogram for ZIP model</a></li>
<li class="chapter" data-level="19.13.9" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#specify-the-r2-and-log-likelihood-values"><i class="fa fa-check"></i><b>19.13.9</b> Specify the R<sup>2</sup> and log (likelihood) values</a></li>
<li class="chapter" data-level="19.13.10" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#check-model-assumptions-5"><i class="fa fa-check"></i><b>19.13.10</b> Check model assumptions</a></li>
<li class="chapter" data-level="19.13.11" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#predictions-for-harry-and-sally-5"><i class="fa fa-check"></i><b>19.13.11</b> Predictions for Harry and Sally</a></li>
</ul></li>
<li class="chapter" data-level="19.14" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#the-zero-inflated-negative-binomial-regression-model"><i class="fa fa-check"></i><b>19.14</b> The Zero-Inflated Negative Binomial Regression Model</a>
<ul>
<li class="chapter" data-level="19.14.1" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#comparison-to-a-null-model-1"><i class="fa fa-check"></i><b>19.14.1</b> Comparison to a null model</a></li>
<li class="chapter" data-level="19.14.2" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#comparison-to-a-negative-binomial-model-vuong-test"><i class="fa fa-check"></i><b>19.14.2</b> Comparison to a Negative Binomial Model: Vuong test</a></li>
<li class="chapter" data-level="19.14.3" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#the-fitted-equation-4"><i class="fa fa-check"></i><b>19.14.3</b> The Fitted Equation</a></li>
<li class="chapter" data-level="19.14.4" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#interpreting-the-coefficients-6"><i class="fa fa-check"></i><b>19.14.4</b> Interpreting the Coefficients</a></li>
<li class="chapter" data-level="19.14.5" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#testing-the-predictors-4"><i class="fa fa-check"></i><b>19.14.5</b> Testing the Predictors</a></li>
<li class="chapter" data-level="19.14.6" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#store-fitted-values-and-residuals-6"><i class="fa fa-check"></i><b>19.14.6</b> Store fitted values and residuals</a></li>
<li class="chapter" data-level="19.14.7" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#modeled-number-of-zero-counts-1"><i class="fa fa-check"></i><b>19.14.7</b> Modeled Number of Zero Counts</a></li>
<li class="chapter" data-level="19.14.8" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#rootogram-for-zero-inflated-negative-binomial-model"><i class="fa fa-check"></i><b>19.14.8</b> Rootogram for Zero-Inflated Negative Binomial model</a></li>
<li class="chapter" data-level="19.14.9" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#specify-the-r2-and-log-likelihood-values-1"><i class="fa fa-check"></i><b>19.14.9</b> Specify the R<sup>2</sup> and log (likelihood) values</a></li>
<li class="chapter" data-level="19.14.10" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#check-model-assumptions-6"><i class="fa fa-check"></i><b>19.14.10</b> Check model assumptions</a></li>
<li class="chapter" data-level="19.14.11" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#predictions-for-harry-and-sally-6"><i class="fa fa-check"></i><b>19.14.11</b> Predictions for Harry and Sally</a></li>
</ul></li>
<li class="chapter" data-level="19.15" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#a-hurdle-model-with-poisson"><i class="fa fa-check"></i><b>19.15</b> A “hurdle” model (with Poisson)</a>
<ul>
<li class="chapter" data-level="19.15.1" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#comparison-to-a-null-model-2"><i class="fa fa-check"></i><b>19.15.1</b> Comparison to a null model</a></li>
<li class="chapter" data-level="19.15.2" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#comparison-to-a-poisson-model-vuong-test"><i class="fa fa-check"></i><b>19.15.2</b> Comparison to a Poisson Model: Vuong test</a></li>
<li class="chapter" data-level="19.15.3" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#comparison-to-a-zero-inflated-poisson-model-vuong-test"><i class="fa fa-check"></i><b>19.15.3</b> Comparison to a Zero-Inflated Poisson Model: Vuong test</a></li>
<li class="chapter" data-level="19.15.4" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#the-fitted-equation-5"><i class="fa fa-check"></i><b>19.15.4</b> The Fitted Equation</a></li>
<li class="chapter" data-level="19.15.5" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#interpreting-the-coefficients-7"><i class="fa fa-check"></i><b>19.15.5</b> Interpreting the Coefficients</a></li>
<li class="chapter" data-level="19.15.6" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#testing-the-predictors-5"><i class="fa fa-check"></i><b>19.15.6</b> Testing the Predictors</a></li>
<li class="chapter" data-level="19.15.7" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#store-fitted-values-and-residuals-7"><i class="fa fa-check"></i><b>19.15.7</b> Store fitted values and residuals</a></li>
<li class="chapter" data-level="19.15.8" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#modeled-number-of-zero-counts-2"><i class="fa fa-check"></i><b>19.15.8</b> Modeled Number of Zero Counts</a></li>
<li class="chapter" data-level="19.15.9" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#rootogram-for-hurdle-model"><i class="fa fa-check"></i><b>19.15.9</b> Rootogram for Hurdle Model</a></li>
<li class="chapter" data-level="19.15.10" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#understanding-the-modeled-counts-in-detail"><i class="fa fa-check"></i><b>19.15.10</b> Understanding the Modeled Counts in Detail</a></li>
<li class="chapter" data-level="19.15.11" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#specify-the-r2-and-log-likelihood-values-2"><i class="fa fa-check"></i><b>19.15.11</b> Specify the R<sup>2</sup> and log (likelihood) values</a></li>
<li class="chapter" data-level="19.15.12" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#check-model-assumptions-7"><i class="fa fa-check"></i><b>19.15.12</b> Check model assumptions</a></li>
<li class="chapter" data-level="19.15.13" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#predictions-for-harry-and-sally-7"><i class="fa fa-check"></i><b>19.15.13</b> Predictions for Harry and Sally</a></li>
</ul></li>
<li class="chapter" data-level="19.16" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#a-hurdle-model-with-negative-binomial-for-overdispersion"><i class="fa fa-check"></i><b>19.16</b> A “hurdle” model (with negative binomial for overdispersion)</a>
<ul>
<li class="chapter" data-level="19.16.1" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#comparison-to-a-null-model-3"><i class="fa fa-check"></i><b>19.16.1</b> Comparison to a null model</a></li>
<li class="chapter" data-level="19.16.2" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#comparison-to-a-negative-binomial-model-vuong-test-1"><i class="fa fa-check"></i><b>19.16.2</b> Comparison to a Negative Binomial Model: Vuong test</a></li>
<li class="chapter" data-level="19.16.3" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#comparison-to-a-zero-inflated-nb-model-vuong-test"><i class="fa fa-check"></i><b>19.16.3</b> Comparison to a Zero-Inflated NB Model: Vuong test</a></li>
<li class="chapter" data-level="19.16.4" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#comparing-the-hurdle-models-with-aic-and-bic"><i class="fa fa-check"></i><b>19.16.4</b> Comparing the Hurdle Models with AIC and BIC</a></li>
<li class="chapter" data-level="19.16.5" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#the-fitted-equation-6"><i class="fa fa-check"></i><b>19.16.5</b> The Fitted Equation</a></li>
<li class="chapter" data-level="19.16.6" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#interpreting-the-coefficients-8"><i class="fa fa-check"></i><b>19.16.6</b> Interpreting the Coefficients</a></li>
<li class="chapter" data-level="19.16.7" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#testing-the-predictors-6"><i class="fa fa-check"></i><b>19.16.7</b> Testing the Predictors</a></li>
<li class="chapter" data-level="19.16.8" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#store-fitted-values-and-residuals-8"><i class="fa fa-check"></i><b>19.16.8</b> Store fitted values and residuals</a></li>
<li class="chapter" data-level="19.16.9" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#rootogram-for-nb-hurdle-model"><i class="fa fa-check"></i><b>19.16.9</b> Rootogram for NB Hurdle Model</a></li>
<li class="chapter" data-level="19.16.10" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#specify-the-r2-and-log-likelihood-values-3"><i class="fa fa-check"></i><b>19.16.10</b> Specify the R<sup>2</sup> and log (likelihood) values</a></li>
<li class="chapter" data-level="19.16.11" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#check-model-assumptions-8"><i class="fa fa-check"></i><b>19.16.11</b> Check model assumptions</a></li>
<li class="chapter" data-level="19.16.12" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#predictions-for-harry-and-sally-8"><i class="fa fa-check"></i><b>19.16.12</b> Predictions for Harry and Sally</a></li>
<li class="chapter" data-level="19.16.13" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#note-fitting-a-different-hurdle-model-for-counts-and-przero"><i class="fa fa-check"></i><b>19.16.13</b> Note: Fitting a Different Hurdle Model for Counts and Pr(zero)</a></li>
<li class="chapter" data-level="19.16.14" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#hanging-rootogram-for-this-new-hurdle-model"><i class="fa fa-check"></i><b>19.16.14</b> Hanging Rootogram for this new Hurdle Model</a></li>
</ul></li>
<li class="chapter" data-level="19.17" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#a-tobit-censored-regression-model"><i class="fa fa-check"></i><b>19.17</b> A Tobit (Censored) Regression Model</a>
<ul>
<li class="chapter" data-level="19.17.1" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#the-fitted-equation-7"><i class="fa fa-check"></i><b>19.17.1</b> The Fitted Equation</a></li>
<li class="chapter" data-level="19.17.2" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#interpreting-the-coefficients-9"><i class="fa fa-check"></i><b>19.17.2</b> Interpreting the Coefficients</a></li>
<li class="chapter" data-level="19.17.3" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#testing-the-predictors-7"><i class="fa fa-check"></i><b>19.17.3</b> Testing the Predictors</a></li>
<li class="chapter" data-level="19.17.4" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#store-fitted-values-and-residuals-9"><i class="fa fa-check"></i><b>19.17.4</b> Store fitted values and residuals</a></li>
<li class="chapter" data-level="19.17.5" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#building-something-like-a-rootogram"><i class="fa fa-check"></i><b>19.17.5</b> Building Something Like a Rootogram</a></li>
<li class="chapter" data-level="19.17.6" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#tables-of-the-observed-and-fitted-physhealth-from-tobit"><i class="fa fa-check"></i><b>19.17.6</b> Tables of the Observed and Fitted <code>physhealth</code> from Tobit</a></li>
<li class="chapter" data-level="19.17.7" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#specify-the-r2-and-log-likelihood-values-4"><i class="fa fa-check"></i><b>19.17.7</b> Specify the R<sup>2</sup> and log (likelihood) values</a></li>
<li class="chapter" data-level="19.17.8" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#check-model-assumptions-9"><i class="fa fa-check"></i><b>19.17.8</b> Check model assumptions</a></li>
<li class="chapter" data-level="19.17.9" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#predictions-for-harry-and-sally-9"><i class="fa fa-check"></i><b>19.17.9</b> Predictions for Harry and Sally</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="20" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><i class="fa fa-check"></i><b>20</b> Modeling an Ordinal Categorical Outcome in Ohio SMART</a>
<ul>
<li class="chapter" data-level="20.1" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#preliminaries-1"><i class="fa fa-check"></i><b>20.1</b> Preliminaries</a></li>
<li class="chapter" data-level="20.2" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#a-subset-of-the-ohio-smart-data-1"><i class="fa fa-check"></i><b>20.2</b> A subset of the Ohio SMART data</a>
<ul>
<li class="chapter" data-level="20.2.1" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#several-ways-of-storing-multi-categorical-data"><i class="fa fa-check"></i><b>20.2.1</b> Several Ways of Storing Multi-Categorical data</a></li>
</ul></li>
<li class="chapter" data-level="20.3" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#building-cross-tabulations"><i class="fa fa-check"></i><b>20.3</b> Building Cross-Tabulations</a>
<ul>
<li class="chapter" data-level="20.3.1" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#using-base-table-functions"><i class="fa fa-check"></i><b>20.3.1</b> Using base <code>table</code> functions</a></li>
<li class="chapter" data-level="20.3.2" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#using-xtabs"><i class="fa fa-check"></i><b>20.3.2</b> Using <code>xtabs</code></a></li>
<li class="chapter" data-level="20.3.3" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#storing-a-table-in-a-tibble"><i class="fa fa-check"></i><b>20.3.3</b> Storing a table in a tibble</a></li>
<li class="chapter" data-level="20.3.4" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#using-crosstable-from-the-gmodels-package"><i class="fa fa-check"></i><b>20.3.4</b> Using <code>CrossTable</code> from the <code>gmodels</code> package</a></li>
</ul></li>
<li class="chapter" data-level="20.4" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#graphing-categorical-data"><i class="fa fa-check"></i><b>20.4</b> Graphing Categorical Data</a>
<ul>
<li class="chapter" data-level="20.4.1" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#a-bar-chart-for-a-single-variable"><i class="fa fa-check"></i><b>20.4.1</b> A Bar Chart for a Single Variable</a></li>
<li class="chapter" data-level="20.4.2" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#a-counts-chart-for-a-2-way-cross-tabulation"><i class="fa fa-check"></i><b>20.4.2</b> A Counts Chart for a 2-Way Cross-Tabulation</a></li>
</ul></li>
<li class="chapter" data-level="20.5" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#building-a-model-for-genh-using-veg_day"><i class="fa fa-check"></i><b>20.5</b> Building a Model for <code>genh</code> using <code>veg_day</code></a>
<ul>
<li class="chapter" data-level="20.5.1" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#a-little-eda"><i class="fa fa-check"></i><b>20.5.1</b> A little EDA</a></li>
<li class="chapter" data-level="20.5.2" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#describing-the-proportional-odds-cumulative-logit-model"><i class="fa fa-check"></i><b>20.5.2</b> Describing the Proportional-Odds Cumulative Logit Model</a></li>
<li class="chapter" data-level="20.5.3" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#fitting-a-proportional-odds-logistic-regression-with-polr"><i class="fa fa-check"></i><b>20.5.3</b> Fitting a Proportional Odds Logistic Regression with <code>polr</code></a></li>
</ul></li>
<li class="chapter" data-level="20.6" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#interpreting-model-m1"><i class="fa fa-check"></i><b>20.6</b> Interpreting Model <code>m1</code></a>
<ul>
<li class="chapter" data-level="20.6.1" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#looking-at-predictions"><i class="fa fa-check"></i><b>20.6.1</b> Looking at Predictions</a></li>
<li class="chapter" data-level="20.6.2" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#making-predictions-for-harry-and-sally-with-predict"><i class="fa fa-check"></i><b>20.6.2</b> Making Predictions for Harry (and Sally) with <code>predict</code></a></li>
<li class="chapter" data-level="20.6.3" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#predicting-the-actual-classification-of-genh"><i class="fa fa-check"></i><b>20.6.3</b> Predicting the actual classification of <code>genh</code></a></li>
<li class="chapter" data-level="20.6.4" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#a-cross-tabulation-of-predictions"><i class="fa fa-check"></i><b>20.6.4</b> A Cross-Tabulation of Predictions?</a></li>
<li class="chapter" data-level="20.6.5" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#the-fitted-model-equations"><i class="fa fa-check"></i><b>20.6.5</b> The Fitted Model Equations</a></li>
<li class="chapter" data-level="20.6.6" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#interpreting-the-veg_day-coefficient"><i class="fa fa-check"></i><b>20.6.6</b> Interpreting the <code>veg_day</code> coefficient</a></li>
<li class="chapter" data-level="20.6.7" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#exponentiating-the-slope-coefficient-to-facilitate-interpretation"><i class="fa fa-check"></i><b>20.6.7</b> Exponentiating the Slope Coefficient to facilitate Interpretation</a></li>
<li class="chapter" data-level="20.6.8" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#comparison-to-a-null-model-4"><i class="fa fa-check"></i><b>20.6.8</b> Comparison to a Null Model</a></li>
</ul></li>
<li class="chapter" data-level="20.7" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#the-assumption-of-proportional-odds"><i class="fa fa-check"></i><b>20.7</b> The Assumption of Proportional Odds</a>
<ul>
<li class="chapter" data-level="20.7.1" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#testing-the-proportional-odds-assumption"><i class="fa fa-check"></i><b>20.7.1</b> Testing the Proportional Odds Assumption</a></li>
</ul></li>
<li class="chapter" data-level="20.8" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#can-model-m1-be-fit-using-rms-tools"><i class="fa fa-check"></i><b>20.8</b> Can model <code>m1</code> be fit using <code>rms</code> tools?</a></li>
<li class="chapter" data-level="20.9" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#building-a-three-predictor-model"><i class="fa fa-check"></i><b>20.9</b> Building a Three-Predictor Model</a>
<ul>
<li class="chapter" data-level="20.9.1" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#scatterplot-matrix-1"><i class="fa fa-check"></i><b>20.9.1</b> Scatterplot Matrix</a></li>
<li class="chapter" data-level="20.9.2" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#our-three-predictor-model-m2"><i class="fa fa-check"></i><b>20.9.2</b> Our Three-Predictor Model, <code>m2</code></a></li>
<li class="chapter" data-level="20.9.3" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#does-the-three-predictor-model-outperform-m1"><i class="fa fa-check"></i><b>20.9.3</b> Does the three-predictor model outperform <code>m1</code>?</a></li>
<li class="chapter" data-level="20.9.4" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#wald-tests-for-individual-predictors"><i class="fa fa-check"></i><b>20.9.4</b> Wald tests for individual predictors</a></li>
<li class="chapter" data-level="20.9.5" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#a-cross-tabulation-of-predictions-1"><i class="fa fa-check"></i><b>20.9.5</b> A Cross-Tabulation of Predictions?</a></li>
<li class="chapter" data-level="20.9.6" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#interpreting-the-effect-sizes"><i class="fa fa-check"></i><b>20.9.6</b> Interpreting the Effect Sizes</a></li>
<li class="chapter" data-level="20.9.7" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#quality-of-the-model-fit"><i class="fa fa-check"></i><b>20.9.7</b> Quality of the Model Fit</a></li>
<li class="chapter" data-level="20.9.8" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#validating-the-summary-statistics-in-m2_lrm"><i class="fa fa-check"></i><b>20.9.8</b> Validating the Summary Statistics in <code>m2_lrm</code></a></li>
<li class="chapter" data-level="20.9.9" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#testing-the-proportional-odds-assumption-1"><i class="fa fa-check"></i><b>20.9.9</b> Testing the Proportional Odds Assumption</a></li>
<li class="chapter" data-level="20.9.10" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#plotting-the-fitted-model"><i class="fa fa-check"></i><b>20.9.10</b> Plotting the Fitted Model</a></li>
</ul></li>
<li class="chapter" data-level="20.10" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#a-larger-model-including-income-group"><i class="fa fa-check"></i><b>20.10</b> A Larger Model, including income group</a>
<ul>
<li class="chapter" data-level="20.10.1" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#cross-tabulation-of-predictedobserved-classifications"><i class="fa fa-check"></i><b>20.10.1</b> Cross-Tabulation of Predicted/Observed Classifications</a></li>
<li class="chapter" data-level="20.10.2" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#nomogram-2"><i class="fa fa-check"></i><b>20.10.2</b> Nomogram</a></li>
<li class="chapter" data-level="20.10.3" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#using-predict-and-showing-mean-prediction-on-1-5-scale-1"><i class="fa fa-check"></i><b>20.10.3</b> Using Predict and showing mean prediction on 1-5 scale</a></li>
<li class="chapter" data-level="20.10.4" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#validating-the-summary-statistics-in-m3_lrm"><i class="fa fa-check"></i><b>20.10.4</b> Validating the Summary Statistics in <code>m3_lrm</code></a></li>
</ul></li>
<li class="chapter" data-level="20.11" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#references-for-this-chapter"><i class="fa fa-check"></i><b>20.11</b> References for this Chapter</a></li>
</ul></li>
<li class="chapter" data-level="21" data-path="analyzing-literary-styles-with-multinomial-logistic-regression.html"><a href="analyzing-literary-styles-with-multinomial-logistic-regression.html"><i class="fa fa-check"></i><b>21</b> Analyzing Literary Styles with Multinomial Logistic Regression</a>
<ul>
<li class="chapter" data-level="21.1" data-path="analyzing-literary-styles-with-multinomial-logistic-regression.html"><a href="analyzing-literary-styles-with-multinomial-logistic-regression.html#the-authorship-example"><i class="fa fa-check"></i><b>21.1</b> The Authorship Example</a></li>
<li class="chapter" data-level="21.2" data-path="analyzing-literary-styles-with-multinomial-logistic-regression.html"><a href="analyzing-literary-styles-with-multinomial-logistic-regression.html#focus-on-11-key-words"><i class="fa fa-check"></i><b>21.2</b> Focus on 11 key words</a>
<ul>
<li class="chapter" data-level="21.2.1" data-path="analyzing-literary-styles-with-multinomial-logistic-regression.html"><a href="analyzing-literary-styles-with-multinomial-logistic-regression.html#side-by-side-boxplots"><i class="fa fa-check"></i><b>21.2.1</b> Side by Side Boxplots</a></li>
</ul></li>
<li class="chapter" data-level="21.3" data-path="analyzing-literary-styles-with-multinomial-logistic-regression.html"><a href="analyzing-literary-styles-with-multinomial-logistic-regression.html#a-multinomial-logistic-regression-model"><i class="fa fa-check"></i><b>21.3</b> A Multinomial Logistic Regression Model</a>
<ul>
<li class="chapter" data-level="21.3.1" data-path="analyzing-literary-styles-with-multinomial-logistic-regression.html"><a href="analyzing-literary-styles-with-multinomial-logistic-regression.html#testing-model-1"><i class="fa fa-check"></i><b>21.3.1</b> Testing Model 1</a></li>
</ul></li>
<li class="chapter" data-level="21.4" data-path="analyzing-literary-styles-with-multinomial-logistic-regression.html"><a href="analyzing-literary-styles-with-multinomial-logistic-regression.html#model-2"><i class="fa fa-check"></i><b>21.4</b> Model 2</a>
<ul>
<li class="chapter" data-level="21.4.1" data-path="analyzing-literary-styles-with-multinomial-logistic-regression.html"><a href="analyzing-literary-styles-with-multinomial-logistic-regression.html#comparing-model-2-to-model-1"><i class="fa fa-check"></i><b>21.4.1</b> Comparing Model 2 to Model 1</a></li>
<li class="chapter" data-level="21.4.2" data-path="analyzing-literary-styles-with-multinomial-logistic-regression.html"><a href="analyzing-literary-styles-with-multinomial-logistic-regression.html#testing-model-2"><i class="fa fa-check"></i><b>21.4.2</b> Testing Model 2</a></li>
<li class="chapter" data-level="21.4.3" data-path="analyzing-literary-styles-with-multinomial-logistic-regression.html"><a href="analyzing-literary-styles-with-multinomial-logistic-regression.html#a-little-history"><i class="fa fa-check"></i><b>21.4.3</b> A little history</a></li>
</ul></li>
<li class="chapter" data-level="21.5" data-path="analyzing-literary-styles-with-multinomial-logistic-regression.html"><a href="analyzing-literary-styles-with-multinomial-logistic-regression.html#classification-table"><i class="fa fa-check"></i><b>21.5</b> Classification Table</a></li>
<li class="chapter" data-level="21.6" data-path="analyzing-literary-styles-with-multinomial-logistic-regression.html"><a href="analyzing-literary-styles-with-multinomial-logistic-regression.html#probability-curves-based-on-a-single-predictor"><i class="fa fa-check"></i><b>21.6</b> Probability Curves based on a Single Predictor</a>
<ul>
<li class="chapter" data-level="21.6.1" data-path="analyzing-literary-styles-with-multinomial-logistic-regression.html"><a href="analyzing-literary-styles-with-multinomial-logistic-regression.html#produce-the-plot-of-estimated-probabilities-based-on-been-counts"><i class="fa fa-check"></i><b>21.6.1</b> Produce the Plot of Estimated Probabilities based on “been” counts</a></li>
<li class="chapter" data-level="21.6.2" data-path="analyzing-literary-styles-with-multinomial-logistic-regression.html"><a href="analyzing-literary-styles-with-multinomial-logistic-regression.html#boxplot-of-been-counts"><i class="fa fa-check"></i><b>21.6.2</b> Boxplot of “been” counts</a></li>
<li class="chapter" data-level="21.6.3" data-path="analyzing-literary-styles-with-multinomial-logistic-regression.html"><a href="analyzing-literary-styles-with-multinomial-logistic-regression.html#quote-sources"><i class="fa fa-check"></i><b>21.6.3</b> Quote Sources</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Data Science for Biological, Medical and Health Research: Notes for 432</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="modeling-a-count-outcome-in-ohio-smart" class="section level1" number="19">
<h1><span class="header-section-number">Chapter 19</span> Modeling a Count Outcome in Ohio SMART</h1>
<p>In this chapter, I use a count outcome (# of poor physical health days out of the last 30) to demonstrate regression models for count outcomes.</p>
<p>Methods discussed in the chapter include the following:</p>
<ul>
<li>Ordinary Least Squares</li>
<li>Poisson Regression</li>
<li>Overdispersed Quasi-Poisson Regression</li>
<li>Negative Binomial Regression</li>
<li>Zero-Inflated Poisson Regression</li>
<li>Zero-Inflated Negative Binomial Regression</li>
<li>Hurdle Models with Poisson counts</li>
<li>Hurdle Models with Negative Binomial counts</li>
<li>Tobit Regression</li>
</ul>
<div id="preliminaries" class="section level2" number="19.1">
<h2><span class="header-section-number">19.1</span> Preliminaries</h2>
<div class="sourceCode" id="cb984"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb984-1"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb984-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb984-2"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb984-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lmtest)</span>
<span id="cb984-3"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb984-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sandwich)</span>
<span id="cb984-4"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb984-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(countreg)</span>
<span id="cb984-5"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb984-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(VGAM)</span></code></pre></div>
<div class="sourceCode" id="cb985"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb985-1"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb985-1" aria-hidden="true" tabindex="-1"></a>smart_oh <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="fu">here</span>(<span class="st">&quot;data&quot;</span>, <span class="st">&quot;smart_ohio.Rds&quot;</span>))</span></code></pre></div>
</div>
<div id="a-subset-of-the-ohio-smart-data" class="section level2" number="19.2">
<h2><span class="header-section-number">19.2</span> A subset of the Ohio SMART data</h2>
<p>Let’s consider the following data. I’ll include the subset of all observations in <code>smart_oh</code> with complete data on these 14 variables.</p>
<table>
<colgroup>
<col width="16%" />
<col width="83%" />
</colgroup>
<thead>
<tr class="header">
<th align="right">Variable</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right"><code>SEQNO</code></td>
<td>Subject identification code</td>
</tr>
<tr class="even">
<td align="right"><code>mmsa_name</code></td>
<td>Name of statistical area</td>
</tr>
<tr class="odd">
<td align="right"><code>genhealth</code></td>
<td>Five categories (E, VG, G, F, P) on general health</td>
</tr>
<tr class="even">
<td align="right"><code>physhealth</code></td>
<td>Now thinking about your physical health, which includes physical illness and injury, for how many days during the past 30 days was your physical health not good?</td>
</tr>
<tr class="odd">
<td align="right"><code>menthlth</code></td>
<td>Now thinking about your mental health, which includes stress, depression, and problems with emotions, for how many days during the past 30 days was your mental health not good?</td>
</tr>
<tr class="even">
<td align="right"><code>healthplan</code></td>
<td>1 if the subject has any kind of health care coverage, 0 otherwise</td>
</tr>
<tr class="odd">
<td align="right"><code>costprob</code></td>
<td>1 indicates Yes to “Was there a time in the past 12 months when you needed to see a doctor but could not because of cost?”</td>
</tr>
<tr class="even">
<td align="right"><code>agegroup</code></td>
<td>13 age groups from 18 through 80+</td>
</tr>
<tr class="odd">
<td align="right"><code>female</code></td>
<td>1 if subject is female</td>
</tr>
<tr class="even">
<td align="right"><code>incomegroup</code></td>
<td>8 income groups from &lt; 10,000 to 75,000 or more</td>
</tr>
<tr class="odd">
<td align="right"><code>bmi</code></td>
<td>body-mass index</td>
</tr>
<tr class="even">
<td align="right"><code>smoke100</code></td>
<td>1 if Yes to “Have you smoked at least 100 cigarettes in your entire life?”</td>
</tr>
<tr class="odd">
<td align="right"><code>alcdays</code></td>
<td># of days out of the past 30 on which the subject had at least one alcoholic drink</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb986"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb986-1"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb986-1" aria-hidden="true" tabindex="-1"></a>sm_oh_A <span class="ot">&lt;-</span> smart_oh <span class="sc">%&gt;%</span></span>
<span id="cb986-2"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb986-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(SEQNO, mmsa_name, genhealth, physhealth, </span>
<span id="cb986-3"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb986-3" aria-hidden="true" tabindex="-1"></a>           menthealth, healthplan, costprob, </span>
<span id="cb986-4"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb986-4" aria-hidden="true" tabindex="-1"></a>           agegroup, female, incomegroup, bmi, smoke100, </span>
<span id="cb986-5"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb986-5" aria-hidden="true" tabindex="-1"></a>           alcdays) <span class="sc">%&gt;%</span></span>
<span id="cb986-6"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb986-6" aria-hidden="true" tabindex="-1"></a>    drop_na</span></code></pre></div>
<div id="is-age-group-associated-with-physhealth" class="section level3" number="19.2.1">
<h3><span class="header-section-number">19.2.1</span> Is age group associated with <code>physhealth</code>?</h3>
<div class="sourceCode" id="cb987"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb987-1"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb987-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(sm_oh_A, <span class="fu">aes</span>(<span class="at">x =</span> agegroup, <span class="at">y =</span> physhealth)) <span class="sc">+</span></span>
<span id="cb987-2"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb987-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_violin</span>(<span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span></code></pre></div>
<p><img src="432-notes_files/figure-html/unnamed-chunk-396-1.png" width="672" /></p>
<p>It’s hard to see much of anything here. The main conclusion seems to be that 0 is by far the most common response.</p>
<p>Here’s a table by age group of:</p>
<ul>
<li>the number of respondents in that age group,</li>
<li>the group’s mean <code>physhealth</code> response (remember that these are the number of poor physical health days in the last 30),</li>
<li>their median <code>physhealth</code> response (which turns out to be 0 in each group), and</li>
<li>the percentage of group members who responded 0.</li>
</ul>
<div class="sourceCode" id="cb988"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb988-1"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb988-1" aria-hidden="true" tabindex="-1"></a>sm_oh_A <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(agegroup) <span class="sc">%&gt;%</span></span>
<span id="cb988-2"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb988-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="at">n =</span> <span class="fu">n</span>(), <span class="at">mean =</span> <span class="fu">round</span>(<span class="fu">mean</span>(physhealth),<span class="dv">2</span>), </span>
<span id="cb988-3"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb988-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">median =</span> <span class="fu">median</span>(physhealth),</span>
<span id="cb988-4"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb988-4" aria-hidden="true" tabindex="-1"></a>              <span class="at">percent_0s =</span> <span class="fu">round</span>(<span class="dv">100</span><span class="sc">*</span><span class="fu">sum</span>(physhealth <span class="sc">==</span> <span class="dv">0</span>)<span class="sc">/</span>n,<span class="dv">1</span>))</span></code></pre></div>
<pre><code># A tibble: 13 x 5
   agegroup     n  mean median percent_0s
 * &lt;fct&gt;    &lt;int&gt; &lt;dbl&gt;  &lt;dbl&gt;      &lt;dbl&gt;
 1 18-24      297  2.31      0       59.6
 2 25-29      259  2.53      0       66  
 3 30-34      296  2.14      0       69.3
 4 35-39      366  3.67      0       63.9
 5 40-44      347  4.18      0       62.8
 6 45-49      409  4.46      0       63.3
 7 50-54      472  4.76      0       60.4
 8 55-59      608  6.71      0       57.1
 9 60-64      648  5.9       0       57.6
10 65-69      604  6.09      0       56  
11 70-74      490  4.89      0       61.6
12 75-79      338  6.38      0       54.1
13 80-96      374  6.1       0       56.4</code></pre>
<p>We can see a real change between the 45-49 age group and the 50-54 age group. The mean difference is clear from the table above, and the plot below (of the percentage with a zero response) in each age group identifies the same story.</p>
<div class="sourceCode" id="cb990"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb990-1"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb990-1" aria-hidden="true" tabindex="-1"></a>sm_oh_A <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(agegroup) <span class="sc">%&gt;%</span></span>
<span id="cb990-2"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb990-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="at">n =</span> <span class="fu">n</span>(), </span>
<span id="cb990-3"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb990-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">percent_0s =</span> <span class="fu">round</span>(<span class="dv">100</span><span class="sc">*</span><span class="fu">sum</span>(physhealth <span class="sc">==</span> <span class="dv">0</span>)<span class="sc">/</span>n,<span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb990-4"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb990-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> agegroup, <span class="at">x =</span> percent_0s)) <span class="sc">+</span></span>
<span id="cb990-5"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb990-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_label</span>(<span class="fu">aes</span>(<span class="at">label =</span> percent_0s)) <span class="sc">+</span></span>
<span id="cb990-6"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb990-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;% with no Bad Physical Health Days in last 30&quot;</span>,</span>
<span id="cb990-7"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb990-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">&quot;Age Group&quot;</span>)</span></code></pre></div>
<p><img src="432-notes_files/figure-html/unnamed-chunk-398-1.png" width="672" /></p>
<p>It looks like we have a fairly consistent result in the younger age range (18-49) or the older range (50+). On the theory that most of the people reading this document are in that younger range, we’ll focus on those respondents in what follows.</p>
</div>
</div>
<div id="exploratory-data-analysis-in-the-18-49-group" class="section level2" number="19.3">
<h2><span class="header-section-number">19.3</span> Exploratory Data Analysis (in the 18-49 group)</h2>
<p>We want to predict the 0-30 <code>physhealth</code> count variable for the 18-49 year old respondents.</p>
<p>To start, we’ll use two predictors:</p>
<ul>
<li>the respondent’s body mass index, and</li>
<li>whether the respondent has smoked 100 cigarettes in their lifetime.</li>
</ul>
<p>We anticipate that each of these variables will have positive associations with the <code>physhealth</code> score. That is, heavier people, and those who have used tobacco will be less healthy, and thus have higher numbers of poor physical health days.</p>
<div id="build-a-subset-of-those-ages-18-49" class="section level3" number="19.3.1">
<h3><span class="header-section-number">19.3.1</span> Build a subset of those ages 18-49</h3>
<p>First, we’ll identify the subset of respondents who are between 18 and 49 years of age.</p>
<div class="sourceCode" id="cb991"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb991-1"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb991-1" aria-hidden="true" tabindex="-1"></a>sm_oh_A_young.raw <span class="ot">&lt;-</span> sm_oh_A <span class="sc">%&gt;%</span></span>
<span id="cb991-2"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb991-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(agegroup <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;18-24&quot;</span>, <span class="st">&quot;25-29&quot;</span>, <span class="st">&quot;30-34&quot;</span>, </span>
<span id="cb991-3"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb991-3" aria-hidden="true" tabindex="-1"></a>                           <span class="st">&quot;35-39&quot;</span>, <span class="st">&quot;40-44&quot;</span>, <span class="st">&quot;45-49&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb991-4"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb991-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">droplevels</span>()</span>
<span id="cb991-5"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb991-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb991-6"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb991-6" aria-hidden="true" tabindex="-1"></a>sm_oh_A_young.raw <span class="sc">%&gt;%</span> </span>
<span id="cb991-7"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb991-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(physhealth, bmi, smoke100, agegroup) <span class="sc">%&gt;%</span></span>
<span id="cb991-8"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb991-8" aria-hidden="true" tabindex="-1"></a>    summary</span></code></pre></div>
<pre><code>   physhealth          bmi           smoke100       agegroup  
 Min.   : 0.000   Min.   :14.00   Min.   :0.0000   18-24:297  
 1st Qu.: 0.000   1st Qu.:23.74   1st Qu.:0.0000   25-29:259  
 Median : 0.000   Median :27.32   Median :0.0000   30-34:296  
 Mean   : 3.337   Mean   :28.79   Mean   :0.4189   35-39:366  
 3rd Qu.: 2.000   3rd Qu.:32.43   3rd Qu.:1.0000   40-44:347  
 Max.   :30.000   Max.   :75.52   Max.   :1.0000   45-49:409  </code></pre>
</div>
<div id="centering-bmi" class="section level3" number="19.3.2">
<h3><span class="header-section-number">19.3.2</span> Centering <code>bmi</code></h3>
<p>I’m going to center the <code>bmi</code> variable to help me interpret the final models later.</p>
<div class="sourceCode" id="cb993"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb993-1"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb993-1" aria-hidden="true" tabindex="-1"></a>sm_oh_A_young <span class="ot">&lt;-</span> sm_oh_A_young.raw <span class="sc">%&gt;%</span></span>
<span id="cb993-2"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb993-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">bmi_c =</span> bmi <span class="sc">-</span> <span class="fu">mean</span>(bmi)) </span></code></pre></div>
<p>Now, let’s look more closely at the distribution of these variables, starting with our outcome.</p>
</div>
<div id="distribution-of-the-outcome" class="section level3" number="19.3.3">
<h3><span class="header-section-number">19.3.3</span> Distribution of the Outcome</h3>
<p>What’s the distribution of <code>physhealth</code>?</p>
<div class="sourceCode" id="cb994"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb994-1"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb994-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(sm_oh_A_young.raw, <span class="fu">aes</span>(<span class="at">x =</span> physhealth)) <span class="sc">+</span></span>
<span id="cb994-2"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb994-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">1</span>, <span class="at">fill =</span> <span class="st">&quot;red&quot;</span>, <span class="at">col =</span> <span class="st">&quot;white&quot;</span>)</span></code></pre></div>
<p><img src="432-notes_files/figure-html/unnamed-chunk-401-1.png" width="672" /></p>
<div class="sourceCode" id="cb995"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb995-1"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb995-1" aria-hidden="true" tabindex="-1"></a>sm_oh_A_young.raw <span class="sc">%&gt;%</span></span>
<span id="cb995-2"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb995-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">count</span>(physhealth <span class="sc">==</span> <span class="dv">0</span>, physhealth <span class="sc">==</span> <span class="dv">30</span>)</span></code></pre></div>
<pre><code># A tibble: 3 x 3
  `physhealth == 0` `physhealth == 30`     n
  &lt;lgl&gt;             &lt;lgl&gt;              &lt;int&gt;
1 FALSE             FALSE                612
2 FALSE             TRUE                  98
3 TRUE              FALSE               1264</code></pre>
<p>Most of our respondents said zero, the minimum allowable value, although there is also a much smaller bump at 30, the maximum value we will allow.</p>
<p>Dealing with this distribution is going to be a bit of a challenge. We will develop a series of potential modeling approaches for this sort of data, but before we do that, let’s look at the distribution of our other two variables, and the pairwise associations, in a scatterplot matrix.</p>
</div>
<div id="scatterplot-matrix" class="section level3" number="19.3.4">
<h3><span class="header-section-number">19.3.4</span> Scatterplot Matrix</h3>
<p>Now, here’s the scatterplot matrix for those 1974 subjects, using the centered <code>bmi</code> data captured in the <code>bmi_c</code> variable.</p>
<div class="sourceCode" id="cb997"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb997-1"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb997-1" aria-hidden="true" tabindex="-1"></a>GGally<span class="sc">::</span><span class="fu">ggpairs</span>(sm_oh_A_young <span class="sc">%&gt;%</span> </span>
<span id="cb997-2"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb997-2" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">select</span>(bmi_c, smoke100, physhealth))</span></code></pre></div>
<pre><code>Registered S3 method overwritten by &#39;GGally&#39;:
  method from   
  +.gg   ggplot2</code></pre>
<p><img src="432-notes_files/figure-html/unnamed-chunk-403-1.png" width="672" /></p>
<p>So <code>bmi_c</code> and <code>smoke100</code> each have modest positive correlations with <code>physhealth</code> and only a very small correlation with each other. Here are some summary statistics for this final data.</p>
</div>
<div id="summary-of-the-final-subset-of-data" class="section level3" number="19.3.5">
<h3><span class="header-section-number">19.3.5</span> Summary of the final subset of data</h3>
<p>Remember that since the mean of <code>bmi</code> is 28.8, the <code>bmi_c</code> values are just <code>bmi</code> - 28.8 for each subject.</p>
<div class="sourceCode" id="cb999"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb999-1"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb999-1" aria-hidden="true" tabindex="-1"></a>sm_oh_A_young <span class="sc">%&gt;%</span> </span>
<span id="cb999-2"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb999-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(bmi, bmi_c, smoke100, physhealth) <span class="sc">%&gt;%</span></span>
<span id="cb999-3"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb999-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summary</span>()</span></code></pre></div>
<pre><code>      bmi            bmi_c            smoke100        physhealth    
 Min.   :14.00   Min.   :-14.791   Min.   :0.0000   Min.   : 0.000  
 1st Qu.:23.74   1st Qu.: -5.051   1st Qu.:0.0000   1st Qu.: 0.000  
 Median :27.32   Median : -1.471   Median :0.0000   Median : 0.000  
 Mean   :28.79   Mean   :  0.000   Mean   :0.4189   Mean   : 3.337  
 3rd Qu.:32.43   3rd Qu.:  3.636   3rd Qu.:1.0000   3rd Qu.: 2.000  
 Max.   :75.52   Max.   : 46.729   Max.   :1.0000   Max.   :30.000  </code></pre>
</div>
</div>
<div id="modeling-strategies-explored-here" class="section level2" number="19.4">
<h2><span class="header-section-number">19.4</span> Modeling Strategies Explored Here</h2>
<p>We are going to predict <code>physhealth</code> using <code>bmi_c</code> and <code>smoke100</code>.</p>
<ul>
<li>Remember that <code>physhealth</code> is a count of the number of poor physical health days in the past 30.</li>
<li>As a result, <code>physhealth</code> is restricted to taking values between 0 and 30.</li>
</ul>
<p>We will demonstrate the use of each of the following regression models, some of which are better choices than others.</p>
<ol style="list-style-type: decimal">
<li>Ordinary Least Squares (OLS) predicting <code>physhealth</code></li>
<li>OLS predicting the logarithm of (<code>physhealth</code> + 1)</li>
<li>Poisson regression, which is appropriate for predicting counts</li>
<li>Poisson regression, adjusted to account for overdispersion</li>
<li>Negative binomial regression, also used for counts and which adjusts for overdispersion</li>
<li>Zero-inflated models, in both the Poisson and Negative Binomial varieties, which allow us to fit counts that have lots of zero values</li>
<li>A “hurdle” model, which allows us to separately fit a model to predict the incidence of “0” and then a separate model to predict the value of <code>physhealth</code> when we know it is not zero</li>
<li>Tobit regression, where a lower (and upper) bound may be set, but the underlying model describes a latent variable which can extend beyond these boundaries</li>
</ol>
<div id="what-will-we-demonstrate" class="section level3" number="19.4.1">
<h3><span class="header-section-number">19.4.1</span> What Will We Demonstrate?</h3>
<p>With each approach, we will fit the model and specify procedures for doing so in R. Then we will:</p>
<ol style="list-style-type: decimal">
<li>Specify the fitted model equation</li>
<li>Interpret the model’s coefficient estimates and 95% confidence intervals around those estimates.</li>
<li>Perform a test of whether each variable adds value to the model, when the other one is already included.</li>
<li>Store the fitted values and appropriate residuals for each model.</li>
<li>Summarize the model’s apparent R<sup>2</sup> value, the proportion of variation explained, and the model log likelihood.</li>
<li>Perform checks of model assumptions as appropriate.</li>
<li>Describe how predictions would be made for two new subjects.
<ul>
<li>Harry has a BMI that is 10 kg/m<sup>2</sup> higher than the average across all respondents and has smoked more than 100 cigarettes in his life.</li>
<li>Sally has a BMI that is 5 kg/m<sup>2</sup> less than the average across all respondents and has not smoked more than 100 cigarettes in her life.</li>
</ul></li>
</ol>
<p>In addition, for some of the new models, we provide a little of the mathematical background, and point to other resources you can use to learn more about the model.</p>
</div>
<div id="extra-data-file-for-harry-and-sally" class="section level3" number="19.4.2">
<h3><span class="header-section-number">19.4.2</span> Extra Data File for Harry and Sally</h3>
<p>To make our lives a little easier, I’ll create a little tibble containing the necessary data for Harry and Sally.</p>
<div class="sourceCode" id="cb1001"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1001-1"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1001-1" aria-hidden="true" tabindex="-1"></a>hs_data <span class="ot">&lt;-</span> <span class="fu">data_frame</span>(<span class="at">subj =</span> <span class="fu">c</span>(<span class="st">&quot;Harry&quot;</span>, <span class="st">&quot;Sally&quot;</span>),</span>
<span id="cb1001-2"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1001-2" aria-hidden="true" tabindex="-1"></a>                      <span class="at">bmi_c =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="sc">-</span><span class="dv">5</span>),</span>
<span id="cb1001-3"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1001-3" aria-hidden="true" tabindex="-1"></a>                      <span class="at">smoke100 =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">0</span>))</span>
<span id="cb1001-4"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1001-4" aria-hidden="true" tabindex="-1"></a>hs_data</span></code></pre></div>
<pre><code># A tibble: 2 x 3
  subj  bmi_c smoke100
  &lt;chr&gt; &lt;dbl&gt;    &lt;dbl&gt;
1 Harry    10        1
2 Sally    -5        0</code></pre>
</div>
</div>
<div id="the-ols-approach" class="section level2" number="19.5">
<h2><span class="header-section-number">19.5</span> The OLS Approach</h2>
<div class="sourceCode" id="cb1003"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1003-1"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1003-1" aria-hidden="true" tabindex="-1"></a>mod_ols1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(physhealth <span class="sc">~</span> bmi_c <span class="sc">+</span> smoke100, </span>
<span id="cb1003-2"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1003-2" aria-hidden="true" tabindex="-1"></a>               <span class="at">data =</span> sm_oh_A_young)</span>
<span id="cb1003-3"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1003-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1003-4"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1003-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod_ols1)</span></code></pre></div>
<pre><code>
Call:
lm(formula = physhealth ~ bmi_c + smoke100, data = sm_oh_A_young)

Residuals:
     Min       1Q   Median       3Q      Max 
-11.1472  -3.6639  -2.2426  -0.7807  28.8777 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  2.57046    0.21648  11.874  &lt; 2e-16 ***
bmi_c        0.14437    0.02305   6.263 4.61e-10 ***
smoke100     1.83061    0.33469   5.470 5.09e-08 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 7.328 on 1971 degrees of freedom
Multiple R-squared:  0.0356,    Adjusted R-squared:  0.03462 
F-statistic: 36.37 on 2 and 1971 DF,  p-value: 3.072e-16</code></pre>
<div class="sourceCode" id="cb1005"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1005-1"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1005-1" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(mod_ols1)</span></code></pre></div>
<pre><code>                2.5 %   97.5 %
(Intercept) 2.1459143 2.995005
bmi_c       0.0991636 0.189573
smoke100    1.1742213 2.486995</code></pre>
<div id="interpreting-the-coefficients" class="section level3" number="19.5.1">
<h3><span class="header-section-number">19.5.1</span> Interpreting the Coefficients</h3>
<ul>
<li>The intercept, 2.57, is the predicted <code>physhealth</code> (in days) for a subject with average BMI who has not smoked 100 cigarettes or more.</li>
<li>The <code>bmi_c</code> coefficient, 0.144, indicates that for each additional kg/m<sup>2</sup> of BMI, while holding <code>smoke100</code> constant, the predicted <code>physhealth</code> value increases by 0.144 day.</li>
<li>The <code>smoke100</code> coefficient, 1.83, indicates that a subject who has smoked 100 cigarettes or more has a predicted <code>physhealth</code> value 1.83 days larger than another subject with the same <code>bmi</code> but who has not smoked 100 cigarettes.</li>
</ul>
</div>
<div id="store-fitted-values-and-residuals" class="section level3" number="19.5.2">
<h3><span class="header-section-number">19.5.2</span> Store fitted values and residuals</h3>
<p>We can use <code>broom</code> to do this. Here, for instance, is a table of the first six predictions and residuals.</p>
<div class="sourceCode" id="cb1007"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1007-1"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1007-1" aria-hidden="true" tabindex="-1"></a>sm_ols_1 <span class="ot">&lt;-</span> <span class="fu">augment</span>(mod_ols1, sm_oh_A_young)</span>
<span id="cb1007-2"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1007-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1007-3"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1007-3" aria-hidden="true" tabindex="-1"></a>sm_ols_1 <span class="sc">%&gt;%</span> <span class="fu">select</span>(physhealth, .fitted, .resid) <span class="sc">%&gt;%</span> <span class="fu">head</span>()</span></code></pre></div>
<pre><code># A tibble: 6 x 3
  physhealth .fitted .resid
       &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;
1          0    2.13  -2.13
2          0    2.25  -2.25
3          0    3.14  -3.14
4         30    5.72  24.3 
5          0    3.20  -3.20
6          0    3.83  -3.83</code></pre>
<p>It turns out that 0 of the 1974 predictions that we make are below 0, and the largest prediction made by this model is 11.15 days.</p>
</div>
<div id="specify-the-r2-and-loglikelihood-values" class="section level3" number="19.5.3">
<h3><span class="header-section-number">19.5.3</span> Specify the R<sup>2</sup> and log(likelihood) values</h3>
<p>The <code>glance</code> function in the <code>broom</code> package gives us the raw and adjusted R<sup>2</sup> values, and the model log(likelihood), among other summaries.</p>
<div class="sourceCode" id="cb1009"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1009-1"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1009-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(mod_ols1) <span class="sc">%&gt;%</span> <span class="fu">round</span>(<span class="dv">3</span>)</span></code></pre></div>
<pre><code># A tibble: 1 x 12
  r.squared adj.r.squared sigma statistic p.value    df logLik    AIC    BIC
      &lt;dbl&gt;         &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
1     0.036         0.035  7.33      36.4       0     2 -6731. 13470. 13492.
# ... with 3 more variables: deviance &lt;dbl&gt;, df.residual &lt;dbl&gt;, nobs &lt;dbl&gt;</code></pre>
<p>Here, we have</p>
<table>
<thead>
<tr class="header">
<th align="right">Model</th>
<th align="right">R<sup>2</sup></th>
<th align="right">log(likelihood)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">OLS</td>
<td align="right">0.036</td>
<td align="right">-6730.98</td>
</tr>
</tbody>
</table>
</div>
<div id="check-model-assumptions" class="section level3" number="19.5.4">
<h3><span class="header-section-number">19.5.4</span> Check model assumptions</h3>
<p>Here is a plot of the residuals vs. the fitted values for this OLS model.</p>
<div class="sourceCode" id="cb1011"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1011-1"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1011-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(sm_ols_1, <span class="fu">aes</span>(<span class="at">x =</span> .fitted, <span class="at">y =</span> .resid)) <span class="sc">+</span></span>
<span id="cb1011-2"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1011-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb1011-3"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1011-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Residuals vs. Fitted Values for OLS model&quot;</span>)</span></code></pre></div>
<p><img src="432-notes_files/figure-html/unnamed-chunk-409-1.png" width="672" /></p>
<p>As usual, we can check OLS assumptions (linearity, homoscedasticity and normality) with R’s complete set of residual plots.</p>
<div class="sourceCode" id="cb1012"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1012-1"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1012-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb1012-2"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1012-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mod_ols1)</span></code></pre></div>
<p><img src="432-notes_files/figure-html/unnamed-chunk-410-1.png" width="672" /></p>
<div class="sourceCode" id="cb1013"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1013-1"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1013-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span></code></pre></div>
<p>We see the problem with our residuals. They don’t follow a Normal distribution.</p>
</div>
<div id="predictions-for-harry-and-sally" class="section level3" number="19.5.5">
<h3><span class="header-section-number">19.5.5</span> Predictions for Harry and Sally</h3>
<div class="sourceCode" id="cb1014"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1014-1"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1014-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(mod_ols1, <span class="at">newdata =</span> hs_data,</span>
<span id="cb1014-2"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1014-2" aria-hidden="true" tabindex="-1"></a>        <span class="at">interval =</span> <span class="st">&quot;prediction&quot;</span>)</span></code></pre></div>
<pre><code>       fit        lwr      upr
1 5.844750  -8.541164 20.23067
2 1.848618 -12.529923 16.22716</code></pre>
<p>The prediction for Harry is 5.8 days, and for Sally is 1.8 days. The prediction intervals for each include some values below 0, even though 0 is the smallest possible value.</p>
</div>
<div id="notes" class="section level3" number="19.5.6">
<h3><span class="header-section-number">19.5.6</span> Notes</h3>
<ul>
<li>This model could have been estimated using the <code>ols</code> function in the <code>rms</code> package, as well.</li>
</ul>
<div class="sourceCode" id="cb1016"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1016-1"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1016-1" aria-hidden="true" tabindex="-1"></a>dd <span class="ot">&lt;-</span> <span class="fu">datadist</span>(sm_oh_A_young)</span>
<span id="cb1016-2"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1016-2" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">datadist =</span> <span class="st">&quot;dd&quot;</span>)</span>
<span id="cb1016-3"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1016-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1016-4"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1016-4" aria-hidden="true" tabindex="-1"></a>(mod_ols1a <span class="ot">&lt;-</span> <span class="fu">ols</span>(physhealth <span class="sc">~</span> bmi_c <span class="sc">+</span> smoke100,</span>
<span id="cb1016-5"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1016-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">data =</span> sm_oh_A_young, <span class="at">x =</span> <span class="cn">TRUE</span>, <span class="at">y =</span> <span class="cn">TRUE</span>))</span></code></pre></div>
<pre><code>Linear Regression Model
 
 ols(formula = physhealth ~ bmi_c + smoke100, data = sm_oh_A_young, 
     x = TRUE, y = TRUE)
 
                 Model Likelihood    Discrimination    
                       Ratio Test           Indexes    
 Obs    1974    LR chi2     71.55    R2       0.036    
 sigma7.3276    d.f.            2    R2 adj   0.035    
 d.f.   1971    Pr(&gt; chi2) 0.0000    g        1.570    
 
 Residuals
 
      Min       1Q   Median       3Q      Max 
 -11.1472  -3.6639  -2.2426  -0.7807  28.8777 
 
 
           Coef   S.E.   t     Pr(&gt;|t|)
 Intercept 2.5705 0.2165 11.87 &lt;0.0001 
 bmi_c     0.1444 0.0230  6.26 &lt;0.0001 
 smoke100  1.8306 0.3347  5.47 &lt;0.0001 
 </code></pre>
</div>
</div>
<div id="ols-model-on-logphyshealth-1-days" class="section level2" number="19.6">
<h2><span class="header-section-number">19.6</span> OLS model on log(<code>physhealth</code> + 1) days</h2>
<p>We could try to solve the problem of fitting some predictions below 0 by log-transforming the data, so as to force values to be at least 0. Since we have undefined values when we take the log of 0, we’ll add one to each of the <code>physhealth</code> values before taking logs, and then transform back when we want to make predictions.</p>
<div class="sourceCode" id="cb1018"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1018-1"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1018-1" aria-hidden="true" tabindex="-1"></a>mod_ols_log1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(physhealth <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">~</span> bmi_c <span class="sc">+</span> smoke100,</span>
<span id="cb1018-2"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1018-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">data =</span> sm_oh_A_young)</span>
<span id="cb1018-3"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1018-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1018-4"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1018-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod_ols_log1)</span></code></pre></div>
<pre><code>
Call:
lm(formula = log(physhealth + 1) ~ bmi_c + smoke100, data = sm_oh_A_young)

Residuals:
    Min      1Q  Median      3Q     Max 
-1.7079 -0.7058 -0.5051  0.5053  3.0484 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  0.57746    0.03099  18.634  &lt; 2e-16 ***
bmi_c        0.01912    0.00330   5.796 7.91e-09 ***
smoke100     0.23679    0.04791   4.942 8.38e-07 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 1.049 on 1971 degrees of freedom
Multiple R-squared:  0.03003,   Adjusted R-squared:  0.02905 
F-statistic: 30.51 on 2 and 1971 DF,  p-value: 8.897e-14</code></pre>
<div class="sourceCode" id="cb1020"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1020-1"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1020-1" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(mod_ols_log1)</span></code></pre></div>
<pre><code>                 2.5 %     97.5 %
(Intercept) 0.51668682 0.63823590
bmi_c       0.01265192 0.02559421
smoke100    0.14282518 0.33075147</code></pre>
<div id="interpreting-the-coefficients-1" class="section level3" number="19.6.1">
<h3><span class="header-section-number">19.6.1</span> Interpreting the Coefficients</h3>
<ul>
<li>The intercept, 0.58, is the predicted logarithm of (<code>physhealth</code> + 1) (in days) for a subject with average BMI who has not smoked 100 cigarettes or more.
<ul>
<li>We can exponentiate to see that the prediction for (<code>physhealth</code> + 1) here is <code>exp(0.58)</code> = 1.79 so the predicted <code>physhealth</code> for a subject with average BMI who has not smoked 100 cigarettes is 0.79 days.</li>
</ul></li>
<li>The <code>bmi_c</code> coefficient, 0.019, indicates that for each additional kg/m<sup>2</sup> of BMI, while holding <code>smoke100</code> constant, the predicted logarithm of (<code>physhealth</code> + 1) increases by 0.019</li>
<li>The <code>smoke100</code> coefficient, 0.24, indicates that a subject who has smoked 100 cigarettes or more has a predicted log of (<code>physhealth</code> + 1) value that is 0.24 larger than another subject with the same <code>bmi</code> but who has not smoked 100 cigarettes.</li>
</ul>
</div>
<div id="store-fitted-values-and-residuals-1" class="section level3" number="19.6.2">
<h3><span class="header-section-number">19.6.2</span> Store fitted values and residuals</h3>
<p>We can use <code>broom</code> to help us with this. Here, for instance, is a table of the first six predictions and residuals, on the scale of our transformed response, log(<code>physhealth</code> + 1).</p>
<div class="sourceCode" id="cb1022"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1022-1"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1022-1" aria-hidden="true" tabindex="-1"></a>sm_ols_log1 <span class="ot">&lt;-</span> <span class="fu">augment</span>(mod_ols_log1, sm_oh_A_young)</span>
<span id="cb1022-2"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1022-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1022-3"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1022-3" aria-hidden="true" tabindex="-1"></a>sm_ols_log1 <span class="ot">&lt;-</span> sm_ols_log1 <span class="sc">%&gt;%</span> </span>
<span id="cb1022-4"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1022-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">outcome =</span> <span class="fu">log</span>(physhealth <span class="sc">+</span> <span class="dv">1</span>))</span>
<span id="cb1022-5"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1022-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1022-6"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1022-6" aria-hidden="true" tabindex="-1"></a>sm_ols_log1 <span class="sc">%&gt;%</span> </span>
<span id="cb1022-7"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1022-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(physhealth, outcome, .fitted, .resid) <span class="sc">%&gt;%</span></span>
<span id="cb1022-8"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1022-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">head</span>()</span></code></pre></div>
<pre><code># A tibble: 6 x 4
  physhealth outcome .fitted .resid
       &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;
1          0    0      0.520 -0.520
2          0    0      0.535 -0.535
3          0    0      0.647 -0.647
4         30    3.43   0.995  2.44 
5          0    0      0.656 -0.656
6          0    0      0.739 -0.739</code></pre>
<p>Note that the <code>outcome</code> used in this model is log(<code>physhealth</code> + 1), so the <code>.fitted</code> and <code>.resid</code> values react to that outcome, and not to our original <code>physhealth</code>.</p>
<p>Another option would be to calculate the model-predicted <code>physhealth</code>, which I’ll call <em>ph</em> for a moment, with the formula:</p>
<p><span class="math display">\[
ph = e^{.fitted} - 1
\]</span></p>
<div class="sourceCode" id="cb1024"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1024-1"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1024-1" aria-hidden="true" tabindex="-1"></a>sm_ols_log1 <span class="ot">&lt;-</span> sm_ols_log1 <span class="sc">%&gt;%</span> </span>
<span id="cb1024-2"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1024-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">pred.physhealth =</span> <span class="fu">exp</span>(.fitted) <span class="sc">-</span> <span class="dv">1</span>,</span>
<span id="cb1024-3"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1024-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">res.physhealth =</span> physhealth <span class="sc">-</span> pred.physhealth)</span>
<span id="cb1024-4"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1024-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1024-5"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1024-5" aria-hidden="true" tabindex="-1"></a>sm_ols_log1 <span class="sc">%&gt;%</span></span>
<span id="cb1024-6"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1024-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(physhealth, pred.physhealth, res.physhealth) <span class="sc">%&gt;%</span> </span>
<span id="cb1024-7"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1024-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">head</span>()</span></code></pre></div>
<pre><code># A tibble: 6 x 3
  physhealth pred.physhealth res.physhealth
       &lt;dbl&gt;           &lt;dbl&gt;          &lt;dbl&gt;
1          0           0.681         -0.681
2          0           0.708         -0.708
3          0           0.910         -0.910
4         30           1.70          28.3  
5          0           0.926         -0.926
6          0           1.09          -1.09 </code></pre>
<p>It turns out that 0 of the 1974 predictions that we make are below 0, and the largest prediction made by this model is 4.52 days.</p>
</div>
<div id="specify-the-r2-and-loglikelihood-values-1" class="section level3" number="19.6.3">
<h3><span class="header-section-number">19.6.3</span> Specify the R<sup>2</sup> and log(likelihood) values</h3>
<p>The <code>glance</code> function in the <code>broom</code> package gives us the raw and adjusted R<sup>2</sup> values, and the model log(likelihood), among other summaries.</p>
<div class="sourceCode" id="cb1026"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1026-1"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1026-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(mod_ols_log1) <span class="sc">%&gt;%</span> <span class="fu">round</span>(<span class="dv">3</span>)</span></code></pre></div>
<pre><code># A tibble: 1 x 12
  r.squared adj.r.squared sigma statistic p.value    df logLik   AIC   BIC
      &lt;dbl&gt;         &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1      0.03         0.029  1.05      30.5       0     2 -2894. 5796. 5818.
# ... with 3 more variables: deviance &lt;dbl&gt;, df.residual &lt;dbl&gt;, nobs &lt;dbl&gt;</code></pre>
<p>Here, we have</p>
<table>
<thead>
<tr class="header">
<th align="right">Model</th>
<th align="right">Scale</th>
<th align="right">R<sup>2</sup></th>
<th align="right">log(likelihood)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">OLS on log</td>
<td align="right">log(<code>physhealth</code> + 1)</td>
<td align="right">0.03</td>
<td align="right">-2893.83</td>
</tr>
</tbody>
</table>
</div>
<div id="getting-r2-on-the-scale-of-physhealth" class="section level3" number="19.6.4">
<h3><span class="header-section-number">19.6.4</span> Getting R<sup>2</sup> on the scale of <code>physhealth</code></h3>
<p>We could find the correlation of our model-predicted <code>physhealth</code> values, after back-transformation, and our observed <code>physhealth</code> values, if we wanted to, and then square that to get a sort of <span class="math inline">\(R^2\)</span> value. But this model is not linear in <code>physhealth</code>, of course, so it’s not completely comparable to our prior OLS model.</p>
</div>
<div id="check-model-assumptions-1" class="section level3" number="19.6.5">
<h3><span class="header-section-number">19.6.5</span> Check model assumptions</h3>
<p>As usual, we can check OLS assumptions (linearity, homoscedasticity and normality) with R’s complete set of residual plots. Of course, these residuals and fitted values are now on the log(<code>physhealth</code> + 1) scale.</p>
<div class="sourceCode" id="cb1028"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1028-1"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1028-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb1028-2"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1028-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mod_ols_log1)</span></code></pre></div>
<p><img src="432-notes_files/figure-html/unnamed-chunk-417-1.png" width="672" /></p>
<div class="sourceCode" id="cb1029"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1029-1"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1029-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span></code></pre></div>
</div>
<div id="predictions-for-harry-and-sally-1" class="section level3" number="19.6.6">
<h3><span class="header-section-number">19.6.6</span> Predictions for Harry and Sally</h3>
<div class="sourceCode" id="cb1030"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1030-1"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1030-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(mod_ols_log1, <span class="at">newdata =</span> hs_data, </span>
<span id="cb1030-2"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1030-2" aria-hidden="true" tabindex="-1"></a>        <span class="at">interval =</span> <span class="st">&quot;prediction&quot;</span>, <span class="at">type =</span> <span class="st">&quot;response&quot;</span>)</span></code></pre></div>
<pre><code>       fit       lwr      upr
1 1.005480 -1.053893 3.064854
2 0.481846 -1.576472 2.540164</code></pre>
<p>Again, these predictions are on the log(<code>physhealth</code> + 1) scale, and so we have to exponentiate them, and then subtract 1, to see them on the original <code>physhealth</code> scale.</p>
<div class="sourceCode" id="cb1032"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1032-1"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1032-1" aria-hidden="true" tabindex="-1"></a><span class="fu">exp</span>(<span class="fu">predict</span>(mod_ols_log1, <span class="at">newdata =</span> hs_data, </span>
<span id="cb1032-2"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1032-2" aria-hidden="true" tabindex="-1"></a>            <span class="at">interval =</span> <span class="st">&quot;prediction&quot;</span>, <span class="at">type =</span> <span class="st">&quot;response&quot;</span>)) <span class="sc">-</span> <span class="dv">1</span></span></code></pre></div>
<pre><code>        fit        lwr      upr
1 1.7332198 -0.6514221 20.43133
2 0.6190605 -0.7932970 11.68175</code></pre>
<p>The prediction for Harry is now 1.73 days, and for Sally is 0.62 days. The prediction intervals for each again include some values below 0, which is the smallest possible value.</p>
</div>
</div>
<div id="a-poisson-regression-model" class="section level2" number="19.7">
<h2><span class="header-section-number">19.7</span> A Poisson Regression Model</h2>
<p>The <code>physhealth</code> data describe a count. Specifically a count of the number of days where the subject felt poorly in the last 30. Why wouldn’t we model this count with linear regression?</p>
<ul>
<li>A count can only be positive. Linear regression would estimate some subjects as having negative counts.</li>
<li>A count is unlikely to follow a Normal distribution. In fact, it’s far more likely that the log of the counts will follow a Poisson distribution.</li>
</ul>
<p>So, we’ll try that. The Poisson distribution is used to model a <em>count</em> outcome - that is, an outcome with possible values (0, 1, 2, …). The model takes a somewhat familiar form to the models we’ve used for linear and logistic regression<a href="#fn9" class="footnote-ref" id="fnref9"><sup>9</sup></a>. If our outcome is <em>y</em> and our linear predictors <em>X</em>, then the model is:</p>
<p><span class="math display">\[
y_i \sim \mbox{Poisson}(\lambda_i)
\]</span></p>
<p>The parameter <span class="math inline">\(\lambda\)</span> must be positive, so it makes sense to fit a linear regression on the logarithm of this…</p>
<p><span class="math display">\[
\lambda_i = exp(\beta_0 + \beta_1 X_1 + ... \beta_k X_k)
\]</span></p>
<p>The coefficients <span class="math inline">\(\beta\)</span> can be exponentiated and treated as multiplicative effects.</p>
<p>We’ll run a generalized linear model with a log link function, ensuring that all of the predicted values will be positive, and using a Poisson error distribution. This is called <strong>Poisson regression</strong>.</p>
<p>Poisson regression may be appropriate when the dependent variable is a count of events. The events must be independent - the occurrence of one event must not make any other more or less likely. That’s hard to justify in our case, but we can take a look.</p>
<div class="sourceCode" id="cb1034"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1034-1"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1034-1" aria-hidden="true" tabindex="-1"></a>mod_poiss1 <span class="ot">&lt;-</span> <span class="fu">glm</span>(physhealth <span class="sc">~</span> bmi_c <span class="sc">+</span> smoke100, </span>
<span id="cb1034-2"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1034-2" aria-hidden="true" tabindex="-1"></a>                  <span class="at">family =</span> <span class="fu">poisson</span>(),</span>
<span id="cb1034-3"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1034-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> sm_oh_A_young)</span>
<span id="cb1034-4"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1034-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1034-5"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1034-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod_poiss1)</span></code></pre></div>
<pre><code>
Call:
glm(formula = physhealth ~ bmi_c + smoke100, family = poisson(), 
    data = sm_oh_A_young)

Deviance Residuals: 
   Min      1Q  Median      3Q     Max  
-6.588  -2.604  -2.087  -0.533  10.688  

Coefficients:
            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept) 0.906991   0.018699   48.51   &lt;2e-16 ***
bmi_c       0.035051   0.001421   24.66   &lt;2e-16 ***
smoke100    0.532505   0.024903   21.38   &lt;2e-16 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

(Dispersion parameter for poisson family taken to be 1)

    Null deviance: 20222  on 1973  degrees of freedom
Residual deviance: 19151  on 1971  degrees of freedom
AIC: 21645

Number of Fisher Scoring iterations: 6</code></pre>
<div class="sourceCode" id="cb1036"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1036-1"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1036-1" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(mod_poiss1)</span></code></pre></div>
<pre><code>Waiting for profiling to be done...</code></pre>
<pre><code>                 2.5 %     97.5 %
(Intercept) 0.87011622 0.94342323
bmi_c       0.03225125 0.03782255
smoke100    0.48373882 0.58136497</code></pre>
<div id="the-fitted-equation" class="section level3" number="19.7.1">
<h3><span class="header-section-number">19.7.1</span> The Fitted Equation</h3>
<p>The model equation is</p>
<pre><code>log(physhealth) = 0.91 + 0.035 bmi_c + 0.53 smoke100</code></pre>
<p>It looks like both <code>bmi</code> and <code>smoke_100</code> have confidence intervals excluding 0.</p>
</div>
<div id="interpreting-the-coefficients-2" class="section level3" number="19.7.2">
<h3><span class="header-section-number">19.7.2</span> Interpreting the Coefficients</h3>
<p>Our new model for <span class="math inline">\(y_i\)</span> = counts of poor <code>physhealth</code> days in the last 30, follows the regression equation:</p>
<p><span class="math display">\[
y_i \sim \mbox{Poisson}(exp(0.91 + 0.035 bmi_c + 0.53 smoke100))
\]</span></p>
<p>where <code>smoke100</code> is 1 if the subject has smoked 100 cigarettes (lifetime) and 0 otherwise, and <code>bmi_c</code> is just the centered body-mass index value in kg/m<sup>2</sup>. We interpret the coefficients as follows:</p>
<ul>
<li>The constant term, 0.91, gives us the intercept of the regression - the prediction if <code>smoke100 = 0</code> and <code>bmi_c = 0</code>. In this case, because we’ve centered BMI, it implies that <code>exp(0.91)</code> = 2.48 is the predicted days of poor <code>physhealth</code> for a non-smoker with average BMI.</li>
<li>The coefficient of <code>bmi_c</code>, 0.035, is the expected difference in count of poor <code>physhealth</code> days (on the log scale) for each additional kg/m<sup>2</sup> of body mass index. The expected multiplicative <em>increase</em> is <span class="math inline">\(e^{0.035}\)</span> = 1.036, corresponding to a 3.6% difference in the count.</li>
<li>The coefficient of <code>smoke100</code>, 0.53, tells us that the predictive difference between those who have and who have not smoked 100 cigarettes can be found by multiplying the <code>physhealth</code> count by <code>exp(0.53)</code> = 1.7, yielding a 70% increase of the <code>physhealth</code> count.</li>
</ul>
<p>As with linear or logistic regression, each coefficient is interpreted as a comparison where one predictor changes by one unit, while the others remain constant.</p>
</div>
<div id="testing-the-predictors" class="section level3" number="19.7.3">
<h3><span class="header-section-number">19.7.3</span> Testing the Predictors</h3>
<p>We can use the Wald tests (z tests) provided with the Poisson regression output, or we can fit the model and then run an ANOVA to obtain a test based on the deviance (a simple transformation of the log likelihood ratio.)</p>
<ul>
<li>By the Wald tests shown above, each predictor clearly adds significant predictive value to the model given the other predictor, and we note that the <em>p</em> values are as small as R will support.</li>
<li>The ANOVA approach for this model lets us check the impact of adding <code>smoke100</code> to a model already containing <code>bmi_c</code>.</li>
</ul>
<div class="sourceCode" id="cb1040"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1040-1"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1040-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod_poiss1, <span class="at">test =</span> <span class="st">&quot;Chisq&quot;</span>)</span></code></pre></div>
<pre><code>Analysis of Deviance Table

Model: poisson, link: log

Response: physhealth

Terms added sequentially (first to last)

         Df Deviance Resid. Df Resid. Dev  Pr(&gt;Chi)    
NULL                      1973      20222              
bmi_c     1   609.46      1972      19612 &lt; 2.2e-16 ***
smoke100  1   461.46      1971      19151 &lt; 2.2e-16 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>To obtain a <em>p</em> value for <code>smoke100</code>’s impact after <code>bmi_c</code> is accounted for, we compare the difference in deviance to a chi-square distribution with 1 degree of freedom. To check the effect of <code>bmi_c</code>, we could refit the model with <code>bmi_c</code> entering last, and again run an ANOVA.</p>
<p>We could also run a likelihood-ratio test for each predictor, by fitting the model with and without that predictor.</p>
<div class="sourceCode" id="cb1042"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1042-1"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1042-1" aria-hidden="true" tabindex="-1"></a>mod_poiss1_without_bmi <span class="ot">&lt;-</span> <span class="fu">glm</span>(physhealth <span class="sc">~</span> smoke100,</span>
<span id="cb1042-2"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1042-2" aria-hidden="true" tabindex="-1"></a>                              <span class="at">family =</span> <span class="fu">poisson</span>(),</span>
<span id="cb1042-3"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1042-3" aria-hidden="true" tabindex="-1"></a>                              <span class="at">data =</span> sm_oh_A_young)</span>
<span id="cb1042-4"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1042-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1042-5"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1042-5" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod_poiss1, mod_poiss1_without_bmi, <span class="at">test =</span> <span class="st">&quot;Chisq&quot;</span>)</span></code></pre></div>
<pre><code>Analysis of Deviance Table

Model 1: physhealth ~ bmi_c + smoke100
Model 2: physhealth ~ smoke100
  Resid. Df Resid. Dev Df Deviance  Pr(&gt;Chi)    
1      1971      19151                          
2      1972      19692 -1  -540.98 &lt; 2.2e-16 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
</div>
<div id="correcting-for-overdispersion-with-coeftestcoefci" class="section level3" number="19.7.4">
<h3><span class="header-section-number">19.7.4</span> Correcting for Overdispersion with <code>coeftest</code>/<code>coefci</code></h3>
<p>The main assumption we’ll think about in a Poisson model is about <strong>overdispersion</strong>. We might deal with the overdispersion we see in this model by changing the nature of the tests we run within this model, using the <code>coeftest</code> or <code>coefci</code> approaches from the <code>lmtest</code> package, as I’ll demonstrate next, or we might refit the model using a quasi-likelihood approach, as I’ll show in the material to come.</p>
<p>Here, we’ll use the <code>coeftest</code> and <code>coefci</code> approach from <code>lmtest</code> combined with robust sandwich estimation (via the <code>sandwich</code> package) to re-compute the Wald tests.</p>
<div class="sourceCode" id="cb1044"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1044-1"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1044-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coeftest</span>(mod_poiss1, <span class="at">vcov. =</span> sandwich)</span></code></pre></div>
<pre><code>
z test of coefficients:

             Estimate Std. Error z value  Pr(&gt;|z|)    
(Intercept) 0.9069908  0.0717221 12.6459 &lt; 2.2e-16 ***
bmi_c       0.0350508  0.0061178  5.7293 1.008e-08 ***
smoke100    0.5325053  0.1004300  5.3023 1.144e-07 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb1046"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1046-1"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1046-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coefci</span>(mod_poiss1, <span class="at">vcov. =</span> sandwich)</span></code></pre></div>
<pre><code>                 2.5 %     97.5 %
(Intercept) 0.76641801 1.04756366
bmi_c       0.02306016 0.04704145
smoke100    0.33566606 0.72934460</code></pre>
<p>Both predictors are still significant, but the standard errors are more appropriate. Later, we’ll fit this approach by changing the estimation method to a quasi-likelihood approach.</p>
</div>
<div id="store-fitted-values-and-residuals-2" class="section level3" number="19.7.5">
<h3><span class="header-section-number">19.7.5</span> Store fitted values and residuals</h3>
<p>What happens if we try using the <code>broom</code> package in this case? We can, if we like, get our residuals and predicted values right on the scale of our <code>physhealth</code> response.</p>
<div class="sourceCode" id="cb1048"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1048-1"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1048-1" aria-hidden="true" tabindex="-1"></a>sm_poiss1 <span class="ot">&lt;-</span> <span class="fu">augment</span>(mod_poiss1, sm_oh_A_young,</span>
<span id="cb1048-2"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1048-2" aria-hidden="true" tabindex="-1"></a>                     <span class="at">type.predict =</span> <span class="st">&quot;response&quot;</span>)</span>
<span id="cb1048-3"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1048-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1048-4"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1048-4" aria-hidden="true" tabindex="-1"></a>sm_poiss1 <span class="sc">%&gt;%</span> </span>
<span id="cb1048-5"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1048-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(physhealth, .fitted) <span class="sc">%&gt;%</span></span>
<span id="cb1048-6"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1048-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">head</span>()</span></code></pre></div>
<pre><code># A tibble: 6 x 2
  physhealth .fitted
       &lt;dbl&gt;   &lt;dbl&gt;
1          0    2.23
2          0    2.29
3          0    3.10
4         30    5.32
5          0    3.15
6          0    3.68</code></pre>
</div>
<div id="rootogram-see-the-fit-of-a-count-regression-model" class="section level3" number="19.7.6">
<h3><span class="header-section-number">19.7.6</span> Rootogram: see the fit of a count regression model</h3>
<p>A <strong>rootogram</strong> is a very useful way to visualize the fit of a count regression model<a href="#fn10" class="footnote-ref" id="fnref10"><sup>10</sup></a>. The <code>rootogram</code> function in the <code>countreg</code> package makes this pretty straightforward. By default, this fits a hanging rootogram on the square root of the frequencies.</p>
<div class="sourceCode" id="cb1050"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1050-1"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1050-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rootogram</span>(mod_poiss1, <span class="at">max =</span> <span class="dv">30</span>)</span></code></pre></div>
<p><img src="432-notes_files/figure-html/unnamed-chunk-425-1.png" width="672" /></p>
<p>The red curved line is the theoretical Poisson fit. “Hanging” from each point on the red line is a bar, the height of which represents the difference between expected and observed counts. A bar hanging below 0 indicates underfitting. A bar hanging above 0 indicates overfitting. The counts have been transformed with a square root transformation to prevent smaller counts from getting obscured and overwhelmed by larger counts. We see a great deal of underfitting for counts of 0, and overfitting for most other counts, especially 1-6, with some underfitting again by <code>physhealth</code> above 14 days.</p>
</div>
<div id="specify-the-r2-and-loglikelihood-values-2" class="section level3" number="19.7.7">
<h3><span class="header-section-number">19.7.7</span> Specify the R<sup>2</sup> and log(likelihood) values</h3>
<p>We can calculate the R<sup>2</sup> as the squared correlation of the fitted values and the observed values.</p>
<div class="sourceCode" id="cb1051"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1051-1"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1051-1" aria-hidden="true" tabindex="-1"></a><span class="co"># The correlation of observed and fitted values</span></span>
<span id="cb1051-2"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1051-2" aria-hidden="true" tabindex="-1"></a>(poiss_r <span class="ot">&lt;-</span> <span class="fu">with</span>(sm_poiss1, <span class="fu">cor</span>(physhealth, .fitted)))</span></code></pre></div>
<pre><code>[1] 0.1846814</code></pre>
<div class="sourceCode" id="cb1053"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1053-1"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1053-1" aria-hidden="true" tabindex="-1"></a><span class="co"># R-square</span></span>
<span id="cb1053-2"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1053-2" aria-hidden="true" tabindex="-1"></a>poiss_r<span class="sc">^</span><span class="dv">2</span></span></code></pre></div>
<pre><code>[1] 0.03410723</code></pre>
<p>The <code>glance</code> function in the <code>broom</code> package gives us model log(likelihood), among other summaries.</p>
<div class="sourceCode" id="cb1055"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1055-1"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1055-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(mod_poiss1) <span class="sc">%&gt;%</span> <span class="fu">round</span>(<span class="dv">3</span>)</span></code></pre></div>
<pre><code># A tibble: 1 x 8
  null.deviance df.null  logLik    AIC    BIC deviance df.residual  nobs
          &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;    &lt;dbl&gt;       &lt;dbl&gt; &lt;dbl&gt;
1        20222.    1973 -10820. 21645. 21662.   19151.        1971  1974</code></pre>
<p>Here, we have</p>
<table>
<thead>
<tr class="header">
<th align="right">Model</th>
<th align="right">Scale</th>
<th align="right">R<sup>2</sup></th>
<th align="right">log(likelihood)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">Poisson</td>
<td align="right">log(<code>physhealth</code>)</td>
<td align="right">0.185</td>
<td align="right">-10189.33</td>
</tr>
</tbody>
</table>
</div>
<div id="check-model-assumptions-2" class="section level3" number="19.7.8">
<h3><span class="header-section-number">19.7.8</span> Check model assumptions</h3>
<p>The Poisson model is a classical generalized linear model, estimated using the method of maximum likelihood. While the default <code>plot</code> option for a <code>glm</code> still shows the plots we would use to assess the assumptions of an OLS model, we don’t actually get much from that, since our Poisson model has different assumptions. It can be useful to look at a plot of residuals vs. fitted values on the original <code>physhealth</code> scale.</p>
<div class="sourceCode" id="cb1057"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1057-1"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1057-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(sm_poiss1, <span class="fu">aes</span>(<span class="at">x =</span> .fitted, <span class="at">y =</span> .resid)) <span class="sc">+</span></span>
<span id="cb1057-2"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1057-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb1057-3"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1057-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Residuals vs. Fitted `physhealth`&quot;</span>,</span>
<span id="cb1057-4"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1057-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">subtitle =</span> <span class="st">&quot;Original Poisson Regression model&quot;</span>)</span></code></pre></div>
<p><img src="432-notes_files/figure-html/unnamed-chunk-428-1.png" width="672" /></p>
</div>
<div id="using-glm.diag.plots-from-the-boot-package" class="section level3" number="19.7.9">
<h3><span class="header-section-number">19.7.9</span> Using <code>glm.diag.plots</code> from the <code>boot</code> package</h3>
<p>The <code>glm.diag.plots</code> function from the <code>boot</code> package makes a series of diagnostic plots for generalized linear models.</p>
<ul>
<li>(Top, Left) Jackknife deviance residuals against fitted values. This is essentially identical to what you obtain with <code>plot(mod_poiss1, which = 1)</code>. A <em>jackknife deviance</em> residual is also called a likelihood residual. It is the change in deviance when this observation is omitted from the data.</li>
<li>(Top, Right) Normal Q-Q plot of standardized deviance residuals. (Dotted line shows expectation if those standardized residuals followed a Normal distribution, and these residuals generally should.) The result is similar to what you obtain with <code>plot(mod_poiss1, which = 2)</code>.</li>
<li>(Bottom, Left) Cook statistic vs. standardized leverage
<ul>
<li>n = # of observations, p = # of parameters estimated</li>
<li>Horizontal dotted line is at <span class="math inline">\(\frac{8}{n - 2p}\)</span>. Points above the line have high influence on the model.</li>
<li>Vertical line is at <span class="math inline">\(\frac{2p}{n - 2p}\)</span>. Points to the right of the line have high leverage.</li>
</ul></li>
<li>(Bottom, Right) Index plot of Cook’s statistic to help identify the observations with high influence. This is essentially the same plot as <code>plot(mod_poiss1, which = 4)</code></li>
</ul>
<div class="sourceCode" id="cb1058"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1058-1"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1058-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glm.diag.plots</span>(mod_poiss1)</span></code></pre></div>
<p><img src="432-notes_files/figure-html/unnamed-chunk-429-1.png" width="672" /></p>
<p>When working with these plots, it is possible to use the <code>iden</code> command to perform some interactive identification of points in your R terminal. But that doesn’t play out effectively in an HTML summary document like this, so we’ll leave that out.</p>
</div>
<div id="predictions-for-harry-and-sally-2" class="section level3" number="19.7.10">
<h3><span class="header-section-number">19.7.10</span> Predictions for Harry and Sally</h3>
<p>The predictions from a <code>glm</code> fit like this don’t include prediction intervals. But we can get predictions on the scale of our original response variable, <code>physhealth</code>, like this.</p>
<div class="sourceCode" id="cb1059"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1059-1"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1059-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(mod_poiss1, <span class="at">newdata =</span> hs_data, <span class="at">se.fit =</span> <span class="cn">TRUE</span>,</span>
<span id="cb1059-2"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1059-2" aria-hidden="true" tabindex="-1"></a>        <span class="at">type =</span> <span class="st">&quot;response&quot;</span>)</span></code></pre></div>
<pre><code>$fit
       1        2 
5.989478 2.078688 

$se.fit
         1          2 
0.11544326 0.04314273 

$residual.scale
[1] 1</code></pre>
<p>By using <code>response</code> as the type, these predictions fall on the original <code>physhealth</code> scale. The prediction for Harry is now 5.99 days, and for Sally is 2.08 days.</p>
</div>
</div>
<div id="overdispersion-in-a-poisson-model" class="section level2" number="19.8">
<h2><span class="header-section-number">19.8</span> Overdispersion in a Poisson Model</h2>
<p>Poisson regressions do not supply an independent variance parameter <span class="math inline">\(\sigma\)</span>, and as a result can be overdispersed, and usually are. Under the Poisson distribution, the variance equals the mean - so the standard deviation equals the square root of the mean. The notion of <strong>overdispersion</strong> arises here. When fitting generalized linear models with Poisson error distributions, the residual deviance and its degrees of freedom should be approximately equal if the model fits well.</p>
<p>If the residual deviance is far greater than the degrees of freedom, then overdispersion may well be a problem. In this case, the residual deviance is about 8.5 times the size of the residual degrees of freedom, so that’s a clear indication of overdispersion. We saw earlier that the Poisson regression model requires that the outcome (here the <code>physhealth</code> counts) be independent. A possible reason for the overdispersion we see here is that <code>physhealth</code> on different days likely do not occur independently of one another but likely “cluster” together.</p>
<div id="testing-for-overdispersion" class="section level3" number="19.8.1">
<h3><span class="header-section-number">19.8.1</span> Testing for Overdispersion?</h3>
<p>Gelman and Hill provide an overdispersion test in R for a Poisson model as follows…</p>
<div class="sourceCode" id="cb1061"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1061-1"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1061-1" aria-hidden="true" tabindex="-1"></a>yhat <span class="ot">&lt;-</span> <span class="fu">predict</span>(mod_poiss1, <span class="at">type =</span> <span class="st">&quot;response&quot;</span>)</span>
<span id="cb1061-2"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1061-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> arm<span class="sc">::</span><span class="fu">display</span>(mod_poiss1)<span class="sc">$</span>n</span></code></pre></div>
<pre><code>glm(formula = physhealth ~ bmi_c + smoke100, family = poisson(), 
    data = sm_oh_A_young)
            coef.est coef.se
(Intercept) 0.91     0.02   
bmi_c       0.04     0.00   
smoke100    0.53     0.02   
---
  n = 1974, k = 3
  residual deviance = 19150.9, null deviance = 20221.8 (difference = 1070.9)</code></pre>
<div class="sourceCode" id="cb1063"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1063-1"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1063-1" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> arm<span class="sc">::</span><span class="fu">display</span>(mod_poiss1)<span class="sc">$</span>k</span></code></pre></div>
<pre><code>glm(formula = physhealth ~ bmi_c + smoke100, family = poisson(), 
    data = sm_oh_A_young)
            coef.est coef.se
(Intercept) 0.91     0.02   
bmi_c       0.04     0.00   
smoke100    0.53     0.02   
---
  n = 1974, k = 3
  residual deviance = 19150.9, null deviance = 20221.8 (difference = 1070.9)</code></pre>
<div class="sourceCode" id="cb1065"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1065-1"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1065-1" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> (sm_oh_A_young<span class="sc">$</span>physhealth <span class="sc">-</span> yhat) <span class="sc">/</span> <span class="fu">sqrt</span>(yhat)</span>
<span id="cb1065-2"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1065-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;overdispersion ratio is &quot;</span>, <span class="fu">sum</span>(z<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span> (n <span class="sc">-</span> k), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>overdispersion ratio is  15.58261 </code></pre>
<div class="sourceCode" id="cb1067"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1067-1"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1067-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;p value of overdispersion test is &quot;</span>, </span>
<span id="cb1067-2"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1067-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pchisq</span>(<span class="fu">sum</span>(z<span class="sc">^</span><span class="dv">2</span>), <span class="at">df =</span> n<span class="sc">-</span>k, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>p value of overdispersion test is  0 </code></pre>
<p>The p value here is 0, indicating that the probability is essentially zero that a random variable from a <span class="math inline">\(\chi^2\)</span> distribution with (n - k) = 1971 degrees of freedom would be as large as what we observed in this case. So there is significant overdispersion.</p>
<p>In summary, the <code>physhealth</code> counts are overdispersed by a factor of 15.581, which is enormous (even a factor of 2 would be considered large) and also highly statistically significant. The basic correction for overdisperson is to multiply all regression standard errors by <span class="math inline">\(\sqrt{15.581}\)</span> = 3.95.</p>
<p>The <code>quasipoisson</code> model and the negative binomial model that we’ll fit below are very similar. We write the overdispersed “quasiPoisson” model as:</p>
<p><span class="math display">\[
y_i \sim \mbox{overdispersed Poisson} (\mu_i exp(X_i \beta), \omega)
\]</span></p>
<p>where <span class="math inline">\(\omega\)</span> is the overdispersion parameter, 15.581, in our case. The Poisson model we saw previously is then just the overdispersed Poisson model with <span class="math inline">\(\omega = 1\)</span>.</p>
</div>
</div>
<div id="fitting-the-quasi-poisson-model" class="section level2" number="19.9">
<h2><span class="header-section-number">19.9</span> Fitting the Quasi-Poisson Model</h2>
<p>To deal with overdispersion, one useful approach is to apply a <strong>quasi-likelihood estimation procedure</strong>, as follows:</p>
<div class="sourceCode" id="cb1069"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1069-1"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1069-1" aria-hidden="true" tabindex="-1"></a>mod_poiss_od1 <span class="ot">&lt;-</span> <span class="fu">glm</span>(physhealth <span class="sc">~</span> bmi_c <span class="sc">+</span> smoke100, </span>
<span id="cb1069-2"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1069-2" aria-hidden="true" tabindex="-1"></a>                  <span class="at">family =</span> <span class="fu">quasipoisson</span>(),</span>
<span id="cb1069-3"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1069-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> sm_oh_A_young)</span>
<span id="cb1069-4"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1069-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1069-5"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1069-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod_poiss_od1)</span></code></pre></div>
<pre><code>
Call:
glm(formula = physhealth ~ bmi_c + smoke100, family = quasipoisson(), 
    data = sm_oh_A_young)

Deviance Residuals: 
   Min      1Q  Median      3Q     Max  
-6.588  -2.604  -2.087  -0.533  10.688  

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 0.906991   0.073818  12.287  &lt; 2e-16 ***
bmi_c       0.035051   0.005611   6.247 5.11e-10 ***
smoke100    0.532505   0.098308   5.417 6.81e-08 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

(Dispersion parameter for quasipoisson family taken to be 15.58436)

    Null deviance: 20222  on 1973  degrees of freedom
Residual deviance: 19151  on 1971  degrees of freedom
AIC: NA

Number of Fisher Scoring iterations: 6</code></pre>
<div class="sourceCode" id="cb1071"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1071-1"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1071-1" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(mod_poiss_od1)</span></code></pre></div>
<pre><code>Waiting for profiling to be done...</code></pre>
<pre><code>                 2.5 %     97.5 %
(Intercept) 0.75877174 1.04831740
bmi_c       0.02383574 0.04583252
smoke100    0.34039368 0.72606948</code></pre>
<p>This “quasi-Poisson regression” model uses the same mean function as Poisson regression, but now estimated by quasi-maximum likelihood estimation or, equivalently, through the method of generalized estimating equations, where the inference is adjusted by an estimated dispersion parameter. Sometimes, though I won’t demonstrate this here, people fit an “adjusted” Poisson regression model, where this estimation by quasi-ML is augmented to adjust the inference via sandwich estimates of the covariances<a href="#fn11" class="footnote-ref" id="fnref11"><sup>11</sup></a>.</p>
<div id="the-fitted-equation-1" class="section level3" number="19.9.1">
<h3><span class="header-section-number">19.9.1</span> The Fitted Equation</h3>
<p>The model equation is still <code>log(physhealth) = 0.91 + 0.035 bmi_c + 0.53 smoke100</code>. The estimated coefficients are still statistically significant, but the standard errors for each coefficient are considerably larger when we account for overdispersion.</p>
<p>The dispersion parameter for the quasi-Poisson family is now taken to be a bit less than the square root of the ratio of the residual deviance and its degrees of freedom. This is a much more believable model, as a result.</p>
</div>
<div id="interpreting-the-coefficients-3" class="section level3" number="19.9.2">
<h3><span class="header-section-number">19.9.2</span> Interpreting the Coefficients</h3>
<p>No meaningful change from the Poisson model we saw previously.</p>
</div>
<div id="testing-the-predictors-1" class="section level3" number="19.9.3">
<h3><span class="header-section-number">19.9.3</span> Testing the Predictors</h3>
<p>Again, we can use the Wald tests (z tests) provided with the Poisson regression output, or we can fit the model and then run an ANOVA to obtain a test based on the deviance (a simple transformation of the log likelihood ratio.)</p>
<ul>
<li>By the Wald tests shown above, each predictor clearly adds significant predictive value to the model given the other predictor, and we note that the <em>p</em> values are as small as R will support.</li>
<li>The ANOVA approach for this model lets us check the impact of adding <code>smoke100</code> to a model already containing <code>bmi_c</code>.</li>
</ul>
<div class="sourceCode" id="cb1074"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1074-1"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1074-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod_poiss_od1, <span class="at">test =</span> <span class="st">&quot;Chisq&quot;</span>)</span></code></pre></div>
<pre><code>Analysis of Deviance Table

Model: quasipoisson, link: log

Response: physhealth

Terms added sequentially (first to last)

         Df Deviance Resid. Df Resid. Dev  Pr(&gt;Chi)    
NULL                      1973      20222              
bmi_c     1   609.46      1972      19612 4.011e-10 ***
smoke100  1   461.46      1971      19151 5.282e-08 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>The result is unchanged. To obtain a <em>p</em> value for <code>smoke100</code>’s impact after <code>bmi_c</code> is accounted for, we compare the difference in deviance to a chi-square distribution with 1 degree of freedom. The result is incredibly statistically significant.</p>
<p>To check the effect of <code>bmi_c</code>, we could refit the model with and without <code>bmi_c</code>, and again run an ANOVA. I’ll skip that here.</p>
</div>
<div id="store-fitted-values-and-residuals-3" class="section level3" number="19.9.4">
<h3><span class="header-section-number">19.9.4</span> Store fitted values and residuals</h3>
<p>What happens if we try using the <code>broom</code> package in this case? We can, if we like, get our predicted values right on the scale of our <code>physhealth</code> response.</p>
<div class="sourceCode" id="cb1076"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1076-1"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1076-1" aria-hidden="true" tabindex="-1"></a>sm_poiss_od1 <span class="ot">&lt;-</span> <span class="fu">augment</span>(mod_poiss_od1, sm_oh_A_young,</span>
<span id="cb1076-2"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1076-2" aria-hidden="true" tabindex="-1"></a>                     <span class="at">type.predict =</span> <span class="st">&quot;response&quot;</span>)</span>
<span id="cb1076-3"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1076-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1076-4"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1076-4" aria-hidden="true" tabindex="-1"></a>sm_poiss_od1 <span class="sc">%&gt;%</span> </span>
<span id="cb1076-5"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1076-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(physhealth, .fitted) <span class="sc">%&gt;%</span></span>
<span id="cb1076-6"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1076-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">head</span>()</span></code></pre></div>
<pre><code># A tibble: 6 x 2
  physhealth .fitted
       &lt;dbl&gt;   &lt;dbl&gt;
1          0    2.23
2          0    2.29
3          0    3.10
4         30    5.32
5          0    3.15
6          0    3.68</code></pre>
<p>It turns out that 0 of the 1974 predictions that we make are below 0, and the largest prediction made by this model is 21.7 days.</p>
<p>The <code>rootogram</code> function we’ve shown doesn’t support overdispersed Poisson models at the moment.</p>
</div>
<div id="specify-the-r2-and-loglikelihood-values-3" class="section level3" number="19.9.5">
<h3><span class="header-section-number">19.9.5</span> Specify the R<sup>2</sup> and log(likelihood) values</h3>
<p>We can calculate the R<sup>2</sup> as the squared correlation of the fitted values and the observed values.</p>
<div class="sourceCode" id="cb1078"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1078-1"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1078-1" aria-hidden="true" tabindex="-1"></a><span class="co"># The correlation of observed and fitted values</span></span>
<span id="cb1078-2"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1078-2" aria-hidden="true" tabindex="-1"></a>(poiss_od_r <span class="ot">&lt;-</span> <span class="fu">with</span>(sm_poiss_od1, <span class="fu">cor</span>(physhealth, .fitted)))</span></code></pre></div>
<pre><code>[1] 0.1846814</code></pre>
<div class="sourceCode" id="cb1080"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1080-1"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1080-1" aria-hidden="true" tabindex="-1"></a><span class="co"># R-square</span></span>
<span id="cb1080-2"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1080-2" aria-hidden="true" tabindex="-1"></a>poiss_od_r<span class="sc">^</span><span class="dv">2</span></span></code></pre></div>
<pre><code>[1] 0.03410723</code></pre>
<p>The <code>glance</code> function in the <code>broom</code> package gives us model log(likelihood), among other summaries.</p>
<div class="sourceCode" id="cb1082"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1082-1"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1082-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(mod_poiss_od1) <span class="sc">%&gt;%</span> <span class="fu">round</span>(<span class="dv">3</span>)</span></code></pre></div>
<pre><code># A tibble: 1 x 8
  null.deviance df.null logLik   AIC   BIC deviance df.residual  nobs
          &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;       &lt;dbl&gt; &lt;dbl&gt;
1        20222.    1973     NA    NA    NA   19151.        1971  1974</code></pre>
<p>Here, we have</p>
<table>
<thead>
<tr class="header">
<th align="right">Model</th>
<th align="right">Scale</th>
<th align="right">R<sup>2</sup></th>
<th align="right">log(likelihood)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">Poisson</td>
<td align="right">log(<code>physhealth</code>)</td>
<td align="right">0.034</td>
<td align="right">NA</td>
</tr>
</tbody>
</table>
</div>
<div id="check-model-assumptions-3" class="section level3" number="19.9.6">
<h3><span class="header-section-number">19.9.6</span> Check model assumptions</h3>
<p>Having dealt with the overdispersion, this should be a cleaner model in some ways, but the diagnostics (other than the dispersion) will be the same. Here is a plot of residuals vs. fitted values on the original <code>physhealth</code> scale.</p>
<div class="sourceCode" id="cb1084"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1084-1"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1084-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(sm_poiss_od1, <span class="fu">aes</span>(<span class="at">x =</span> .fitted, <span class="at">y =</span> .resid)) <span class="sc">+</span></span>
<span id="cb1084-2"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1084-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb1084-3"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1084-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Residuals vs. Fitted `physhealth`&quot;</span>,</span>
<span id="cb1084-4"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1084-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">subtitle =</span> <span class="st">&quot;Overdispersed Poisson Regression model&quot;</span>)</span></code></pre></div>
<p><img src="432-notes_files/figure-html/unnamed-chunk-437-1.png" width="672" /></p>
<p>I’ll skip the <code>glm.diag.plots</code> results, since you’ve already seen them.</p>
</div>
<div id="predictions-for-harry-and-sally-3" class="section level3" number="19.9.7">
<h3><span class="header-section-number">19.9.7</span> Predictions for Harry and Sally</h3>
<p>The predictions from this overdispersed Poisson regression will match those in the original Poisson regression, but the standard error will be larger.</p>
<div class="sourceCode" id="cb1085"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1085-1"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1085-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(mod_poiss_od1, <span class="at">newdata =</span> hs_data, <span class="at">se.fit =</span> <span class="cn">TRUE</span>,</span>
<span id="cb1085-2"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1085-2" aria-hidden="true" tabindex="-1"></a>        <span class="at">type =</span> <span class="st">&quot;response&quot;</span>)</span></code></pre></div>
<pre><code>$fit
       1        2 
5.989478 2.078688 

$se.fit
        1         2 
0.4557357 0.1703147 

$residual.scale
[1] 3.947703</code></pre>
<p>By using <code>response</code> as the type, these predictions fall on the original <code>physhealth</code> scale. Again, the prediction for Harry is 5.99 days, and for Sally is 2.08 days.</p>
</div>
</div>
<div id="poisson-and-quasi-poisson-models-using-glm-from-the-rms-package" class="section level2" number="19.10">
<h2><span class="header-section-number">19.10</span> Poisson and Quasi-Poisson models using <code>Glm</code> from the <code>rms</code> package</h2>
<p>The <code>Glm</code> function in the <code>rms</code> package can be used to fit both the original Poisson regression and the quasi-Poisson model accounting for overdispersion.</p>
<div id="refitting-the-original-poisson-regression-with-glm" class="section level3" number="19.10.1">
<h3><span class="header-section-number">19.10.1</span> Refitting the original Poisson regression with <code>Glm</code></h3>
<div class="sourceCode" id="cb1087"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1087-1"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1087-1" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">datadist</span>(sm_oh_A_young)</span>
<span id="cb1087-2"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1087-2" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">datadist =</span> <span class="st">&quot;d&quot;</span>)</span>
<span id="cb1087-3"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1087-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1087-4"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1087-4" aria-hidden="true" tabindex="-1"></a>mod_poi_Glm_1 <span class="ot">&lt;-</span> <span class="fu">Glm</span>(physhealth <span class="sc">~</span> bmi_c <span class="sc">+</span> smoke100,</span>
<span id="cb1087-5"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1087-5" aria-hidden="true" tabindex="-1"></a>                     <span class="at">family =</span> <span class="fu">poisson</span>(), </span>
<span id="cb1087-6"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1087-6" aria-hidden="true" tabindex="-1"></a>                     <span class="at">data =</span> sm_oh_A_young, </span>
<span id="cb1087-7"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1087-7" aria-hidden="true" tabindex="-1"></a>                     <span class="at">x =</span> T, <span class="at">y =</span> T)</span>
<span id="cb1087-8"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1087-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1087-9"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1087-9" aria-hidden="true" tabindex="-1"></a>mod_poi_Glm_1</span></code></pre></div>
<pre><code>General Linear Model
 
 Glm(formula = physhealth ~ bmi_c + smoke100, family = poisson(), 
     data = sm_oh_A_young, x = T, y = T)
 
                        Model Likelihood    
                              Ratio Test    
       Obs    1974    LR chi2    1070.93    
 Residual d.f.1971    d.f.             2    
       g 0.4182128    Pr(&gt; chi2) &lt;0.0001    
 
           Coef   S.E.   Wald Z Pr(&gt;|Z|)
 Intercept 0.9070 0.0187 48.50  &lt;0.0001 
 bmi_c     0.0351 0.0014 24.66  &lt;0.0001 
 smoke100  0.5325 0.0249 21.38  &lt;0.0001 
 </code></pre>
</div>
<div id="refitting-the-overdispersed-poisson-regression-with-glm" class="section level3" number="19.10.2">
<h3><span class="header-section-number">19.10.2</span> Refitting the overdispersed Poisson regression with <code>Glm</code></h3>
<div class="sourceCode" id="cb1089"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1089-1"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1089-1" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">datadist</span>(sm_oh_A_young)</span>
<span id="cb1089-2"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1089-2" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">datadist =</span> <span class="st">&quot;d&quot;</span>)</span>
<span id="cb1089-3"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1089-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1089-4"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1089-4" aria-hidden="true" tabindex="-1"></a>mod_poi_od_Glm_1 <span class="ot">&lt;-</span> <span class="fu">Glm</span>(physhealth <span class="sc">~</span> bmi_c <span class="sc">+</span> smoke100,</span>
<span id="cb1089-5"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1089-5" aria-hidden="true" tabindex="-1"></a>                     <span class="at">family =</span> <span class="fu">quasipoisson</span>(), </span>
<span id="cb1089-6"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1089-6" aria-hidden="true" tabindex="-1"></a>                     <span class="at">data =</span> sm_oh_A_young, </span>
<span id="cb1089-7"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1089-7" aria-hidden="true" tabindex="-1"></a>                     <span class="at">x =</span> T, <span class="at">y =</span> T)</span>
<span id="cb1089-8"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1089-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1089-9"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1089-9" aria-hidden="true" tabindex="-1"></a>mod_poi_od_Glm_1</span></code></pre></div>
<pre><code>General Linear Model
 
 Glm(formula = physhealth ~ bmi_c + smoke100, family = quasipoisson(), 
     data = sm_oh_A_young, x = T, y = T)
 
                        Model Likelihood    
                              Ratio Test    
       Obs    1974    LR chi2    1070.93    
 Residual d.f.1971    d.f.             2    
       g 0.4182128    Pr(&gt; chi2) &lt;0.0001    
 
           Coef   S.E.   Wald Z Pr(&gt;|Z|)
 Intercept 0.9070 0.0738 12.29  &lt;0.0001 
 bmi_c     0.0351 0.0056  6.25  &lt;0.0001 
 smoke100  0.5325 0.0983  5.42  &lt;0.0001 
 </code></pre>
<p>The big advantage here is that we have access to the usual <code>ANOVA</code>, <code>summary</code>, and <code>nomogram</code> features that <code>rms</code> brings to fitting models.</p>
</div>
<div id="anova-on-a-glm-fit" class="section level3" number="19.10.3">
<h3><span class="header-section-number">19.10.3</span> ANOVA on a <code>Glm</code> fit</h3>
<div class="sourceCode" id="cb1091"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1091-1"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1091-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod_poi_od_Glm_1)</span></code></pre></div>
<pre><code>                Wald Statistics          Response: physhealth 

 Factor     Chi-Square d.f. P     
 bmi_c      39.03      1    &lt;.0001
 smoke100   29.34      1    &lt;.0001
 TOTAL      74.39      2    &lt;.0001</code></pre>
<p>This shows the individual Wald <span class="math inline">\(\chi^2\)</span> tests without having to refit the model.</p>
</div>
<div id="ggplots-from-glm-fit" class="section level3" number="19.10.4">
<h3><span class="header-section-number">19.10.4</span> ggplots from <code>Glm</code> fit</h3>
<div class="sourceCode" id="cb1093"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1093-1"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1093-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">Predict</span>(mod_poi_od_Glm_1, <span class="at">fun =</span> exp))</span></code></pre></div>
<p><img src="432-notes_files/figure-html/unnamed-chunk-442-1.png" width="672" /></p>
</div>
<div id="summary-of-a-glm-fit" class="section level3" number="19.10.5">
<h3><span class="header-section-number">19.10.5</span> Summary of a <code>Glm</code> fit</h3>
<div class="sourceCode" id="cb1094"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1094-1"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1094-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod_poi_od_Glm_1)</span></code></pre></div>
<pre><code>             Effects              Response : physhealth 

 Factor   Low     High   Diff.  Effect  S.E.     Lower 0.95 Upper 0.95
 bmi_c    -5.0513 3.6362 8.6875 0.30450 0.048742 0.20891    0.4001    
 smoke100  0.0000 1.0000 1.0000 0.53251 0.098308 0.33971    0.7253    </code></pre>
</div>
<div id="plot-of-the-summary" class="section level3" number="19.10.6">
<h3><span class="header-section-number">19.10.6</span> Plot of the Summary</h3>
<div class="sourceCode" id="cb1096"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1096-1"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1096-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">summary</span>(mod_poi_od_Glm_1))</span></code></pre></div>
<p><img src="432-notes_files/figure-html/unnamed-chunk-444-1.png" width="672" /></p>
</div>
<div id="nomogram-of-a-glm-fit" class="section level3" number="19.10.7">
<h3><span class="header-section-number">19.10.7</span> Nomogram of a <code>Glm</code> fit</h3>
<div class="sourceCode" id="cb1097"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1097-1"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1097-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">nomogram</span>(mod_poi_od_Glm_1, <span class="at">fun =</span> exp, </span>
<span id="cb1097-2"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1097-2" aria-hidden="true" tabindex="-1"></a>              <span class="at">funlabel =</span> <span class="st">&quot;physhealth days&quot;</span>))</span></code></pre></div>
<p><img src="432-notes_files/figure-html/unnamed-chunk-445-1.png" width="672" /></p>
<p>Note the use of <code>fun=exp</code> in both the ggplot of Predict and the nomogram. What’s that doing?</p>
</div>
</div>
<div id="negative-binomial-model" class="section level2" number="19.11">
<h2><span class="header-section-number">19.11</span> Negative Binomial Model</h2>
<p>Another approach to dealing with overdispersion is to fit a negative binomial model<a href="#fn12" class="footnote-ref" id="fnref12"><sup>12</sup></a> to predict the log(<code>physhealth</code>) counts. This involves the fitting of an additional parameter, <span class="math inline">\(\theta\)</span>. That’s our dispersion parameter<a href="#fn13" class="footnote-ref" id="fnref13"><sup>13</sup></a></p>
<p>Sometimes, people will fit a model where <span class="math inline">\(\theta\)</span> is known, for instance a geometric model (where <span class="math inline">\(\theta\)</span> = 1), and then this can be directly plugged into a <code>glm()</code> fit, but the more common scenario is that we are going to iteratively estimate the <span class="math inline">\(\beta\)</span> coefficients and <span class="math inline">\(\theta\)</span>. To do this, I’ll use the <code>glm.nb</code> function from the <code>MASS</code> package.</p>
<div class="sourceCode" id="cb1098"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1098-1"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1098-1" aria-hidden="true" tabindex="-1"></a>mod_nb1 <span class="ot">&lt;-</span> MASS<span class="sc">::</span><span class="fu">glm.nb</span>(physhealth <span class="sc">~</span> bmi_c <span class="sc">+</span> smoke100, <span class="at">link =</span> log,</span>
<span id="cb1098-2"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1098-2" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> sm_oh_A_young)</span>
<span id="cb1098-3"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1098-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1098-4"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1098-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod_nb1)</span></code></pre></div>
<pre><code>
Call:
MASS::glm.nb(formula = physhealth ~ bmi_c + smoke100, data = sm_oh_A_young, 
    link = log, init.theta = 0.1487673114)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-1.2260  -0.9712  -0.8985  -0.1128   1.9929  

Coefficients:
            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept) 0.874530   0.078994  11.071  &lt; 2e-16 ***
bmi_c       0.035712   0.008317   4.294 1.76e-05 ***
smoke100    0.596396   0.121166   4.922 8.56e-07 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

(Dispersion parameter for Negative Binomial(0.1488) family taken to be 1)

    Null deviance: 1468.1  on 1973  degrees of freedom
Residual deviance: 1422.6  on 1971  degrees of freedom
AIC: 6976.6

Number of Fisher Scoring iterations: 1

              Theta:  0.14877 
          Std. Err.:  0.00705 

 2 x log-likelihood:  -6968.55300 </code></pre>
<div class="sourceCode" id="cb1100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1100-1"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1100-1" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(mod_nb1)</span></code></pre></div>
<pre><code>Waiting for profiling to be done...</code></pre>
<pre><code>                 2.5 %     97.5 %
(Intercept) 0.72304817 1.03304660
bmi_c       0.02072601 0.05124925
smoke100    0.35977590 0.83584673</code></pre>
<div id="the-fitted-equation-2" class="section level3" number="19.11.1">
<h3><span class="header-section-number">19.11.1</span> The Fitted Equation</h3>
<p>The form of the model equation for a negative binomial regression is the same as that for Poisson regression.</p>
<pre><code>log(physhealth) = 0.87 + 0.036 bmi_c + 0.60 smoke100</code></pre>
</div>
<div id="comparison-with-the-raw-poisson-model" class="section level3" number="19.11.2">
<h3><span class="header-section-number">19.11.2</span> Comparison with the (raw) Poisson model</h3>
<p>To compare the negative binomial model to the Poisson model (without the overdispersion) we can use the <code>logLik</code> function to make a comparison. Note that the Poisson model is a subset of the negative binomial.</p>
<div class="sourceCode" id="cb1104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1104-1"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1104-1" aria-hidden="true" tabindex="-1"></a><span class="fu">logLik</span>(mod_nb1)</span></code></pre></div>
<pre><code>&#39;log Lik.&#39; -3484.277 (df=4)</code></pre>
<div class="sourceCode" id="cb1106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1106-1"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1106-1" aria-hidden="true" tabindex="-1"></a><span class="fu">logLik</span>(mod_poiss1)</span></code></pre></div>
<pre><code>&#39;log Lik.&#39; -10819.6 (df=3)</code></pre>
<div class="sourceCode" id="cb1108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1108-1"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1108-1" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span> <span class="sc">*</span> (<span class="fu">logLik</span>(mod_nb1) <span class="sc">-</span> <span class="fu">logLik</span>(mod_poiss1))</span></code></pre></div>
<pre><code>&#39;log Lik.&#39; 14670.65 (df=4)</code></pre>
<div class="sourceCode" id="cb1110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1110-1"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1110-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pchisq</span>(<span class="dv">2</span> <span class="sc">*</span> (<span class="fu">logLik</span>(mod_nb1) <span class="sc">-</span> <span class="fu">logLik</span>(mod_poiss1)), <span class="at">df =</span> <span class="dv">1</span>, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>&#39;log Lik.&#39; 0 (df=4)</code></pre>
<p>Here, the difference in the log likelihoods is large enough that the resulting <em>p</em> value is very small. This strongly suggests that the negative binomial model, which adds the dispersion parameter, is more appropriate than the raw Poisson model.</p>
<p>However, both the regression coefficients and the standard errors are rather similar to the quasi-Poisson and the sandwich-adjusted Poisson results above. Thus, in terms of predicted means, all three models give very similar results; the associated Wald tests also lead to the same conclusions.</p>
</div>
<div id="interpreting-the-coefficients-4" class="section level3" number="19.11.3">
<h3><span class="header-section-number">19.11.3</span> Interpreting the Coefficients</h3>
<p>There’s only a small change here from the Poisson models we saw previously.</p>
<ul>
<li>The constant term, 0.87, gives us the intercept of the regression - the prediction if <code>smoke100 = 0</code> and <code>bmi_c = 0</code>. In this case, because we’ve centered BMI, it implies that <code>exp(0.87)</code> = 2.39 is the predicted days of poor <code>physhealth</code> for a non-smoker with average BMI.</li>
<li>The coefficient of <code>bmi_c</code>, 0.036, is the expected difference in count of poor <code>physhealth</code> days (on the log scale) for each additional kg/m<sup>2</sup> of body mass index. The expected multiplicative <em>increase</em> is <span class="math inline">\(e^{0.036}\)</span> = 1.037, corresponding to a 3.7% difference in the count.</li>
<li>The coefficient of <code>smoke100</code>, 0.60, tells us that the predictive difference between those who have and who have not smoked 100 cigarettes can be found by multiplying the <code>physhealth</code> count by exp(0.6) = 1.82, yielding essentially an 82% increase of the <code>physhealth</code> count.</li>
</ul>
</div>
<div id="interpretation-of-coefficients-in-terms-of-irrs" class="section level3" number="19.11.4">
<h3><span class="header-section-number">19.11.4</span> Interpretation of Coefficients in terms of IRRs</h3>
<p>We might be interested in looking at incident rate ratios rather than coefficients. The coefficients have an additive effect in the log(y) scale, and the IRR have a multiplicative effect in the y scale. To do this, we can exponentiate our model coefficients. This also applies to the confidence intervals.</p>
<div class="sourceCode" id="cb1112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1112-1"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1112-1" aria-hidden="true" tabindex="-1"></a><span class="fu">exp</span>(<span class="fu">coef</span>(mod_nb1))</span></code></pre></div>
<pre><code>(Intercept)       bmi_c    smoke100 
   2.397748    1.036357    1.815563 </code></pre>
<div class="sourceCode" id="cb1114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1114-1"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1114-1" aria-hidden="true" tabindex="-1"></a><span class="fu">exp</span>(<span class="fu">confint</span>(mod_nb1))</span></code></pre></div>
<pre><code>Waiting for profiling to be done...</code></pre>
<pre><code>               2.5 %   97.5 %
(Intercept) 2.060705 2.809613
bmi_c       1.020942 1.052585
smoke100    1.433008 2.306766</code></pre>
<p>As an example, then, the incident rate for <code>smoke100</code> = 1 is 1.82 times the incident rate of <code>physhealth</code> days for the reference group (<code>smoke100</code> = 0). The percent change in the incident rate of <code>physhealth</code> is a 3.6% increase for every kg/m<sup>2</sup> increase in centered <code>bmi</code>.</p>
</div>
<div id="testing-the-predictors-2" class="section level3" number="19.11.5">
<h3><span class="header-section-number">19.11.5</span> Testing the Predictors</h3>
<p>Again, we can use the Wald tests (z tests) provided with the negative binomial regression output.</p>
<p>As an alternative, we probably should not use the standard <code>anova</code> process, because the models there don’t re-estimate <span class="math inline">\(\theta\)</span> for each new model, as the warning message below indicates.</p>
<div class="sourceCode" id="cb1117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1117-1"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1117-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod_nb1)</span></code></pre></div>
<pre><code>Warning in anova.negbin(mod_nb1): tests made without re-estimating &#39;theta&#39;</code></pre>
<pre><code>Analysis of Deviance Table

Model: Negative Binomial(0.1488), link: log

Response: physhealth

Terms added sequentially (first to last)

         Df Deviance Resid. Df Resid. Dev  Pr(&gt;Chi)    
NULL                      1973     1468.0              
bmi_c     1   20.837      1972     1447.2 5.001e-06 ***
smoke100  1   24.584      1971     1422.6 7.115e-07 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>So, instead, if we want, for instance to assess the significance of <code>bmi_c</code>, after <code>smoke100</code> is already included in the model, we fit both models (with and without <code>bmi_c</code>) and then compare those models with a likelihood ratio test.</p>
<div class="sourceCode" id="cb1120"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1120-1"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1120-1" aria-hidden="true" tabindex="-1"></a>mod_nb1_without_bmi <span class="ot">&lt;-</span> MASS<span class="sc">::</span><span class="fu">glm.nb</span>(physhealth <span class="sc">~</span> smoke100, </span>
<span id="cb1120-2"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1120-2" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">link =</span> log,</span>
<span id="cb1120-3"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1120-3" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">data =</span> sm_oh_A_young)</span>
<span id="cb1120-4"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1120-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1120-5"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1120-5" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod_nb1, mod_nb1_without_bmi)</span></code></pre></div>
<pre><code>Likelihood ratio tests of Negative Binomial Models

Response: physhealth
             Model     theta Resid. df    2 x log-lik.   Test    df LR stat.
1         smoke100 0.1452219      1972       -6991.195                      
2 bmi_c + smoke100 0.1487673      1971       -6968.553 1 vs 2     1  22.6421
       Pr(Chi)
1             
2 1.951615e-06</code></pre>
<p>And we could compare the negative binomial models with and without <code>smoke100</code> in a similar way.</p>
<div class="sourceCode" id="cb1122"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1122-1"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1122-1" aria-hidden="true" tabindex="-1"></a>mod_nb1_without_smoke <span class="ot">&lt;-</span> MASS<span class="sc">::</span><span class="fu">glm.nb</span>(physhealth <span class="sc">~</span> bmi_c, </span>
<span id="cb1122-2"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1122-2" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">link =</span> log,</span>
<span id="cb1122-3"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1122-3" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">data =</span> sm_oh_A_young)</span>
<span id="cb1122-4"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1122-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1122-5"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1122-5" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod_nb1, mod_nb1_without_smoke)</span></code></pre></div>
<pre><code>Likelihood ratio tests of Negative Binomial Models

Response: physhealth
             Model     theta Resid. df    2 x log-lik.   Test    df LR stat.
1            bmi_c 0.1449966      1972       -6992.839                      
2 bmi_c + smoke100 0.1487673      1971       -6968.553 1 vs 2     1 24.28569
       Pr(Chi)
1             
2 8.305388e-07</code></pre>
</div>
<div id="store-fitted-values-and-residuals-4" class="section level3" number="19.11.6">
<h3><span class="header-section-number">19.11.6</span> Store fitted values and residuals</h3>
<p>The <code>broom</code> package works in this case, too. We’ll look here at predicted (fitted) values on the scale of our <code>physhealth</code> response.</p>
<div class="sourceCode" id="cb1124"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1124-1"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1124-1" aria-hidden="true" tabindex="-1"></a>sm_nb1 <span class="ot">&lt;-</span> <span class="fu">augment</span>(mod_nb1, sm_oh_A_young,</span>
<span id="cb1124-2"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1124-2" aria-hidden="true" tabindex="-1"></a>                     <span class="at">type.predict =</span> <span class="st">&quot;response&quot;</span>)</span></code></pre></div>
<pre><code>Warning: Tidiers for objects of class negbin are not maintained by the broom
team, and are only supported through the glmlm tidier method. Please be cautious
in interpreting and reporting broom output.</code></pre>
<div class="sourceCode" id="cb1126"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1126-1"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1126-1" aria-hidden="true" tabindex="-1"></a>sm_nb1 <span class="sc">%&gt;%</span> </span>
<span id="cb1126-2"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1126-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(physhealth, .fitted) <span class="sc">%&gt;%</span></span>
<span id="cb1126-3"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1126-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">head</span>()</span></code></pre></div>
<pre><code># A tibble: 6 x 2
  physhealth .fitted
       &lt;dbl&gt;   &lt;dbl&gt;
1          0    2.15
2          0    2.22
3          0    3.18
4         30    5.23
5          0    3.24
6          0    3.78</code></pre>
</div>
<div id="rootogram-for-negative-binomial-model" class="section level3" number="19.11.7">
<h3><span class="header-section-number">19.11.7</span> Rootogram for Negative Binomial model</h3>
<p>Here’s the rootogram for the negative binomial model.</p>
<div class="sourceCode" id="cb1128"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1128-1"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1128-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rootogram</span>(mod_nb1, <span class="at">max =</span> <span class="dv">30</span>)</span></code></pre></div>
<p><img src="432-notes_files/figure-html/unnamed-chunk-453-1.png" width="672" /></p>
<p>Again, the red curved line is the theoretical (negative binomial) fit. “Hanging” from each point on the red line is a bar, the height of which represents the difference between expected and observed counts. A bar hanging below 0 indicates underfitting. A bar hanging above 0 indicates overfitting. The counts have been transformed with a square root transformation to prevent smaller counts from getting obscured and overwhelmed by larger counts.</p>
<p>The match looks much better than the Poisson model, which is a sign that accounting for overdispersion is very important. Even this model badly underfits the number of 30 values, however.</p>
</div>
<div id="simulating-what-the-negative-binomial-model-predicts" class="section level3" number="19.11.8">
<h3><span class="header-section-number">19.11.8</span> Simulating what the Negative Binomial model predicts</h3>
<p>We can use the parameters of the negative binomial model to simulate data<a href="#fn14" class="footnote-ref" id="fnref14"><sup>14</sup></a> and compare the simulated results to our observed <code>physhealth</code> data.</p>
<div class="sourceCode" id="cb1129"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1129-1"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1129-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb1129-2"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1129-2" aria-hidden="true" tabindex="-1"></a>sm_oh_A_young<span class="sc">$</span>physhealth <span class="sc">%&gt;%</span> </span>
<span id="cb1129-3"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1129-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">table</span>() <span class="sc">%&gt;%</span> <span class="fu">barplot</span>(<span class="at">main =</span> <span class="st">&quot;Observed physhealth&quot;</span>)</span>
<span id="cb1129-4"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1129-4" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">432122</span>)</span>
<span id="cb1129-5"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1129-5" aria-hidden="true" tabindex="-1"></a><span class="fu">rnbinom</span>(<span class="at">n =</span> <span class="fu">nrow</span>(sm_oh_A_young), </span>
<span id="cb1129-6"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1129-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">size =</span> mod_nb1<span class="sc">$</span>theta,</span>
<span id="cb1129-7"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1129-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">mu =</span> <span class="fu">exp</span>(<span class="fu">coef</span>(mod_nb1)[<span class="dv">1</span>])) <span class="sc">%&gt;%</span></span>
<span id="cb1129-8"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1129-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">table</span>() <span class="sc">%&gt;%</span> <span class="fu">barplot</span>(<span class="at">main =</span> <span class="st">&quot;Simulated physhealth&quot;</span>)</span></code></pre></div>
<p><img src="432-notes_files/figure-html/unnamed-chunk-454-1.png" width="672" /></p>
<p>Again we see that the simulated data badly underfits the 30 values, and includes some predictions larger than 30.</p>
</div>
<div id="specify-the-r2-and-loglikelihood-values-4" class="section level3" number="19.11.9">
<h3><span class="header-section-number">19.11.9</span> Specify the R<sup>2</sup> and log(likelihood) values</h3>
<p>We can calculate the R<sup>2</sup> as the squared correlation of the fitted values and the observed values.</p>
<div class="sourceCode" id="cb1130"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1130-1"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1130-1" aria-hidden="true" tabindex="-1"></a><span class="co"># The correlation of observed and fitted values</span></span>
<span id="cb1130-2"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1130-2" aria-hidden="true" tabindex="-1"></a>(nb_r <span class="ot">&lt;-</span> <span class="fu">with</span>(sm_nb1, <span class="fu">cor</span>(physhealth, .fitted)))</span></code></pre></div>
<pre><code>[1] 0.183675</code></pre>
<div class="sourceCode" id="cb1132"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1132-1"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1132-1" aria-hidden="true" tabindex="-1"></a><span class="co"># R-square</span></span>
<span id="cb1132-2"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1132-2" aria-hidden="true" tabindex="-1"></a>nb_r<span class="sc">^</span><span class="dv">2</span></span></code></pre></div>
<pre><code>[1] 0.03373649</code></pre>
<p>The <code>glance</code> function in the <code>broom</code> package gives us model log(likelihood), among other summaries.</p>
<div class="sourceCode" id="cb1134"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1134-1"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1134-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(mod_nb1) <span class="sc">%&gt;%</span> <span class="fu">round</span>(<span class="dv">3</span>)</span></code></pre></div>
<pre><code>Warning: Tidiers for objects of class negbin are not maintained by the broom
team, and are only supported through the glmlm tidier method. Please be cautious
in interpreting and reporting broom output.</code></pre>
<pre><code># A tibble: 1 x 8
  null.deviance df.null logLik   AIC   BIC deviance df.residual  nobs
          &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;       &lt;dbl&gt; &lt;dbl&gt;
1         1468.    1973 -3484. 6977. 6999.    1423.        1971  1974</code></pre>
<p>Here, we have</p>
<table>
<thead>
<tr class="header">
<th align="right">Model</th>
<th align="right">Scale</th>
<th align="right">R<sup>2</sup></th>
<th align="right">log(likelihood)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">Negative Binomial</td>
<td align="right">log(<code>physhealth</code>)</td>
<td align="right">.034</td>
<td align="right">-3484.27</td>
</tr>
</tbody>
</table>
</div>
<div id="check-model-assumptions-4" class="section level3" number="19.11.10">
<h3><span class="header-section-number">19.11.10</span> Check model assumptions</h3>
<p>Here is a plot of residuals vs. fitted values on the original <code>physhealth</code> scale.</p>
<div class="sourceCode" id="cb1137"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1137-1"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1137-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(sm_nb1, <span class="fu">aes</span>(<span class="at">x =</span> .fitted, <span class="at">y =</span> .resid)) <span class="sc">+</span></span>
<span id="cb1137-2"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1137-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb1137-3"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1137-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Residuals vs. Fitted `physhealth`&quot;</span>,</span>
<span id="cb1137-4"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1137-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">subtitle =</span> <span class="st">&quot;Negative Binomial Regression model&quot;</span>)</span></code></pre></div>
<p><img src="432-notes_files/figure-html/unnamed-chunk-457-1.png" width="672" /></p>
<p>Here are the <code>glm</code> diagnostic plots from the <code>boot</code> package.</p>
<div class="sourceCode" id="cb1138"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1138-1"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1138-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glm.diag.plots</span>(mod_nb1)</span></code></pre></div>
<p><img src="432-notes_files/figure-html/unnamed-chunk-458-1.png" width="672" /></p>
<p>From the lower left plot, we see fewer points with large values of both Cook’s distance and leverage, so that’s a step in the right direction. The upper right plot still has some issues, but we’re closer to a desirable result there, too.</p>
</div>
<div id="predictions-for-harry-and-sally-4" class="section level3" number="19.11.11">
<h3><span class="header-section-number">19.11.11</span> Predictions for Harry and Sally</h3>
<p>The predictions from this negative binomial regression model will be only a little different than those from the Poisson models.</p>
<div class="sourceCode" id="cb1139"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1139-1"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1139-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(mod_nb1, <span class="at">newdata =</span> hs_data, <span class="at">se.fit =</span> <span class="cn">TRUE</span>,</span>
<span id="cb1139-2"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1139-2" aria-hidden="true" tabindex="-1"></a>        <span class="at">type =</span> <span class="st">&quot;response&quot;</span>)</span></code></pre></div>
<pre><code>$fit
       1        2 
6.221696 2.005657 

$se.fit
        1         2 
0.7537535 0.1773595 

$residual.scale
[1] 1</code></pre>
<p>As we’ve seen in the past, when we use <code>response</code> as the type, the predictions fall on the original <code>physhealth</code> scale. The prediction for Harry is 6.2 days, and for Sally is 2.0 days.</p>
</div>
</div>
<div id="the-problem-too-few-zeros" class="section level2" number="19.12">
<h2><span class="header-section-number">19.12</span> The Problem: Too Few Zeros</h2>
<p>Remember that we observe more than 1000 zeros in our <code>physhealth</code> data.</p>
<div class="sourceCode" id="cb1141"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1141-1"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1141-1" aria-hidden="true" tabindex="-1"></a>sm_oh_A_young <span class="sc">%&gt;%</span> <span class="fu">count</span>(physhealth <span class="sc">==</span> <span class="dv">0</span>)</span></code></pre></div>
<pre><code># A tibble: 2 x 2
  `physhealth == 0`     n
* &lt;lgl&gt;             &lt;int&gt;
1 FALSE               710
2 TRUE               1264</code></pre>
<p>Let’s go back to our Poisson model (without overdispersion) for a moment, and concentrate on the zero values.</p>
<div class="sourceCode" id="cb1143"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1143-1"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1143-1" aria-hidden="true" tabindex="-1"></a><span class="co"># predict expected mean physhealth for each subject</span></span>
<span id="cb1143-2"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1143-2" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="fu">predict</span>(mod_poiss1, <span class="at">type =</span> <span class="st">&quot;response&quot;</span>)</span>
<span id="cb1143-3"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1143-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1143-4"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1143-4" aria-hidden="true" tabindex="-1"></a><span class="co"># sum the probabilities of a zero count for each mean</span></span>
<span id="cb1143-5"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1143-5" aria-hidden="true" tabindex="-1"></a>exp <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">dpois</span>(<span class="at">x =</span> <span class="dv">0</span>, <span class="at">lambda =</span> mu))</span>
<span id="cb1143-6"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1143-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1143-7"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1143-7" aria-hidden="true" tabindex="-1"></a><span class="co"># predicted number of zeros from Poisson model</span></span>
<span id="cb1143-8"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1143-8" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(exp)</span></code></pre></div>
<pre><code>[1] 124</code></pre>
<p>As we’ve seen previously, we’re severely underfitting zero counts. We can compare the observed number of zero <code>physhealth</code> results to the expected number of zero values from the likelihood-based models.</p>
<div class="sourceCode" id="cb1145"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1145-1"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1145-1" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">c</span>(<span class="st">&quot;Obs&quot;</span> <span class="ot">=</span> <span class="fu">sum</span>(sm_oh_A_young<span class="sc">$</span>physhealth <span class="sc">==</span> <span class="dv">0</span>),</span>
<span id="cb1145-2"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1145-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;Poisson&quot;</span> <span class="ot">=</span> <span class="fu">sum</span>(<span class="fu">dpois</span>(<span class="dv">0</span>, <span class="fu">fitted</span>(mod_poiss1))),</span>
<span id="cb1145-3"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1145-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;NB&quot;</span> <span class="ot">=</span> <span class="fu">sum</span>(<span class="fu">dnbinom</span>(<span class="dv">0</span>, <span class="at">mu =</span> <span class="fu">fitted</span>(mod_nb1), <span class="at">size =</span> mod_nb1<span class="sc">$</span>theta))),<span class="dv">0</span>)</span></code></pre></div>
<pre><code>    Obs Poisson      NB 
   1264     124    1250 </code></pre>
<p>There are at least two ways to tackle this problem.</p>
<ul>
<li>Fitting a model which deliberately inflates the number of zeros that are fitted</li>
<li>Fitting a hurdle model</li>
</ul>
<p>We’ll look at those options, next.</p>
</div>
<div id="the-zero-inflated-poisson-regression-model" class="section level2" number="19.13">
<h2><span class="header-section-number">19.13</span> The Zero-Inflated Poisson Regression Model</h2>
<p>The zero-inflated Poisson or (ZIP) model is used to describe count data with an excess of zero counts<a href="#fn15" class="footnote-ref" id="fnref15"><sup>15</sup></a>. The model posits that there are two processes involved:</p>
<ul>
<li>a logit model is used to predict excess zeros</li>
<li>while a Poisson model is used to predict the counts, generally</li>
</ul>
<p>The <code>pscl</code> package is used here, which can conflict with the <code>countreg</code> package we used to fit rootograms. That’s why I’m loading it here.</p>
<div class="sourceCode" id="cb1147"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1147-1"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1147-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pscl)</span></code></pre></div>
<p>To run the zero-inflated Poisson model, we use the following:</p>
<div class="sourceCode" id="cb1148"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1148-1"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1148-1" aria-hidden="true" tabindex="-1"></a>mod_zip1 <span class="ot">&lt;-</span> pscl<span class="sc">::</span><span class="fu">zeroinfl</span>(physhealth <span class="sc">~</span> bmi_c <span class="sc">+</span> smoke100, </span>
<span id="cb1148-2"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1148-2" aria-hidden="true" tabindex="-1"></a>                     <span class="at">data =</span> sm_oh_A_young)</span>
<span id="cb1148-3"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1148-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1148-4"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1148-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod_zip1)</span></code></pre></div>
<pre><code>
Call:
pscl::zeroinfl(formula = physhealth ~ bmi_c + smoke100, data = sm_oh_A_young)

Pearson residuals:
    Min      1Q  Median      3Q     Max 
-1.4389 -0.6987 -0.6138 -0.1947  9.3036 

Count model coefficients (poisson with log link):
            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept) 1.997594   0.018797   106.3   &lt;2e-16 ***
bmi_c       0.018176   0.001398    13.0   &lt;2e-16 ***
smoke100    0.393383   0.024889    15.8   &lt;2e-16 ***

Zero-inflation model coefficients (binomial with logit link):
             Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)  0.682427   0.062853  10.857  &lt; 2e-16 ***
bmi_c       -0.027731   0.006509  -4.260 2.04e-05 ***
smoke100    -0.237224   0.095318  -2.489   0.0128 *  
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 

Number of iterations in BFGS optimization: 8 
Log-likelihood: -5680 on 6 Df</code></pre>
<div class="sourceCode" id="cb1150"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1150-1"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1150-1" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(mod_zip1)</span></code></pre></div>
<pre><code>                        2.5 %      97.5 %
count_(Intercept)  1.96075280  2.03443546
count_bmi_c        0.01543576  0.02091718
count_smoke100     0.34460096  0.44216461
zero_(Intercept)   0.55923725  0.80561744
zero_bmi_c        -0.04048828 -0.01497359
zero_smoke100     -0.42404310 -0.05040515</code></pre>
<p>The output describes two separate regression models. Below the model call, we see information on a Poisson regression model. Then we see another block describing the inflation model.</p>
<p>Each predictor (<code>bmi_c</code> and <code>smoke100</code>) appears to be statistically significant in each part of the model.</p>
<div id="comparison-to-a-null-model" class="section level3" number="19.13.1">
<h3><span class="header-section-number">19.13.1</span> Comparison to a null model</h3>
<p>To show that this model fits better than the null model (the model with intercept only), we can compare them directly with a chi-squared test. Since we have two predictors in the full model, the degrees of freedom for this test is 2.</p>
<div class="sourceCode" id="cb1152"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1152-1"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1152-1" aria-hidden="true" tabindex="-1"></a>mod_zipnull <span class="ot">&lt;-</span> pscl<span class="sc">::</span><span class="fu">zeroinfl</span>(physhealth <span class="sc">~</span> <span class="dv">1</span>, </span>
<span id="cb1152-2"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1152-2" aria-hidden="true" tabindex="-1"></a>                     <span class="at">data =</span> sm_oh_A_young)</span>
<span id="cb1152-3"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1152-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1152-4"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1152-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod_zipnull)</span></code></pre></div>
<pre><code>
Call:
pscl::zeroinfl(formula = physhealth ~ 1, data = sm_oh_A_young)

Pearson residuals:
    Min      1Q  Median      3Q     Max 
-0.6934 -0.6934 -0.6934 -0.2779  5.5400 

Count model coefficients (poisson with log link):
            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)  2.22764    0.01233   180.7   &lt;2e-16 ***

Zero-inflation model coefficients (binomial with logit link):
            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)   0.5767     0.0469   12.29   &lt;2e-16 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 

Number of iterations in BFGS optimization: 2 
Log-likelihood: -5908 on 2 Df</code></pre>
<div class="sourceCode" id="cb1154"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1154-1"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1154-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pchisq</span>(<span class="dv">2</span> <span class="sc">*</span> (<span class="fu">logLik</span>(mod_zip1) <span class="sc">-</span> <span class="fu">logLik</span>(mod_zipnull)), <span class="at">df =</span> <span class="dv">2</span>, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>&#39;log Lik.&#39; 8.59676e-100 (df=6)</code></pre>
</div>
<div id="comparison-to-a-poisson-model-with-the-vuong-test" class="section level3" number="19.13.2">
<h3><span class="header-section-number">19.13.2</span> Comparison to a Poisson Model with the Vuong test</h3>
<div class="sourceCode" id="cb1156"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1156-1"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1156-1" aria-hidden="true" tabindex="-1"></a><span class="fu">vuong</span>(mod_zip1, mod_poiss1)</span></code></pre></div>
<pre><code>Vuong Non-Nested Hypothesis Test-Statistic: 
(test-statistic is asymptotically distributed N(0,1) under the
 null that the models are indistinguishible)
-------------------------------------------------------------
              Vuong z-statistic             H_A    p-value
Raw                    19.90843 model1 &gt; model2 &lt; 2.22e-16
AIC-corrected          19.89681 model1 &gt; model2 &lt; 2.22e-16
BIC-corrected          19.86434 model1 &gt; model2 &lt; 2.22e-16</code></pre>
<p>Certainly, the ZIP model is a significant improvement over the standard Poisson model, as the Vuong test reveals.</p>
</div>
<div id="the-fitted-equation-3" class="section level3" number="19.13.3">
<h3><span class="header-section-number">19.13.3</span> The Fitted Equation</h3>
<p>The form of the model equation for a zero-inflated Poisson regression requires us to take two separate models into account. First we have a logistic regression model to predict the log odds of zero <code>physhealth</code> days. That takes care of the <em>extra</em> zeros. Then, to predict the number of <code>physhealth</code> days, we have a Poisson model, which may produce some additional zero count estimates.</p>
</div>
<div id="interpreting-the-coefficients-5" class="section level3" number="19.13.4">
<h3><span class="header-section-number">19.13.4</span> Interpreting the Coefficients</h3>
<p>We can exponentiate the logistic regression coefficients to obtain results in terms of odds ratios for that model, and that can be of some help in understanding the process behind excess zeros.</p>
<p>Also, exponentiating the coefficients of the count model help us describe those counts on the original scale of <code>physhealth</code>.</p>
<div class="sourceCode" id="cb1158"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1158-1"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1158-1" aria-hidden="true" tabindex="-1"></a><span class="fu">exp</span>(<span class="fu">coef</span>(mod_zip1))</span></code></pre></div>
<pre><code>count_(Intercept)       count_bmi_c    count_smoke100  zero_(Intercept) 
        7.3713003         1.0183427         1.4819856         1.9786748 
       zero_bmi_c     zero_smoke100 
        0.9726500         0.7888145 </code></pre>
<p>For example,</p>
<ul>
<li>in the model for <code>physhealth</code> = 0, the odds of <code>physhealth</code> = 0 are 79% as high for subjects with <code>smoke100</code> = 1 as for non-smokers with the same BMI.</li>
<li>in the Poisson model for <code>physhealth</code>, the <code>physhealth</code> count is estimated to increase by 1.48 for smokers as compared to non-smokers with the same BMI.</li>
</ul>
</div>
<div id="testing-the-predictors-3" class="section level3" number="19.13.5">
<h3><span class="header-section-number">19.13.5</span> Testing the Predictors</h3>
<p>We can test the model with and without <code>bmi_c</code>, for example, by fitting the model both ways, and comparing the results with either a Wald or Likelihood Ratio test, each of which is available in the <code>lmtest</code> package.</p>
<div class="sourceCode" id="cb1160"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1160-1"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1160-1" aria-hidden="true" tabindex="-1"></a>mod_zip1_nobmi <span class="ot">&lt;-</span> pscl<span class="sc">::</span><span class="fu">zeroinfl</span>(physhealth <span class="sc">~</span> smoke100, </span>
<span id="cb1160-2"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1160-2" aria-hidden="true" tabindex="-1"></a>                     <span class="at">data =</span> sm_oh_A_young)</span>
<span id="cb1160-3"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1160-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1160-4"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1160-4" aria-hidden="true" tabindex="-1"></a>lmtest<span class="sc">::</span><span class="fu">waldtest</span>(mod_zip1, mod_zip1_nobmi)</span></code></pre></div>
<pre><code>Wald test

Model 1: physhealth ~ bmi_c + smoke100
Model 2: physhealth ~ smoke100
  Res.Df Df Chisq Pr(&gt;Chisq)    
1   1968                        
2   1970 -2 187.2  &lt; 2.2e-16 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb1162"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1162-1"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1162-1" aria-hidden="true" tabindex="-1"></a>lmtest<span class="sc">::</span><span class="fu">lrtest</span>(mod_zip1, mod_zip1_nobmi)</span></code></pre></div>
<pre><code>Likelihood ratio test

Model 1: physhealth ~ bmi_c + smoke100
Model 2: physhealth ~ smoke100
  #Df  LogLik Df  Chisq Pr(&gt;Chisq)    
1   6 -5679.8                         
2   4 -5769.5 -2 179.35  &lt; 2.2e-16 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
</div>
<div id="store-fitted-values-and-residuals-5" class="section level3" number="19.13.6">
<h3><span class="header-section-number">19.13.6</span> Store fitted values and residuals</h3>
<p>The <code>broom</code> package does not work with the <code>zeroinfl</code> tool. So we need to build up the fitted values and residuals ourselves.</p>
<div class="sourceCode" id="cb1164"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1164-1"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1164-1" aria-hidden="true" tabindex="-1"></a>sm_zip1 <span class="ot">&lt;-</span> sm_oh_A_young <span class="sc">%&gt;%</span></span>
<span id="cb1164-2"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1164-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">fitted =</span> <span class="fu">fitted</span>(mod_zip1, <span class="at">type =</span> <span class="st">&quot;response&quot;</span>),</span>
<span id="cb1164-3"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1164-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">resid =</span> <span class="fu">resid</span>(mod_zip1, <span class="at">type =</span> <span class="st">&quot;response&quot;</span>))</span>
<span id="cb1164-4"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1164-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1164-5"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1164-5" aria-hidden="true" tabindex="-1"></a>sm_zip1 <span class="sc">%&gt;%</span> </span>
<span id="cb1164-6"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1164-6" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(physhealth, fitted, resid) <span class="sc">%&gt;%</span></span>
<span id="cb1164-7"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1164-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">head</span>()</span></code></pre></div>
<pre><code># A tibble: 6 x 3
  physhealth fitted resid
       &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;
1          0   2.21 -2.21
2          0   2.28 -2.28
3          0   3.12 -3.12
4         30   5.27 24.7 
5          0   3.17 -3.17
6          0   3.71 -3.71</code></pre>
</div>
<div id="modeled-number-of-zero-counts" class="section level3" number="19.13.7">
<h3><span class="header-section-number">19.13.7</span> Modeled Number of Zero Counts</h3>
<p>The zero-inflated model is designed to perfectly match the number of observed zeros. We can compare the observed number of zero <code>physhealth</code> results to the expected number of zero values from the likelihood-based models.</p>
<div class="sourceCode" id="cb1166"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1166-1"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1166-1" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">c</span>(<span class="st">&quot;Obs&quot;</span> <span class="ot">=</span> <span class="fu">sum</span>(sm_oh_A_young<span class="sc">$</span>physhealth <span class="sc">==</span> <span class="dv">0</span>),</span>
<span id="cb1166-2"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1166-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;Poisson&quot;</span> <span class="ot">=</span> <span class="fu">sum</span>(<span class="fu">dpois</span>(<span class="dv">0</span>, <span class="fu">fitted</span>(mod_poiss1))),</span>
<span id="cb1166-3"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1166-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;NB&quot;</span> <span class="ot">=</span> <span class="fu">sum</span>(<span class="fu">dnbinom</span>(<span class="dv">0</span>, <span class="at">mu =</span> <span class="fu">fitted</span>(mod_nb1), <span class="at">size =</span> mod_nb1<span class="sc">$</span>theta)),</span>
<span id="cb1166-4"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1166-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;ZIP&quot;</span> <span class="ot">=</span> <span class="fu">sum</span>(<span class="fu">predict</span>(mod_zip1, <span class="at">type =</span> <span class="st">&quot;prob&quot;</span>)[,<span class="dv">1</span>])), <span class="dv">0</span>)</span></code></pre></div>
<pre><code>    Obs Poisson      NB     ZIP 
   1264     124    1250    1264 </code></pre>
</div>
<div id="rootogram-for-zip-model" class="section level3" number="19.13.8">
<h3><span class="header-section-number">19.13.8</span> Rootogram for ZIP model</h3>
<p>Here’s the rootogram for the zero-inflated Poisson model.</p>
<div class="sourceCode" id="cb1168"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1168-1"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1168-1" aria-hidden="true" tabindex="-1"></a>countreg<span class="sc">::</span><span class="fu">rootogram</span>(mod_zip1, <span class="at">max =</span> <span class="dv">30</span>)</span></code></pre></div>
<p><img src="432-notes_files/figure-html/unnamed-chunk-472-1.png" width="672" /></p>
<p>The zero frequencies are perfectly matched here, but we can see that counts of 1 and 2 are now substantially underfit, and values between 6 and 13 are overfit.</p>
</div>
<div id="specify-the-r2-and-log-likelihood-values" class="section level3" number="19.13.9">
<h3><span class="header-section-number">19.13.9</span> Specify the R<sup>2</sup> and log (likelihood) values</h3>
<p>We can calculate a proxy for R<sup>2</sup> as the squared correlation of the fitted values and the observed values.</p>
<div class="sourceCode" id="cb1169"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1169-1"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1169-1" aria-hidden="true" tabindex="-1"></a><span class="co"># The correlation of observed and fitted values</span></span>
<span id="cb1169-2"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1169-2" aria-hidden="true" tabindex="-1"></a>(zip_r <span class="ot">&lt;-</span> <span class="fu">with</span>(sm_zip1, <span class="fu">cor</span>(physhealth, fitted)))</span></code></pre></div>
<pre><code>[1] 0.187328</code></pre>
<div class="sourceCode" id="cb1171"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1171-1"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1171-1" aria-hidden="true" tabindex="-1"></a><span class="co"># R-square</span></span>
<span id="cb1171-2"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1171-2" aria-hidden="true" tabindex="-1"></a>zip_r<span class="sc">^</span><span class="dv">2</span></span></code></pre></div>
<pre><code>[1] 0.03509178</code></pre>
<div class="sourceCode" id="cb1173"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1173-1"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1173-1" aria-hidden="true" tabindex="-1"></a><span class="fu">logLik</span>(mod_zip1)</span></code></pre></div>
<pre><code>&#39;log Lik.&#39; -5679.794 (df=6)</code></pre>
<p>Here, we have</p>
<table>
<thead>
<tr class="header">
<th align="right">Model</th>
<th align="right">Scale</th>
<th align="right">R<sup>2</sup></th>
<th align="right">log(likelihood)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">Zero-Inflated Poisson</td>
<td align="right">Complex: log(<code>physhealth</code>)</td>
<td align="right">.035</td>
<td align="right">-5679.83</td>
</tr>
</tbody>
</table>
</div>
<div id="check-model-assumptions-5" class="section level3" number="19.13.10">
<h3><span class="header-section-number">19.13.10</span> Check model assumptions</h3>
<p>Here is a plot of residuals vs. fitted values on the original <code>physhealth</code> scale.</p>
<div class="sourceCode" id="cb1175"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1175-1"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1175-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(sm_zip1, <span class="fu">aes</span>(<span class="at">x =</span> fitted, <span class="at">y =</span> resid)) <span class="sc">+</span></span>
<span id="cb1175-2"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1175-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb1175-3"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1175-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Residuals vs. Fitted `physhealth`&quot;</span>,</span>
<span id="cb1175-4"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1175-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">subtitle =</span> <span class="st">&quot;Zero-Inflated Poisson Regression model&quot;</span>)</span></code></pre></div>
<p><img src="432-notes_files/figure-html/unnamed-chunk-475-1.png" width="672" /></p>
</div>
<div id="predictions-for-harry-and-sally-5" class="section level3" number="19.13.11">
<h3><span class="header-section-number">19.13.11</span> Predictions for Harry and Sally</h3>
<p>The predictions from this ZIP regression model are obtained as follows…</p>
<div class="sourceCode" id="cb1176"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1176-1"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1176-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(mod_zip1, <span class="at">newdata =</span> hs_data, <span class="at">type =</span> <span class="st">&quot;response&quot;</span>)</span></code></pre></div>
<pre><code>       1        2 
6.002212 2.056525 </code></pre>
<p>As we’ve seen in the past, when we use <code>response</code> as the type, the predictions fall on the original <code>physhealth</code> scale. The prediction for Harry is 6.0 days, and for Sally is 2.1 days.</p>
</div>
</div>
<div id="the-zero-inflated-negative-binomial-regression-model" class="section level2" number="19.14">
<h2><span class="header-section-number">19.14</span> The Zero-Inflated Negative Binomial Regression Model</h2>
<p>As an alternative to the ZIP model, we might consider a zero-inflated negative binomial regression<a href="#fn16" class="footnote-ref" id="fnref16"><sup>16</sup></a>. This will involve a logistic regression to predict the probability of a 0, and then a negative binomial model to describe the counts of <code>physhealth</code>.</p>
<p>To run the zero-inflated negative binomial model, we use the following code:</p>
<div class="sourceCode" id="cb1178"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1178-1"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1178-1" aria-hidden="true" tabindex="-1"></a>mod_zinb1 <span class="ot">&lt;-</span> pscl<span class="sc">::</span><span class="fu">zeroinfl</span>(physhealth <span class="sc">~</span> bmi_c <span class="sc">+</span> smoke100, </span>
<span id="cb1178-2"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1178-2" aria-hidden="true" tabindex="-1"></a>                      <span class="at">dist =</span> <span class="st">&quot;negbin&quot;</span>, <span class="at">data =</span> sm_oh_A_young)</span>
<span id="cb1178-3"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1178-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1178-4"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1178-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod_zinb1)</span></code></pre></div>
<pre><code>
Call:
pscl::zeroinfl(formula = physhealth ~ bmi_c + smoke100, data = sm_oh_A_young, 
    dist = &quot;negbin&quot;)

Pearson residuals:
    Min      1Q  Median      3Q     Max 
-0.5579 -0.4192 -0.3957 -0.1166  6.4358 

Count model coefficients (negbin with log link):
             Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)  1.545599   0.099781  15.490  &lt; 2e-16 ***
bmi_c        0.024614   0.006641   3.707  0.00021 ***
smoke100     0.517559   0.110772   4.672 2.98e-06 ***
Log(theta)  -0.874034   0.143876  -6.075 1.24e-09 ***

Zero-inflation model coefficients (binomial with logit link):
             Estimate Std. Error z value Pr(&gt;|z|)   
(Intercept) -0.071629   0.164039  -0.437  0.66236   
bmi_c       -0.027607   0.009313  -2.964  0.00303 **
smoke100    -0.127004   0.137171  -0.926  0.35451   
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 

Theta = 0.4173 
Number of iterations in BFGS optimization: 14 
Log-likelihood: -3469 on 7 Df</code></pre>
<div class="sourceCode" id="cb1180"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1180-1"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1180-1" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(mod_zinb1)</span></code></pre></div>
<pre><code>                        2.5 %       97.5 %
count_(Intercept)  1.35003234  1.741165036
count_bmi_c        0.01159892  0.037629890
count_smoke100     0.30045008  0.734668671
zero_(Intercept)  -0.39313901  0.249880357
zero_bmi_c        -0.04585974 -0.009354261
zero_smoke100     -0.39585468  0.141845790</code></pre>
<div id="comparison-to-a-null-model-1" class="section level3" number="19.14.1">
<h3><span class="header-section-number">19.14.1</span> Comparison to a null model</h3>
<p>To show that this model fits better than the null model (the model with intercept only), we can compare them directly with a chi-squared test. Since we have two predictors in the full model, the degrees of freedom for this test is 2.</p>
<div class="sourceCode" id="cb1182"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1182-1"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1182-1" aria-hidden="true" tabindex="-1"></a>mod_zinbnull <span class="ot">&lt;-</span> pscl<span class="sc">::</span><span class="fu">zeroinfl</span>(physhealth <span class="sc">~</span> <span class="dv">1</span>, <span class="at">dist =</span> <span class="st">&quot;negbin&quot;</span>,</span>
<span id="cb1182-2"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1182-2" aria-hidden="true" tabindex="-1"></a>                     <span class="at">data =</span> sm_oh_A_young)</span>
<span id="cb1182-3"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1182-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1182-4"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1182-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod_zinbnull)</span></code></pre></div>
<pre><code>
Call:
pscl::zeroinfl(formula = physhealth ~ 1, data = sm_oh_A_young, dist = &quot;negbin&quot;)

Pearson residuals:
    Min      1Q  Median      3Q     Max 
-0.4048 -0.4048 -0.4048 -0.1622  3.2340 

Count model coefficients (negbin with log link):
            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)   1.7766     0.0964  18.429  &lt; 2e-16 ***
Log(theta)   -1.0445     0.1612  -6.479 9.25e-11 ***

Zero-inflation model coefficients (binomial with logit link):
            Estimate Std. Error z value Pr(&gt;|z|)
(Intercept)  -0.2605     0.1920  -1.357    0.175
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 

Theta = 0.3519 
Number of iterations in BFGS optimization: 12 
Log-likelihood: -3498 on 3 Df</code></pre>
<div class="sourceCode" id="cb1184"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1184-1"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1184-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pchisq</span>(<span class="dv">2</span> <span class="sc">*</span> (<span class="fu">logLik</span>(mod_nb1) <span class="sc">-</span> <span class="fu">logLik</span>(mod_zinbnull)), <span class="at">df =</span> <span class="dv">2</span>, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>&#39;log Lik.&#39; 8.538917e-07 (df=4)</code></pre>
</div>
<div id="comparison-to-a-negative-binomial-model-vuong-test" class="section level3" number="19.14.2">
<h3><span class="header-section-number">19.14.2</span> Comparison to a Negative Binomial Model: Vuong test</h3>
<div class="sourceCode" id="cb1186"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1186-1"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1186-1" aria-hidden="true" tabindex="-1"></a><span class="fu">vuong</span>(mod_zinb1, mod_nb1)</span></code></pre></div>
<pre><code>Vuong Non-Nested Hypothesis Test-Statistic: 
(test-statistic is asymptotically distributed N(0,1) under the
 null that the models are indistinguishible)
-------------------------------------------------------------
              Vuong z-statistic             H_A   p-value
Raw                   3.0753499 model1 &gt; model2 0.0010513
AIC-corrected         2.4597116 model1 &gt; model2 0.0069524
BIC-corrected         0.7396743 model1 &gt; model2 0.2297488</code></pre>
<p>The zero-inflated negative binomial model is a significant improvement over the standard negative binomial model according to the the raw or AIC-corrected Vuong tests, but not according to the BIC-corrected test.</p>
</div>
<div id="the-fitted-equation-4" class="section level3" number="19.14.3">
<h3><span class="header-section-number">19.14.3</span> The Fitted Equation</h3>
<p>Like the ZIP, the zero-inflated negative binomial regression also requires us to take two separate models into account. First we have a logistic regression model to predict the log odds of zero <code>physhealth</code> days. That takes care of the <em>extra</em> zeros. Then, to predict the number of <code>physhealth</code> days, we have a negative binomial regression, with a <span class="math inline">\(\theta\)</span> term, and this negative binomial regression model may also produce some additional zero count estimates.</p>
</div>
<div id="interpreting-the-coefficients-6" class="section level3" number="19.14.4">
<h3><span class="header-section-number">19.14.4</span> Interpreting the Coefficients</h3>
<p>As with the zip, we can exponentiate the logistic regression coefficients to obtain results in terms of odds ratios for that model, and that can be of some help in understanding the process behind excess zeros.</p>
<div class="sourceCode" id="cb1188"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1188-1"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1188-1" aria-hidden="true" tabindex="-1"></a><span class="fu">exp</span>(<span class="fu">coef</span>(mod_zinb1))</span></code></pre></div>
<pre><code>count_(Intercept)       count_bmi_c    count_smoke100  zero_(Intercept) 
        4.6907791         1.0249198         1.6779275         0.9308759 
       zero_bmi_c     zero_smoke100 
        0.9727706         0.8807298 </code></pre>
<p>For example,</p>
<ul>
<li>in the model for <code>physhealth</code> = 0, the odds of <code>physhealth</code> = 0 are 88.1% as high for subjects with <code>smoke100</code> = 1 as for non-smokers with the same BMI.</li>
</ul>
<p>Interpreting the negative binomial piece works the same way as it did in the negative binomial regression.</p>
</div>
<div id="testing-the-predictors-4" class="section level3" number="19.14.5">
<h3><span class="header-section-number">19.14.5</span> Testing the Predictors</h3>
<p>We can test the model with and without <code>bmi_c</code>, for example, by fitting the model both ways, and comparing the results with either a Wald or Likelihood Ratio test, each of which is available in the <code>lmtest</code> package.</p>
<div class="sourceCode" id="cb1190"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1190-1"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1190-1" aria-hidden="true" tabindex="-1"></a>mod_zinb1_nobmi <span class="ot">&lt;-</span> pscl<span class="sc">::</span><span class="fu">zeroinfl</span>(physhealth <span class="sc">~</span> smoke100, </span>
<span id="cb1190-2"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1190-2" aria-hidden="true" tabindex="-1"></a>                            <span class="at">dist =</span> <span class="st">&quot;negbin&quot;</span>,</span>
<span id="cb1190-3"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1190-3" aria-hidden="true" tabindex="-1"></a>                            <span class="at">data =</span> sm_oh_A_young)</span>
<span id="cb1190-4"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1190-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1190-5"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1190-5" aria-hidden="true" tabindex="-1"></a>lmtest<span class="sc">::</span><span class="fu">waldtest</span>(mod_zinb1, mod_zinb1_nobmi)</span></code></pre></div>
<pre><code>Wald test

Model 1: physhealth ~ bmi_c + smoke100
Model 2: physhealth ~ smoke100
  Res.Df Df  Chisq Pr(&gt;Chisq)    
1   1967                         
2   1969 -2 29.589  3.757e-07 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb1192"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1192-1"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1192-1" aria-hidden="true" tabindex="-1"></a>lmtest<span class="sc">::</span><span class="fu">lrtest</span>(mod_zinb1, mod_zinb1_nobmi)</span></code></pre></div>
<pre><code>Likelihood ratio test

Model 1: physhealth ~ bmi_c + smoke100
Model 2: physhealth ~ smoke100
  #Df  LogLik Df  Chisq Pr(&gt;Chisq)    
1   7 -3469.3                         
2   5 -3485.0 -2 31.418  1.506e-07 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
</div>
<div id="store-fitted-values-and-residuals-6" class="section level3" number="19.14.6">
<h3><span class="header-section-number">19.14.6</span> Store fitted values and residuals</h3>
<p>Again, we need to build up the fitted values and residuals without the <code>broom</code> package.</p>
<div class="sourceCode" id="cb1194"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1194-1"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1194-1" aria-hidden="true" tabindex="-1"></a>sm_zinb1 <span class="ot">&lt;-</span> sm_oh_A_young <span class="sc">%&gt;%</span></span>
<span id="cb1194-2"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1194-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">fitted =</span> <span class="fu">fitted</span>(mod_zinb1, <span class="at">type =</span> <span class="st">&quot;response&quot;</span>),</span>
<span id="cb1194-3"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1194-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">resid =</span> <span class="fu">resid</span>(mod_zinb1, <span class="at">type =</span> <span class="st">&quot;response&quot;</span>))</span>
<span id="cb1194-4"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1194-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1194-5"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1194-5" aria-hidden="true" tabindex="-1"></a>sm_zip1 <span class="sc">%&gt;%</span> </span>
<span id="cb1194-6"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1194-6" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(physhealth, fitted, resid) <span class="sc">%&gt;%</span></span>
<span id="cb1194-7"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1194-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">head</span>()</span></code></pre></div>
<pre><code># A tibble: 6 x 3
  physhealth fitted resid
       &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;
1          0   2.21 -2.21
2          0   2.28 -2.28
3          0   3.12 -3.12
4         30   5.27 24.7 
5          0   3.17 -3.17
6          0   3.71 -3.71</code></pre>
</div>
<div id="modeled-number-of-zero-counts-1" class="section level3" number="19.14.7">
<h3><span class="header-section-number">19.14.7</span> Modeled Number of Zero Counts</h3>
<p>Once again, we can compare the observed number of zero <code>physhealth</code> results to the expected number of zero values from the likelihood-based models.</p>
<div class="sourceCode" id="cb1196"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1196-1"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1196-1" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">c</span>(<span class="st">&quot;Obs&quot;</span> <span class="ot">=</span> <span class="fu">sum</span>(sm_oh_A_young<span class="sc">$</span>physhealth <span class="sc">==</span> <span class="dv">0</span>),</span>
<span id="cb1196-2"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1196-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;Poisson&quot;</span> <span class="ot">=</span> <span class="fu">sum</span>(<span class="fu">dpois</span>(<span class="dv">0</span>, <span class="fu">fitted</span>(mod_poiss1))),</span>
<span id="cb1196-3"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1196-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;NB&quot;</span> <span class="ot">=</span> <span class="fu">sum</span>(<span class="fu">dnbinom</span>(<span class="dv">0</span>, <span class="at">mu =</span> <span class="fu">fitted</span>(mod_nb1), <span class="at">size =</span> mod_nb1<span class="sc">$</span>theta)),</span>
<span id="cb1196-4"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1196-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;ZIP&quot;</span> <span class="ot">=</span> <span class="fu">sum</span>(<span class="fu">predict</span>(mod_zip1, <span class="at">type =</span> <span class="st">&quot;prob&quot;</span>)[,<span class="dv">1</span>]),</span>
<span id="cb1196-5"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1196-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;ZINB&quot;</span> <span class="ot">=</span> <span class="fu">sum</span>(<span class="fu">predict</span>(mod_zinb1, <span class="at">type =</span> <span class="st">&quot;prob&quot;</span>)[,<span class="dv">1</span>])),<span class="dv">0</span>)</span></code></pre></div>
<pre><code>    Obs Poisson      NB     ZIP    ZINB 
   1264     124    1250    1264    1264 </code></pre>
<p>So, the Poisson model is clearly inappropriate, but the zero-inflated (Poisson and NB) and the negative binomial model all give reasonable fits in this regard.</p>
</div>
<div id="rootogram-for-zero-inflated-negative-binomial-model" class="section level3" number="19.14.8">
<h3><span class="header-section-number">19.14.8</span> Rootogram for Zero-Inflated Negative Binomial model</h3>
<p>Here’s the rootogram for the zero-inflated negative binomial model.</p>
<div class="sourceCode" id="cb1198"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1198-1"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1198-1" aria-hidden="true" tabindex="-1"></a>countreg<span class="sc">::</span><span class="fu">rootogram</span>(mod_zinb1, <span class="at">max =</span> <span class="dv">30</span>)</span></code></pre></div>
<p><img src="432-notes_files/figure-html/unnamed-chunk-485-1.png" width="672" /></p>
<p>As in the ZIP model, the zero frequencies are perfectly matched here, but we can see that counts of 1 and 2 are now closer to the data we observe than in the ZIP model. We are still substantially underfitting values of 30.</p>
</div>
<div id="specify-the-r2-and-log-likelihood-values-1" class="section level3" number="19.14.9">
<h3><span class="header-section-number">19.14.9</span> Specify the R<sup>2</sup> and log (likelihood) values</h3>
<p>We can calculate a proxy for R<sup>2</sup> as the squared correlation of the fitted values and the observed values.</p>
<div class="sourceCode" id="cb1199"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1199-1"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1199-1" aria-hidden="true" tabindex="-1"></a><span class="co"># The correlation of observed and fitted values</span></span>
<span id="cb1199-2"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1199-2" aria-hidden="true" tabindex="-1"></a>(zinb_r <span class="ot">&lt;-</span> <span class="fu">with</span>(sm_zinb1, <span class="fu">cor</span>(physhealth, fitted)))</span></code></pre></div>
<pre><code>[1] 0.1858969</code></pre>
<div class="sourceCode" id="cb1201"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1201-1"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1201-1" aria-hidden="true" tabindex="-1"></a><span class="co"># R-square</span></span>
<span id="cb1201-2"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1201-2" aria-hidden="true" tabindex="-1"></a>zinb_r<span class="sc">^</span><span class="dv">2</span></span></code></pre></div>
<pre><code>[1] 0.03455767</code></pre>
<div class="sourceCode" id="cb1203"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1203-1"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1203-1" aria-hidden="true" tabindex="-1"></a><span class="fu">logLik</span>(mod_zinb1)</span></code></pre></div>
<pre><code>&#39;log Lik.&#39; -3469.29 (df=7)</code></pre>
<p>Here, we have</p>
<table>
<thead>
<tr class="header">
<th align="right">Model</th>
<th align="right">Scale</th>
<th align="right">R<sup>2</sup></th>
<th align="right">log(likelihood)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">Zero-Inflated Negative Binomial</td>
<td align="right">Complex: log(<code>physhealth</code>)</td>
<td align="right">.035</td>
<td align="right">-3469.27</td>
</tr>
</tbody>
</table>
</div>
<div id="check-model-assumptions-6" class="section level3" number="19.14.10">
<h3><span class="header-section-number">19.14.10</span> Check model assumptions</h3>
<p>Here is a plot of residuals vs. fitted values on the original <code>physhealth</code> scale.</p>
<div class="sourceCode" id="cb1205"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1205-1"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1205-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(sm_zinb1, <span class="fu">aes</span>(<span class="at">x =</span> fitted, <span class="at">y =</span> resid)) <span class="sc">+</span></span>
<span id="cb1205-2"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1205-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb1205-3"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1205-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Residuals vs. Fitted `physhealth`&quot;</span>,</span>
<span id="cb1205-4"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1205-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">subtitle =</span> <span class="st">&quot;Zero-Inflated Negative Binomial Regression model&quot;</span>)</span></code></pre></div>
<p><img src="432-notes_files/figure-html/unnamed-chunk-488-1.png" width="672" /></p>
</div>
<div id="predictions-for-harry-and-sally-6" class="section level3" number="19.14.11">
<h3><span class="header-section-number">19.14.11</span> Predictions for Harry and Sally</h3>
<p>The predictions from this zero-inflated negative binomial regression model are obtained as follows…</p>
<div class="sourceCode" id="cb1206"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1206-1"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1206-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(mod_zinb1, <span class="at">newdata =</span> hs_data, <span class="at">type =</span> <span class="st">&quot;response&quot;</span>)</span></code></pre></div>
<pre><code>       1        2 
6.206514 2.004963 </code></pre>
<p>As we’ve seen in the past, when we use <code>response</code> as the type, the predictions fall on the original <code>physhealth</code> scale. The prediction for Harry is 6.2 days, and for Sally is 2.0 days.</p>
</div>
</div>
<div id="a-hurdle-model-with-poisson" class="section level2" number="19.15">
<h2><span class="header-section-number">19.15</span> A “hurdle” model (with Poisson)</h2>
<p>Much of the discussion here of hurdle models comes from Clay Ford at the University of Virginia<a href="#fn17" class="footnote-ref" id="fnref17"><sup>17</sup></a>. Ford describes a hurdle model as follows:</p>
<blockquote>
<p>The hurdle model is a two-part model that specifies one process for zero counts and another process for positive counts. The idea is that positive counts occur once a threshold is crossed, or put another way, a hurdle is cleared. If the hurdle is not cleared, then we have a count of 0.</p>
</blockquote>
<blockquote>
<p>The first part of the model is typically a binary logit model. This models whether an observation takes a positive count or not. The second part of the model is usually a truncated Poisson or Negative Binomial model. Truncated means we’re only fitting positive counts. If we were to fit a hurdle model to our [medicare] data, the interpretation would be that one process governs whether a patient visits a doctor or not, and another process governs how many visits are made.</p>
</blockquote>
<p>To fit a hurdle model, we’ll use the <code>hurdle</code> function in the <code>pscl</code> package.</p>
<div class="sourceCode" id="cb1208"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1208-1"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1208-1" aria-hidden="true" tabindex="-1"></a>mod_hur1 <span class="ot">&lt;-</span> pscl<span class="sc">::</span><span class="fu">hurdle</span>(physhealth <span class="sc">~</span> bmi_c <span class="sc">+</span> smoke100,</span>
<span id="cb1208-2"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1208-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">dist =</span> <span class="st">&quot;poisson&quot;</span>, <span class="at">zero.dist =</span> <span class="st">&quot;binomial&quot;</span>,</span>
<span id="cb1208-3"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1208-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">data =</span> sm_oh_A_young)</span>
<span id="cb1208-4"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1208-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1208-5"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1208-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod_hur1)</span></code></pre></div>
<pre><code>
Call:
pscl::hurdle(formula = physhealth ~ bmi_c + smoke100, data = sm_oh_A_young, 
    dist = &quot;poisson&quot;, zero.dist = &quot;binomial&quot;)

Pearson residuals:
    Min      1Q  Median      3Q     Max 
-1.4403 -0.6987 -0.6139 -0.1946  9.2997 

Count model coefficients (truncated poisson with log link):
            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept) 1.997612   0.018797   106.3   &lt;2e-16 ***
bmi_c       0.018178   0.001398    13.0   &lt;2e-16 ***
smoke100    0.393348   0.024889    15.8   &lt;2e-16 ***
Zero hurdle model coefficients (binomial with logit link):
             Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept) -0.683509   0.062827 -10.879  &lt; 2e-16 ***
bmi_c        0.027777   0.006508   4.268 1.97e-05 ***
smoke100     0.238300   0.095301   2.500   0.0124 *  
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 

Number of iterations in BFGS optimization: 14 
Log-likelihood: -5680 on 6 Df</code></pre>
<div class="sourceCode" id="cb1210"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1210-1"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1210-1" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(mod_hur1)</span></code></pre></div>
<pre><code>                        2.5 %      97.5 %
count_(Intercept)  1.96077105  2.03445261
count_bmi_c        0.01543722  0.02091901
count_smoke100     0.34456599  0.44212932
zero_(Intercept)  -0.80664805 -0.56037031
zero_bmi_c         0.01502124  0.04053230
zero_smoke100      0.05151314  0.42508607</code></pre>
<p>We are using the default settings here, using the same predictors for both models:</p>
<ul>
<li>a <strong>Binomial</strong> model to predict the probability of <code>physhealth</code> = 0 given our predictors, as specified by the <code>zero.dist</code> argument in the <code>hurdle</code> function, and</li>
<li>a (truncated) <strong>Poisson</strong> model to predict the positive-count of <code>physhealth</code> given those same predictors, as specified by the <code>dist</code> argument in the <code>hurdle</code> function.</li>
</ul>
<div id="comparison-to-a-null-model-2" class="section level3" number="19.15.1">
<h3><span class="header-section-number">19.15.1</span> Comparison to a null model</h3>
<p>To show that this model fits better than the null model (the model with intercept only), we can compare them directly with a chi-squared test. Since we have two predictors in the full model, the degrees of freedom for this test is 2.</p>
<div class="sourceCode" id="cb1212"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1212-1"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1212-1" aria-hidden="true" tabindex="-1"></a>mod_hurnull <span class="ot">&lt;-</span> pscl<span class="sc">::</span><span class="fu">hurdle</span>(physhealth <span class="sc">~</span> <span class="dv">1</span>, <span class="at">dist =</span> <span class="st">&quot;poisson&quot;</span>, </span>
<span id="cb1212-2"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1212-2" aria-hidden="true" tabindex="-1"></a>                      <span class="at">zero.dist =</span> <span class="st">&quot;binomial&quot;</span>, </span>
<span id="cb1212-3"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1212-3" aria-hidden="true" tabindex="-1"></a>                      <span class="at">data =</span> sm_oh_A_young)</span>
<span id="cb1212-4"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1212-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1212-5"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1212-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod_hurnull)</span></code></pre></div>
<pre><code>
Call:
pscl::hurdle(formula = physhealth ~ 1, data = sm_oh_A_young, dist = &quot;poisson&quot;, 
    zero.dist = &quot;binomial&quot;)

Pearson residuals:
    Min      1Q  Median      3Q     Max 
-0.6934 -0.6934 -0.6934 -0.2779  5.5399 

Count model coefficients (truncated poisson with log link):
            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)  2.22765    0.01233   180.7   &lt;2e-16 ***
Zero hurdle model coefficients (binomial with logit link):
            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)  -0.5768     0.0469   -12.3   &lt;2e-16 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 

Number of iterations in BFGS optimization: 8 
Log-likelihood: -5908 on 2 Df</code></pre>
<div class="sourceCode" id="cb1214"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1214-1"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1214-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pchisq</span>(<span class="dv">2</span> <span class="sc">*</span> (<span class="fu">logLik</span>(mod_hur1) <span class="sc">-</span> <span class="fu">logLik</span>(mod_hurnull)), <span class="at">df =</span> <span class="dv">2</span>, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>&#39;log Lik.&#39; 8.577393e-100 (df=6)</code></pre>
</div>
<div id="comparison-to-a-poisson-model-vuong-test" class="section level3" number="19.15.2">
<h3><span class="header-section-number">19.15.2</span> Comparison to a Poisson Model: Vuong test</h3>
<div class="sourceCode" id="cb1216"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1216-1"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1216-1" aria-hidden="true" tabindex="-1"></a><span class="fu">vuong</span>(mod_hur1, mod_poiss1)</span></code></pre></div>
<pre><code>Vuong Non-Nested Hypothesis Test-Statistic: 
(test-statistic is asymptotically distributed N(0,1) under the
 null that the models are indistinguishible)
-------------------------------------------------------------
              Vuong z-statistic             H_A    p-value
Raw                    19.90847 model1 &gt; model2 &lt; 2.22e-16
AIC-corrected          19.89685 model1 &gt; model2 &lt; 2.22e-16
BIC-corrected          19.86438 model1 &gt; model2 &lt; 2.22e-16</code></pre>
<p>The hurdle model shows a detectable improvement over the standard Poisson model according to this test.</p>
</div>
<div id="comparison-to-a-zero-inflated-poisson-model-vuong-test" class="section level3" number="19.15.3">
<h3><span class="header-section-number">19.15.3</span> Comparison to a Zero-Inflated Poisson Model: Vuong test</h3>
<p>Is the hurdle model comparable to the zero-inflated Poisson?</p>
<div class="sourceCode" id="cb1218"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1218-1"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1218-1" aria-hidden="true" tabindex="-1"></a><span class="fu">vuong</span>(mod_hur1, mod_zip1)</span></code></pre></div>
<pre><code>Vuong Non-Nested Hypothesis Test-Statistic: 
(test-statistic is asymptotically distributed N(0,1) under the
 null that the models are indistinguishible)
-------------------------------------------------------------
              Vuong z-statistic             H_A p-value
Raw                   0.2046181 model1 &gt; model2 0.41894
AIC-corrected         0.2046181 model1 &gt; model2 0.41894
BIC-corrected         0.2046181 model1 &gt; model2 0.41894</code></pre>
<p>The hurdle model doesn’t show a detecatble improvement over the zero-inflated Poisson model according to this test.</p>
</div>
<div id="the-fitted-equation-5" class="section level3" number="19.15.4">
<h3><span class="header-section-number">19.15.4</span> The Fitted Equation</h3>
<p>The form of the model equation for this hurdle also requires us to take two separate models into account. First we have a logistic regression model to predict the log odds of zero <code>physhealth</code> days. That takes care of the zeros. Then, to predict the number of <code>physhealth</code> days, we use a truncated Poisson model, which is truncated to produce only estimates greater than zero.</p>
</div>
<div id="interpreting-the-coefficients-7" class="section level3" number="19.15.5">
<h3><span class="header-section-number">19.15.5</span> Interpreting the Coefficients</h3>
<p>We can exponentiate the logistic regression coefficients to obtain results in terms of odds ratios for that model, and that can be of some help in understanding the process behind excess zeros.</p>
<p>Also, exponentiating the coefficients of the count model help us describe those counts on the original scale of <code>physhealth</code>.</p>
<div class="sourceCode" id="cb1220"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1220-1"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1220-1" aria-hidden="true" tabindex="-1"></a><span class="fu">exp</span>(<span class="fu">coef</span>(mod_hur1))</span></code></pre></div>
<pre><code>count_(Intercept)       count_bmi_c    count_smoke100  zero_(Intercept) 
        7.3714308         1.0183443         1.4819335         0.5048423 
       zero_bmi_c     zero_smoke100 
        1.0281661         1.2690894 </code></pre>
<p>For example,</p>
<ul>
<li>in the model for <code>physhealth</code> = 0, the odds of <code>physhealth</code> = 0 are 127% as high for subjects with <code>smoke100</code> = 1 as for non-smokers with the same BMI.</li>
<li>in the Poisson model for <code>physhealth</code>, the <code>physhealth</code> count is estimated to increase by 1.48 for smokers as compared to non-smokers with the same BMI.</li>
</ul>
</div>
<div id="testing-the-predictors-5" class="section level3" number="19.15.6">
<h3><span class="header-section-number">19.15.6</span> Testing the Predictors</h3>
<p>We can test the model with and without <code>bmi_c</code>, for example, by fitting the model both ways, and comparing the results with either a Wald or Likelihood Ratio test, each of which is available in the <code>lmtest</code> package.</p>
<div class="sourceCode" id="cb1222"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1222-1"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1222-1" aria-hidden="true" tabindex="-1"></a>mod_hur1_nobmi <span class="ot">&lt;-</span> pscl<span class="sc">::</span><span class="fu">hurdle</span>(physhealth <span class="sc">~</span> smoke100,</span>
<span id="cb1222-2"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1222-2" aria-hidden="true" tabindex="-1"></a>                         <span class="at">dist =</span> <span class="st">&quot;poisson&quot;</span>, </span>
<span id="cb1222-3"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1222-3" aria-hidden="true" tabindex="-1"></a>                         <span class="at">zero.dist =</span> <span class="st">&quot;binomial&quot;</span>,</span>
<span id="cb1222-4"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1222-4" aria-hidden="true" tabindex="-1"></a>                         <span class="at">data =</span> sm_oh_A_young)</span>
<span id="cb1222-5"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1222-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1222-6"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1222-6" aria-hidden="true" tabindex="-1"></a>lmtest<span class="sc">::</span><span class="fu">waldtest</span>(mod_hur1, mod_hur1_nobmi)</span></code></pre></div>
<pre><code>Wald test

Model 1: physhealth ~ bmi_c + smoke100
Model 2: physhealth ~ smoke100
  Res.Df Df  Chisq Pr(&gt;Chisq)    
1   1968                         
2   1970 -2 187.19  &lt; 2.2e-16 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb1224"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1224-1"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1224-1" aria-hidden="true" tabindex="-1"></a>lmtest<span class="sc">::</span><span class="fu">lrtest</span>(mod_hur1, mod_hur1_nobmi)</span></code></pre></div>
<pre><code>Likelihood ratio test

Model 1: physhealth ~ bmi_c + smoke100
Model 2: physhealth ~ smoke100
  #Df  LogLik Df  Chisq Pr(&gt;Chisq)    
1   6 -5679.8                         
2   4 -5769.5 -2 179.35  &lt; 2.2e-16 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
</div>
<div id="store-fitted-values-and-residuals-7" class="section level3" number="19.15.7">
<h3><span class="header-section-number">19.15.7</span> Store fitted values and residuals</h3>
<p>The <code>broom</code> package does not work with the <code>hurdle</code> class of models. Again we need to build up the fitted values and residuals ourselves.</p>
<div class="sourceCode" id="cb1226"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1226-1"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1226-1" aria-hidden="true" tabindex="-1"></a>sm_hur1 <span class="ot">&lt;-</span> sm_oh_A_young <span class="sc">%&gt;%</span></span>
<span id="cb1226-2"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1226-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">fitted =</span> <span class="fu">fitted</span>(mod_hur1, <span class="at">type =</span> <span class="st">&quot;response&quot;</span>),</span>
<span id="cb1226-3"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1226-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">resid =</span> <span class="fu">resid</span>(mod_hur1, <span class="at">type =</span> <span class="st">&quot;response&quot;</span>))</span>
<span id="cb1226-4"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1226-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1226-5"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1226-5" aria-hidden="true" tabindex="-1"></a>sm_hur1 <span class="sc">%&gt;%</span> </span>
<span id="cb1226-6"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1226-6" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(physhealth, fitted, resid) <span class="sc">%&gt;%</span></span>
<span id="cb1226-7"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1226-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">head</span>()</span></code></pre></div>
<pre><code># A tibble: 6 x 3
  physhealth fitted resid
       &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;
1          0   2.21 -2.21
2          0   2.28 -2.28
3          0   3.12 -3.12
4         30   5.27 24.7 
5          0   3.17 -3.17
6          0   3.71 -3.71</code></pre>
</div>
<div id="modeled-number-of-zero-counts-2" class="section level3" number="19.15.8">
<h3><span class="header-section-number">19.15.8</span> Modeled Number of Zero Counts</h3>
<p>Once again, we can compare the observed number of zero <code>physhealth</code> results to the expected number of zero values from the likelihood-based models.</p>
<div class="sourceCode" id="cb1228"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1228-1"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1228-1" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">c</span>(<span class="st">&quot;Obs&quot;</span> <span class="ot">=</span> <span class="fu">sum</span>(sm_oh_A_young<span class="sc">$</span>physhealth <span class="sc">==</span> <span class="dv">0</span>),</span>
<span id="cb1228-2"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1228-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;Poisson&quot;</span> <span class="ot">=</span> <span class="fu">sum</span>(<span class="fu">dpois</span>(<span class="dv">0</span>, <span class="fu">fitted</span>(mod_poiss1))),</span>
<span id="cb1228-3"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1228-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;NB&quot;</span> <span class="ot">=</span> <span class="fu">sum</span>(<span class="fu">dnbinom</span>(<span class="dv">0</span>, <span class="at">mu =</span> <span class="fu">fitted</span>(mod_nb1), <span class="at">size =</span> mod_nb1<span class="sc">$</span>theta)),</span>
<span id="cb1228-4"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1228-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;ZIP&quot;</span> <span class="ot">=</span> <span class="fu">sum</span>(<span class="fu">predict</span>(mod_zip1, <span class="at">type =</span> <span class="st">&quot;prob&quot;</span>)[,<span class="dv">1</span>]),</span>
<span id="cb1228-5"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1228-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;ZINB&quot;</span> <span class="ot">=</span> <span class="fu">sum</span>(<span class="fu">predict</span>(mod_zinb1, <span class="at">type =</span> <span class="st">&quot;prob&quot;</span>)[,<span class="dv">1</span>]),</span>
<span id="cb1228-6"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1228-6" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;Hurdle&quot;</span> <span class="ot">=</span> <span class="fu">sum</span>(<span class="fu">predict</span>(mod_hur1, <span class="at">type =</span> <span class="st">&quot;prob&quot;</span>)[,<span class="dv">1</span>])),<span class="dv">0</span>)</span></code></pre></div>
<pre><code>    Obs Poisson      NB     ZIP    ZINB  Hurdle 
   1264     124    1250    1264    1264    1264 </code></pre>
<p>The hurdle model does about as well as the negative binomial and zero-inflated models. All but the Poisson give reasonable fits in this regard.</p>
</div>
<div id="rootogram-for-hurdle-model" class="section level3" number="19.15.9">
<h3><span class="header-section-number">19.15.9</span> Rootogram for Hurdle Model</h3>
<div class="sourceCode" id="cb1230"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1230-1"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1230-1" aria-hidden="true" tabindex="-1"></a>countreg<span class="sc">::</span><span class="fu">rootogram</span>(mod_hur1, <span class="at">max =</span> <span class="dv">30</span>)</span></code></pre></div>
<p><img src="432-notes_files/figure-html/unnamed-chunk-499-1.png" width="672" /></p>
<p>The results are still not perfect, of course. In fitting the zeros exactly, we’re underfitting counts of 1, 2, and 30, and overfitting many of the counts between 6 and 20. We still have a problem here with overdispersion. That’s why we’ll consider a hurdle model with a negative binomial regression for the counts in a moment.</p>
</div>
<div id="understanding-the-modeled-counts-in-detail" class="section level3" number="19.15.10">
<h3><span class="header-section-number">19.15.10</span> Understanding the Modeled Counts in Detail</h3>
<p>The expected mean count uses both parts of the hurdle model. Mathematically, we want…</p>
<p><span class="math display">\[
E[y | {\bf x}] = \frac{1 - f_1(0 | {\bf x})}{1 - f_2(0 | {\bf x})} \mu_2({\bf x})
\]</span></p>
<p>where</p>
<ul>
<li>our count of <code>physhealth</code> is <span class="math inline">\(y\)</span></li>
<li>our predictors are represented by <strong>x</strong></li>
<li>and the expected count is the product of a ratio and a mean.</li>
</ul>
<blockquote>
<p>The ratio is the probability of a non-zero in the first process divided the probability of a non-zero in the second untruncated process. The f symbols represent distributions. Recall these are logistic and Poisson, respectively, by default but can be others. The mean is for the untruncated version of the positive-count process.</p>
</blockquote>
<p>If we want to see the expected hurdle counts, we can get them using some clever applications of the <code>predict</code> function.</p>
<p>The first six expected mean counts (<span class="math inline">\(E[y | {\bf x}]\)</span> from the equation above) are:</p>
<div class="sourceCode" id="cb1231"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1231-1"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1231-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">predict</span>(mod_hur1, <span class="at">type =</span> <span class="st">&quot;response&quot;</span>))</span></code></pre></div>
<pre><code>       1        2        3        4        5        6 
2.214179 2.281482 3.116124 5.267881 3.167890 3.712120 </code></pre>
<p>The ratio of non-zero probabilities, <span class="math inline">\(\frac{1 - f_1(0 | {\bf x})}{1 - f_2(0 | {\bf x})}\)</span>, from the mathematical expression above can be extracted by:</p>
<div class="sourceCode" id="cb1233"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1233-1"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1233-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">predict</span>(mod_hur1, <span class="at">type =</span> <span class="st">&quot;zero&quot;</span>))</span></code></pre></div>
<pre><code>        1         2         3         4         5         6 
0.3173312 0.3221978 0.3344433 0.4806542 0.3372292 0.3649208 </code></pre>
<p>The mean for the untruncated process, <span class="math inline">\(\mu_2({\bf x})\)</span>, can also be obtained by:</p>
<div class="sourceCode" id="cb1235"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1235-1"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1235-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">predict</span>(mod_hur1, <span class="at">type =</span> <span class="st">&quot;count&quot;</span>))</span></code></pre></div>
<pre><code>        1         2         3         4         5         6 
 6.977501  7.081000  9.317347 10.959814  9.393877 10.172401 </code></pre>
<p>and we can multiply these last two pieces together to verify that they match our expected hurdle counts.</p>
<div class="sourceCode" id="cb1237"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1237-1"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1237-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">predict</span>(mod_hur1, <span class="at">type =</span> <span class="st">&quot;zero&quot;</span>) <span class="sc">*</span> <span class="fu">predict</span>(mod_hur1, <span class="at">type =</span> <span class="st">&quot;count&quot;</span>),<span class="dv">5</span>)</span></code></pre></div>
<pre><code>       1        2        3        4        5 
2.214179 2.281482 3.116124 5.267881 3.167890 </code></pre>
</div>
<div id="specify-the-r2-and-log-likelihood-values-2" class="section level3" number="19.15.11">
<h3><span class="header-section-number">19.15.11</span> Specify the R<sup>2</sup> and log (likelihood) values</h3>
<p>We can calculate a proxy for R<sup>2</sup> as the squared correlation of the fitted values and the observed values.</p>
<div class="sourceCode" id="cb1239"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1239-1"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1239-1" aria-hidden="true" tabindex="-1"></a><span class="co"># The correlation of observed and fitted values</span></span>
<span id="cb1239-2"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1239-2" aria-hidden="true" tabindex="-1"></a>(hur1_r <span class="ot">&lt;-</span> <span class="fu">with</span>(sm_hur1, <span class="fu">cor</span>(physhealth, fitted)))</span></code></pre></div>
<pre><code>[1] 0.1873104</code></pre>
<div class="sourceCode" id="cb1241"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1241-1"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1241-1" aria-hidden="true" tabindex="-1"></a><span class="co"># R-square</span></span>
<span id="cb1241-2"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1241-2" aria-hidden="true" tabindex="-1"></a>hur1_r<span class="sc">^</span><span class="dv">2</span></span></code></pre></div>
<pre><code>[1] 0.03508517</code></pre>
<div class="sourceCode" id="cb1243"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1243-1"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1243-1" aria-hidden="true" tabindex="-1"></a><span class="fu">logLik</span>(mod_hur1)</span></code></pre></div>
<pre><code>&#39;log Lik.&#39; -5679.792 (df=6)</code></pre>
<p>Here, we have</p>
<table>
<thead>
<tr class="header">
<th align="right">Model</th>
<th align="right">Scale</th>
<th align="right">R<sup>2</sup></th>
<th align="right">log(likelihood)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">Hurdle Model (Poisson)</td>
<td align="right">Complex: log(<code>physhealth</code>)</td>
<td align="right">.035</td>
<td align="right">-5679.83</td>
</tr>
</tbody>
</table>
</div>
<div id="check-model-assumptions-7" class="section level3" number="19.15.12">
<h3><span class="header-section-number">19.15.12</span> Check model assumptions</h3>
<p>Here is a plot of residuals vs. fitted values on the original <code>physhealth</code> scale.</p>
<div class="sourceCode" id="cb1245"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1245-1"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1245-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(sm_hur1, <span class="fu">aes</span>(<span class="at">x =</span> fitted, <span class="at">y =</span> resid)) <span class="sc">+</span></span>
<span id="cb1245-2"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1245-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb1245-3"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1245-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Residuals vs. Fitted `physhealth`&quot;</span>,</span>
<span id="cb1245-4"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1245-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">subtitle =</span> <span class="st">&quot;Hurdle model with Poisson counts&quot;</span>)</span></code></pre></div>
<p><img src="432-notes_files/figure-html/unnamed-chunk-506-1.png" width="672" /></p>
</div>
<div id="predictions-for-harry-and-sally-7" class="section level3" number="19.15.13">
<h3><span class="header-section-number">19.15.13</span> Predictions for Harry and Sally</h3>
<p>The predictions from this zero-inflated negative binomial regression model are obtained as follows…</p>
<div class="sourceCode" id="cb1246"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1246-1"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1246-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(mod_hur1, <span class="at">newdata =</span> hs_data, <span class="at">type =</span> <span class="st">&quot;response&quot;</span>)</span></code></pre></div>
<pre><code>       1        2 
6.003689 2.057127 </code></pre>
<p>As we’ve seen in the past, when we use <code>response</code> as the type, the predictions fall on the original <code>physhealth</code> scale. The prediction for Harry is 6.0 days, and for Sally is 2.1 days.</p>
</div>
</div>
<div id="a-hurdle-model-with-negative-binomial-for-overdispersion" class="section level2" number="19.16">
<h2><span class="header-section-number">19.16</span> A “hurdle” model (with negative binomial for overdispersion)</h2>
<p>Let’s account for overdispersion better with a negative binomial model for the counts in our hurdle model. We specify that the positive-count process be fit with this NB model using <code>dist = negbin</code>.</p>
<div class="sourceCode" id="cb1248"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1248-1"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1248-1" aria-hidden="true" tabindex="-1"></a>mod_hur_nb1 <span class="ot">&lt;-</span> pscl<span class="sc">::</span><span class="fu">hurdle</span>(physhealth <span class="sc">~</span> bmi_c <span class="sc">+</span> smoke100,</span>
<span id="cb1248-2"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1248-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">dist =</span> <span class="st">&quot;negbin&quot;</span>, <span class="at">zero.dist =</span> <span class="st">&quot;binomial&quot;</span>,</span>
<span id="cb1248-3"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1248-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">data =</span> sm_oh_A_young)</span>
<span id="cb1248-4"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1248-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1248-5"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1248-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod_hur_nb1)</span></code></pre></div>
<pre><code>
Call:
pscl::hurdle(formula = physhealth ~ bmi_c + smoke100, data = sm_oh_A_young, 
    dist = &quot;negbin&quot;, zero.dist = &quot;binomial&quot;)

Pearson residuals:
    Min      1Q  Median      3Q     Max 
-0.5749 -0.4178 -0.3948 -0.1165  6.4023 

Count model coefficients (truncated negbin with log link):
            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)  1.54170    0.10101  15.263  &lt; 2e-16 ***
bmi_c        0.02434    0.00677   3.595 0.000324 ***
smoke100     0.51792    0.11101   4.666 3.08e-06 ***
Log(theta)  -0.88245    0.14653  -6.023 1.72e-09 ***
Zero hurdle model coefficients (binomial with logit link):
             Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept) -0.683509   0.062827 -10.879  &lt; 2e-16 ***
bmi_c        0.027777   0.006508   4.268 1.97e-05 ***
smoke100     0.238300   0.095301   2.500   0.0124 *  
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 

Theta: count = 0.4138
Number of iterations in BFGS optimization: 17 
Log-likelihood: -3469 on 7 Df</code></pre>
<div class="sourceCode" id="cb1250"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1250-1"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1250-1" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(mod_hur_nb1)</span></code></pre></div>
<pre><code>                        2.5 %      97.5 %
count_(Intercept)  1.34373051  1.73966938
count_bmi_c        0.01107002  0.03760871
count_smoke100     0.30035006  0.73549531
zero_(Intercept)  -0.80664805 -0.56037031
zero_bmi_c         0.01502124  0.04053230
zero_smoke100      0.05151314  0.42508607</code></pre>
<div id="comparison-to-a-null-model-3" class="section level3" number="19.16.1">
<h3><span class="header-section-number">19.16.1</span> Comparison to a null model</h3>
<p>To show that this model fits better than the null model (the model with intercept only), we can compare them directly with a chi-squared test. Since we have two predictors in the full model, the degrees of freedom for this test is 2.</p>
<div class="sourceCode" id="cb1252"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1252-1"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1252-1" aria-hidden="true" tabindex="-1"></a>mod_hur_nb_null <span class="ot">&lt;-</span> pscl<span class="sc">::</span><span class="fu">hurdle</span>(physhealth <span class="sc">~</span> <span class="dv">1</span>, <span class="at">dist =</span> <span class="st">&quot;negbin&quot;</span>, </span>
<span id="cb1252-2"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1252-2" aria-hidden="true" tabindex="-1"></a>                      <span class="at">zero.dist =</span> <span class="st">&quot;binomial&quot;</span>, </span>
<span id="cb1252-3"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1252-3" aria-hidden="true" tabindex="-1"></a>                      <span class="at">data =</span> sm_oh_A_young)</span>
<span id="cb1252-4"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1252-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1252-5"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1252-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod_hur_nb_null)</span></code></pre></div>
<pre><code>
Call:
pscl::hurdle(formula = physhealth ~ 1, data = sm_oh_A_young, dist = &quot;negbin&quot;, 
    zero.dist = &quot;binomial&quot;)

Pearson residuals:
    Min      1Q  Median      3Q     Max 
-0.4048 -0.4048 -0.4048 -0.1622  3.2340 

Count model coefficients (truncated negbin with log link):
            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)  1.77653    0.09641  18.427  &lt; 2e-16 ***
Log(theta)  -1.04455    0.16123  -6.479 9.25e-11 ***
Zero hurdle model coefficients (binomial with logit link):
            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)  -0.5768     0.0469   -12.3   &lt;2e-16 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 

Theta: count = 0.3518
Number of iterations in BFGS optimization: 12 
Log-likelihood: -3498 on 3 Df</code></pre>
<div class="sourceCode" id="cb1254"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1254-1"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1254-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pchisq</span>(<span class="dv">2</span> <span class="sc">*</span> (<span class="fu">logLik</span>(mod_hur_nb1) <span class="sc">-</span> <span class="fu">logLik</span>(mod_hur_nb_null)), <span class="at">df =</span> <span class="dv">2</span>, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>&#39;log Lik.&#39; 2.17419e-13 (df=7)</code></pre>
</div>
<div id="comparison-to-a-negative-binomial-model-vuong-test-1" class="section level3" number="19.16.2">
<h3><span class="header-section-number">19.16.2</span> Comparison to a Negative Binomial Model: Vuong test</h3>
<div class="sourceCode" id="cb1256"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1256-1"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1256-1" aria-hidden="true" tabindex="-1"></a><span class="fu">vuong</span>(mod_hur_nb1, mod_nb1)</span></code></pre></div>
<pre><code>Vuong Non-Nested Hypothesis Test-Statistic: 
(test-statistic is asymptotically distributed N(0,1) under the
 null that the models are indistinguishible)
-------------------------------------------------------------
              Vuong z-statistic             H_A    p-value
Raw                   3.0953118 model1 &gt; model2 0.00098303
AIC-corrected         2.4837306 model1 &gt; model2 0.00650071
BIC-corrected         0.7750288 model1 &gt; model2 0.21916133</code></pre>
<p>The hurdle model is a significant improvement over the standard negative binomial model according to the raw and AIC-corrected versions of this test, but not the BIC-corrected version.</p>
</div>
<div id="comparison-to-a-zero-inflated-nb-model-vuong-test" class="section level3" number="19.16.3">
<h3><span class="header-section-number">19.16.3</span> Comparison to a Zero-Inflated NB Model: Vuong test</h3>
<p>Is the hurdle model comparable to the zero-inflated Poisson?</p>
<div class="sourceCode" id="cb1258"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1258-1"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1258-1" aria-hidden="true" tabindex="-1"></a><span class="fu">vuong</span>(mod_hur_nb1, mod_zinb1)</span></code></pre></div>
<pre><code>Vuong Non-Nested Hypothesis Test-Statistic: 
(test-statistic is asymptotically distributed N(0,1) under the
 null that the models are indistinguishible)
-------------------------------------------------------------
              Vuong z-statistic             H_A p-value
Raw                     0.91178 model1 &gt; model2 0.18094
AIC-corrected           0.91178 model1 &gt; model2 0.18094
BIC-corrected           0.91178 model1 &gt; model2 0.18094</code></pre>
<p>The hurdle model is just barely a significant improvement over the zero-inflated Negative Binomial model.</p>
</div>
<div id="comparing-the-hurdle-models-with-aic-and-bic" class="section level3" number="19.16.4">
<h3><span class="header-section-number">19.16.4</span> Comparing the Hurdle Models with AIC and BIC</h3>
<div class="sourceCode" id="cb1260"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1260-1"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1260-1" aria-hidden="true" tabindex="-1"></a><span class="fu">AIC</span>(mod_hur1); <span class="fu">BIC</span>(mod_hur1)</span></code></pre></div>
<pre><code>[1] 11371.58</code></pre>
<pre><code>[1] 11405.11</code></pre>
<div class="sourceCode" id="cb1263"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1263-1"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1263-1" aria-hidden="true" tabindex="-1"></a><span class="fu">AIC</span>(mod_hur_nb1); <span class="fu">BIC</span>(mod_hur_nb1)</span></code></pre></div>
<pre><code>[1] 6952.186</code></pre>
<pre><code>[1] 6991.301</code></pre>
<p>The negative binomial approach certainly looks better than the Poisson here.</p>
</div>
<div id="the-fitted-equation-6" class="section level3" number="19.16.5">
<h3><span class="header-section-number">19.16.5</span> The Fitted Equation</h3>
<p>The form of the model equation for this hurdle also requires us to take two separate models into account. First we have a logistic regression model to predict the log odds of zero <code>physhealth</code> days. That takes care of the zeros. Then, to predict the number of <code>physhealth</code> days, we use a truncated negative binomial model, which is truncated to produce only estimates greater than zero, with <span class="math inline">\(\theta\)</span> estimated as <code>exp(-1.123)</code> or 0.325.</p>
</div>
<div id="interpreting-the-coefficients-8" class="section level3" number="19.16.6">
<h3><span class="header-section-number">19.16.6</span> Interpreting the Coefficients</h3>
<p>We can exponentiate the logistic regression coefficients to obtain results in terms of odds ratios for that model, and that can be of some help in understanding the process behind excess zeros.</p>
<div class="sourceCode" id="cb1266"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1266-1"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1266-1" aria-hidden="true" tabindex="-1"></a><span class="fu">exp</span>(<span class="fu">coef</span>(mod_hur_nb1))</span></code></pre></div>
<pre><code>count_(Intercept)       count_bmi_c    count_smoke100  zero_(Intercept) 
        4.6725266         1.0246380         1.6785372         0.5048423 
       zero_bmi_c     zero_smoke100 
        1.0281661         1.2690894 </code></pre>
<p>For example,</p>
<ul>
<li>in the model for <code>physhealth</code> = 0, the odds of <code>physhealth</code> = 0 are 127% as high for subjects with <code>smoke100</code> = 1 as for non-smokers with the same BMI.</li>
</ul>
</div>
<div id="testing-the-predictors-6" class="section level3" number="19.16.7">
<h3><span class="header-section-number">19.16.7</span> Testing the Predictors</h3>
<p>We can test the model with and without <code>bmi_c</code>, for example, by fitting the model both ways, and comparing the results with either a Wald or Likelihood Ratio test, each of which is available in the <code>lmtest</code> package.</p>
<div class="sourceCode" id="cb1268"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1268-1"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1268-1" aria-hidden="true" tabindex="-1"></a>mod_hurnb1_nobmi <span class="ot">&lt;-</span> pscl<span class="sc">::</span><span class="fu">hurdle</span>(physhealth <span class="sc">~</span> smoke100,</span>
<span id="cb1268-2"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1268-2" aria-hidden="true" tabindex="-1"></a>                         <span class="at">dist =</span> <span class="st">&quot;negbin&quot;</span>, </span>
<span id="cb1268-3"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1268-3" aria-hidden="true" tabindex="-1"></a>                         <span class="at">zero.dist =</span> <span class="st">&quot;binomial&quot;</span>,</span>
<span id="cb1268-4"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1268-4" aria-hidden="true" tabindex="-1"></a>                         <span class="at">data =</span> sm_oh_A_young)</span>
<span id="cb1268-5"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1268-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1268-6"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1268-6" aria-hidden="true" tabindex="-1"></a>lmtest<span class="sc">::</span><span class="fu">waldtest</span>(mod_hur_nb1, mod_hurnb1_nobmi)</span></code></pre></div>
<pre><code>Wald test

Model 1: physhealth ~ bmi_c + smoke100
Model 2: physhealth ~ smoke100
  Res.Df Df  Chisq Pr(&gt;Chisq)    
1   1967                         
2   1969 -2 31.141  1.729e-07 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb1270"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1270-1"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1270-1" aria-hidden="true" tabindex="-1"></a>lmtest<span class="sc">::</span><span class="fu">lrtest</span>(mod_hur_nb1, mod_hurnb1_nobmi)</span></code></pre></div>
<pre><code>Likelihood ratio test

Model 1: physhealth ~ bmi_c + smoke100
Model 2: physhealth ~ smoke100
  #Df  LogLik Df  Chisq Pr(&gt;Chisq)    
1   7 -3469.1                         
2   5 -3485.0 -2 31.812  1.236e-07 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
</div>
<div id="store-fitted-values-and-residuals-8" class="section level3" number="19.16.8">
<h3><span class="header-section-number">19.16.8</span> Store fitted values and residuals</h3>
<p>Again we need to build up the fitted values and residuals, without <code>broom</code> to help.</p>
<div class="sourceCode" id="cb1272"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1272-1"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1272-1" aria-hidden="true" tabindex="-1"></a>sm_hur_nb1 <span class="ot">&lt;-</span> sm_oh_A_young <span class="sc">%&gt;%</span></span>
<span id="cb1272-2"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1272-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">fitted =</span> <span class="fu">fitted</span>(mod_hur_nb1, <span class="at">type =</span> <span class="st">&quot;response&quot;</span>),</span>
<span id="cb1272-3"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1272-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">resid =</span> <span class="fu">resid</span>(mod_hur_nb1, <span class="at">type =</span> <span class="st">&quot;response&quot;</span>))</span>
<span id="cb1272-4"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1272-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1272-5"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1272-5" aria-hidden="true" tabindex="-1"></a>sm_hur_nb1 <span class="sc">%&gt;%</span> </span>
<span id="cb1272-6"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1272-6" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(physhealth, fitted, resid) <span class="sc">%&gt;%</span></span>
<span id="cb1272-7"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1272-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">head</span>()</span></code></pre></div>
<pre><code># A tibble: 6 x 3
  physhealth fitted resid
       &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;
1          0   2.16 -2.16
2          0   2.23 -2.23
3          0   3.09 -3.09
4         30   5.37 24.6 
5          0   3.15 -3.15
6          0   3.72 -3.72</code></pre>
</div>
<div id="rootogram-for-nb-hurdle-model" class="section level3" number="19.16.9">
<h3><span class="header-section-number">19.16.9</span> Rootogram for NB Hurdle Model</h3>
<div class="sourceCode" id="cb1274"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1274-1"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1274-1" aria-hidden="true" tabindex="-1"></a>countreg<span class="sc">::</span><span class="fu">rootogram</span>(mod_hur_nb1, <span class="at">max =</span> <span class="dv">30</span>)</span></code></pre></div>
<p><img src="432-notes_files/figure-html/unnamed-chunk-518-1.png" width="672" /></p>
<p>This improves the situation, but we’re still underfitting the 30s.</p>
</div>
<div id="specify-the-r2-and-log-likelihood-values-3" class="section level3" number="19.16.10">
<h3><span class="header-section-number">19.16.10</span> Specify the R<sup>2</sup> and log (likelihood) values</h3>
<p>We can calculate a proxy for R<sup>2</sup> as the squared correlation of the fitted values and the observed values.</p>
<div class="sourceCode" id="cb1275"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1275-1"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1275-1" aria-hidden="true" tabindex="-1"></a><span class="co"># The correlation of observed and fitted values</span></span>
<span id="cb1275-2"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1275-2" aria-hidden="true" tabindex="-1"></a>(hurnb1_r <span class="ot">&lt;-</span> <span class="fu">with</span>(sm_hur_nb1, <span class="fu">cor</span>(physhealth, fitted)))</span></code></pre></div>
<pre><code>[1] 0.1856393</code></pre>
<div class="sourceCode" id="cb1277"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1277-1"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1277-1" aria-hidden="true" tabindex="-1"></a><span class="co"># R-square</span></span>
<span id="cb1277-2"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1277-2" aria-hidden="true" tabindex="-1"></a>hurnb1_r<span class="sc">^</span><span class="dv">2</span></span></code></pre></div>
<pre><code>[1] 0.03446194</code></pre>
<div class="sourceCode" id="cb1279"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1279-1"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1279-1" aria-hidden="true" tabindex="-1"></a><span class="fu">logLik</span>(mod_hur_nb1)</span></code></pre></div>
<pre><code>&#39;log Lik.&#39; -3469.093 (df=7)</code></pre>
<p>Here, we have</p>
<table>
<thead>
<tr class="header">
<th align="right">Model</th>
<th align="right">Scale</th>
<th align="right">R<sup>2</sup></th>
<th align="right">log(likelihood)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">Hurdle Model (Neg. Bin.)</td>
<td align="right">Complex: log(<code>physhealth</code>)</td>
<td align="right">.035</td>
<td align="right">-3469.07</td>
</tr>
</tbody>
</table>
</div>
<div id="check-model-assumptions-8" class="section level3" number="19.16.11">
<h3><span class="header-section-number">19.16.11</span> Check model assumptions</h3>
<p>Here is a plot of residuals vs. fitted values on the original <code>physhealth</code> scale.</p>
<div class="sourceCode" id="cb1281"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1281-1"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1281-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(sm_hur_nb1, <span class="fu">aes</span>(<span class="at">x =</span> fitted, <span class="at">y =</span> resid)) <span class="sc">+</span></span>
<span id="cb1281-2"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1281-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb1281-3"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1281-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Residuals vs. Fitted `physhealth`&quot;</span>,</span>
<span id="cb1281-4"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1281-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">subtitle =</span> <span class="st">&quot;Hurdle model with Negative Binomial counts&quot;</span>)</span></code></pre></div>
<p><img src="432-notes_files/figure-html/unnamed-chunk-521-1.png" width="672" /></p>
</div>
<div id="predictions-for-harry-and-sally-8" class="section level3" number="19.16.12">
<h3><span class="header-section-number">19.16.12</span> Predictions for Harry and Sally</h3>
<p>The predictions from this zero-inflated negative binomial regression model are obtained as follows…</p>
<div class="sourceCode" id="cb1282"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1282-1"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1282-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(mod_hur_nb1, <span class="at">newdata =</span> hs_data, <span class="at">type =</span> <span class="st">&quot;response&quot;</span>)</span></code></pre></div>
<pre><code>       1        2 
6.222041 2.007095 </code></pre>
<p>The prediction for Harry is 6.22 days, and for Sally is 2.01 days.</p>
</div>
<div id="note-fitting-a-different-hurdle-model-for-counts-and-przero" class="section level3" number="19.16.13">
<h3><span class="header-section-number">19.16.13</span> Note: Fitting a Different Hurdle Model for Counts and Pr(zero)</h3>
<p>Suppose we wanted to use only <code>bmi_c</code> to predict the probability of a zero count, but use both predictors in the model for the positive counts. We use the <code>|</code> command.</p>
<div class="sourceCode" id="cb1284"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1284-1"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1284-1" aria-hidden="true" tabindex="-1"></a>mod_hur_new1 <span class="ot">&lt;-</span> </span>
<span id="cb1284-2"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1284-2" aria-hidden="true" tabindex="-1"></a>    pscl<span class="sc">::</span><span class="fu">hurdle</span>(physhealth <span class="sc">~</span> bmi_c <span class="sc">+</span> smoke100 <span class="sc">|</span> bmi_c,</span>
<span id="cb1284-3"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1284-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">dist =</span> <span class="st">&quot;negbin&quot;</span>, <span class="at">zero.dist =</span> <span class="st">&quot;binomial&quot;</span>,</span>
<span id="cb1284-4"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1284-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">data =</span> sm_oh_A_young)</span>
<span id="cb1284-5"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1284-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1284-6"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1284-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod_hur_new1)</span></code></pre></div>
<pre><code>
Call:
pscl::hurdle(formula = physhealth ~ bmi_c + smoke100 | bmi_c, data = sm_oh_A_young, 
    dist = &quot;negbin&quot;, zero.dist = &quot;binomial&quot;)

Pearson residuals:
    Min      1Q  Median      3Q     Max 
-0.5630 -0.4179 -0.3971 -0.1150  6.1958 

Count model coefficients (truncated negbin with log link):
            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)  1.54170    0.10101  15.263  &lt; 2e-16 ***
bmi_c        0.02434    0.00677   3.595 0.000324 ***
smoke100     0.51792    0.11101   4.666 3.08e-06 ***
Log(theta)  -0.88245    0.14653  -6.023 1.72e-09 ***
Zero hurdle model coefficients (binomial with logit link):
            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept) -0.58186    0.04718 -12.332  &lt; 2e-16 ***
bmi_c        0.02853    0.00649   4.396  1.1e-05 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 

Theta: count = 0.4138
Number of iterations in BFGS optimization: 17 
Log-likelihood: -3472 on 6 Df</code></pre>
</div>
<div id="hanging-rootogram-for-this-new-hurdle-model" class="section level3" number="19.16.14">
<h3><span class="header-section-number">19.16.14</span> Hanging Rootogram for this new Hurdle Model</h3>
<div class="sourceCode" id="cb1286"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1286-1"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1286-1" aria-hidden="true" tabindex="-1"></a>countreg<span class="sc">::</span><span class="fu">rootogram</span>(mod_hur_new1, <span class="at">max =</span> <span class="dv">30</span>)</span></code></pre></div>
<p><img src="432-notes_files/figure-html/unnamed-chunk-524-1.png" width="672" /></p>
<p>Not a meaningful improvement, certainly.</p>
</div>
</div>
<div id="a-tobit-censored-regression-model" class="section level2" number="19.17">
<h2><span class="header-section-number">19.17</span> A Tobit (Censored) Regression Model</h2>
<p>The idea of the <strong>tobit</strong> model (sometimes called a <strong>censored regression</strong> model) is to estimate associations for outcomes where we can see either left-censoring (censoring from below) or right-censoring (censoring from above.)</p>
<p>Consider the variable <code>physhealth</code>, which is restricted to fall between 0 and 30 by the way the measure was constructed. But supposed we think about a broader and latent (unobserved) variable describing physical health. Among the people with <code>physhealth</code> = 0, some would be incredible athletes and others would be in much poorer physical health but still healthy enough to truthfully answer 0. On the other end, some of the people responding 30 are in substantially worse physical health than others with that same response.</p>
<ul>
<li>Censoring from below takes place when values at or below a threshold (in this case 0) take that value.</li>
<li>Censoring from above takes place when values at or above a threshold (here, 30) take that value.</li>
</ul>
<p>Several examples of tobit analysis are available at <a href="https://stats.idre.ucla.edu/r/dae/tobit-models/" class="uri">https://stats.idre.ucla.edu/r/dae/tobit-models/</a>, which is my primary source for the material here on those models.</p>
<p>The tobit model postulates that the value 0 in our model is just the lower limit of the underlying measure of poor physical health that we would actually observe in the population if we had a stronger measure. Similarly, we’ll postulate that 30 is just the upper limit of “poor health” that we can see. The approach I’ll take to run the tobit model comes from the <code>vglm</code> function in the <code>VGAM</code> package.</p>
<p>Here’s the model, and its summary. Note that the default Lower value for a tobit model is 0, so we didn’t technically have to list that here.</p>
<div class="sourceCode" id="cb1287"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1287-1"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1287-1" aria-hidden="true" tabindex="-1"></a>mod_tob1 <span class="ot">&lt;-</span> <span class="fu">vglm</span>(physhealth <span class="sc">~</span> bmi_c <span class="sc">+</span> smoke100, </span>
<span id="cb1287-2"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1287-2" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">tobit</span>(<span class="at">Lower =</span> <span class="dv">0</span>, <span class="at">Upper =</span> <span class="dv">30</span>),</span>
<span id="cb1287-3"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1287-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">type.fitted =</span> <span class="st">&quot;censored&quot;</span>,</span>
<span id="cb1287-4"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1287-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">data =</span> sm_oh_A_young)</span>
<span id="cb1287-5"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1287-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1287-6"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1287-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod_tob1)</span></code></pre></div>
<pre><code>
Call:
vglm(formula = physhealth ~ bmi_c + smoke100, family = tobit(Lower = 0, 
    Upper = 30), data = sm_oh_A_young, type.fitted = &quot;censored&quot;)

Coefficients: 
              Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept):1 -9.29104    0.75509 -12.305  &lt; 2e-16 ***
(Intercept):2  2.87081    0.03028  94.818  &lt; 2e-16 ***
bmi_c          0.37434    0.06537   5.727 1.02e-08 ***
smoke100       4.35390    0.97223   4.478 7.52e-06 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Names of linear predictors: mu, loglink(sd)

Log-likelihood: -3420.605 on 3944 degrees of freedom

Number of Fisher scoring iterations: 6 

No Hauck-Donner effect found in any of the estimates</code></pre>
<div class="sourceCode" id="cb1289"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1289-1"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1289-1" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(mod_tob1)</span></code></pre></div>
<pre><code>                    2.5 %     97.5 %
(Intercept):1 -10.7709932 -7.8110877
(Intercept):2   2.8114721  2.9301560
bmi_c           0.2462244  0.5024551
smoke100        2.4483714  6.2594277</code></pre>
<div id="the-fitted-equation-7" class="section level3" number="19.17.1">
<h3><span class="header-section-number">19.17.1</span> The Fitted Equation</h3>
<p>Because we’ve used the censoring approach, our model will limit its predictions to the range of [0, 30], where any predictions outside that range are censored. Values below 0 are fitted as 0, and values above 30 are fitted as 30.</p>
<p>The model equation is</p>
<pre><code>physhealth = -9.29 + 0.37 bmi_c + 4.35 smoke100</code></pre>
</div>
<div id="interpreting-the-coefficients-9" class="section level3" number="19.17.2">
<h3><span class="header-section-number">19.17.2</span> Interpreting the Coefficients</h3>
<p>Tobit model regression coefficients are interpreted as we would a set of OLS coefficients, <em>except</em> that the linear effect is on the uncensored <em>latent variable</em>, rather than on the observed outcome.</p>
<p>In our case,</p>
<ul>
<li>a one-unit increase in <code>bmi_c</code> is associated with a 0.37 day increase in the predicted value of <code>physhealth</code>, holding <code>smoke100</code> constant</li>
<li>a move from <code>smoke100</code> = 0 to 1 is associated with a 4.35 day increase in the predicted value of <code>physhealth</code>, holding <code>bmi_c</code> constant</li>
<li>the coefficient labeled <code>(Intercept):1</code> is the intercept for the model and is the predicted value of <code>physhealth</code> when <code>smoke100</code> = 0 and <code>bmi_c</code> = 0. Note that this value is -9.29, which is outside the range of <code>physhealth</code> values we observed.</li>
<li>the coefficient labeled <code>(Intercept):2</code> is a statistic we can use after we exponentiate it, as follows:
<ul>
<li>here <code>(Intercept):2</code> = 2.87, and exp(2.87) = 17.6370182, which is analogous to the square root of the residual variance in OLS regression, which is summarized for our OLS model as <code>Residual standard error: 17.64</code>.</li>
</ul></li>
</ul>
</div>
<div id="testing-the-predictors-7" class="section level3" number="19.17.3">
<h3><span class="header-section-number">19.17.3</span> Testing the Predictors</h3>
<p>We can test the model with and without <code>bmi_c</code>, for example, by fitting the model both ways, and comparing the results with either a Wald or Likelihood Ratio test, each of which is available in the <code>lmtest</code> package.</p>
<div class="sourceCode" id="cb1292"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1292-1"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1292-1" aria-hidden="true" tabindex="-1"></a>mod_tob_nobmi <span class="ot">&lt;-</span> <span class="fu">vglm</span>(physhealth <span class="sc">~</span> smoke100, </span>
<span id="cb1292-2"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1292-2" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">tobit</span>(<span class="at">Lower =</span> <span class="dv">0</span>, <span class="at">Upper =</span> <span class="dv">30</span>),</span>
<span id="cb1292-3"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1292-3" aria-hidden="true" tabindex="-1"></a>                      <span class="at">type.fitted =</span> <span class="st">&quot;censored&quot;</span>,</span>
<span id="cb1292-4"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1292-4" aria-hidden="true" tabindex="-1"></a>                      <span class="at">data =</span> sm_oh_A_young)</span>
<span id="cb1292-5"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1292-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1292-6"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1292-6" aria-hidden="true" tabindex="-1"></a>lmtest<span class="sc">::</span><span class="fu">waldtest</span>(mod_tob1, mod_tob_nobmi)</span></code></pre></div>
<pre><code>Wald test

Model 1: physhealth ~ bmi_c + smoke100
Model 2: physhealth ~ smoke100
  Res.Df Df  Chisq Pr(&gt;Chisq)    
1   3944                         
2   3945 -1 32.796  1.023e-08 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>The likelihood ratio test we have used in some other settings isn’t available here.</p>
</div>
<div id="store-fitted-values-and-residuals-9" class="section level3" number="19.17.4">
<h3><span class="header-section-number">19.17.4</span> Store fitted values and residuals</h3>
<p>The residuals and fitted values from the tobit model can be stored and then summarized in several ways:</p>
<div class="sourceCode" id="cb1294"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1294-1"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1294-1" aria-hidden="true" tabindex="-1"></a>sm_tob1 <span class="ot">&lt;-</span> sm_oh_A_young <span class="sc">%&gt;%</span></span>
<span id="cb1294-2"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1294-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">fitted =</span> <span class="fu">fitted</span>(mod_tob1,</span>
<span id="cb1294-3"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1294-3" aria-hidden="true" tabindex="-1"></a>                           <span class="at">type.fitted =</span> <span class="st">&quot;censored&quot;</span>),</span>
<span id="cb1294-4"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1294-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">resid =</span> physhealth <span class="sc">-</span> fitted)</span>
<span id="cb1294-5"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1294-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1294-6"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1294-6" aria-hidden="true" tabindex="-1"></a>sm_tob1 <span class="sc">%&gt;%</span> </span>
<span id="cb1294-7"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1294-7" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(physhealth, fitted, resid) <span class="sc">%&gt;%</span></span>
<span id="cb1294-8"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1294-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">head</span>()</span></code></pre></div>
<pre><code># A tibble: 6 x 3
  physhealth fitted[,1] resid[,1]
       &lt;dbl&gt;      &lt;dbl&gt;     &lt;dbl&gt;
1          0          0         0
2          0          0         0
3          0          0         0
4         30          0        30
5          0          0         0
6          0          0         0</code></pre>
</div>
<div id="building-something-like-a-rootogram" class="section level3" number="19.17.5">
<h3><span class="header-section-number">19.17.5</span> Building Something Like a Rootogram</h3>
<p>Building a rootogram is tricky for a tobit model, to say the least, but we can approximate a piece of the issue by plotting the rounded fitted values against the observed <code>physhealth</code> data.</p>
<div class="sourceCode" id="cb1296"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1296-1"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1296-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(sm_tob1, <span class="fu">aes</span>(<span class="at">x =</span> physhealth, <span class="at">y =</span> <span class="fu">round</span>(fitted))) <span class="sc">+</span></span>
<span id="cb1296-2"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1296-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="fl">0.2</span>) <span class="sc">+</span> </span>
<span id="cb1296-3"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1296-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">1</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="432-notes_files/figure-html/unnamed-chunk-528-1.png" width="672" /></p>
<p>Note that the model never predicts a subject to have an underlying <code>physhealth</code> worse than about 13 (remember that larger numbers indicate worse health here.)</p>
</div>
<div id="tables-of-the-observed-and-fitted-physhealth-from-tobit" class="section level3" number="19.17.6">
<h3><span class="header-section-number">19.17.6</span> Tables of the Observed and Fitted <code>physhealth</code> from Tobit</h3>
<div class="sourceCode" id="cb1297"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1297-1"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1297-1" aria-hidden="true" tabindex="-1"></a><span class="fu">addmargins</span>(<span class="fu">table</span>(<span class="fu">round</span>(sm_tob1<span class="sc">$</span>physhealth)))</span></code></pre></div>
<pre><code>
   0    1    2    3    4    5    6    7    8   10   12   13   14   15   16   17 
1264  112  139   78   29   50    5   40    9   41    4    1   24   38    2    1 
  18   20   21   25   26   28   29   30  Sum 
   1   23    3    8    2    1    1   98 1974 </code></pre>
<div class="sourceCode" id="cb1299"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1299-1"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1299-1" aria-hidden="true" tabindex="-1"></a><span class="fu">addmargins</span>(<span class="fu">table</span>(<span class="fu">round</span>(sm_tob1<span class="sc">$</span>fitted)))</span></code></pre></div>
<pre><code>
   0    1    2    3    4    5    6    8   13  Sum 
1924   20    7   10    4    6    1    1    1 1974 </code></pre>
</div>
<div id="specify-the-r2-and-log-likelihood-values-4" class="section level3" number="19.17.7">
<h3><span class="header-section-number">19.17.7</span> Specify the R<sup>2</sup> and log (likelihood) values</h3>
<p>We can calculate a proxy for R<sup>2</sup> as the squared correlation of the fitted values and the observed values.</p>
<div class="sourceCode" id="cb1301"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1301-1"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1301-1" aria-hidden="true" tabindex="-1"></a><span class="co"># The correlation of observed and fitted values</span></span>
<span id="cb1301-2"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1301-2" aria-hidden="true" tabindex="-1"></a>(tob1_r <span class="ot">&lt;-</span> <span class="fu">with</span>(sm_tob1, <span class="fu">cor</span>(physhealth, fitted)))</span></code></pre></div>
<pre><code>           [,1]
[1,] 0.09329619</code></pre>
<div class="sourceCode" id="cb1303"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1303-1"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1303-1" aria-hidden="true" tabindex="-1"></a><span class="co"># R-square</span></span>
<span id="cb1303-2"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1303-2" aria-hidden="true" tabindex="-1"></a>tob1_r<span class="sc">^</span><span class="dv">2</span></span></code></pre></div>
<pre><code>            [,1]
[1,] 0.008704178</code></pre>
<div class="sourceCode" id="cb1305"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1305-1"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1305-1" aria-hidden="true" tabindex="-1"></a><span class="fu">logLik</span>(mod_tob1)</span></code></pre></div>
<pre><code>[1] -3420.605</code></pre>
<p>Here, we have</p>
<table>
<thead>
<tr class="header">
<th align="right">Model</th>
<th align="right">Scale</th>
<th align="right">R<sup>2</sup></th>
<th align="right">log(likelihood)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">Tobit</td>
<td align="right"><code>physhealth</code></td>
<td align="right">.008</td>
<td align="right">-3420.58</td>
</tr>
</tbody>
</table>
</div>
<div id="check-model-assumptions-9" class="section level3" number="19.17.8">
<h3><span class="header-section-number">19.17.8</span> Check model assumptions</h3>
<p>Here is a plot of residuals vs. fitted values.</p>
<div class="sourceCode" id="cb1307"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1307-1"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1307-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(sm_tob1, <span class="fu">aes</span>(<span class="at">x =</span> fitted, <span class="at">y =</span> resid)) <span class="sc">+</span></span>
<span id="cb1307-2"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1307-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb1307-3"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1307-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Residuals vs. Fitted Values for Tobit 1&quot;</span>)</span></code></pre></div>
<p><img src="432-notes_files/figure-html/unnamed-chunk-533-1.png" width="672" /></p>
<p>Here is a normal Q-Q plot of the Tobit Model 1 residuals.</p>
<div class="sourceCode" id="cb1308"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1308-1"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1308-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(sm_tob1<span class="sc">$</span>resid)</span></code></pre></div>
<p><img src="432-notes_files/figure-html/unnamed-chunk-534-1.png" width="672" /></p>
</div>
<div id="predictions-for-harry-and-sally-9" class="section level3" number="19.17.9">
<h3><span class="header-section-number">19.17.9</span> Predictions for Harry and Sally</h3>
<p>The predictions from this tobit model are obtained as follows…</p>
<div class="sourceCode" id="cb1309"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1309-1"><a href="modeling-a-count-outcome-in-ohio-smart.html#cb1309-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(mod_tob1, <span class="at">newdata =</span> hs_data, <span class="at">type =</span> <span class="st">&quot;response&quot;</span>)</span></code></pre></div>
<pre><code>        [,1]
1  -1.193743
2 -11.162739</code></pre>
<p>The prediction for both Harry and Sally under the tobit model would be truncated to 0 days.</p>

</div>
</div>
</div>
<div class="footnotes">
<hr />
<ol start="9">
<li id="fn9"><p>This discussion is motivated by Section 6.2 of Gelman and Hill.<a href="modeling-a-count-outcome-in-ohio-smart.html#fnref9" class="footnote-back">↩︎</a></p></li>
<li id="fn10"><p>See <a href="http://data.library.virginia.edu/getting-started-with-negative-binomial-regression-modeling/" class="uri">http://data.library.virginia.edu/getting-started-with-negative-binomial-regression-modeling/</a><a href="modeling-a-count-outcome-in-ohio-smart.html#fnref10" class="footnote-back">↩︎</a></p></li>
<li id="fn11"><p>See Zeileis A Kleiber C Jackman S <em>Regression Models for Count Data in R</em> Vignette at <a href="https://cran.r-project.org/web/packages/pscl/vignettes/countreg.pdf" class="uri">https://cran.r-project.org/web/packages/pscl/vignettes/countreg.pdf</a><a href="modeling-a-count-outcome-in-ohio-smart.html#fnref11" class="footnote-back">↩︎</a></p></li>
<li id="fn12"><p>See <a href="https://cran.r-project.org/web/packages/pscl/vignettes/countreg.pdf" class="uri">https://cran.r-project.org/web/packages/pscl/vignettes/countreg.pdf</a> for more details.<a href="modeling-a-count-outcome-in-ohio-smart.html#fnref12" class="footnote-back">↩︎</a></p></li>
<li id="fn13"><p>This <span class="math inline">\(\theta\)</span> is the inverse of the dispersion parameter estimated for these models by most other software packages, like SAS, Stata and SPSS. See <a href="https://stats.idre.ucla.edu/r/dae/negative-binomial-regression/" class="uri">https://stats.idre.ucla.edu/r/dae/negative-binomial-regression/</a> for more details.<a href="modeling-a-count-outcome-in-ohio-smart.html#fnref13" class="footnote-back">↩︎</a></p></li>
<li id="fn14"><p>See <a href="http://data.library.virginia.edu/getting-started-with-negative-binomial-regression-modeling/" class="uri">http://data.library.virginia.edu/getting-started-with-negative-binomial-regression-modeling/</a><a href="modeling-a-count-outcome-in-ohio-smart.html#fnref14" class="footnote-back">↩︎</a></p></li>
<li id="fn15"><p>See <a href="https://stats.idre.ucla.edu/r/dae/zip/" class="uri">https://stats.idre.ucla.edu/r/dae/zip/</a> for more on the zero-inflated poisson model.<a href="modeling-a-count-outcome-in-ohio-smart.html#fnref15" class="footnote-back">↩︎</a></p></li>
<li id="fn16"><p>See <a href="https://stats.idre.ucla.edu/r/dae/zinb/" class="uri">https://stats.idre.ucla.edu/r/dae/zinb/</a><a href="modeling-a-count-outcome-in-ohio-smart.html#fnref16" class="footnote-back">↩︎</a></p></li>
<li id="fn17"><p><a href="http://data.library.virginia.edu/getting-started-with-hurdle-models/" class="uri">http://data.library.virginia.edu/getting-started-with-hurdle-models/</a> is an excellent introduction, by Clay Ford, a Statistical Research Consultant at the University of Virginia Library. I can also recommend <a href="https://rpubs.com/kaz_yos/pscl-2" class="uri">https://rpubs.com/kaz_yos/pscl-2</a> as a place to learn more about the <code>pscl</code> package, and the fitting and interpretation of both hurdle and zero-inflated regression models. That <code>rpubs</code> site has a link to <a href="https://www.ncbi.nlm.nih.gov/pubmed/21854279">this article by Hu, Pavlicova and Nunes from the Am J Drug Alcohol Abuse</a> which provides a real set of examples from a trial of a behavioral health intervention meant to reduce the risk of unprotected sexual occasions as part of a strategy to reduce HIV risk.<a href="modeling-a-count-outcome-in-ohio-smart.html#fnref17" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="colorectal-cancer-screening-and-some-special-cases.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["432-notes.pdf"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
