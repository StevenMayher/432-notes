<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 12 Logistic Regression and the resect data | Data Science for Biological, Medical and Health Research: Notes for 432</title>
  <meta name="description" content="Course Notes for PQHS 432 in Spring 2021." />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 12 Logistic Regression and the resect data | Data Science for Biological, Medical and Health Research: Notes for 432" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Course Notes for PQHS 432 in Spring 2021." />
  <meta name="github-repo" content="thomaselove/432-notes" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 12 Logistic Regression and the resect data | Data Science for Biological, Medical and Health Research: Notes for 432" />
  
  <meta name="twitter:description" content="Course Notes for PQHS 432 in Spring 2021." />
  

<meta name="author" content="Thomas E. Love, Ph.D." />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="logistic-regression-the-foundations.html"/>
<link rel="next" href="a-study-of-prostate-cancer.html"/>
<script src="libs/header-attrs-2.6/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="" data-path="r-packages-used-in-these-notes.html"><a href="r-packages-used-in-these-notes.html"><i class="fa fa-check"></i>R Packages used in these notes</a>
<ul>
<li class="chapter" data-level="" data-path="r-packages-used-in-these-notes.html"><a href="r-packages-used-in-these-notes.html#dealing-with-conflicts"><i class="fa fa-check"></i>Dealing with Conflicts</a></li>
<li><a href="r-packages-used-in-these-notes.html#general-theme-for-ggplot-work">General Theme for <code>ggplot</code> work</a></li>
<li class="chapter" data-level="" data-path="r-packages-used-in-these-notes.html"><a href="r-packages-used-in-these-notes.html#data-used-in-these-notes"><i class="fa fa-check"></i>Data used in these notes</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="building-table-1.html"><a href="building-table-1.html"><i class="fa fa-check"></i><b>1</b> Building Table 1</a>
<ul>
<li class="chapter" data-level="1.1" data-path="building-table-1.html"><a href="building-table-1.html#data-load"><i class="fa fa-check"></i><b>1.1</b> Data load</a></li>
<li class="chapter" data-level="1.2" data-path="building-table-1.html"><a href="building-table-1.html#two-examples-from-the-new-england-journal-of-medicine"><i class="fa fa-check"></i><b>1.2</b> Two examples from the <em>New England Journal of Medicine</em></a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="building-table-1.html"><a href="building-table-1.html#a-simple-table-1"><i class="fa fa-check"></i><b>1.2.1</b> A simple Table 1</a></li>
<li class="chapter" data-level="1.2.2" data-path="building-table-1.html"><a href="building-table-1.html#a-group-comparison"><i class="fa fa-check"></i><b>1.2.2</b> A group comparison</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="building-table-1.html"><a href="building-table-1.html#the-mr-clean-trial"><i class="fa fa-check"></i><b>1.3</b> The MR CLEAN trial</a></li>
<li class="chapter" data-level="1.4" data-path="building-table-1.html"><a href="building-table-1.html#simulated-fakestroke-data"><i class="fa fa-check"></i><b>1.4</b> Simulated <code>fakestroke</code> data</a></li>
<li class="chapter" data-level="1.5" data-path="building-table-1.html"><a href="building-table-1.html#building-table-1-for-fakestroke-attempt-1"><i class="fa fa-check"></i><b>1.5</b> Building Table 1 for <code>fakestroke</code>: Attempt 1</a>
<ul>
<li class="chapter" data-level="1.5.1" data-path="building-table-1.html"><a href="building-table-1.html#some-of-this-is-very-useful-and-other-parts-need-to-be-fixed."><i class="fa fa-check"></i><b>1.5.1</b> Some of this is very useful, and other parts need to be fixed.</a></li>
<li class="chapter" data-level="1.5.2" data-path="building-table-1.html"><a href="building-table-1.html#fakestroke-cleaning-up-categorical-variables"><i class="fa fa-check"></i><b>1.5.2</b> <code>fakestroke</code> Cleaning Up Categorical Variables</a></li>
</ul></li>
<li class="chapter" data-level="1.6" data-path="building-table-1.html"><a href="building-table-1.html#fakestroke-table-1-attempt-2"><i class="fa fa-check"></i><b>1.6</b> <code>fakestroke</code> Table 1: Attempt 2</a>
<ul>
<li class="chapter" data-level="1.6.1" data-path="building-table-1.html"><a href="building-table-1.html#what-summaries-should-we-show"><i class="fa fa-check"></i><b>1.6.1</b> What summaries should we show?</a></li>
</ul></li>
<li class="chapter" data-level="1.7" data-path="building-table-1.html"><a href="building-table-1.html#obtaining-a-more-detailed-summary"><i class="fa fa-check"></i><b>1.7</b> Obtaining a more detailed Summary</a></li>
<li class="chapter" data-level="1.8" data-path="building-table-1.html"><a href="building-table-1.html#exporting-the-completed-table-1-from-r-to-excel-or-word"><i class="fa fa-check"></i><b>1.8</b> Exporting the Completed Table 1 from R to Excel or Word</a>
<ul>
<li class="chapter" data-level="1.8.1" data-path="building-table-1.html"><a href="building-table-1.html#approach-a-save-and-open-in-excel"><i class="fa fa-check"></i><b>1.8.1</b> Approach A: Save and open in Excel</a></li>
<li class="chapter" data-level="1.8.2" data-path="building-table-1.html"><a href="building-table-1.html#approach-b-produce-the-table-so-you-can-cut-and-paste-it"><i class="fa fa-check"></i><b>1.8.2</b> Approach B: Produce the Table so you can cut and paste it</a></li>
</ul></li>
<li class="chapter" data-level="1.9" data-path="building-table-1.html"><a href="building-table-1.html#a-controlled-biological-experiment---the-blood-brain-barrier"><i class="fa fa-check"></i><b>1.9</b> A Controlled Biological Experiment - The Blood-Brain Barrier</a></li>
<li class="chapter" data-level="1.10" data-path="building-table-1.html"><a href="building-table-1.html#the-bloodbrain.csv-file"><i class="fa fa-check"></i><b>1.10</b> The <code>bloodbrain.csv</code> file</a></li>
<li class="chapter" data-level="1.11" data-path="building-table-1.html"><a href="building-table-1.html#a-table-1-for-bloodbrain"><i class="fa fa-check"></i><b>1.11</b> A Table 1 for <code>bloodbrain</code></a>
<ul>
<li class="chapter" data-level="1.11.1" data-path="building-table-1.html"><a href="building-table-1.html#generate-final-table-1-for-bloodbrain"><i class="fa fa-check"></i><b>1.11.1</b> Generate final Table 1 for <code>bloodbrain</code></a></li>
<li class="chapter" data-level="1.11.2" data-path="building-table-1.html"><a href="building-table-1.html#a-more-finished-version-after-cleanup-in-word"><i class="fa fa-check"></i><b>1.11.2</b> A More Finished Version (after Cleanup in Word)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="brfss-smart-data-building.html"><a href="brfss-smart-data-building.html"><i class="fa fa-check"></i><b>2</b> BRFSS SMART Data Building</a>
<ul>
<li class="chapter" data-level="2.1" data-path="brfss-smart-data-building.html"><a href="brfss-smart-data-building.html#key-resources"><i class="fa fa-check"></i><b>2.1</b> Key resources</a></li>
<li class="chapter" data-level="2.2" data-path="brfss-smart-data-building.html"><a href="brfss-smart-data-building.html#ingesting-the-raw-data"><i class="fa fa-check"></i><b>2.2</b> Ingesting the Raw Data</a></li>
<li class="chapter" data-level="2.3" data-path="brfss-smart-data-building.html"><a href="brfss-smart-data-building.html#ingesting-from-our-csv-file"><i class="fa fa-check"></i><b>2.3</b> Ingesting from our CSV file</a></li>
<li class="chapter" data-level="2.4" data-path="brfss-smart-data-building.html"><a href="brfss-smart-data-building.html#what-does-the-raw-data-look-like"><i class="fa fa-check"></i><b>2.4</b> What does the raw data look like?</a></li>
<li class="chapter" data-level="2.5" data-path="brfss-smart-data-building.html"><a href="brfss-smart-data-building.html#cleaning-the-brfss-data"><i class="fa fa-check"></i><b>2.5</b> Cleaning the BRFSS Data</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="brfss-smart-data-building.html"><a href="brfss-smart-data-building.html#identifying-information"><i class="fa fa-check"></i><b>2.5.1</b> Identifying Information</a></li>
<li class="chapter" data-level="2.5.2" data-path="brfss-smart-data-building.html"><a href="brfss-smart-data-building.html#survey-method"><i class="fa fa-check"></i><b>2.5.2</b> Survey Method</a></li>
<li class="chapter" data-level="2.5.3" data-path="brfss-smart-data-building.html"><a href="brfss-smart-data-building.html#health-status-1-item"><i class="fa fa-check"></i><b>2.5.3</b> Health Status (1 item)</a></li>
<li class="chapter" data-level="2.5.4" data-path="brfss-smart-data-building.html"><a href="brfss-smart-data-building.html#healthy-days---health-related-quality-of-life-3-items"><i class="fa fa-check"></i><b>2.5.4</b> Healthy Days - Health-Related Quality of Life (3 items)</a></li>
<li class="chapter" data-level="2.5.5" data-path="brfss-smart-data-building.html"><a href="brfss-smart-data-building.html#health-care-access-4-items"><i class="fa fa-check"></i><b>2.5.5</b> Health Care Access (4 items)</a></li>
<li class="chapter" data-level="2.5.6" data-path="brfss-smart-data-building.html"><a href="brfss-smart-data-building.html#blood-pressure-2-measures"><i class="fa fa-check"></i><b>2.5.6</b> Blood Pressure (2 measures)</a></li>
<li class="chapter" data-level="2.5.7" data-path="brfss-smart-data-building.html"><a href="brfss-smart-data-building.html#cholesterol-3-items"><i class="fa fa-check"></i><b>2.5.7</b> Cholesterol (3 items)</a></li>
<li class="chapter" data-level="2.5.8" data-path="brfss-smart-data-building.html"><a href="brfss-smart-data-building.html#chronic-health-conditions-14-items"><i class="fa fa-check"></i><b>2.5.8</b> Chronic Health Conditions (14 items)</a></li>
<li class="chapter" data-level="2.5.9" data-path="brfss-smart-data-building.html"><a href="brfss-smart-data-building.html#arthritis-burden-4-items"><i class="fa fa-check"></i><b>2.5.9</b> Arthritis Burden (4 items)</a></li>
<li class="chapter" data-level="2.5.10" data-path="brfss-smart-data-building.html"><a href="brfss-smart-data-building.html#demographics-25-items"><i class="fa fa-check"></i><b>2.5.10</b> Demographics (25 items)</a></li>
<li class="chapter" data-level="2.5.11" data-path="brfss-smart-data-building.html"><a href="brfss-smart-data-building.html#tobacco-use-2-items"><i class="fa fa-check"></i><b>2.5.11</b> Tobacco Use (2 items)</a></li>
<li class="chapter" data-level="2.5.12" data-path="brfss-smart-data-building.html"><a href="brfss-smart-data-building.html#e-cigarettes-2-items"><i class="fa fa-check"></i><b>2.5.12</b> E-Cigarettes (2 items)</a></li>
<li class="chapter" data-level="2.5.13" data-path="brfss-smart-data-building.html"><a href="brfss-smart-data-building.html#alcohol-consumption-6-items"><i class="fa fa-check"></i><b>2.5.13</b> Alcohol Consumption (6 items)</a></li>
<li class="chapter" data-level="2.5.14" data-path="brfss-smart-data-building.html"><a href="brfss-smart-data-building.html#fruits-and-vegetables-8-items"><i class="fa fa-check"></i><b>2.5.14</b> Fruits and Vegetables (8 items)</a></li>
<li class="chapter" data-level="2.5.15" data-path="brfss-smart-data-building.html"><a href="brfss-smart-data-building.html#exercise-and-physical-activity-8-items"><i class="fa fa-check"></i><b>2.5.15</b> Exercise and Physical Activity (8 items)</a></li>
<li class="chapter" data-level="2.5.16" data-path="brfss-smart-data-building.html"><a href="brfss-smart-data-building.html#seatbelt-use-1-item"><i class="fa fa-check"></i><b>2.5.16</b> Seatbelt Use (1 item)</a></li>
<li class="chapter" data-level="2.5.17" data-path="brfss-smart-data-building.html"><a href="brfss-smart-data-building.html#immunization-3-items"><i class="fa fa-check"></i><b>2.5.17</b> Immunization (3 items)</a></li>
<li class="chapter" data-level="2.5.18" data-path="brfss-smart-data-building.html"><a href="brfss-smart-data-building.html#hivaids-2-items"><i class="fa fa-check"></i><b>2.5.18</b> HIV/AIDS (2 items)</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="brfss-smart-data-building.html"><a href="brfss-smart-data-building.html#imputing-age-and-income-as-quantitative-from-thin-air"><i class="fa fa-check"></i><b>2.6</b> Imputing Age and Income as Quantitative from Thin Air</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="brfss-smart-data-building.html"><a href="brfss-smart-data-building.html#age_imp-imputing-age-data"><i class="fa fa-check"></i><b>2.6.1</b> <code>age_imp</code>: Imputing Age Data</a></li>
<li class="chapter" data-level="2.6.2" data-path="brfss-smart-data-building.html"><a href="brfss-smart-data-building.html#inc_imp-imputing-income-data"><i class="fa fa-check"></i><b>2.6.2</b> <code>inc_imp</code>: Imputing Income Data</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="brfss-smart-data-building.html"><a href="brfss-smart-data-building.html#clean-data-in-the-state-of-ohio"><i class="fa fa-check"></i><b>2.7</b> Clean Data in the State of Ohio</a></li>
<li class="chapter" data-level="2.8" data-path="brfss-smart-data-building.html"><a href="brfss-smart-data-building.html#clean-cleveland-elyria-data"><i class="fa fa-check"></i><b>2.8</b> Clean Cleveland-Elyria Data</a>
<ul>
<li class="chapter" data-level="2.8.1" data-path="brfss-smart-data-building.html"><a href="brfss-smart-data-building.html#cleveland---elyria-data"><i class="fa fa-check"></i><b>2.8.1</b> Cleveland - Elyria Data</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="dealing-with-missingness-single-imputation.html"><a href="dealing-with-missingness-single-imputation.html"><i class="fa fa-check"></i><b>3</b> Dealing with Missingness: Single Imputation</a>
<ul>
<li class="chapter" data-level="3.1" data-path="dealing-with-missingness-single-imputation.html"><a href="dealing-with-missingness-single-imputation.html#selecting-some-variables-from-the-smart_cle-data"><i class="fa fa-check"></i><b>3.1</b> Selecting Some Variables from the <code>smart_cle</code> data</a></li>
<li class="chapter" data-level="3.2" data-path="dealing-with-missingness-single-imputation.html"><a href="dealing-with-missingness-single-imputation.html#smart_cle1-seeing-our-missing-data"><i class="fa fa-check"></i><b>3.2</b> <code>smart_cle1</code>: Seeing our Missing Data</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="dealing-with-missingness-single-imputation.html"><a href="dealing-with-missingness-single-imputation.html#plotting-missingness"><i class="fa fa-check"></i><b>3.2.1</b> Plotting Missingness</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="dealing-with-missingness-single-imputation.html"><a href="dealing-with-missingness-single-imputation.html#missing-data-mechanisms"><i class="fa fa-check"></i><b>3.3</b> Missing-data mechanisms</a></li>
<li class="chapter" data-level="3.4" data-path="dealing-with-missingness-single-imputation.html"><a href="dealing-with-missingness-single-imputation.html#options-for-dealing-with-missingness"><i class="fa fa-check"></i><b>3.4</b> Options for Dealing with Missingness</a></li>
<li class="chapter" data-level="3.5" data-path="dealing-with-missingness-single-imputation.html"><a href="dealing-with-missingness-single-imputation.html#complete-case-and-available-case-analyses"><i class="fa fa-check"></i><b>3.5</b> Complete Case (and Available Case) analyses</a></li>
<li class="chapter" data-level="3.6" data-path="dealing-with-missingness-single-imputation.html"><a href="dealing-with-missingness-single-imputation.html#single-imputation"><i class="fa fa-check"></i><b>3.6</b> Single Imputation</a></li>
<li class="chapter" data-level="3.7" data-path="dealing-with-missingness-single-imputation.html"><a href="dealing-with-missingness-single-imputation.html#multiple-imputation"><i class="fa fa-check"></i><b>3.7</b> Multiple Imputation</a></li>
<li class="chapter" data-level="3.8" data-path="dealing-with-missingness-single-imputation.html"><a href="dealing-with-missingness-single-imputation.html#approach-1-building-a-complete-case-analysis-smart_cle1_cc"><i class="fa fa-check"></i><b>3.8</b> Approach 1: Building a Complete Case Analysis: <code>smart_cle1_cc</code></a></li>
<li class="chapter" data-level="3.9" data-path="dealing-with-missingness-single-imputation.html"><a href="dealing-with-missingness-single-imputation.html#approach-2-single-imputation-to-create-smart_cle1_sh"><i class="fa fa-check"></i><b>3.9</b> Approach 2: Single Imputation to create <code>smart_cle1_sh</code></a>
<ul>
<li class="chapter" data-level="3.9.1" data-path="dealing-with-missingness-single-imputation.html"><a href="dealing-with-missingness-single-imputation.html#what-type-of-missingness-do-we-have"><i class="fa fa-check"></i><b>3.9.1</b> What Type of Missingness Do We Have?</a></li>
<li class="chapter" data-level="3.9.2" data-path="dealing-with-missingness-single-imputation.html"><a href="dealing-with-missingness-single-imputation.html#single-imputation-into-smart_cle1_sh"><i class="fa fa-check"></i><b>3.9.2</b> Single imputation into <code>smart_cle1_sh</code></a></li>
<li class="chapter" data-level="3.9.3" data-path="dealing-with-missingness-single-imputation.html"><a href="dealing-with-missingness-single-imputation.html#imputing-binary-categorical-variables"><i class="fa fa-check"></i><b>3.9.3</b> Imputing Binary Categorical Variables</a></li>
<li class="chapter" data-level="3.9.4" data-path="dealing-with-missingness-single-imputation.html"><a href="dealing-with-missingness-single-imputation.html#imputing-quantitative-variables"><i class="fa fa-check"></i><b>3.9.4</b> Imputing Quantitative Variables</a></li>
<li class="chapter" data-level="3.9.5" data-path="dealing-with-missingness-single-imputation.html"><a href="dealing-with-missingness-single-imputation.html#imputation-results"><i class="fa fa-check"></i><b>3.9.5</b> Imputation Results</a></li>
<li class="chapter" data-level="3.9.6" data-path="dealing-with-missingness-single-imputation.html"><a href="dealing-with-missingness-single-imputation.html#imputing-multi-categorical-variables"><i class="fa fa-check"></i><b>3.9.6</b> Imputing Multi-Categorical Variables</a></li>
<li class="chapter" data-level="3.9.7" data-path="dealing-with-missingness-single-imputation.html"><a href="dealing-with-missingness-single-imputation.html#saving-the-new-tibbles"><i class="fa fa-check"></i><b>3.9.7</b> Saving the new tibbles</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="summarizing-the-smart-cle1-data.html"><a href="summarizing-the-smart-cle1-data.html"><i class="fa fa-check"></i><b>4</b> Summarizing the <code>smart_cle1</code> data</a>
<ul>
<li class="chapter" data-level="4.1" data-path="summarizing-the-smart-cle1-data.html"><a href="summarizing-the-smart-cle1-data.html#general-approaches-to-obtaining-numeric-summaries"><i class="fa fa-check"></i><b>4.1</b> General Approaches to Obtaining Numeric Summaries</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="summarizing-the-smart-cle1-data.html"><a href="summarizing-the-smart-cle1-data.html#summary-for-a-data-frame"><i class="fa fa-check"></i><b>4.1.1</b> <code>summary</code> for a data frame</a></li>
<li class="chapter" data-level="4.1.2" data-path="summarizing-the-smart-cle1-data.html"><a href="summarizing-the-smart-cle1-data.html#the-inspect-function-from-the-mosaic-package"><i class="fa fa-check"></i><b>4.1.2</b> The <code>inspect</code> function from the <code>mosaic</code> package</a></li>
<li class="chapter" data-level="4.1.3" data-path="summarizing-the-smart-cle1-data.html"><a href="summarizing-the-smart-cle1-data.html#the-describe-function-in-hmisc"><i class="fa fa-check"></i><b>4.1.3</b> The <code>describe</code> function in <code>Hmisc</code></a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="summarizing-the-smart-cle1-data.html"><a href="summarizing-the-smart-cle1-data.html#counting-as-exploratory-data-analysis"><i class="fa fa-check"></i><b>4.2</b> Counting as exploratory data analysis</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="summarizing-the-smart-cle1-data.html"><a href="summarizing-the-smart-cle1-data.html#did-genhealth-vary-by-smoking-status"><i class="fa fa-check"></i><b>4.2.1</b> Did <code>genhealth</code> vary by smoking status?</a></li>
<li class="chapter" data-level="4.2.2" data-path="summarizing-the-smart-cle1-data.html"><a href="summarizing-the-smart-cle1-data.html#whats-the-distribution-of-physhealth"><i class="fa fa-check"></i><b>4.2.2</b> What’s the distribution of <code>physhealth</code>?</a></li>
<li class="chapter" data-level="4.2.3" data-path="summarizing-the-smart-cle1-data.html"><a href="summarizing-the-smart-cle1-data.html#whats-the-distribution-of-bmi"><i class="fa fa-check"></i><b>4.2.3</b> What’s the distribution of <code>bmi</code>?</a></li>
<li class="chapter" data-level="4.2.4" data-path="summarizing-the-smart-cle1-data.html"><a href="summarizing-the-smart-cle1-data.html#how-many-of-the-respondents-have-a-bmi-below-30"><i class="fa fa-check"></i><b>4.2.4</b> How many of the respondents have a BMI below 30?</a></li>
<li class="chapter" data-level="4.2.5" data-path="summarizing-the-smart-cle1-data.html"><a href="summarizing-the-smart-cle1-data.html#how-many-of-the-respondents-with-a-bmi-30-are-highly-active"><i class="fa fa-check"></i><b>4.2.5</b> How many of the respondents with a BMI &lt; 30 are highly active?</a></li>
<li class="chapter" data-level="4.2.6" data-path="summarizing-the-smart-cle1-data.html"><a href="summarizing-the-smart-cle1-data.html#is-obesity-associated-with-smoking-history"><i class="fa fa-check"></i><b>4.2.6</b> Is obesity associated with smoking history?</a></li>
<li class="chapter" data-level="4.2.7" data-path="summarizing-the-smart-cle1-data.html"><a href="summarizing-the-smart-cle1-data.html#comparing-drinks_wk-summaries-by-obesity-status"><i class="fa fa-check"></i><b>4.2.7</b> Comparing <code>drinks_wk</code> summaries by obesity status</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="summarizing-the-smart-cle1-data.html"><a href="summarizing-the-smart-cle1-data.html#can-bmi-predict-physhealth"><i class="fa fa-check"></i><b>4.3</b> Can <code>bmi</code> predict <code>physhealth</code>?</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="summarizing-the-smart-cle1-data.html"><a href="summarizing-the-smart-cle1-data.html#fitting-a-simple-regression-model"><i class="fa fa-check"></i><b>4.3.1</b> Fitting a Simple Regression Model</a></li>
<li class="chapter" data-level="4.3.2" data-path="summarizing-the-smart-cle1-data.html"><a href="summarizing-the-smart-cle1-data.html#model-summary-for-a-simple-one-predictor-regression"><i class="fa fa-check"></i><b>4.3.2</b> Model Summary for a Simple (One-Predictor) Regression</a></li>
<li class="chapter" data-level="4.3.3" data-path="summarizing-the-smart-cle1-data.html"><a href="summarizing-the-smart-cle1-data.html#using-the-broom-package"><i class="fa fa-check"></i><b>4.3.3</b> Using the <code>broom</code> package</a></li>
<li class="chapter" data-level="4.3.4" data-path="summarizing-the-smart-cle1-data.html"><a href="summarizing-the-smart-cle1-data.html#how-does-the-model-do-residuals-vs.-fitted-values"><i class="fa fa-check"></i><b>4.3.4</b> How does the model do? (Residuals vs. Fitted Values)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="analysis-of-variance-with-smart.html"><a href="analysis-of-variance-with-smart.html"><i class="fa fa-check"></i><b>5</b> Analysis of Variance with SMART</a>
<ul>
<li class="chapter" data-level="5.1" data-path="analysis-of-variance-with-smart.html"><a href="analysis-of-variance-with-smart.html#a-one-factor-analysis-of-variance"><i class="fa fa-check"></i><b>5.1</b> A One-Factor Analysis of Variance</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="analysis-of-variance-with-smart.html"><a href="analysis-of-variance-with-smart.html#can-activity-be-used-to-predict-bmi"><i class="fa fa-check"></i><b>5.1.1</b> Can <code>activity</code> be used to predict <code>bmi</code>?</a></li>
<li class="chapter" data-level="5.1.2" data-path="analysis-of-variance-with-smart.html"><a href="analysis-of-variance-with-smart.html#should-we-transform-bmi"><i class="fa fa-check"></i><b>5.1.2</b> Should we transform <code>bmi</code>?</a></li>
<li class="chapter" data-level="5.1.3" data-path="analysis-of-variance-with-smart.html"><a href="analysis-of-variance-with-smart.html#building-the-anova-model"><i class="fa fa-check"></i><b>5.1.3</b> Building the ANOVA model</a></li>
<li class="chapter" data-level="5.1.4" data-path="analysis-of-variance-with-smart.html"><a href="analysis-of-variance-with-smart.html#the-anova-table"><i class="fa fa-check"></i><b>5.1.4</b> The ANOVA table</a></li>
<li class="chapter" data-level="5.1.5" data-path="analysis-of-variance-with-smart.html"><a href="analysis-of-variance-with-smart.html#the-model-coefficients"><i class="fa fa-check"></i><b>5.1.5</b> The Model Coefficients</a></li>
<li class="chapter" data-level="5.1.6" data-path="analysis-of-variance-with-smart.html"><a href="analysis-of-variance-with-smart.html#using-broomtidy-to-explore-the-coefficients"><i class="fa fa-check"></i><b>5.1.6</b> Using <code>broom::tidy</code> to explore the coefficients</a></li>
<li class="chapter" data-level="5.1.7" data-path="analysis-of-variance-with-smart.html"><a href="analysis-of-variance-with-smart.html#using-broomglance-to-summarize-the-models-fit"><i class="fa fa-check"></i><b>5.1.7</b> Using <code>broom::glance</code> to summarize the model’s fit</a></li>
<li class="chapter" data-level="5.1.8" data-path="analysis-of-variance-with-smart.html"><a href="analysis-of-variance-with-smart.html#using-broomaugment-to-make-predictions"><i class="fa fa-check"></i><b>5.1.8</b> Using <code>broom::augment</code> to make predictions</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="analysis-of-variance-with-smart.html"><a href="analysis-of-variance-with-smart.html#a-two-factor-anova-without-interaction"><i class="fa fa-check"></i><b>5.2</b> A Two-Factor ANOVA (without Interaction)</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="analysis-of-variance-with-smart.html"><a href="analysis-of-variance-with-smart.html#model-coefficients"><i class="fa fa-check"></i><b>5.2.1</b> Model Coefficients</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="analysis-of-variance-with-smart.html"><a href="analysis-of-variance-with-smart.html#a-two-factor-anova-with-interaction"><i class="fa fa-check"></i><b>5.3</b> A Two-Factor ANOVA (with Interaction)</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="analysis-of-variance-with-smart.html"><a href="analysis-of-variance-with-smart.html#model-coefficients-1"><i class="fa fa-check"></i><b>5.3.1</b> Model Coefficients</a></li>
<li class="chapter" data-level="5.3.2" data-path="analysis-of-variance-with-smart.html"><a href="analysis-of-variance-with-smart.html#is-the-interaction-term-necessary"><i class="fa fa-check"></i><b>5.3.2</b> Is the interaction term necessary?</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="analysis-of-variance.html"><a href="analysis-of-variance.html"><i class="fa fa-check"></i><b>6</b> Analysis of Variance</a>
<ul>
<li class="chapter" data-level="6.1" data-path="analysis-of-variance.html"><a href="analysis-of-variance.html#the-bonding-data-a-designed-dental-experiment"><i class="fa fa-check"></i><b>6.1</b> The <code>bonding</code> data: A Designed Dental Experiment</a></li>
<li class="chapter" data-level="6.2" data-path="analysis-of-variance.html"><a href="analysis-of-variance.html#a-one-factor-analysis-of-variance-1"><i class="fa fa-check"></i><b>6.2</b> A One-Factor Analysis of Variance</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="analysis-of-variance.html"><a href="analysis-of-variance.html#look-at-the-data"><i class="fa fa-check"></i><b>6.2.1</b> Look at the Data!</a></li>
<li class="chapter" data-level="6.2.2" data-path="analysis-of-variance.html"><a href="analysis-of-variance.html#table-of-summary-statistics"><i class="fa fa-check"></i><b>6.2.2</b> Table of Summary Statistics</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="analysis-of-variance.html"><a href="analysis-of-variance.html#a-two-way-anova-looking-at-two-factors"><i class="fa fa-check"></i><b>6.3</b> A Two-Way ANOVA: Looking at Two Factors</a></li>
<li class="chapter" data-level="6.4" data-path="analysis-of-variance.html"><a href="analysis-of-variance.html#a-means-plot-with-standard-deviations-to-check-for-interaction"><i class="fa fa-check"></i><b>6.4</b> A Means Plot (with standard deviations) to check for interaction</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="analysis-of-variance.html"><a href="analysis-of-variance.html#summarizing-the-data-after-grouping-by-resin-and-light"><i class="fa fa-check"></i><b>6.4.1</b> Summarizing the data after grouping by <code>resin</code> and <code>light</code></a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="analysis-of-variance.html"><a href="analysis-of-variance.html#fitting-the-two-way-anova-model-with-interaction"><i class="fa fa-check"></i><b>6.5</b> Fitting the Two-Way ANOVA model with Interaction</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="analysis-of-variance.html"><a href="analysis-of-variance.html#the-anova-table-for-our-model"><i class="fa fa-check"></i><b>6.5.1</b> The ANOVA table for our model</a></li>
<li class="chapter" data-level="6.5.2" data-path="analysis-of-variance.html"><a href="analysis-of-variance.html#is-the-interaction-important"><i class="fa fa-check"></i><b>6.5.2</b> Is the interaction important?</a></li>
<li class="chapter" data-level="6.5.3" data-path="analysis-of-variance.html"><a href="analysis-of-variance.html#interpreting-the-interaction"><i class="fa fa-check"></i><b>6.5.3</b> Interpreting the Interaction</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="analysis-of-variance.html"><a href="analysis-of-variance.html#comparing-individual-combinations-of-resin-and-light"><i class="fa fa-check"></i><b>6.6</b> Comparing Individual Combinations of <code>resin</code> and <code>light</code></a></li>
<li class="chapter" data-level="6.7" data-path="analysis-of-variance.html"><a href="analysis-of-variance.html#the-bonding-model-without-interaction"><i class="fa fa-check"></i><b>6.7</b> The <code>bonding</code> model without Interaction</a></li>
<li class="chapter" data-level="6.8" data-path="analysis-of-variance.html"><a href="analysis-of-variance.html#cortisol-a-hypothetical-clinical-trial"><i class="fa fa-check"></i><b>6.8</b> <code>cortisol</code>: A Hypothetical Clinical Trial</a>
<ul>
<li class="chapter" data-level="6.8.1" data-path="analysis-of-variance.html"><a href="analysis-of-variance.html#codebook-and-raw-data-for-cortisol"><i class="fa fa-check"></i><b>6.8.1</b> Codebook and Raw Data for <code>cortisol</code></a></li>
</ul></li>
<li class="chapter" data-level="6.9" data-path="analysis-of-variance.html"><a href="analysis-of-variance.html#creating-a-factor-combining-sex-and-waist"><i class="fa fa-check"></i><b>6.9</b> Creating a factor combining sex and waist</a></li>
<li class="chapter" data-level="6.10" data-path="analysis-of-variance.html"><a href="analysis-of-variance.html#a-means-plot-for-the-cortisol-trial-with-standard-errors"><i class="fa fa-check"></i><b>6.10</b> A Means Plot for the <code>cortisol</code> trial (with standard errors)</a></li>
<li class="chapter" data-level="6.11" data-path="analysis-of-variance.html"><a href="analysis-of-variance.html#a-two-way-anova-model-for-cortisol-with-interaction"><i class="fa fa-check"></i><b>6.11</b> A Two-Way ANOVA model for <code>cortisol</code> with Interaction</a></li>
<li class="chapter" data-level="6.12" data-path="analysis-of-variance.html"><a href="analysis-of-variance.html#a-two-way-anova-model-for-cortisol-without-interaction"><i class="fa fa-check"></i><b>6.12</b> A Two-Way ANOVA model for <code>cortisol</code> without Interaction</a>
<ul>
<li class="chapter" data-level="6.12.1" data-path="analysis-of-variance.html"><a href="analysis-of-variance.html#the-graph"><i class="fa fa-check"></i><b>6.12.1</b> The Graph</a></li>
<li class="chapter" data-level="6.12.2" data-path="analysis-of-variance.html"><a href="analysis-of-variance.html#the-anova-model"><i class="fa fa-check"></i><b>6.12.2</b> The ANOVA Model</a></li>
<li class="chapter" data-level="6.12.3" data-path="analysis-of-variance.html"><a href="analysis-of-variance.html#the-regression-summary"><i class="fa fa-check"></i><b>6.12.3</b> The Regression Summary</a></li>
<li class="chapter" data-level="6.12.4" data-path="analysis-of-variance.html"><a href="analysis-of-variance.html#tukey-hsd-comparisons"><i class="fa fa-check"></i><b>6.12.4</b> Tukey HSD Comparisons</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="analysis-of-covariance.html"><a href="analysis-of-covariance.html"><i class="fa fa-check"></i><b>7</b> Analysis of Covariance</a>
<ul>
<li class="chapter" data-level="7.1" data-path="analysis-of-covariance.html"><a href="analysis-of-covariance.html#an-emphysema-study"><i class="fa fa-check"></i><b>7.1</b> An Emphysema Study</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="analysis-of-covariance.html"><a href="analysis-of-covariance.html#codebook"><i class="fa fa-check"></i><b>7.1.1</b> Codebook</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="analysis-of-covariance.html"><a href="analysis-of-covariance.html#does-sex-affect-the-mean-change-in-theophylline"><i class="fa fa-check"></i><b>7.2</b> Does <code>sex</code> affect the mean change in theophylline?</a></li>
<li class="chapter" data-level="7.3" data-path="analysis-of-covariance.html"><a href="analysis-of-covariance.html#is-there-an-association-between-age-and-sex-in-this-study"><i class="fa fa-check"></i><b>7.3</b> Is there an association between <code>age</code> and <code>sex</code> in this study?</a></li>
<li class="chapter" data-level="7.4" data-path="analysis-of-covariance.html"><a href="analysis-of-covariance.html#adding-a-quantitative-covariate-age-to-the-model"><i class="fa fa-check"></i><b>7.4</b> Adding a quantitative covariate, <code>age</code>, to the model</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="analysis-of-covariance.html"><a href="analysis-of-covariance.html#the-ancova-model"><i class="fa fa-check"></i><b>7.4.1</b> The ANCOVA model</a></li>
<li class="chapter" data-level="7.4.2" data-path="analysis-of-covariance.html"><a href="analysis-of-covariance.html#the-ancova-table"><i class="fa fa-check"></i><b>7.4.2</b> The ANCOVA Table</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="analysis-of-covariance.html"><a href="analysis-of-covariance.html#rerunning-the-ancova-model-after-simple-imputation"><i class="fa fa-check"></i><b>7.5</b> Rerunning the ANCOVA model after simple imputation</a></li>
<li class="chapter" data-level="7.6" data-path="analysis-of-covariance.html"><a href="analysis-of-covariance.html#looking-at-a-factor-covariate-interaction"><i class="fa fa-check"></i><b>7.6</b> Looking at a factor-covariate interaction</a></li>
<li class="chapter" data-level="7.7" data-path="analysis-of-covariance.html"><a href="analysis-of-covariance.html#centering-the-covariate-to-facilitate-ancova-interpretation"><i class="fa fa-check"></i><b>7.7</b> Centering the Covariate to Facilitate ANCOVA Interpretation</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="analysis-of-covariance-with-the-smart-data.html"><a href="analysis-of-covariance-with-the-smart-data.html"><i class="fa fa-check"></i><b>8</b> Analysis of Covariance with the SMART data</a>
<ul>
<li class="chapter" data-level="8.1" data-path="analysis-of-covariance-with-the-smart-data.html"><a href="analysis-of-covariance-with-the-smart-data.html#a-new-small-study-predicting-bmi"><i class="fa fa-check"></i><b>8.1</b> A New Small Study: Predicting BMI</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="analysis-of-covariance-with-the-smart-data.html"><a href="analysis-of-covariance-with-the-smart-data.html#does-female-predict-bmi-well"><i class="fa fa-check"></i><b>8.1.1</b> Does <code>female</code> predict <code>bmi</code> well?</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="analysis-of-covariance-with-the-smart-data.html"><a href="analysis-of-covariance-with-the-smart-data.html#c8_m1-a-simple-t-test-model"><i class="fa fa-check"></i><b>8.2</b> <code>c8_m1</code>: A simple t-test model</a></li>
<li class="chapter" data-level="8.3" data-path="analysis-of-covariance-with-the-smart-data.html"><a href="analysis-of-covariance-with-the-smart-data.html#c8_m2-adding-another-predictor-two-way-anova-without-interaction"><i class="fa fa-check"></i><b>8.3</b> <code>c8_m2</code>: Adding another predictor (two-way ANOVA without interaction)</a></li>
<li class="chapter" data-level="8.4" data-path="analysis-of-covariance-with-the-smart-data.html"><a href="analysis-of-covariance-with-the-smart-data.html#c8_m3-adding-the-interaction-term-two-way-anova-with-interaction"><i class="fa fa-check"></i><b>8.4</b> <code>c8_m3</code>: Adding the interaction term (Two-way ANOVA with interaction)</a></li>
<li class="chapter" data-level="8.5" data-path="analysis-of-covariance-with-the-smart-data.html"><a href="analysis-of-covariance-with-the-smart-data.html#c8_m4-using-female-and-physhealth-in-a-model-for-bmi"><i class="fa fa-check"></i><b>8.5</b> <code>c8_m4</code>: Using <code>female</code> and <code>physhealth</code> in a model for <code>bmi</code></a></li>
<li class="chapter" data-level="8.6" data-path="analysis-of-covariance-with-the-smart-data.html"><a href="analysis-of-covariance-with-the-smart-data.html#making-predictions-with-a-linear-regression-model"><i class="fa fa-check"></i><b>8.6</b> Making Predictions with a Linear Regression Model</a>
<ul>
<li class="chapter" data-level="8.6.1" data-path="analysis-of-covariance-with-the-smart-data.html"><a href="analysis-of-covariance-with-the-smart-data.html#fitting-an-individual-prediction-and-95-prediction-interval"><i class="fa fa-check"></i><b>8.6.1</b> Fitting an Individual Prediction and 95% Prediction Interval</a></li>
<li class="chapter" data-level="8.6.2" data-path="analysis-of-covariance-with-the-smart-data.html"><a href="analysis-of-covariance-with-the-smart-data.html#confidence-interval-for-an-average-prediction"><i class="fa fa-check"></i><b>8.6.2</b> Confidence Interval for an Average Prediction</a></li>
<li class="chapter" data-level="8.6.3" data-path="analysis-of-covariance-with-the-smart-data.html"><a href="analysis-of-covariance-with-the-smart-data.html#fitting-multiple-individual-predictions-to-new-data"><i class="fa fa-check"></i><b>8.6.3</b> Fitting Multiple Individual Predictions to New Data</a></li>
</ul></li>
<li class="chapter" data-level="8.7" data-path="analysis-of-covariance-with-the-smart-data.html"><a href="analysis-of-covariance-with-the-smart-data.html#centering-the-model"><i class="fa fa-check"></i><b>8.7</b> Centering the model</a>
<ul>
<li class="chapter" data-level="8.7.1" data-path="analysis-of-covariance-with-the-smart-data.html"><a href="analysis-of-covariance-with-the-smart-data.html#plot-of-model-4-on-centered-physhealth-c8_m4_c"><i class="fa fa-check"></i><b>8.7.1</b> Plot of Model 4 on Centered <code>physhealth</code>: <code>c8_m4_c</code></a></li>
</ul></li>
<li class="chapter" data-level="8.8" data-path="analysis-of-covariance-with-the-smart-data.html"><a href="analysis-of-covariance-with-the-smart-data.html#rescaling-an-input-by-subtracting-the-mean-and-dividing-by-2-standard-deviations"><i class="fa fa-check"></i><b>8.8</b> Rescaling an input by subtracting the mean and dividing by 2 standard deviations</a>
<ul>
<li class="chapter" data-level="8.8.1" data-path="analysis-of-covariance-with-the-smart-data.html"><a href="analysis-of-covariance-with-the-smart-data.html#refitting-model-c8_m4-to-the-rescaled-data"><i class="fa fa-check"></i><b>8.8.1</b> Refitting model <code>c8_m4</code> to the rescaled data</a></li>
<li class="chapter" data-level="8.8.2" data-path="analysis-of-covariance-with-the-smart-data.html"><a href="analysis-of-covariance-with-the-smart-data.html#interpreting-the-model-on-rescaled-data"><i class="fa fa-check"></i><b>8.8.2</b> Interpreting the model on rescaled data</a></li>
<li class="chapter" data-level="8.8.3" data-path="analysis-of-covariance-with-the-smart-data.html"><a href="analysis-of-covariance-with-the-smart-data.html#plot-of-model-on-rescaled-data"><i class="fa fa-check"></i><b>8.8.3</b> Plot of model on rescaled data</a></li>
</ul></li>
<li class="chapter" data-level="8.9" data-path="analysis-of-covariance-with-the-smart-data.html"><a href="analysis-of-covariance-with-the-smart-data.html#c8_m5-what-if-we-add-more-variables"><i class="fa fa-check"></i><b>8.9</b> <code>c8_m5</code>: What if we add more variables?</a></li>
<li class="chapter" data-level="8.10" data-path="analysis-of-covariance-with-the-smart-data.html"><a href="analysis-of-covariance-with-the-smart-data.html#c8_m6-would-adding-self-reported-health-help"><i class="fa fa-check"></i><b>8.10</b> <code>c8_m6</code>: Would adding self-reported health help?</a></li>
<li class="chapter" data-level="8.11" data-path="analysis-of-covariance-with-the-smart-data.html"><a href="analysis-of-covariance-with-the-smart-data.html#key-regression-assumptions-for-building-effective-prediction-models"><i class="fa fa-check"></i><b>8.11</b> Key Regression Assumptions for Building Effective Prediction Models</a>
<ul>
<li class="chapter" data-level="8.11.1" data-path="analysis-of-covariance-with-the-smart-data.html"><a href="analysis-of-covariance-with-the-smart-data.html#checking-assumptions-in-model-c8_m6"><i class="fa fa-check"></i><b>8.11.1</b> Checking Assumptions in model <code>c8_m6</code></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="adding-non-linear-terms-to-a-linear-regression-model.html"><a href="adding-non-linear-terms-to-a-linear-regression-model.html"><i class="fa fa-check"></i><b>9</b> Adding Non-linear Terms to a Linear Regression Model</a>
<ul>
<li class="chapter" data-level="9.1" data-path="adding-non-linear-terms-to-a-linear-regression-model.html"><a href="adding-non-linear-terms-to-a-linear-regression-model.html#the-pollution-data"><i class="fa fa-check"></i><b>9.1</b> The <code>pollution</code> data</a></li>
<li class="chapter" data-level="9.2" data-path="adding-non-linear-terms-to-a-linear-regression-model.html"><a href="adding-non-linear-terms-to-a-linear-regression-model.html#fitting-a-straight-line-model-to-predict-y-from-x2"><i class="fa fa-check"></i><b>9.2</b> Fitting a straight line model to predict <code>y</code> from <code>x2</code></a></li>
<li class="chapter" data-level="9.3" data-path="adding-non-linear-terms-to-a-linear-regression-model.html"><a href="adding-non-linear-terms-to-a-linear-regression-model.html#quadratic-polynomial-model-to-predict-y-using-x2"><i class="fa fa-check"></i><b>9.3</b> Quadratic polynomial model to predict <code>y</code> using <code>x2</code></a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="adding-non-linear-terms-to-a-linear-regression-model.html"><a href="adding-non-linear-terms-to-a-linear-regression-model.html#the-raw-quadratic-model"><i class="fa fa-check"></i><b>9.3.1</b> The raw quadratic model</a></li>
<li class="chapter" data-level="9.3.2" data-path="adding-non-linear-terms-to-a-linear-regression-model.html"><a href="adding-non-linear-terms-to-a-linear-regression-model.html#raw-quadratic-fit-after-centering-x2"><i class="fa fa-check"></i><b>9.3.2</b> Raw quadratic fit after centering <code>x2</code></a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="adding-non-linear-terms-to-a-linear-regression-model.html"><a href="adding-non-linear-terms-to-a-linear-regression-model.html#orthogonal-polynomials"><i class="fa fa-check"></i><b>9.4</b> Orthogonal Polynomials</a></li>
<li class="chapter" data-level="9.5" data-path="adding-non-linear-terms-to-a-linear-regression-model.html"><a href="adding-non-linear-terms-to-a-linear-regression-model.html#fit-a-cubic-polynomial-to-predict-y-from-x3"><i class="fa fa-check"></i><b>9.5</b> Fit a cubic polynomial to predict <code>y</code> from <code>x3</code></a></li>
<li class="chapter" data-level="9.6" data-path="adding-non-linear-terms-to-a-linear-regression-model.html"><a href="adding-non-linear-terms-to-a-linear-regression-model.html#fitting-a-restricted-cubic-spline-in-a-linear-regression"><i class="fa fa-check"></i><b>9.6</b> Fitting a restricted cubic spline in a linear regression</a></li>
<li class="chapter" data-level="9.7" data-path="adding-non-linear-terms-to-a-linear-regression-model.html"><a href="adding-non-linear-terms-to-a-linear-regression-model.html#spending-degrees-of-freedom"><i class="fa fa-check"></i><b>9.7</b> “Spending” Degrees of Freedom</a>
<ul>
<li class="chapter" data-level="9.7.1" data-path="adding-non-linear-terms-to-a-linear-regression-model.html"><a href="adding-non-linear-terms-to-a-linear-regression-model.html#overfitting-and-limits-on-the-of-predictors"><i class="fa fa-check"></i><b>9.7.1</b> Overfitting and Limits on the # of Predictors</a></li>
<li class="chapter" data-level="9.7.2" data-path="adding-non-linear-terms-to-a-linear-regression-model.html"><a href="adding-non-linear-terms-to-a-linear-regression-model.html#the-importance-of-collinearity"><i class="fa fa-check"></i><b>9.7.2</b> The Importance of Collinearity</a></li>
<li class="chapter" data-level="9.7.3" data-path="adding-non-linear-terms-to-a-linear-regression-model.html"><a href="adding-non-linear-terms-to-a-linear-regression-model.html#collinearity-in-an-explanatory-model"><i class="fa fa-check"></i><b>9.7.3</b> Collinearity in an Explanatory Model</a></li>
<li class="chapter" data-level="9.7.4" data-path="adding-non-linear-terms-to-a-linear-regression-model.html"><a href="adding-non-linear-terms-to-a-linear-regression-model.html#collinearity-in-a-prediction-model"><i class="fa fa-check"></i><b>9.7.4</b> Collinearity in a Prediction Model</a></li>
</ul></li>
<li class="chapter" data-level="9.8" data-path="adding-non-linear-terms-to-a-linear-regression-model.html"><a href="adding-non-linear-terms-to-a-linear-regression-model.html#spending-df-on-non-linearity-the-spearman-plot"><i class="fa fa-check"></i><b>9.8</b> Spending DF on Non-Linearity: The Spearman Plot</a>
<ul>
<li class="chapter" data-level="9.8.1" data-path="adding-non-linear-terms-to-a-linear-regression-model.html"><a href="adding-non-linear-terms-to-a-linear-regression-model.html#fitting-a-big-model-to-the-pollution-data"><i class="fa fa-check"></i><b>9.8.1</b> Fitting a Big Model to the <code>pollution</code> data</a></li>
<li class="chapter" data-level="9.8.2" data-path="adding-non-linear-terms-to-a-linear-regression-model.html"><a href="adding-non-linear-terms-to-a-linear-regression-model.html#limitations-of-lm-for-fitting-complex-linear-regression-models"><i class="fa fa-check"></i><b>9.8.2</b> Limitations of <code>lm</code> for fitting complex linear regression models</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="using-ols-from-the-rms-package-to-fit-linear-models.html"><a href="using-ols-from-the-rms-package-to-fit-linear-models.html"><i class="fa fa-check"></i><b>10</b> Using <code>ols</code> from the <code>rms</code> package to fit linear models</a>
<ul>
<li class="chapter" data-level="10.1" data-path="using-ols-from-the-rms-package-to-fit-linear-models.html"><a href="using-ols-from-the-rms-package-to-fit-linear-models.html#fitting-a-model-with-ols"><i class="fa fa-check"></i><b>10.1</b> Fitting a model with <code>ols</code></a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="using-ols-from-the-rms-package-to-fit-linear-models.html"><a href="using-ols-from-the-rms-package-to-fit-linear-models.html#the-model-likelihood-ratio-test"><i class="fa fa-check"></i><b>10.1.1</b> The Model Likelihood Ratio Test</a></li>
<li class="chapter" data-level="10.1.2" data-path="using-ols-from-the-rms-package-to-fit-linear-models.html"><a href="using-ols-from-the-rms-package-to-fit-linear-models.html#the-g-statistic"><i class="fa fa-check"></i><b>10.1.2</b> The g statistic</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="using-ols-from-the-rms-package-to-fit-linear-models.html"><a href="using-ols-from-the-rms-package-to-fit-linear-models.html#anova-for-an-ols-model"><i class="fa fa-check"></i><b>10.2</b> ANOVA for an <code>ols</code> model</a></li>
<li class="chapter" data-level="10.3" data-path="using-ols-from-the-rms-package-to-fit-linear-models.html"><a href="using-ols-from-the-rms-package-to-fit-linear-models.html#effect-estimates"><i class="fa fa-check"></i><b>10.3</b> Effect Estimates</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="using-ols-from-the-rms-package-to-fit-linear-models.html"><a href="using-ols-from-the-rms-package-to-fit-linear-models.html#simultaneous-confidence-intervals"><i class="fa fa-check"></i><b>10.3.1</b> Simultaneous Confidence Intervals</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="using-ols-from-the-rms-package-to-fit-linear-models.html"><a href="using-ols-from-the-rms-package-to-fit-linear-models.html#the-predict-function-for-an-ols-model"><i class="fa fa-check"></i><b>10.4</b> The <code>Predict</code> function for an <code>ols</code> model</a></li>
<li class="chapter" data-level="10.5" data-path="using-ols-from-the-rms-package-to-fit-linear-models.html"><a href="using-ols-from-the-rms-package-to-fit-linear-models.html#checking-influence-via-dfbeta"><i class="fa fa-check"></i><b>10.5</b> Checking Influence via <code>dfbeta</code></a>
<ul>
<li class="chapter" data-level="10.5.1" data-path="using-ols-from-the-rms-package-to-fit-linear-models.html"><a href="using-ols-from-the-rms-package-to-fit-linear-models.html#using-the-residuals-command-for-dfbetas"><i class="fa fa-check"></i><b>10.5.1</b> Using the <code>residuals</code> command for <code>dfbetas</code></a></li>
<li class="chapter" data-level="10.5.2" data-path="using-ols-from-the-rms-package-to-fit-linear-models.html"><a href="using-ols-from-the-rms-package-to-fit-linear-models.html#using-the-residuals-command-for-other-summaries"><i class="fa fa-check"></i><b>10.5.2</b> Using the <code>residuals</code> command for other summaries</a></li>
</ul></li>
<li class="chapter" data-level="10.6" data-path="using-ols-from-the-rms-package-to-fit-linear-models.html"><a href="using-ols-from-the-rms-package-to-fit-linear-models.html#model-validation-and-correcting-for-optimism"><i class="fa fa-check"></i><b>10.6</b> Model Validation and Correcting for Optimism</a></li>
<li class="chapter" data-level="10.7" data-path="using-ols-from-the-rms-package-to-fit-linear-models.html"><a href="using-ols-from-the-rms-package-to-fit-linear-models.html#building-a-nomogram-for-our-model"><i class="fa fa-check"></i><b>10.7</b> Building a Nomogram for Our Model</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="logistic-regression-the-foundations.html"><a href="logistic-regression-the-foundations.html"><i class="fa fa-check"></i><b>11</b> Logistic Regression: The Foundations</a>
<ul>
<li class="chapter" data-level="11.1" data-path="logistic-regression-the-foundations.html"><a href="logistic-regression-the-foundations.html#a-first-attempt-a-linear-probability-model"><i class="fa fa-check"></i><b>11.1</b> A First Attempt: A Linear Probability Model</a></li>
<li class="chapter" data-level="11.2" data-path="logistic-regression-the-foundations.html"><a href="logistic-regression-the-foundations.html#logistic-regression"><i class="fa fa-check"></i><b>11.2</b> Logistic Regression</a></li>
<li class="chapter" data-level="11.3" data-path="logistic-regression-the-foundations.html"><a href="logistic-regression-the-foundations.html#the-logistic-regression-model"><i class="fa fa-check"></i><b>11.3</b> The Logistic Regression Model</a></li>
<li class="chapter" data-level="11.4" data-path="logistic-regression-the-foundations.html"><a href="logistic-regression-the-foundations.html#the-link-function"><i class="fa fa-check"></i><b>11.4</b> The Link Function</a></li>
<li class="chapter" data-level="11.5" data-path="logistic-regression-the-foundations.html"><a href="logistic-regression-the-foundations.html#the-logit-or-log-odds"><i class="fa fa-check"></i><b>11.5</b> The logit or log odds</a></li>
<li class="chapter" data-level="11.6" data-path="logistic-regression-the-foundations.html"><a href="logistic-regression-the-foundations.html#interpreting-the-coefficients-of-a-logistic-regression-model"><i class="fa fa-check"></i><b>11.6</b> Interpreting the Coefficients of a Logistic Regression Model</a></li>
<li class="chapter" data-level="11.7" data-path="logistic-regression-the-foundations.html"><a href="logistic-regression-the-foundations.html#the-logistic-regression-has-non-constant-variance"><i class="fa fa-check"></i><b>11.7</b> The Logistic Regression has non-constant variance</a></li>
<li class="chapter" data-level="11.8" data-path="logistic-regression-the-foundations.html"><a href="logistic-regression-the-foundations.html#fitting-a-logistic-regression-model-to-our-simulated-data"><i class="fa fa-check"></i><b>11.8</b> Fitting a Logistic Regression Model to our Simulated Data</a></li>
<li class="chapter" data-level="11.9" data-path="logistic-regression-the-foundations.html"><a href="logistic-regression-the-foundations.html#plotting-the-logistic-regression-model"><i class="fa fa-check"></i><b>11.9</b> Plotting the Logistic Regression Model</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html"><i class="fa fa-check"></i><b>12</b> Logistic Regression and the <code>resect</code> data</a>
<ul>
<li class="chapter" data-level="12.1" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#the-resect-data"><i class="fa fa-check"></i><b>12.1</b> The <code>resect</code> data</a></li>
<li class="chapter" data-level="12.2" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#running-a-simple-logistic-regression-model"><i class="fa fa-check"></i><b>12.2</b> Running A Simple Logistic Regression Model</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#logistic-regression-can-be-harder-than-linear-regression"><i class="fa fa-check"></i><b>12.2.1</b> Logistic Regression Can Be Harder than Linear Regression</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#logistic-regression-using-glm"><i class="fa fa-check"></i><b>12.3</b> Logistic Regression using <code>glm</code></a>
<ul>
<li class="chapter" data-level="12.3.1" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#interpreting-the-coefficients-of-a-logistic-regression-model-1"><i class="fa fa-check"></i><b>12.3.1</b> Interpreting the Coefficients of a Logistic Regression Model</a></li>
<li class="chapter" data-level="12.3.2" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#using-predict-to-describe-the-models-fits"><i class="fa fa-check"></i><b>12.3.2</b> Using <code>predict</code> to describe the model’s fits</a></li>
<li class="chapter" data-level="12.3.3" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#odds-ratio-interpretation-of-coefficients"><i class="fa fa-check"></i><b>12.3.3</b> Odds Ratio interpretation of Coefficients</a></li>
<li class="chapter" data-level="12.3.4" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#interpreting-the-rest-of-the-model-output-from-glm"><i class="fa fa-check"></i><b>12.3.4</b> Interpreting the rest of the model output from <code>glm</code></a></li>
<li class="chapter" data-level="12.3.5" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#deviance-and-comparing-our-model-to-the-null-model"><i class="fa fa-check"></i><b>12.3.5</b> Deviance and Comparing Our Model to the Null Model</a></li>
<li class="chapter" data-level="12.3.6" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#using-glance-with-a-logistic-regression-model"><i class="fa fa-check"></i><b>12.3.6</b> Using <code>glance</code> with a logistic regression model</a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#interpreting-the-model-summary"><i class="fa fa-check"></i><b>12.4</b> Interpreting the Model Summary</a>
<ul>
<li class="chapter" data-level="12.4.1" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#wald-z-tests-for-coefficients-in-a-logistic-regression"><i class="fa fa-check"></i><b>12.4.1</b> Wald Z tests for Coefficients in a Logistic Regression</a></li>
<li class="chapter" data-level="12.4.2" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#confidence-intervals-for-the-coefficients"><i class="fa fa-check"></i><b>12.4.2</b> Confidence Intervals for the Coefficients</a></li>
<li class="chapter" data-level="12.4.3" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#deviance-residuals"><i class="fa fa-check"></i><b>12.4.3</b> Deviance Residuals</a></li>
<li class="chapter" data-level="12.4.4" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#dispersion-parameter"><i class="fa fa-check"></i><b>12.4.4</b> Dispersion Parameter</a></li>
<li class="chapter" data-level="12.4.5" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#fisher-scoring-iterations"><i class="fa fa-check"></i><b>12.4.5</b> Fisher Scoring iterations</a></li>
</ul></li>
<li class="chapter" data-level="12.5" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#plotting-a-simple-logistic-regression-model"><i class="fa fa-check"></i><b>12.5</b> Plotting a Simple Logistic Regression Model</a>
<ul>
<li class="chapter" data-level="12.5.1" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#using-augment-to-capture-the-fitted-probabilities"><i class="fa fa-check"></i><b>12.5.1</b> Using <code>augment</code> to capture the fitted probabilities</a></li>
<li class="chapter" data-level="12.5.2" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#plotting-a-logistic-regression-models-fitted-values"><i class="fa fa-check"></i><b>12.5.2</b> Plotting a Logistic Regression Model’s Fitted Values</a></li>
<li class="chapter" data-level="12.5.3" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#plotting-a-simple-logistic-model-using-binomial_smooth"><i class="fa fa-check"></i><b>12.5.3</b> Plotting a Simple Logistic Model using <code>binomial_smooth</code></a></li>
</ul></li>
<li class="chapter" data-level="12.6" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#how-well-does-model-a-classify-subjects"><i class="fa fa-check"></i><b>12.6</b> How well does Model A classify subjects?</a></li>
<li class="chapter" data-level="12.7" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#the-confusion-matrix"><i class="fa fa-check"></i><b>12.7</b> The Confusion Matrix</a></li>
<li class="chapter" data-level="12.8" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#using-the-confusionmatrix-tool-from-the-caret-package"><i class="fa fa-check"></i><b>12.8</b> Using the <code>confusionMatrix</code> tool from the <code>caret</code> package</a></li>
<li class="chapter" data-level="12.9" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#receiver-operating-characteristic-curve-analysis"><i class="fa fa-check"></i><b>12.9</b> Receiver Operating Characteristic Curve Analysis</a>
<ul>
<li class="chapter" data-level="12.9.1" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#interpreting-the-area-under-the-roc-curve"><i class="fa fa-check"></i><b>12.9.1</b> Interpreting the Area under the ROC curve</a></li>
</ul></li>
<li class="chapter" data-level="12.10" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#the-roc-plot-for-res_moda"><i class="fa fa-check"></i><b>12.10</b> The ROC Plot for <code>res_modA</code></a>
<ul>
<li class="chapter" data-level="12.10.1" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#another-way-to-plot-the-roc-curve"><i class="fa fa-check"></i><b>12.10.1</b> Another way to plot the ROC Curve</a></li>
</ul></li>
<li class="chapter" data-level="12.11" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#assessing-residual-plots-from-model-a"><i class="fa fa-check"></i><b>12.11</b> Assessing Residual Plots from Model A</a></li>
<li class="chapter" data-level="12.12" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#model-b-a-kitchen-sink-logistic-regression-model"><i class="fa fa-check"></i><b>12.12</b> Model B: A “Kitchen Sink” Logistic Regression Model</a>
<ul>
<li class="chapter" data-level="12.12.1" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#comparing-model-a-to-model-b"><i class="fa fa-check"></i><b>12.12.1</b> Comparing Model A to Model B</a></li>
<li class="chapter" data-level="12.12.2" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#interpreting-model-b"><i class="fa fa-check"></i><b>12.12.2</b> Interpreting Model B</a></li>
</ul></li>
<li class="chapter" data-level="12.13" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#plotting-model-b"><i class="fa fa-check"></i><b>12.13</b> Plotting Model B</a>
<ul>
<li class="chapter" data-level="12.13.1" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#using-augment-to-capture-the-fitted-probabilities-1"><i class="fa fa-check"></i><b>12.13.1</b> Using <code>augment</code> to capture the fitted probabilities</a></li>
<li class="chapter" data-level="12.13.2" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#plotting-model-b-fits-by-observed-mortality"><i class="fa fa-check"></i><b>12.13.2</b> Plotting Model B Fits by Observed Mortality</a></li>
<li class="chapter" data-level="12.13.3" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#confusion-matrix-for-model-b"><i class="fa fa-check"></i><b>12.13.3</b> Confusion Matrix for Model B</a></li>
<li class="chapter" data-level="12.13.4" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#the-roc-curve-for-model-b"><i class="fa fa-check"></i><b>12.13.4</b> The ROC curve for Model B</a></li>
<li class="chapter" data-level="12.13.5" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#residuals-leverage-and-influence"><i class="fa fa-check"></i><b>12.13.5</b> Residuals, Leverage and Influence</a></li>
</ul></li>
<li class="chapter" data-level="12.14" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#logistic-regression-using-lrm"><i class="fa fa-check"></i><b>12.14</b> Logistic Regression using <code>lrm</code></a>
<ul>
<li class="chapter" data-level="12.14.1" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#interpreting-nagelkerke-r2"><i class="fa fa-check"></i><b>12.14.1</b> Interpreting Nagelkerke R<sup>2</sup></a></li>
<li class="chapter" data-level="12.14.2" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#interpreting-the-c-statistic-and-plotting-the-roc-curve"><i class="fa fa-check"></i><b>12.14.2</b> Interpreting the C statistic and Plotting the ROC Curve</a></li>
<li class="chapter" data-level="12.14.3" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#the-c-statistic-and-somers-d"><i class="fa fa-check"></i><b>12.14.3</b> The C statistic and Somers’ D</a></li>
<li class="chapter" data-level="12.14.4" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#validating-the-logistic-regression-model-summary-statistics"><i class="fa fa-check"></i><b>12.14.4</b> Validating the Logistic Regression Model Summary Statistics</a></li>
<li class="chapter" data-level="12.14.5" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#plotting-the-summary-of-the-lrm-approach"><i class="fa fa-check"></i><b>12.14.5</b> Plotting the Summary of the <code>lrm</code> approach</a></li>
<li class="chapter" data-level="12.14.6" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#plot-in-sample-predictions-for-model-c"><i class="fa fa-check"></i><b>12.14.6</b> Plot In-Sample Predictions for Model C</a></li>
<li class="chapter" data-level="12.14.7" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#anova-from-the-lrm-approach"><i class="fa fa-check"></i><b>12.14.7</b> ANOVA from the <code>lrm</code> approach</a></li>
<li class="chapter" data-level="12.14.8" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#are-any-points-particularly-influential"><i class="fa fa-check"></i><b>12.14.8</b> Are any points particularly influential?</a></li>
<li class="chapter" data-level="12.14.9" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#a-nomogram-for-model-c"><i class="fa fa-check"></i><b>12.14.9</b> A Nomogram for Model C</a></li>
</ul></li>
<li class="chapter" data-level="12.15" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#model-d-an-augmented-kitchen-sink-model"><i class="fa fa-check"></i><b>12.15</b> Model D: An Augmented Kitchen Sink Model</a>
<ul>
<li class="chapter" data-level="12.15.1" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#spearman-rho2-plot"><i class="fa fa-check"></i><b>12.15.1</b> Spearman <span class="math inline">\(\rho^2\)</span> Plot</a></li>
<li class="chapter" data-level="12.15.2" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#fitting-model-d-using-lrm"><i class="fa fa-check"></i><b>12.15.2</b> Fitting Model D using <code>lrm</code></a></li>
<li class="chapter" data-level="12.15.3" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#assessing-model-d-using-lrms-tools"><i class="fa fa-check"></i><b>12.15.3</b> Assessing Model D using <code>lrm</code>’s tools</a></li>
<li class="chapter" data-level="12.15.4" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#anova-and-wald-tests-for-model-d"><i class="fa fa-check"></i><b>12.15.4</b> ANOVA and Wald Tests for Model D</a></li>
<li class="chapter" data-level="12.15.5" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#effect-sizes-in-model-d"><i class="fa fa-check"></i><b>12.15.5</b> Effect Sizes in Model D</a></li>
<li class="chapter" data-level="12.15.6" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#plot-in-sample-predictions-for-model-d"><i class="fa fa-check"></i><b>12.15.6</b> Plot In-Sample Predictions for Model D</a></li>
<li class="chapter" data-level="12.15.7" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#plotting-the-roc-curve-for-model-d"><i class="fa fa-check"></i><b>12.15.7</b> Plotting the ROC curve for Model D</a></li>
<li class="chapter" data-level="12.15.8" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#validation-of-model-d-summaries"><i class="fa fa-check"></i><b>12.15.8</b> Validation of Model D summaries</a></li>
</ul></li>
<li class="chapter" data-level="12.16" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#model-e-fitting-a-reduced-model-in-light-of-model-d"><i class="fa fa-check"></i><b>12.16</b> Model E: Fitting a Reduced Model in light of Model D</a>
<ul>
<li class="chapter" data-level="12.16.1" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#a-plot-comparing-the-two-intubation-groups"><i class="fa fa-check"></i><b>12.16.1</b> A Plot comparing the two intubation groups</a></li>
<li class="chapter" data-level="12.16.2" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#nomogram-for-model-e"><i class="fa fa-check"></i><b>12.16.2</b> Nomogram for Model E</a></li>
<li class="chapter" data-level="12.16.3" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#effect-sizes-from-model-e"><i class="fa fa-check"></i><b>12.16.3</b> Effect Sizes from Model E</a></li>
<li class="chapter" data-level="12.16.4" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#plot-in-sample-predictions-for-model-e"><i class="fa fa-check"></i><b>12.16.4</b> Plot In-Sample Predictions for Model E</a></li>
<li class="chapter" data-level="12.16.5" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#anova-for-model-e"><i class="fa fa-check"></i><b>12.16.5</b> ANOVA for Model E</a></li>
<li class="chapter" data-level="12.16.6" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#validation-of-model-e"><i class="fa fa-check"></i><b>12.16.6</b> Validation of Model E</a></li>
<li class="chapter" data-level="12.16.7" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#do-any-points-seem-particularly-influential"><i class="fa fa-check"></i><b>12.16.7</b> Do any points seem particularly influential?</a></li>
<li class="chapter" data-level="12.16.8" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#fitting-model-e-using-glm-to-get-plots-about-influence"><i class="fa fa-check"></i><b>12.16.8</b> Fitting Model E using <code>glm</code> to get plots about influence</a></li>
</ul></li>
<li class="chapter" data-level="12.17" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#concordance-comparing-model-c-d-and-es-predictions"><i class="fa fa-check"></i><b>12.17</b> Concordance: Comparing Model C, D and E’s predictions</a></li>
<li class="chapter" data-level="12.18" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#conclusions"><i class="fa fa-check"></i><b>12.18</b> Conclusions</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="a-study-of-prostate-cancer.html"><a href="a-study-of-prostate-cancer.html"><i class="fa fa-check"></i><b>13</b> A Study of Prostate Cancer</a>
<ul>
<li class="chapter" data-level="13.1" data-path="a-study-of-prostate-cancer.html"><a href="a-study-of-prostate-cancer.html#data-load-and-background"><i class="fa fa-check"></i><b>13.1</b> Data Load and Background</a></li>
<li class="chapter" data-level="13.2" data-path="a-study-of-prostate-cancer.html"><a href="a-study-of-prostate-cancer.html#code-book"><i class="fa fa-check"></i><b>13.2</b> Code Book</a></li>
<li class="chapter" data-level="13.3" data-path="a-study-of-prostate-cancer.html"><a href="a-study-of-prostate-cancer.html#additions-for-later-use"><i class="fa fa-check"></i><b>13.3</b> Additions for Later Use</a></li>
<li class="chapter" data-level="13.4" data-path="a-study-of-prostate-cancer.html"><a href="a-study-of-prostate-cancer.html#fitting-and-evaluating-a-two-predictor-model"><i class="fa fa-check"></i><b>13.4</b> Fitting and Evaluating a Two-Predictor Model</a>
<ul>
<li class="chapter" data-level="13.4.1" data-path="a-study-of-prostate-cancer.html"><a href="a-study-of-prostate-cancer.html#using-tidy"><i class="fa fa-check"></i><b>13.4.1</b> Using <code>tidy</code></a></li>
<li class="chapter" data-level="13.4.2" data-path="a-study-of-prostate-cancer.html"><a href="a-study-of-prostate-cancer.html#interpretation"><i class="fa fa-check"></i><b>13.4.2</b> Interpretation</a></li>
</ul></li>
<li class="chapter" data-level="13.5" data-path="a-study-of-prostate-cancer.html"><a href="a-study-of-prostate-cancer.html#exploring-model-c11_prost_a"><i class="fa fa-check"></i><b>13.5</b> Exploring Model <code>c11_prost_A</code></a>
<ul>
<li class="chapter" data-level="13.5.1" data-path="a-study-of-prostate-cancer.html"><a href="a-study-of-prostate-cancer.html#summary-for-model-c11_prost_a"><i class="fa fa-check"></i><b>13.5.1</b> <code>summary</code> for Model <code>c11_prost_A</code></a></li>
<li class="chapter" data-level="13.5.2" data-path="a-study-of-prostate-cancer.html"><a href="a-study-of-prostate-cancer.html#adjusted-r2"><i class="fa fa-check"></i><b>13.5.2</b> Adjusted R<sup>2</sup></a></li>
<li class="chapter" data-level="13.5.3" data-path="a-study-of-prostate-cancer.html"><a href="a-study-of-prostate-cancer.html#coefficient-confidence-intervals"><i class="fa fa-check"></i><b>13.5.3</b> Coefficient Confidence Intervals</a></li>
<li class="chapter" data-level="13.5.4" data-path="a-study-of-prostate-cancer.html"><a href="a-study-of-prostate-cancer.html#anova-for-model-c11_prost_a"><i class="fa fa-check"></i><b>13.5.4</b> ANOVA for Model <code>c11_prost_A</code></a></li>
<li class="chapter" data-level="13.5.5" data-path="a-study-of-prostate-cancer.html"><a href="a-study-of-prostate-cancer.html#residuals-fitted-values-and-standard-errors-with-augment"><i class="fa fa-check"></i><b>13.5.5</b> Residuals, Fitted Values and Standard Errors with <code>augment</code></a></li>
<li class="chapter" data-level="13.5.6" data-path="a-study-of-prostate-cancer.html"><a href="a-study-of-prostate-cancer.html#making-predictions-with-c11_prost_a"><i class="fa fa-check"></i><b>13.5.6</b> Making Predictions with <code>c11_prost_A</code></a></li>
</ul></li>
<li class="chapter" data-level="13.6" data-path="a-study-of-prostate-cancer.html"><a href="a-study-of-prostate-cancer.html#plotting-model-c11_prost_a"><i class="fa fa-check"></i><b>13.6</b> Plotting Model <code>c11_prost_A</code></a>
<ul>
<li class="chapter" data-level="13.6.1" data-path="a-study-of-prostate-cancer.html"><a href="a-study-of-prostate-cancer.html#residual-plots-of-c11_prost_a"><i class="fa fa-check"></i><b>13.6.1</b> Residual Plots of <code>c11_prost_A</code></a></li>
</ul></li>
<li class="chapter" data-level="13.7" data-path="a-study-of-prostate-cancer.html"><a href="a-study-of-prostate-cancer.html#cross-validation-of-model-c11_prost_a"><i class="fa fa-check"></i><b>13.7</b> Cross-Validation of Model <code>c11_prost_A</code></a>
<ul>
<li class="chapter" data-level="13.7.1" data-path="a-study-of-prostate-cancer.html"><a href="a-study-of-prostate-cancer.html#a-validation-split-approach"><i class="fa fa-check"></i><b>13.7.1</b> A Validation Split Approach</a></li>
<li class="chapter" data-level="13.7.2" data-path="a-study-of-prostate-cancer.html"><a href="a-study-of-prostate-cancer.html#k-fold-cross-validation"><i class="fa fa-check"></i><b>13.7.2</b> K-Fold Cross-Validation</a></li>
<li class="chapter" data-level="13.7.3" data-path="a-study-of-prostate-cancer.html"><a href="a-study-of-prostate-cancer.html#comparing-models-with-5-fold-cross-validation"><i class="fa fa-check"></i><b>13.7.3</b> Comparing Models with 5-fold Cross-Validation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="14" data-path="multiple-imputation-and-linear-regression.html"><a href="multiple-imputation-and-linear-regression.html"><i class="fa fa-check"></i><b>14</b> Multiple Imputation and Linear Regression</a>
<ul>
<li class="chapter" data-level="14.1" data-path="multiple-imputation-and-linear-regression.html"><a href="multiple-imputation-and-linear-regression.html#developing-a-smart_16-data-set"><i class="fa fa-check"></i><b>14.1</b> Developing a <code>smart_16</code> data set</a>
<ul>
<li class="chapter" data-level="14.1.1" data-path="multiple-imputation-and-linear-regression.html"><a href="multiple-imputation-and-linear-regression.html#any-missing-values"><i class="fa fa-check"></i><b>14.1.1</b> Any missing values?</a></li>
</ul></li>
<li class="chapter" data-level="14.2" data-path="multiple-imputation-and-linear-regression.html"><a href="multiple-imputation-and-linear-regression.html#obtaining-a-simple-imputation-with-mice"><i class="fa fa-check"></i><b>14.2</b> Obtaining a Simple Imputation with <code>mice</code></a></li>
<li class="chapter" data-level="14.3" data-path="multiple-imputation-and-linear-regression.html"><a href="multiple-imputation-and-linear-regression.html#linear-regression-considering-a-transformation-of-the-outcome"><i class="fa fa-check"></i><b>14.3</b> Linear Regression: Considering a Transformation of the Outcome</a></li>
<li class="chapter" data-level="14.4" data-path="multiple-imputation-and-linear-regression.html"><a href="multiple-imputation-and-linear-regression.html#linear-regression-considering-non-linearity-in-the-predictors"><i class="fa fa-check"></i><b>14.4</b> Linear Regression: Considering Non-Linearity in the Predictors</a></li>
<li class="chapter" data-level="14.5" data-path="multiple-imputation-and-linear-regression.html"><a href="multiple-imputation-and-linear-regression.html#main-effects-linear-regression-with-lm-on-the-complete-cases"><i class="fa fa-check"></i><b>14.5</b> “Main Effects” Linear Regression with <code>lm</code> on the Complete Cases</a>
<ul>
<li class="chapter" data-level="14.5.1" data-path="multiple-imputation-and-linear-regression.html"><a href="multiple-imputation-and-linear-regression.html#quality-of-fit-statistics"><i class="fa fa-check"></i><b>14.5.1</b> Quality of Fit Statistics</a></li>
<li class="chapter" data-level="14.5.2" data-path="multiple-imputation-and-linear-regression.html"><a href="multiple-imputation-and-linear-regression.html#interpreting-effect-sizes"><i class="fa fa-check"></i><b>14.5.2</b> Interpreting Effect Sizes</a></li>
<li class="chapter" data-level="14.5.3" data-path="multiple-imputation-and-linear-regression.html"><a href="multiple-imputation-and-linear-regression.html#making-predictions-with-the-model"><i class="fa fa-check"></i><b>14.5.3</b> Making Predictions with the Model</a></li>
</ul></li>
<li class="chapter" data-level="14.6" data-path="multiple-imputation-and-linear-regression.html"><a href="multiple-imputation-and-linear-regression.html#augmented-linear-regression-with-lm-on-the-complete-cases"><i class="fa fa-check"></i><b>14.6</b> “Augmented” Linear Regression with <code>lm</code> on the Complete Cases</a>
<ul>
<li class="chapter" data-level="14.6.1" data-path="multiple-imputation-and-linear-regression.html"><a href="multiple-imputation-and-linear-regression.html#quality-of-fit-statistics-1"><i class="fa fa-check"></i><b>14.6.1</b> Quality of Fit Statistics</a></li>
<li class="chapter" data-level="14.6.2" data-path="multiple-imputation-and-linear-regression.html"><a href="multiple-imputation-and-linear-regression.html#anova-assessing-the-impact-of-the-non-linear-terms"><i class="fa fa-check"></i><b>14.6.2</b> ANOVA assessing the impact of the non-linear terms</a></li>
<li class="chapter" data-level="14.6.3" data-path="multiple-imputation-and-linear-regression.html"><a href="multiple-imputation-and-linear-regression.html#interpreting-effect-sizes-1"><i class="fa fa-check"></i><b>14.6.3</b> Interpreting Effect Sizes</a></li>
<li class="chapter" data-level="14.6.4" data-path="multiple-imputation-and-linear-regression.html"><a href="multiple-imputation-and-linear-regression.html#making-predictions-with-the-model-1"><i class="fa fa-check"></i><b>14.6.4</b> Making Predictions with the Model</a></li>
</ul></li>
<li class="chapter" data-level="14.7" data-path="multiple-imputation-and-linear-regression.html"><a href="multiple-imputation-and-linear-regression.html#using-mice-to-perform-multiple-imputation"><i class="fa fa-check"></i><b>14.7</b> Using <code>mice</code> to perform Multiple Imputation</a></li>
<li class="chapter" data-level="14.8" data-path="multiple-imputation-and-linear-regression.html"><a href="multiple-imputation-and-linear-regression.html#running-the-linear-regression-in-lm-with-multiple-imputation"><i class="fa fa-check"></i><b>14.8</b> Running the Linear Regression in <code>lm</code> with Multiple Imputation</a></li>
<li class="chapter" data-level="14.9" data-path="multiple-imputation-and-linear-regression.html"><a href="multiple-imputation-and-linear-regression.html#fit-the-multiple-imputation-model-with-aregimpute"><i class="fa fa-check"></i><b>14.9</b> Fit the Multiple Imputation Model with <code>aregImpute</code></a></li>
<li class="chapter" data-level="14.10" data-path="multiple-imputation-and-linear-regression.html"><a href="multiple-imputation-and-linear-regression.html#fit-linear-regression-using-ols-and-fit.mult.impute"><i class="fa fa-check"></i><b>14.10</b> Fit Linear Regression using <code>ols</code> and <code>fit.mult.impute</code></a>
<ul>
<li class="chapter" data-level="14.10.1" data-path="multiple-imputation-and-linear-regression.html"><a href="multiple-imputation-and-linear-regression.html#summaries-and-coefficients"><i class="fa fa-check"></i><b>14.10.1</b> Summaries and Coefficients</a></li>
<li class="chapter" data-level="14.10.2" data-path="multiple-imputation-and-linear-regression.html"><a href="multiple-imputation-and-linear-regression.html#effect-sizes"><i class="fa fa-check"></i><b>14.10.2</b> Effect Sizes</a></li>
<li class="chapter" data-level="14.10.3" data-path="multiple-imputation-and-linear-regression.html"><a href="multiple-imputation-and-linear-regression.html#making-predictions-with-this-model"><i class="fa fa-check"></i><b>14.10.3</b> Making Predictions with this Model</a></li>
<li class="chapter" data-level="14.10.4" data-path="multiple-imputation-and-linear-regression.html"><a href="multiple-imputation-and-linear-regression.html#nomogram"><i class="fa fa-check"></i><b>14.10.4</b> Nomogram</a></li>
<li class="chapter" data-level="14.10.5" data-path="multiple-imputation-and-linear-regression.html"><a href="multiple-imputation-and-linear-regression.html#validating-summary-statistics"><i class="fa fa-check"></i><b>14.10.5</b> Validating Summary Statistics</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="15" data-path="using-tidymodels-to-fit-linear-regressions.html"><a href="using-tidymodels-to-fit-linear-regressions.html"><i class="fa fa-check"></i><b>15</b> Using tidymodels to fit linear regressions</a></li>
<li class="chapter" data-level="16" data-path="using-tidymodels-to-fit-logistic-regressions.html"><a href="using-tidymodels-to-fit-logistic-regressions.html"><i class="fa fa-check"></i><b>16</b> Using tidymodels to fit logistic regressions</a></li>
<li class="chapter" data-level="17" data-path="using-tidymodels-approaches-next-steps.html"><a href="using-tidymodels-approaches-next-steps.html"><i class="fa fa-check"></i><b>17</b> Using tidymodels approaches: Next Steps</a></li>
<li class="chapter" data-level="18" data-path="colorectal-cancer-screening-and-some-special-cases.html"><a href="colorectal-cancer-screening-and-some-special-cases.html"><i class="fa fa-check"></i><b>18</b> Colorectal Cancer Screening and Some Special Cases</a>
<ul>
<li class="chapter" data-level="18.1" data-path="colorectal-cancer-screening-and-some-special-cases.html"><a href="colorectal-cancer-screening-and-some-special-cases.html#logistic-regression-for-aggregated-data"><i class="fa fa-check"></i><b>18.1</b> Logistic Regression for Aggregated Data</a>
<ul>
<li class="chapter" data-level="18.1.1" data-path="colorectal-cancer-screening-and-some-special-cases.html"><a href="colorectal-cancer-screening-and-some-special-cases.html#colorectal-cancer-screening-data"><i class="fa fa-check"></i><b>18.1.1</b> Colorectal Cancer Screening Data</a></li>
<li class="chapter" data-level="18.1.2" data-path="colorectal-cancer-screening-and-some-special-cases.html"><a href="colorectal-cancer-screening-and-some-special-cases.html#fitting-a-logistic-regression-model-to-proportion-data"><i class="fa fa-check"></i><b>18.1.2</b> Fitting a Logistic Regression Model to Proportion Data</a></li>
<li class="chapter" data-level="18.1.3" data-path="colorectal-cancer-screening-and-some-special-cases.html"><a href="colorectal-cancer-screening-and-some-special-cases.html#fitting-a-logistic-regression-model-to-counts-of-successes-and-failures"><i class="fa fa-check"></i><b>18.1.3</b> Fitting a Logistic Regression Model to Counts of Successes and Failures</a></li>
<li class="chapter" data-level="18.1.4" data-path="colorectal-cancer-screening-and-some-special-cases.html"><a href="colorectal-cancer-screening-and-some-special-cases.html#how-does-one-address-this-problem-in-rms"><i class="fa fa-check"></i><b>18.1.4</b> How does one address this problem in <code>rms</code>?</a></li>
</ul></li>
<li class="chapter" data-level="18.2" data-path="colorectal-cancer-screening-and-some-special-cases.html"><a href="colorectal-cancer-screening-and-some-special-cases.html#probit-regression"><i class="fa fa-check"></i><b>18.2</b> Probit Regression</a>
<ul>
<li class="chapter" data-level="18.2.1" data-path="colorectal-cancer-screening-and-some-special-cases.html"><a href="colorectal-cancer-screening-and-some-special-cases.html#colorectal-cancer-screening-data-on-individuals"><i class="fa fa-check"></i><b>18.2.1</b> Colorectal Cancer Screening Data on Individuals</a></li>
<li class="chapter" data-level="18.2.2" data-path="colorectal-cancer-screening-and-some-special-cases.html"><a href="colorectal-cancer-screening-and-some-special-cases.html#a-logistic-regression-model"><i class="fa fa-check"></i><b>18.2.2</b> A logistic regression model</a></li>
<li class="chapter" data-level="18.2.3" data-path="colorectal-cancer-screening-and-some-special-cases.html"><a href="colorectal-cancer-screening-and-some-special-cases.html#predicting-status-for-harry-and-sally"><i class="fa fa-check"></i><b>18.2.3</b> Predicting status for Harry and Sally</a></li>
<li class="chapter" data-level="18.2.4" data-path="colorectal-cancer-screening-and-some-special-cases.html"><a href="colorectal-cancer-screening-and-some-special-cases.html#a-probit-regression-model"><i class="fa fa-check"></i><b>18.2.4</b> A probit regression model</a></li>
<li class="chapter" data-level="18.2.5" data-path="colorectal-cancer-screening-and-some-special-cases.html"><a href="colorectal-cancer-screening-and-some-special-cases.html#interpreting-the-probit-models-coefficients"><i class="fa fa-check"></i><b>18.2.5</b> Interpreting the Probit Model’s Coefficients</a></li>
<li class="chapter" data-level="18.2.6" data-path="colorectal-cancer-screening-and-some-special-cases.html"><a href="colorectal-cancer-screening-and-some-special-cases.html#what-about-harry-and-sally"><i class="fa fa-check"></i><b>18.2.6</b> What about Harry and Sally?</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="19" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html"><i class="fa fa-check"></i><b>19</b> Modeling a Count Outcome in Ohio SMART</a>
<ul>
<li class="chapter" data-level="19.1" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#preliminaries"><i class="fa fa-check"></i><b>19.1</b> Preliminaries</a></li>
<li class="chapter" data-level="19.2" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#a-subset-of-the-ohio-smart-data"><i class="fa fa-check"></i><b>19.2</b> A subset of the Ohio SMART data</a>
<ul>
<li class="chapter" data-level="19.2.1" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#is-age-group-associated-with-physhealth"><i class="fa fa-check"></i><b>19.2.1</b> Is age group associated with <code>physhealth</code>?</a></li>
</ul></li>
<li class="chapter" data-level="19.3" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#exploratory-data-analysis-in-the-18-49-group"><i class="fa fa-check"></i><b>19.3</b> Exploratory Data Analysis (in the 18-49 group)</a>
<ul>
<li class="chapter" data-level="19.3.1" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#build-a-subset-of-those-ages-18-49"><i class="fa fa-check"></i><b>19.3.1</b> Build a subset of those ages 18-49</a></li>
<li class="chapter" data-level="19.3.2" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#centering-bmi"><i class="fa fa-check"></i><b>19.3.2</b> Centering <code>bmi</code></a></li>
<li class="chapter" data-level="19.3.3" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#distribution-of-the-outcome"><i class="fa fa-check"></i><b>19.3.3</b> Distribution of the Outcome</a></li>
<li class="chapter" data-level="19.3.4" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#scatterplot-matrix"><i class="fa fa-check"></i><b>19.3.4</b> Scatterplot Matrix</a></li>
<li class="chapter" data-level="19.3.5" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#summary-of-the-final-subset-of-data"><i class="fa fa-check"></i><b>19.3.5</b> Summary of the final subset of data</a></li>
</ul></li>
<li class="chapter" data-level="19.4" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#modeling-strategies-explored-here"><i class="fa fa-check"></i><b>19.4</b> Modeling Strategies Explored Here</a>
<ul>
<li class="chapter" data-level="19.4.1" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#what-will-we-demonstrate"><i class="fa fa-check"></i><b>19.4.1</b> What Will We Demonstrate?</a></li>
<li class="chapter" data-level="19.4.2" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#extra-data-file-for-harry-and-sally"><i class="fa fa-check"></i><b>19.4.2</b> Extra Data File for Harry and Sally</a></li>
</ul></li>
<li class="chapter" data-level="19.5" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#the-ols-approach"><i class="fa fa-check"></i><b>19.5</b> The OLS Approach</a>
<ul>
<li class="chapter" data-level="19.5.1" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#interpreting-the-coefficients"><i class="fa fa-check"></i><b>19.5.1</b> Interpreting the Coefficients</a></li>
<li class="chapter" data-level="19.5.2" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#store-fitted-values-and-residuals"><i class="fa fa-check"></i><b>19.5.2</b> Store fitted values and residuals</a></li>
<li class="chapter" data-level="19.5.3" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#specify-the-r2-and-loglikelihood-values"><i class="fa fa-check"></i><b>19.5.3</b> Specify the R<sup>2</sup> and log(likelihood) values</a></li>
<li class="chapter" data-level="19.5.4" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#check-model-assumptions"><i class="fa fa-check"></i><b>19.5.4</b> Check model assumptions</a></li>
<li class="chapter" data-level="19.5.5" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#predictions-for-harry-and-sally"><i class="fa fa-check"></i><b>19.5.5</b> Predictions for Harry and Sally</a></li>
<li class="chapter" data-level="19.5.6" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#notes"><i class="fa fa-check"></i><b>19.5.6</b> Notes</a></li>
</ul></li>
<li class="chapter" data-level="19.6" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#ols-model-on-logphyshealth-1-days"><i class="fa fa-check"></i><b>19.6</b> OLS model on log(<code>physhealth</code> + 1) days</a>
<ul>
<li class="chapter" data-level="19.6.1" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#interpreting-the-coefficients-1"><i class="fa fa-check"></i><b>19.6.1</b> Interpreting the Coefficients</a></li>
<li class="chapter" data-level="19.6.2" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#store-fitted-values-and-residuals-1"><i class="fa fa-check"></i><b>19.6.2</b> Store fitted values and residuals</a></li>
<li class="chapter" data-level="19.6.3" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#specify-the-r2-and-loglikelihood-values-1"><i class="fa fa-check"></i><b>19.6.3</b> Specify the R<sup>2</sup> and log(likelihood) values</a></li>
<li class="chapter" data-level="19.6.4" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#getting-r2-on-the-scale-of-physhealth"><i class="fa fa-check"></i><b>19.6.4</b> Getting R<sup>2</sup> on the scale of <code>physhealth</code></a></li>
<li class="chapter" data-level="19.6.5" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#check-model-assumptions-1"><i class="fa fa-check"></i><b>19.6.5</b> Check model assumptions</a></li>
<li class="chapter" data-level="19.6.6" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#predictions-for-harry-and-sally-1"><i class="fa fa-check"></i><b>19.6.6</b> Predictions for Harry and Sally</a></li>
</ul></li>
<li class="chapter" data-level="19.7" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#a-poisson-regression-model"><i class="fa fa-check"></i><b>19.7</b> A Poisson Regression Model</a>
<ul>
<li class="chapter" data-level="19.7.1" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#the-fitted-equation"><i class="fa fa-check"></i><b>19.7.1</b> The Fitted Equation</a></li>
<li class="chapter" data-level="19.7.2" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#interpreting-the-coefficients-2"><i class="fa fa-check"></i><b>19.7.2</b> Interpreting the Coefficients</a></li>
<li class="chapter" data-level="19.7.3" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#testing-the-predictors"><i class="fa fa-check"></i><b>19.7.3</b> Testing the Predictors</a></li>
<li class="chapter" data-level="19.7.4" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#correcting-for-overdispersion-with-coeftestcoefci"><i class="fa fa-check"></i><b>19.7.4</b> Correcting for Overdispersion with <code>coeftest</code>/<code>coefci</code></a></li>
<li class="chapter" data-level="19.7.5" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#store-fitted-values-and-residuals-2"><i class="fa fa-check"></i><b>19.7.5</b> Store fitted values and residuals</a></li>
<li class="chapter" data-level="19.7.6" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#rootogram-see-the-fit-of-a-count-regression-model"><i class="fa fa-check"></i><b>19.7.6</b> Rootogram: see the fit of a count regression model</a></li>
<li class="chapter" data-level="19.7.7" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#specify-the-r2-and-loglikelihood-values-2"><i class="fa fa-check"></i><b>19.7.7</b> Specify the R<sup>2</sup> and log(likelihood) values</a></li>
<li class="chapter" data-level="19.7.8" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#check-model-assumptions-2"><i class="fa fa-check"></i><b>19.7.8</b> Check model assumptions</a></li>
<li class="chapter" data-level="19.7.9" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#using-glm.diag.plots-from-the-boot-package"><i class="fa fa-check"></i><b>19.7.9</b> Using <code>glm.diag.plots</code> from the <code>boot</code> package</a></li>
<li class="chapter" data-level="19.7.10" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#predictions-for-harry-and-sally-2"><i class="fa fa-check"></i><b>19.7.10</b> Predictions for Harry and Sally</a></li>
</ul></li>
<li class="chapter" data-level="19.8" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#overdispersion-in-a-poisson-model"><i class="fa fa-check"></i><b>19.8</b> Overdispersion in a Poisson Model</a>
<ul>
<li class="chapter" data-level="19.8.1" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#testing-for-overdispersion"><i class="fa fa-check"></i><b>19.8.1</b> Testing for Overdispersion?</a></li>
</ul></li>
<li class="chapter" data-level="19.9" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#fitting-the-quasi-poisson-model"><i class="fa fa-check"></i><b>19.9</b> Fitting the Quasi-Poisson Model</a>
<ul>
<li class="chapter" data-level="19.9.1" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#the-fitted-equation-1"><i class="fa fa-check"></i><b>19.9.1</b> The Fitted Equation</a></li>
<li class="chapter" data-level="19.9.2" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#interpreting-the-coefficients-3"><i class="fa fa-check"></i><b>19.9.2</b> Interpreting the Coefficients</a></li>
<li class="chapter" data-level="19.9.3" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#testing-the-predictors-1"><i class="fa fa-check"></i><b>19.9.3</b> Testing the Predictors</a></li>
<li class="chapter" data-level="19.9.4" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#store-fitted-values-and-residuals-3"><i class="fa fa-check"></i><b>19.9.4</b> Store fitted values and residuals</a></li>
<li class="chapter" data-level="19.9.5" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#specify-the-r2-and-loglikelihood-values-3"><i class="fa fa-check"></i><b>19.9.5</b> Specify the R<sup>2</sup> and log(likelihood) values</a></li>
<li class="chapter" data-level="19.9.6" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#check-model-assumptions-3"><i class="fa fa-check"></i><b>19.9.6</b> Check model assumptions</a></li>
<li class="chapter" data-level="19.9.7" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#predictions-for-harry-and-sally-3"><i class="fa fa-check"></i><b>19.9.7</b> Predictions for Harry and Sally</a></li>
</ul></li>
<li class="chapter" data-level="19.10" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#poisson-and-quasi-poisson-models-using-glm-from-the-rms-package"><i class="fa fa-check"></i><b>19.10</b> Poisson and Quasi-Poisson models using <code>Glm</code> from the <code>rms</code> package</a>
<ul>
<li class="chapter" data-level="19.10.1" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#refitting-the-original-poisson-regression-with-glm"><i class="fa fa-check"></i><b>19.10.1</b> Refitting the original Poisson regression with <code>Glm</code></a></li>
<li class="chapter" data-level="19.10.2" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#refitting-the-overdispersed-poisson-regression-with-glm"><i class="fa fa-check"></i><b>19.10.2</b> Refitting the overdispersed Poisson regression with <code>Glm</code></a></li>
<li class="chapter" data-level="19.10.3" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#anova-on-a-glm-fit"><i class="fa fa-check"></i><b>19.10.3</b> ANOVA on a <code>Glm</code> fit</a></li>
<li class="chapter" data-level="19.10.4" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#ggplots-from-glm-fit"><i class="fa fa-check"></i><b>19.10.4</b> ggplots from <code>Glm</code> fit</a></li>
<li class="chapter" data-level="19.10.5" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#summary-of-a-glm-fit"><i class="fa fa-check"></i><b>19.10.5</b> Summary of a <code>Glm</code> fit</a></li>
<li class="chapter" data-level="19.10.6" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#plot-of-the-summary"><i class="fa fa-check"></i><b>19.10.6</b> Plot of the Summary</a></li>
<li class="chapter" data-level="19.10.7" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#nomogram-of-a-glm-fit"><i class="fa fa-check"></i><b>19.10.7</b> Nomogram of a <code>Glm</code> fit</a></li>
</ul></li>
<li class="chapter" data-level="19.11" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#negative-binomial-model"><i class="fa fa-check"></i><b>19.11</b> Negative Binomial Model</a>
<ul>
<li class="chapter" data-level="19.11.1" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#the-fitted-equation-2"><i class="fa fa-check"></i><b>19.11.1</b> The Fitted Equation</a></li>
<li class="chapter" data-level="19.11.2" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#comparison-with-the-raw-poisson-model"><i class="fa fa-check"></i><b>19.11.2</b> Comparison with the (raw) Poisson model</a></li>
<li class="chapter" data-level="19.11.3" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#interpreting-the-coefficients-4"><i class="fa fa-check"></i><b>19.11.3</b> Interpreting the Coefficients</a></li>
<li class="chapter" data-level="19.11.4" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#interpretation-of-coefficients-in-terms-of-irrs"><i class="fa fa-check"></i><b>19.11.4</b> Interpretation of Coefficients in terms of IRRs</a></li>
<li class="chapter" data-level="19.11.5" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#testing-the-predictors-2"><i class="fa fa-check"></i><b>19.11.5</b> Testing the Predictors</a></li>
<li class="chapter" data-level="19.11.6" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#store-fitted-values-and-residuals-4"><i class="fa fa-check"></i><b>19.11.6</b> Store fitted values and residuals</a></li>
<li class="chapter" data-level="19.11.7" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#rootogram-for-negative-binomial-model"><i class="fa fa-check"></i><b>19.11.7</b> Rootogram for Negative Binomial model</a></li>
<li class="chapter" data-level="19.11.8" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#simulating-what-the-negative-binomial-model-predicts"><i class="fa fa-check"></i><b>19.11.8</b> Simulating what the Negative Binomial model predicts</a></li>
<li class="chapter" data-level="19.11.9" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#specify-the-r2-and-loglikelihood-values-4"><i class="fa fa-check"></i><b>19.11.9</b> Specify the R<sup>2</sup> and log(likelihood) values</a></li>
<li class="chapter" data-level="19.11.10" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#check-model-assumptions-4"><i class="fa fa-check"></i><b>19.11.10</b> Check model assumptions</a></li>
<li class="chapter" data-level="19.11.11" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#predictions-for-harry-and-sally-4"><i class="fa fa-check"></i><b>19.11.11</b> Predictions for Harry and Sally</a></li>
</ul></li>
<li class="chapter" data-level="19.12" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#the-problem-too-few-zeros"><i class="fa fa-check"></i><b>19.12</b> The Problem: Too Few Zeros</a></li>
<li class="chapter" data-level="19.13" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#the-zero-inflated-poisson-regression-model"><i class="fa fa-check"></i><b>19.13</b> The Zero-Inflated Poisson Regression Model</a>
<ul>
<li class="chapter" data-level="19.13.1" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#comparison-to-a-null-model"><i class="fa fa-check"></i><b>19.13.1</b> Comparison to a null model</a></li>
<li class="chapter" data-level="19.13.2" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#comparison-to-a-poisson-model-with-the-vuong-test"><i class="fa fa-check"></i><b>19.13.2</b> Comparison to a Poisson Model with the Vuong test</a></li>
<li class="chapter" data-level="19.13.3" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#the-fitted-equation-3"><i class="fa fa-check"></i><b>19.13.3</b> The Fitted Equation</a></li>
<li class="chapter" data-level="19.13.4" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#interpreting-the-coefficients-5"><i class="fa fa-check"></i><b>19.13.4</b> Interpreting the Coefficients</a></li>
<li class="chapter" data-level="19.13.5" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#testing-the-predictors-3"><i class="fa fa-check"></i><b>19.13.5</b> Testing the Predictors</a></li>
<li class="chapter" data-level="19.13.6" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#store-fitted-values-and-residuals-5"><i class="fa fa-check"></i><b>19.13.6</b> Store fitted values and residuals</a></li>
<li class="chapter" data-level="19.13.7" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#modeled-number-of-zero-counts"><i class="fa fa-check"></i><b>19.13.7</b> Modeled Number of Zero Counts</a></li>
<li class="chapter" data-level="19.13.8" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#rootogram-for-zip-model"><i class="fa fa-check"></i><b>19.13.8</b> Rootogram for ZIP model</a></li>
<li class="chapter" data-level="19.13.9" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#specify-the-r2-and-log-likelihood-values"><i class="fa fa-check"></i><b>19.13.9</b> Specify the R<sup>2</sup> and log (likelihood) values</a></li>
<li class="chapter" data-level="19.13.10" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#check-model-assumptions-5"><i class="fa fa-check"></i><b>19.13.10</b> Check model assumptions</a></li>
<li class="chapter" data-level="19.13.11" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#predictions-for-harry-and-sally-5"><i class="fa fa-check"></i><b>19.13.11</b> Predictions for Harry and Sally</a></li>
</ul></li>
<li class="chapter" data-level="19.14" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#the-zero-inflated-negative-binomial-regression-model"><i class="fa fa-check"></i><b>19.14</b> The Zero-Inflated Negative Binomial Regression Model</a>
<ul>
<li class="chapter" data-level="19.14.1" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#comparison-to-a-null-model-1"><i class="fa fa-check"></i><b>19.14.1</b> Comparison to a null model</a></li>
<li class="chapter" data-level="19.14.2" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#comparison-to-a-negative-binomial-model-vuong-test"><i class="fa fa-check"></i><b>19.14.2</b> Comparison to a Negative Binomial Model: Vuong test</a></li>
<li class="chapter" data-level="19.14.3" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#the-fitted-equation-4"><i class="fa fa-check"></i><b>19.14.3</b> The Fitted Equation</a></li>
<li class="chapter" data-level="19.14.4" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#interpreting-the-coefficients-6"><i class="fa fa-check"></i><b>19.14.4</b> Interpreting the Coefficients</a></li>
<li class="chapter" data-level="19.14.5" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#testing-the-predictors-4"><i class="fa fa-check"></i><b>19.14.5</b> Testing the Predictors</a></li>
<li class="chapter" data-level="19.14.6" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#store-fitted-values-and-residuals-6"><i class="fa fa-check"></i><b>19.14.6</b> Store fitted values and residuals</a></li>
<li class="chapter" data-level="19.14.7" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#modeled-number-of-zero-counts-1"><i class="fa fa-check"></i><b>19.14.7</b> Modeled Number of Zero Counts</a></li>
<li class="chapter" data-level="19.14.8" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#rootogram-for-zero-inflated-negative-binomial-model"><i class="fa fa-check"></i><b>19.14.8</b> Rootogram for Zero-Inflated Negative Binomial model</a></li>
<li class="chapter" data-level="19.14.9" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#specify-the-r2-and-log-likelihood-values-1"><i class="fa fa-check"></i><b>19.14.9</b> Specify the R<sup>2</sup> and log (likelihood) values</a></li>
<li class="chapter" data-level="19.14.10" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#check-model-assumptions-6"><i class="fa fa-check"></i><b>19.14.10</b> Check model assumptions</a></li>
<li class="chapter" data-level="19.14.11" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#predictions-for-harry-and-sally-6"><i class="fa fa-check"></i><b>19.14.11</b> Predictions for Harry and Sally</a></li>
</ul></li>
<li class="chapter" data-level="19.15" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#a-hurdle-model-with-poisson"><i class="fa fa-check"></i><b>19.15</b> A “hurdle” model (with Poisson)</a>
<ul>
<li class="chapter" data-level="19.15.1" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#comparison-to-a-null-model-2"><i class="fa fa-check"></i><b>19.15.1</b> Comparison to a null model</a></li>
<li class="chapter" data-level="19.15.2" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#comparison-to-a-poisson-model-vuong-test"><i class="fa fa-check"></i><b>19.15.2</b> Comparison to a Poisson Model: Vuong test</a></li>
<li class="chapter" data-level="19.15.3" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#comparison-to-a-zero-inflated-poisson-model-vuong-test"><i class="fa fa-check"></i><b>19.15.3</b> Comparison to a Zero-Inflated Poisson Model: Vuong test</a></li>
<li class="chapter" data-level="19.15.4" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#the-fitted-equation-5"><i class="fa fa-check"></i><b>19.15.4</b> The Fitted Equation</a></li>
<li class="chapter" data-level="19.15.5" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#interpreting-the-coefficients-7"><i class="fa fa-check"></i><b>19.15.5</b> Interpreting the Coefficients</a></li>
<li class="chapter" data-level="19.15.6" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#testing-the-predictors-5"><i class="fa fa-check"></i><b>19.15.6</b> Testing the Predictors</a></li>
<li class="chapter" data-level="19.15.7" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#store-fitted-values-and-residuals-7"><i class="fa fa-check"></i><b>19.15.7</b> Store fitted values and residuals</a></li>
<li class="chapter" data-level="19.15.8" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#modeled-number-of-zero-counts-2"><i class="fa fa-check"></i><b>19.15.8</b> Modeled Number of Zero Counts</a></li>
<li class="chapter" data-level="19.15.9" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#rootogram-for-hurdle-model"><i class="fa fa-check"></i><b>19.15.9</b> Rootogram for Hurdle Model</a></li>
<li class="chapter" data-level="19.15.10" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#understanding-the-modeled-counts-in-detail"><i class="fa fa-check"></i><b>19.15.10</b> Understanding the Modeled Counts in Detail</a></li>
<li class="chapter" data-level="19.15.11" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#specify-the-r2-and-log-likelihood-values-2"><i class="fa fa-check"></i><b>19.15.11</b> Specify the R<sup>2</sup> and log (likelihood) values</a></li>
<li class="chapter" data-level="19.15.12" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#check-model-assumptions-7"><i class="fa fa-check"></i><b>19.15.12</b> Check model assumptions</a></li>
<li class="chapter" data-level="19.15.13" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#predictions-for-harry-and-sally-7"><i class="fa fa-check"></i><b>19.15.13</b> Predictions for Harry and Sally</a></li>
</ul></li>
<li class="chapter" data-level="19.16" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#a-hurdle-model-with-negative-binomial-for-overdispersion"><i class="fa fa-check"></i><b>19.16</b> A “hurdle” model (with negative binomial for overdispersion)</a>
<ul>
<li class="chapter" data-level="19.16.1" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#comparison-to-a-null-model-3"><i class="fa fa-check"></i><b>19.16.1</b> Comparison to a null model</a></li>
<li class="chapter" data-level="19.16.2" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#comparison-to-a-negative-binomial-model-vuong-test-1"><i class="fa fa-check"></i><b>19.16.2</b> Comparison to a Negative Binomial Model: Vuong test</a></li>
<li class="chapter" data-level="19.16.3" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#comparison-to-a-zero-inflated-nb-model-vuong-test"><i class="fa fa-check"></i><b>19.16.3</b> Comparison to a Zero-Inflated NB Model: Vuong test</a></li>
<li class="chapter" data-level="19.16.4" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#comparing-the-hurdle-models-with-aic-and-bic"><i class="fa fa-check"></i><b>19.16.4</b> Comparing the Hurdle Models with AIC and BIC</a></li>
<li class="chapter" data-level="19.16.5" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#the-fitted-equation-6"><i class="fa fa-check"></i><b>19.16.5</b> The Fitted Equation</a></li>
<li class="chapter" data-level="19.16.6" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#interpreting-the-coefficients-8"><i class="fa fa-check"></i><b>19.16.6</b> Interpreting the Coefficients</a></li>
<li class="chapter" data-level="19.16.7" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#testing-the-predictors-6"><i class="fa fa-check"></i><b>19.16.7</b> Testing the Predictors</a></li>
<li class="chapter" data-level="19.16.8" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#store-fitted-values-and-residuals-8"><i class="fa fa-check"></i><b>19.16.8</b> Store fitted values and residuals</a></li>
<li class="chapter" data-level="19.16.9" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#rootogram-for-nb-hurdle-model"><i class="fa fa-check"></i><b>19.16.9</b> Rootogram for NB Hurdle Model</a></li>
<li class="chapter" data-level="19.16.10" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#specify-the-r2-and-log-likelihood-values-3"><i class="fa fa-check"></i><b>19.16.10</b> Specify the R<sup>2</sup> and log (likelihood) values</a></li>
<li class="chapter" data-level="19.16.11" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#check-model-assumptions-8"><i class="fa fa-check"></i><b>19.16.11</b> Check model assumptions</a></li>
<li class="chapter" data-level="19.16.12" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#predictions-for-harry-and-sally-8"><i class="fa fa-check"></i><b>19.16.12</b> Predictions for Harry and Sally</a></li>
<li class="chapter" data-level="19.16.13" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#note-fitting-a-different-hurdle-model-for-counts-and-przero"><i class="fa fa-check"></i><b>19.16.13</b> Note: Fitting a Different Hurdle Model for Counts and Pr(zero)</a></li>
<li class="chapter" data-level="19.16.14" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#hanging-rootogram-for-this-new-hurdle-model"><i class="fa fa-check"></i><b>19.16.14</b> Hanging Rootogram for this new Hurdle Model</a></li>
</ul></li>
<li class="chapter" data-level="19.17" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#a-tobit-censored-regression-model"><i class="fa fa-check"></i><b>19.17</b> A Tobit (Censored) Regression Model</a>
<ul>
<li class="chapter" data-level="19.17.1" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#the-fitted-equation-7"><i class="fa fa-check"></i><b>19.17.1</b> The Fitted Equation</a></li>
<li class="chapter" data-level="19.17.2" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#interpreting-the-coefficients-9"><i class="fa fa-check"></i><b>19.17.2</b> Interpreting the Coefficients</a></li>
<li class="chapter" data-level="19.17.3" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#testing-the-predictors-7"><i class="fa fa-check"></i><b>19.17.3</b> Testing the Predictors</a></li>
<li class="chapter" data-level="19.17.4" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#store-fitted-values-and-residuals-9"><i class="fa fa-check"></i><b>19.17.4</b> Store fitted values and residuals</a></li>
<li class="chapter" data-level="19.17.5" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#building-something-like-a-rootogram"><i class="fa fa-check"></i><b>19.17.5</b> Building Something Like a Rootogram</a></li>
<li class="chapter" data-level="19.17.6" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#tables-of-the-observed-and-fitted-physhealth-from-tobit"><i class="fa fa-check"></i><b>19.17.6</b> Tables of the Observed and Fitted <code>physhealth</code> from Tobit</a></li>
<li class="chapter" data-level="19.17.7" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#specify-the-r2-and-log-likelihood-values-4"><i class="fa fa-check"></i><b>19.17.7</b> Specify the R<sup>2</sup> and log (likelihood) values</a></li>
<li class="chapter" data-level="19.17.8" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#check-model-assumptions-9"><i class="fa fa-check"></i><b>19.17.8</b> Check model assumptions</a></li>
<li class="chapter" data-level="19.17.9" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#predictions-for-harry-and-sally-9"><i class="fa fa-check"></i><b>19.17.9</b> Predictions for Harry and Sally</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="20" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><i class="fa fa-check"></i><b>20</b> Modeling an Ordinal Categorical Outcome in Ohio SMART</a>
<ul>
<li class="chapter" data-level="20.1" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#preliminaries-1"><i class="fa fa-check"></i><b>20.1</b> Preliminaries</a></li>
<li class="chapter" data-level="20.2" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#a-subset-of-the-ohio-smart-data-1"><i class="fa fa-check"></i><b>20.2</b> A subset of the Ohio SMART data</a>
<ul>
<li class="chapter" data-level="20.2.1" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#several-ways-of-storing-multi-categorical-data"><i class="fa fa-check"></i><b>20.2.1</b> Several Ways of Storing Multi-Categorical data</a></li>
</ul></li>
<li class="chapter" data-level="20.3" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#building-cross-tabulations"><i class="fa fa-check"></i><b>20.3</b> Building Cross-Tabulations</a>
<ul>
<li class="chapter" data-level="20.3.1" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#using-base-table-functions"><i class="fa fa-check"></i><b>20.3.1</b> Using base <code>table</code> functions</a></li>
<li class="chapter" data-level="20.3.2" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#using-xtabs"><i class="fa fa-check"></i><b>20.3.2</b> Using <code>xtabs</code></a></li>
<li class="chapter" data-level="20.3.3" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#storing-a-table-in-a-tibble"><i class="fa fa-check"></i><b>20.3.3</b> Storing a table in a tibble</a></li>
<li class="chapter" data-level="20.3.4" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#using-crosstable-from-the-gmodels-package"><i class="fa fa-check"></i><b>20.3.4</b> Using <code>CrossTable</code> from the <code>gmodels</code> package</a></li>
</ul></li>
<li class="chapter" data-level="20.4" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#graphing-categorical-data"><i class="fa fa-check"></i><b>20.4</b> Graphing Categorical Data</a>
<ul>
<li class="chapter" data-level="20.4.1" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#a-bar-chart-for-a-single-variable"><i class="fa fa-check"></i><b>20.4.1</b> A Bar Chart for a Single Variable</a></li>
<li class="chapter" data-level="20.4.2" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#a-counts-chart-for-a-2-way-cross-tabulation"><i class="fa fa-check"></i><b>20.4.2</b> A Counts Chart for a 2-Way Cross-Tabulation</a></li>
</ul></li>
<li class="chapter" data-level="20.5" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#building-a-model-for-genh-using-veg_day"><i class="fa fa-check"></i><b>20.5</b> Building a Model for <code>genh</code> using <code>veg_day</code></a>
<ul>
<li class="chapter" data-level="20.5.1" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#a-little-eda"><i class="fa fa-check"></i><b>20.5.1</b> A little EDA</a></li>
<li class="chapter" data-level="20.5.2" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#describing-the-proportional-odds-cumulative-logit-model"><i class="fa fa-check"></i><b>20.5.2</b> Describing the Proportional-Odds Cumulative Logit Model</a></li>
<li class="chapter" data-level="20.5.3" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#fitting-a-proportional-odds-logistic-regression-with-polr"><i class="fa fa-check"></i><b>20.5.3</b> Fitting a Proportional Odds Logistic Regression with <code>polr</code></a></li>
</ul></li>
<li class="chapter" data-level="20.6" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#interpreting-model-m1"><i class="fa fa-check"></i><b>20.6</b> Interpreting Model <code>m1</code></a>
<ul>
<li class="chapter" data-level="20.6.1" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#looking-at-predictions"><i class="fa fa-check"></i><b>20.6.1</b> Looking at Predictions</a></li>
<li class="chapter" data-level="20.6.2" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#making-predictions-for-harry-and-sally-with-predict"><i class="fa fa-check"></i><b>20.6.2</b> Making Predictions for Harry (and Sally) with <code>predict</code></a></li>
<li class="chapter" data-level="20.6.3" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#predicting-the-actual-classification-of-genh"><i class="fa fa-check"></i><b>20.6.3</b> Predicting the actual classification of <code>genh</code></a></li>
<li class="chapter" data-level="20.6.4" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#a-cross-tabulation-of-predictions"><i class="fa fa-check"></i><b>20.6.4</b> A Cross-Tabulation of Predictions?</a></li>
<li class="chapter" data-level="20.6.5" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#the-fitted-model-equations"><i class="fa fa-check"></i><b>20.6.5</b> The Fitted Model Equations</a></li>
<li class="chapter" data-level="20.6.6" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#interpreting-the-veg_day-coefficient"><i class="fa fa-check"></i><b>20.6.6</b> Interpreting the <code>veg_day</code> coefficient</a></li>
<li class="chapter" data-level="20.6.7" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#exponentiating-the-slope-coefficient-to-facilitate-interpretation"><i class="fa fa-check"></i><b>20.6.7</b> Exponentiating the Slope Coefficient to facilitate Interpretation</a></li>
<li class="chapter" data-level="20.6.8" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#comparison-to-a-null-model-4"><i class="fa fa-check"></i><b>20.6.8</b> Comparison to a Null Model</a></li>
</ul></li>
<li class="chapter" data-level="20.7" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#the-assumption-of-proportional-odds"><i class="fa fa-check"></i><b>20.7</b> The Assumption of Proportional Odds</a>
<ul>
<li class="chapter" data-level="20.7.1" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#testing-the-proportional-odds-assumption"><i class="fa fa-check"></i><b>20.7.1</b> Testing the Proportional Odds Assumption</a></li>
</ul></li>
<li class="chapter" data-level="20.8" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#can-model-m1-be-fit-using-rms-tools"><i class="fa fa-check"></i><b>20.8</b> Can model <code>m1</code> be fit using <code>rms</code> tools?</a></li>
<li class="chapter" data-level="20.9" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#building-a-three-predictor-model"><i class="fa fa-check"></i><b>20.9</b> Building a Three-Predictor Model</a>
<ul>
<li class="chapter" data-level="20.9.1" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#scatterplot-matrix-1"><i class="fa fa-check"></i><b>20.9.1</b> Scatterplot Matrix</a></li>
<li class="chapter" data-level="20.9.2" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#our-three-predictor-model-m2"><i class="fa fa-check"></i><b>20.9.2</b> Our Three-Predictor Model, <code>m2</code></a></li>
<li class="chapter" data-level="20.9.3" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#does-the-three-predictor-model-outperform-m1"><i class="fa fa-check"></i><b>20.9.3</b> Does the three-predictor model outperform <code>m1</code>?</a></li>
<li class="chapter" data-level="20.9.4" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#wald-tests-for-individual-predictors"><i class="fa fa-check"></i><b>20.9.4</b> Wald tests for individual predictors</a></li>
<li class="chapter" data-level="20.9.5" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#a-cross-tabulation-of-predictions-1"><i class="fa fa-check"></i><b>20.9.5</b> A Cross-Tabulation of Predictions?</a></li>
<li class="chapter" data-level="20.9.6" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#interpreting-the-effect-sizes"><i class="fa fa-check"></i><b>20.9.6</b> Interpreting the Effect Sizes</a></li>
<li class="chapter" data-level="20.9.7" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#quality-of-the-model-fit"><i class="fa fa-check"></i><b>20.9.7</b> Quality of the Model Fit</a></li>
<li class="chapter" data-level="20.9.8" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#validating-the-summary-statistics-in-m2_lrm"><i class="fa fa-check"></i><b>20.9.8</b> Validating the Summary Statistics in <code>m2_lrm</code></a></li>
<li class="chapter" data-level="20.9.9" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#testing-the-proportional-odds-assumption-1"><i class="fa fa-check"></i><b>20.9.9</b> Testing the Proportional Odds Assumption</a></li>
<li class="chapter" data-level="20.9.10" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#plotting-the-fitted-model"><i class="fa fa-check"></i><b>20.9.10</b> Plotting the Fitted Model</a></li>
</ul></li>
<li class="chapter" data-level="20.10" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#a-larger-model-including-income-group"><i class="fa fa-check"></i><b>20.10</b> A Larger Model, including income group</a>
<ul>
<li class="chapter" data-level="20.10.1" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#cross-tabulation-of-predictedobserved-classifications"><i class="fa fa-check"></i><b>20.10.1</b> Cross-Tabulation of Predicted/Observed Classifications</a></li>
<li class="chapter" data-level="20.10.2" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#nomogram-2"><i class="fa fa-check"></i><b>20.10.2</b> Nomogram</a></li>
<li class="chapter" data-level="20.10.3" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#using-predict-and-showing-mean-prediction-on-1-5-scale-1"><i class="fa fa-check"></i><b>20.10.3</b> Using Predict and showing mean prediction on 1-5 scale</a></li>
<li class="chapter" data-level="20.10.4" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#validating-the-summary-statistics-in-m3_lrm"><i class="fa fa-check"></i><b>20.10.4</b> Validating the Summary Statistics in <code>m3_lrm</code></a></li>
</ul></li>
<li class="chapter" data-level="20.11" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#references-for-this-chapter"><i class="fa fa-check"></i><b>20.11</b> References for this Chapter</a></li>
</ul></li>
<li class="chapter" data-level="21" data-path="analyzing-literary-styles-with-multinomial-logistic-regression.html"><a href="analyzing-literary-styles-with-multinomial-logistic-regression.html"><i class="fa fa-check"></i><b>21</b> Analyzing Literary Styles with Multinomial Logistic Regression</a>
<ul>
<li class="chapter" data-level="21.1" data-path="analyzing-literary-styles-with-multinomial-logistic-regression.html"><a href="analyzing-literary-styles-with-multinomial-logistic-regression.html#the-authorship-example"><i class="fa fa-check"></i><b>21.1</b> The Authorship Example</a></li>
<li class="chapter" data-level="21.2" data-path="analyzing-literary-styles-with-multinomial-logistic-regression.html"><a href="analyzing-literary-styles-with-multinomial-logistic-regression.html#focus-on-11-key-words"><i class="fa fa-check"></i><b>21.2</b> Focus on 11 key words</a>
<ul>
<li class="chapter" data-level="21.2.1" data-path="analyzing-literary-styles-with-multinomial-logistic-regression.html"><a href="analyzing-literary-styles-with-multinomial-logistic-regression.html#side-by-side-boxplots"><i class="fa fa-check"></i><b>21.2.1</b> Side by Side Boxplots</a></li>
</ul></li>
<li class="chapter" data-level="21.3" data-path="analyzing-literary-styles-with-multinomial-logistic-regression.html"><a href="analyzing-literary-styles-with-multinomial-logistic-regression.html#a-multinomial-logistic-regression-model"><i class="fa fa-check"></i><b>21.3</b> A Multinomial Logistic Regression Model</a>
<ul>
<li class="chapter" data-level="21.3.1" data-path="analyzing-literary-styles-with-multinomial-logistic-regression.html"><a href="analyzing-literary-styles-with-multinomial-logistic-regression.html#testing-model-1"><i class="fa fa-check"></i><b>21.3.1</b> Testing Model 1</a></li>
</ul></li>
<li class="chapter" data-level="21.4" data-path="analyzing-literary-styles-with-multinomial-logistic-regression.html"><a href="analyzing-literary-styles-with-multinomial-logistic-regression.html#model-2"><i class="fa fa-check"></i><b>21.4</b> Model 2</a>
<ul>
<li class="chapter" data-level="21.4.1" data-path="analyzing-literary-styles-with-multinomial-logistic-regression.html"><a href="analyzing-literary-styles-with-multinomial-logistic-regression.html#comparing-model-2-to-model-1"><i class="fa fa-check"></i><b>21.4.1</b> Comparing Model 2 to Model 1</a></li>
<li class="chapter" data-level="21.4.2" data-path="analyzing-literary-styles-with-multinomial-logistic-regression.html"><a href="analyzing-literary-styles-with-multinomial-logistic-regression.html#testing-model-2"><i class="fa fa-check"></i><b>21.4.2</b> Testing Model 2</a></li>
<li class="chapter" data-level="21.4.3" data-path="analyzing-literary-styles-with-multinomial-logistic-regression.html"><a href="analyzing-literary-styles-with-multinomial-logistic-regression.html#a-little-history"><i class="fa fa-check"></i><b>21.4.3</b> A little history</a></li>
</ul></li>
<li class="chapter" data-level="21.5" data-path="analyzing-literary-styles-with-multinomial-logistic-regression.html"><a href="analyzing-literary-styles-with-multinomial-logistic-regression.html#classification-table"><i class="fa fa-check"></i><b>21.5</b> Classification Table</a></li>
<li class="chapter" data-level="21.6" data-path="analyzing-literary-styles-with-multinomial-logistic-regression.html"><a href="analyzing-literary-styles-with-multinomial-logistic-regression.html#probability-curves-based-on-a-single-predictor"><i class="fa fa-check"></i><b>21.6</b> Probability Curves based on a Single Predictor</a>
<ul>
<li class="chapter" data-level="21.6.1" data-path="analyzing-literary-styles-with-multinomial-logistic-regression.html"><a href="analyzing-literary-styles-with-multinomial-logistic-regression.html#produce-the-plot-of-estimated-probabilities-based-on-been-counts"><i class="fa fa-check"></i><b>21.6.1</b> Produce the Plot of Estimated Probabilities based on “been” counts</a></li>
<li class="chapter" data-level="21.6.2" data-path="analyzing-literary-styles-with-multinomial-logistic-regression.html"><a href="analyzing-literary-styles-with-multinomial-logistic-regression.html#boxplot-of-been-counts"><i class="fa fa-check"></i><b>21.6.2</b> Boxplot of “been” counts</a></li>
<li class="chapter" data-level="21.6.3" data-path="analyzing-literary-styles-with-multinomial-logistic-regression.html"><a href="analyzing-literary-styles-with-multinomial-logistic-regression.html#quote-sources"><i class="fa fa-check"></i><b>21.6.3</b> Quote Sources</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Data Science for Biological, Medical and Health Research: Notes for 432</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="logistic-regression-and-the-resect-data" class="section level1" number="12">
<h1><span class="header-section-number">Chapter 12</span> Logistic Regression and the <code>resect</code> data</h1>
<div id="the-resect-data" class="section level2" number="12.1">
<h2><span class="header-section-number">12.1</span> The <code>resect</code> data</h2>
<p>My source for these data was <span class="citation"><a href="references.html#ref-Riffenburgh2006" role="doc-biblioref">Riffenburgh</a> (<a href="references.html#ref-Riffenburgh2006" role="doc-biblioref">2006</a>)</span>. The data describe 134 patients who had undergone resection of the tracheal carina (most often this is done to address tumors in the trachea), and the <code>resect.csv</code> data file contains the following variables:</p>
<ul>
<li><code>id</code> = a patient ID #,</li>
<li><code>age</code>= the patient’s age at surgery,</li>
<li><code>prior</code> = prior tracheal surgery (1 = yes, 0 = no),</li>
<li><code>resection</code> = extent of the resection (in cm),</li>
<li><code>intubated</code> = whether intubation was required at the end of surgery (1 = yes, 0 = no), and</li>
<li><code>died</code> = the patient’s death status (1 = dead, 0 = alive).</li>
</ul>
<div class="sourceCode" id="cb686"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb686-1"><a href="logistic-regression-and-the-resect-data.html#cb686-1" aria-hidden="true" tabindex="-1"></a><span class="fu">miss_var_summary</span>(resect)</span></code></pre></div>
<pre><code># A tibble: 6 x 3
  variable  n_miss pct_miss
  &lt;chr&gt;      &lt;int&gt;    &lt;dbl&gt;
1 id             0        0
2 age            0        0
3 prior          0        0
4 resection      0        0
5 intubated      0        0
6 died           0        0</code></pre>
<div class="sourceCode" id="cb688"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb688-1"><a href="logistic-regression-and-the-resect-data.html#cb688-1" aria-hidden="true" tabindex="-1"></a>resect <span class="sc">%&gt;%</span> <span class="fu">count</span>(died, prior)</span></code></pre></div>
<pre><code># A tibble: 4 x 3
   died prior     n
  &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt;
1     0     0    89
2     0     1    28
3     1     0    11
4     1     1     6</code></pre>
<div class="sourceCode" id="cb690"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb690-1"><a href="logistic-regression-and-the-resect-data.html#cb690-1" aria-hidden="true" tabindex="-1"></a>resect <span class="sc">%&gt;%</span> mosaic<span class="sc">::</span><span class="fu">inspect</span>()</span></code></pre></div>
<pre><code>
quantitative variables:  
          name   class min    Q1 median     Q3 max       mean         sd   n
...1        id numeric   1 34.25   67.5 100.75 134 67.5000000 38.8265373 134
...2       age numeric   8 36.00   51.0  61.00  80 47.8432836 15.7775202 134
...3     prior numeric   0  0.00    0.0   0.75   1  0.2537313  0.4367785 134
...4 resection numeric   1  2.00    2.5   4.00   6  2.9634328  1.2402123 134
...5 intubated numeric   0  0.00    0.0   0.00   1  0.1417910  0.3501447 134
...6      died numeric   0  0.00    0.0   0.00   1  0.1268657  0.3340713 134
     missing
...1       0
...2       0
...3       0
...4       0
...5       0
...6       0</code></pre>
<p>We have no missing data, and 17 of the 134 patients died. Our goal will be to understand the characteristics of the patients, and how they relate to the binary outcome of interest, death.</p>
</div>
<div id="running-a-simple-logistic-regression-model" class="section level2" number="12.2">
<h2><span class="header-section-number">12.2</span> Running A Simple Logistic Regression Model</h2>
<p>In the most common scenario, a logistic regression model is used to predict a binary outcome (which can take on the values 0 or 1.) We will eventually fit a logistic regression model in two ways.</p>
<ol style="list-style-type: decimal">
<li>Through the <code>glm</code> function in the base package of R (similar to <code>lm</code> for linear regression)</li>
<li>Through the <code>lrm</code> function available in the <code>rms</code> package (similar to <code>ols</code> for linear regression)</li>
</ol>
<p>We’ll focus on the <code>glm</code> approach first, and save the <code>lrm</code> ideas for later in this Chapter.</p>
<div id="logistic-regression-can-be-harder-than-linear-regression" class="section level3" number="12.2.1">
<h3><span class="header-section-number">12.2.1</span> Logistic Regression Can Be Harder than Linear Regression</h3>
<ul>
<li>Logistic regression models are fitted using the method of maximum likelihood in <code>glm</code>, which requires multiple iterations until convergence is reached.</li>
<li>Logistic regression models are harder to interpret (for most people) than linear regressions.</li>
<li>Logistic regression models don’t have the same set of assumptions as linear models.</li>
<li>Logistic regression outcomes (yes/no) carry much less information than quantitative outcomes. As a result, fitting a reasonable logistic regression requires more data than a linear model of similar size.
<ul>
<li>The rule I learned in graduate school was that a logistic regression requires 100 observations to fit an intercept plus another 15 observations for each candidate predictor. That’s not terrible, but it’s a very large sample size.</li>
<li>Frank Harrell recommends that 96 observations + a function of the number of candidate predictors (which depends on the amount of variation in the predictors, but 15 x the number of such predictors isn’t too bad if the signal to noise ratio is pretty good) are required just to get reasonable confidence intervals around your predictions.
<ul>
<li>In a <a href="https://twitter.com/f2harrell/status/936230071219707913">twitter note</a>, Frank suggests that 96 + 8 times the number of candidate parameters might be reasonable so long as the smallest cell of interest (combination of an outcome and a split of the covariates) is 96 or more observations.</li>
</ul></li>
<li><span class="citation"><a href="references.html#ref-Peduzzi1996" role="doc-biblioref">Peduzzi et al.</a> (<a href="references.html#ref-Peduzzi1996" role="doc-biblioref">1996</a>)</span> suggest that if we let <span class="math inline">\(\pi\)</span> be the smaller of the proportions of “yes” or “no” cases in the population of interest, and <em>k</em> be the number of inputs under consideration, then <span class="math inline">\(N = 10k/\pi\)</span> is the minimum number of cases to include, except that if N &lt; 100 by this standard, you should increase it to 100, according to <span class="citation"><a href="references.html#ref-Long1997" role="doc-biblioref">Long</a> (<a href="references.html#ref-Long1997" role="doc-biblioref">1997</a>)</span>.
<ul>
<li>That suggests that if you have an outcome that happens 10% of the time, and you are running a model with 3 predictors, then you could get away with <span class="math inline">\((10 \times 3)/(0.10) = 300\)</span> observations, but if your outcome happened 40% of the time, you could get away with only <span class="math inline">\((10 \times 3)/(0.40) = 75\)</span> observations, which you’d round up to 100.</li>
</ul></li>
</ul></li>
</ul>
</div>
</div>
<div id="logistic-regression-using-glm" class="section level2" number="12.3">
<h2><span class="header-section-number">12.3</span> Logistic Regression using <code>glm</code></h2>
<p>We’ll begin by attempting to predict death based on the extent of the resection.</p>
<div class="sourceCode" id="cb692"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb692-1"><a href="logistic-regression-and-the-resect-data.html#cb692-1" aria-hidden="true" tabindex="-1"></a>res_modA <span class="ot">&lt;-</span> <span class="fu">glm</span>(died <span class="sc">~</span> resection, <span class="at">data=</span>resect, </span>
<span id="cb692-2"><a href="logistic-regression-and-the-resect-data.html#cb692-2" aria-hidden="true" tabindex="-1"></a>               <span class="at">family=</span><span class="st">&quot;binomial&quot;</span>(<span class="at">link=</span><span class="st">&quot;logit&quot;</span>))</span>
<span id="cb692-3"><a href="logistic-regression-and-the-resect-data.html#cb692-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb692-4"><a href="logistic-regression-and-the-resect-data.html#cb692-4" aria-hidden="true" tabindex="-1"></a>res_modA</span></code></pre></div>
<pre><code>
Call:  glm(formula = died ~ resection, family = binomial(link = &quot;logit&quot;), 
    data = resect)

Coefficients:
(Intercept)    resection  
    -4.4337       0.7417  

Degrees of Freedom: 133 Total (i.e. Null);  132 Residual
Null Deviance:      101.9 
Residual Deviance: 89.49    AIC: 93.49</code></pre>
<p>Note that the <code>logit</code> link is the default approach with the <code>binomial</code> family, so we could also have used:</p>
<div class="sourceCode" id="cb694"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb694-1"><a href="logistic-regression-and-the-resect-data.html#cb694-1" aria-hidden="true" tabindex="-1"></a>res_modA <span class="ot">&lt;-</span> <span class="fu">glm</span>(died <span class="sc">~</span> resection, <span class="at">data =</span> resect, </span>
<span id="cb694-2"><a href="logistic-regression-and-the-resect-data.html#cb694-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">family =</span> <span class="st">&quot;binomial&quot;</span>)</span></code></pre></div>
<p>which yields the same model.</p>
<div id="interpreting-the-coefficients-of-a-logistic-regression-model-1" class="section level3" number="12.3.1">
<h3><span class="header-section-number">12.3.1</span> Interpreting the Coefficients of a Logistic Regression Model</h3>
<p>Our model is:</p>
<p><span class="math display">\[
logit(died = 1) = log\left(\frac{Pr(died = 1)}{1 - Pr(died = 1)}\right) = \beta_0 + \beta_1 x = -4.4337 + 0.7417 \times resection
\]</span></p>
<p>The predicted log odds of death for a subject with a resection of 4 cm is:</p>
<p><span class="math display">\[
log\left(\frac{Pr(died = 1)}{1 - Pr(died = 1)}\right) = -4.4337 + 0.7417 \times 4 = -1.467
\]</span></p>
<p>The predicted odds of death for a subject with a resection of 4 cm is thus:</p>
<p><span class="math display">\[
\frac{Pr(died = 1)}{1 - Pr(died = 1)} = e^{-4.4337 + 0.7417 \times 4} = e^{-1.467} = 0.2306
\]</span></p>
<p>Since the odds are less than 1, we should find that the probability of death is less than 1/2. With a little algebra, we see that the predicted probability of death for a subject with a resection of 4 cm is:</p>
<p><span class="math display">\[
Pr(died = 1) = \frac{e^{-4.4337 + 0.7417 \times 4}}{1 + e^{-4.4337 + 0.7417 \times 4}} = \frac{e^{-1.467}}{1 + e^{-1.467}} = \frac{0.2306}{1.2306} = 0.187
\]</span></p>
<p>In general, we can frame the model in terms of a statement about probabilities, like this:</p>
<p><span class="math display">\[
Pr(died = 1) = \frac{e^{\beta_0 + \beta_1 x}}{1 + {e^{\beta_0 + \beta_1 x}}} = \frac{e^{-4.4337 + 0.7417 \times resection}}{1 + e^{-4.4337 + 0.7417 \times resection}}
\]</span></p>
<p>and so by substituting in values for <code>resection</code>, we can estimate the model’s fitted probabilities of death.</p>
</div>
<div id="using-predict-to-describe-the-models-fits" class="section level3" number="12.3.2">
<h3><span class="header-section-number">12.3.2</span> Using <code>predict</code> to describe the model’s fits</h3>
<p>To obtain these fitted odds and probabilities in R, we can use the <code>predict</code> function.</p>
<ul>
<li>The default predictions are on the scale of the log odds. These predictions are also available through the <code>type = "link"</code> command within the <code>predict</code> function for a generalized linear model like logistic regression.</li>
<li>Here are the predicted log odds of death for a subject (Sally) with a 4 cm resection and a subject (Harry) who had a 5 cm resection.</li>
</ul>
<div class="sourceCode" id="cb695"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb695-1"><a href="logistic-regression-and-the-resect-data.html#cb695-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(res_modA, <span class="at">newdata =</span> <span class="fu">tibble</span>(<span class="at">resection =</span> <span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">5</span>)))</span></code></pre></div>
<pre><code>         1          2 
-1.4669912 -0.7253027 </code></pre>
<ul>
<li>We can also obtain predictions for each subject on the original response (here, probability) scale, backing out of the logit link.</li>
</ul>
<div class="sourceCode" id="cb697"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb697-1"><a href="logistic-regression-and-the-resect-data.html#cb697-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(res_modA, <span class="at">newdata =</span> <span class="fu">tibble</span>(<span class="at">resection =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">5</span>)), </span>
<span id="cb697-2"><a href="logistic-regression-and-the-resect-data.html#cb697-2" aria-hidden="true" tabindex="-1"></a>        <span class="at">type =</span> <span class="st">&quot;response&quot;</span>)</span></code></pre></div>
<pre><code>        1         2 
0.1874004 0.3262264 </code></pre>
<p>So the predicted probability of death is 0.187 for Sally, the subject with a 4 cm resection, and 0.326 for Harry, the subject with a 5 cm resection.</p>
</div>
<div id="odds-ratio-interpretation-of-coefficients" class="section level3" number="12.3.3">
<h3><span class="header-section-number">12.3.3</span> Odds Ratio interpretation of Coefficients</h3>
<p>Often, we will exponentiate the estimated slope coefficients of a logistic regression model to help us understand the impact of changing a predictor on the odds of our outcome.</p>
<div class="sourceCode" id="cb699"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb699-1"><a href="logistic-regression-and-the-resect-data.html#cb699-1" aria-hidden="true" tabindex="-1"></a><span class="fu">exp</span>(<span class="fu">coef</span>(res_modA))</span></code></pre></div>
<pre><code>(Intercept)   resection 
 0.01186995  2.09947754 </code></pre>
<p>To interpret this finding, suppose we have two subjects, Harry and Sally. Harry had a resection that was 1 cm larger than Sally. This estimated coefficient suggests that the estimated odds for death associated with Harry is 2.099 times larger than the odds for death associated with Sally. In general, the odds ratio comparing two subjects who differ by 1 cm on the resection length is 2.099.</p>
<p>To illustrate, again let’s assume that Harry’s resection was 5 cm, and Sally’s was 4 cm. Then we have:</p>
<p><span class="math display">\[
log\left(\frac{Pr(Harry died)}{1 - Pr(Harry died)}\right) = -4.4337 + 0.7417 \times 5 = -0.7253, \\
log\left(\frac{Pr(Sally died)}{1 - Pr(Sally died)}\right) = -4.4337 + 0.7417 \times 4 = -1.4667.
\]</span></p>
<p>which implies that our estimated odds of death for Harry and Sally are:</p>
<p><span class="math display">\[
Odds(Harry died) = \frac{Pr(Harry died)}{1 - Pr(Harry died)} = e^{-4.4337 + 0.7417 \times 5} = e^{-0.7253} = 0.4842 \\
Odds(Sally died) = \frac{Pr(Sally died)}{1 - Pr(Sally died)} = e^{-4.4337 + 0.7417 \times 4} = e^{-1.4667} = 0.2307
\]</span></p>
<p>and so the odds ratio is:</p>
<p><span class="math display">\[
OR = \frac{Odds(Harry died)}{Odds(Sally died)} = \frac{0.4842}{0.2307} = 2.099
\]</span></p>
<ul>
<li>If the odds ratio was 1, that would mean that Harry and Sally had the same estimated odds of death, and thus the same estimated probability of death, despite having different sizes of resections.</li>
<li>Since the odds ratio is greater than 1, it means that Harry has a higher estimated odds of death than Sally, and thus that Harry has a higher estimated probability of death than Sally.</li>
<li>If the odds ratio was less than 1, it would mean that Harry had a lower estimated odds of death than Sally, and thus that Harry had a lower estimated probability of death than Sally.</li>
</ul>
<p>Remember that the odds ratio is a fraction describing two positive numbers (odds can only be non-negative) so that the smallest possible odds ratio is 0.</p>
</div>
<div id="interpreting-the-rest-of-the-model-output-from-glm" class="section level3" number="12.3.4">
<h3><span class="header-section-number">12.3.4</span> Interpreting the rest of the model output from <code>glm</code></h3>
<div class="sourceCode" id="cb701"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb701-1"><a href="logistic-regression-and-the-resect-data.html#cb701-1" aria-hidden="true" tabindex="-1"></a>res_modA</span></code></pre></div>
<pre><code>
Call:  glm(formula = died ~ resection, family = &quot;binomial&quot;, data = resect)

Coefficients:
(Intercept)    resection  
    -4.4337       0.7417  

Degrees of Freedom: 133 Total (i.e. Null);  132 Residual
Null Deviance:      101.9 
Residual Deviance: 89.49    AIC: 93.49</code></pre>
<p>In addition to specifying the logistic regression coefficients, we are also presented with information on degrees of freedom, deviance (null and residual) and AIC.</p>
<ul>
<li>The degrees of freedom indicate the sample size.
<ul>
<li>Recall that we had <em>n</em> = 134 subjects in the data. The “Null” model includes only an intercept term (which uses 1 df) and we thus have <em>n</em> - 1 (here 133) degrees of freedom available for estimation.</li>
<li>In our <code>res_modA</code> model, a logistic regression is fit including a single slope (resection) and an intercept term. Each uses up one degree of freedom to build an estimate, so we have <em>n</em> - 2 = 134 - 2 = 132 residual df remaining.</li>
</ul></li>
<li>The AIC or Akaike Information Criterion (lower values are better) is also provided. This is helpful if we’re
comparing multiple models for the same outcome.</li>
</ul>
</div>
<div id="deviance-and-comparing-our-model-to-the-null-model" class="section level3" number="12.3.5">
<h3><span class="header-section-number">12.3.5</span> Deviance and Comparing Our Model to the Null Model</h3>
<ul>
<li>The deviance (a measure of the model’s <em>lack of fit</em>) is available for both the null model (the model with only an intercept) and for our model (<code>res_modA</code>) predicting our outcome, mortality.</li>
<li>The deviance test, though available in R (see below) isn’t really a test of whether the model works well. Instead, it assumes the model is true, and then tests to see if the coefficients are detectably different from zero. So it isn’t of much practical use.
<ul>
<li>To compare the <code>deviance</code> statistics, we can subtract the residual deviance from the null deviance to describe the impact of our model on fit.</li>
<li>Null Deviance - Residual Deviance can be compared to a <span class="math inline">\(\chi^2\)</span> distribution with Null DF - Residual DF degrees of freedom to obtain a global test of the in-sample predictive power of our model.</li>
<li>We can see this comparison more directly by running <code>anova</code> on our model:</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb703"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb703-1"><a href="logistic-regression-and-the-resect-data.html#cb703-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(res_modA, <span class="at">test =</span> <span class="st">&quot;LRT&quot;</span>)</span></code></pre></div>
<pre><code>Analysis of Deviance Table

Model: binomial, link: logit

Response: died

Terms added sequentially (first to last)

          Df Deviance Resid. Df Resid. Dev  Pr(&gt;Chi)    
NULL                        133    101.943              
resection  1    12.45       132     89.493 0.0004179 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>The <code>test = "LRT"</code> section completes a deviance test and provides a <em>p</em> value, which just estimates the probability that a chi-square distribution with a single degree of freedom would exhibit an improvement in deviance as large as 12.45.</p>
<p>The <em>p</em> value for the deviance test here is about 0.0004. But, again, this isn’t a test of whether the model is any good - it assumes the model is true, and then tests some consequences.</p>
<ul>
<li>Specifically, it tests whether (if the model is TRUE) some of the model’s coefficients are non-zero.</li>
<li>That’s not so practically useful, so I discourage you from performing global tests of a logistic regression model with a deviance test.</li>
</ul>
</div>
<div id="using-glance-with-a-logistic-regression-model" class="section level3" number="12.3.6">
<h3><span class="header-section-number">12.3.6</span> Using <code>glance</code> with a logistic regression model</h3>
<p>We can use the <code>glance</code> function from the <code>broom</code> package to obtain the null and residual deviance and degrees of freedom. Note that the deviance for our model is related to the log likelihood by -2*<code>logLik</code>.</p>
<div class="sourceCode" id="cb705"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb705-1"><a href="logistic-regression-and-the-resect-data.html#cb705-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(res_modA)</span></code></pre></div>
<pre><code># A tibble: 1 x 8
  null.deviance df.null logLik   AIC   BIC deviance df.residual  nobs
          &lt;dbl&gt;   &lt;int&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;       &lt;int&gt; &lt;int&gt;
1          102.     133  -44.7  93.5  99.3     89.5         132   134</code></pre>
<p>The <code>glance</code> result also provides the AIC, and the BIC (Bayes Information Criterion), each of which is helpful in understanding comparisons between multiple models for the same outcome (with smaller values of either criterion indicating better models.) The AIC is based on the deviance, but penalizes you for making the model more complicated. The BIC does the same sort of thing but with a different penalty.</p>
<p>Again we see that we have a null deviance of 101.94 on 133 degrees of freedom. Including the <code>resection</code> information in the model decreased the deviance to 89.49 points on 132 degrees of freedom, so that’s a decrease of 12.45 points while using one degree of freedom, a statistically significant reduction in deviance.</p>
</div>
</div>
<div id="interpreting-the-model-summary" class="section level2" number="12.4">
<h2><span class="header-section-number">12.4</span> Interpreting the Model Summary</h2>
<p>Let’s get a more detailed summary of our <code>res_modA</code> model, including 95% confidence intervals for the coefficients:</p>
<div class="sourceCode" id="cb707"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb707-1"><a href="logistic-regression-and-the-resect-data.html#cb707-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(res_modA)</span></code></pre></div>
<pre><code>
Call:
glm(formula = died ~ resection, family = &quot;binomial&quot;, data = resect)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-1.1844  -0.5435  -0.3823  -0.2663   2.4501  

Coefficients:
            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)  -4.4337     0.8799  -5.039 4.67e-07 ***
resection     0.7417     0.2230   3.327 0.000879 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 101.943  on 133  degrees of freedom
Residual deviance:  89.493  on 132  degrees of freedom
AIC: 93.493

Number of Fisher Scoring iterations: 5</code></pre>
<div class="sourceCode" id="cb709"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb709-1"><a href="logistic-regression-and-the-resect-data.html#cb709-1" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(res_modA, <span class="at">level =</span> <span class="fl">0.95</span>)</span></code></pre></div>
<pre><code>Waiting for profiling to be done...</code></pre>
<pre><code>                2.5 %    97.5 %
(Intercept) -6.344472 -2.855856
resection    0.322898  1.208311</code></pre>
<p>Some elements of this summary are very familiar from our work with linear models.</p>
<ul>
<li>We still have a five-number summary of residuals, although these are called <em>deviance</em> residuals.</li>
<li>We have a table of coefficients with standard errors, and hypothesis tests, although these are Wald z-tests, rather than the t tests we saw in linear modeling.</li>
<li>We have a summary of global fit in the comparison of null deviance and residual deviance, but without a formal p value. And we have the AIC, as discussed above.</li>
<li>We also have some new items related to a <em>dispersion</em> parameter and to the number of Fisher Scoring Iterations.</li>
</ul>
<p>Let’s walk through each of these elements.</p>
<div id="wald-z-tests-for-coefficients-in-a-logistic-regression" class="section level3" number="12.4.1">
<h3><span class="header-section-number">12.4.1</span> Wald Z tests for Coefficients in a Logistic Regression</h3>
<p>The coefficients output provides the estimated coefficients, and their standard errors, plus a Wald Z statistic, which is just the estimated coefficient divided by its standard error. This is compared to a standard Normal distribution to obtain the two-tailed p values summarized in the <code>Pr(&gt;|z|)</code> column.</p>
<ul>
<li>The interesting result is <code>resection</code>, which has a Wald Z = 3.327, yielding a <em>p</em> value of 0.00088.</li>
<li>The <em>p</em> value assesses whether the estimated coefficient of <code>resection</code>, 0.7417, is statistically detectably different from 0. If the coefficient (on the logit scale) for <code>resection</code> was truly 0, this would mean that:
<ul>
<li>the log odds of death did not change based on the <code>resection</code> size,</li>
<li>the odds of death were unchanged based on the <code>resection</code> size (the odds ratio would be 1), and</li>
<li>the probability of death was unchanged based on the <code>resection</code> size.</li>
</ul></li>
</ul>
<p>In our case, we have a statistically detectable change in the log odds of <code>died</code> associated with changes in <code>resection</code>, according to this <em>p</em> value. We conclude that <code>resection</code> size is associated with a positive impact on death rates (death rates are generally higher for people with larger resections.)</p>
</div>
<div id="confidence-intervals-for-the-coefficients" class="section level3" number="12.4.2">
<h3><span class="header-section-number">12.4.2</span> Confidence Intervals for the Coefficients</h3>
<p>As in linear regression, we can obtain 95% confidence intervals (to get other levels, change the <code>level</code> parameter in <code>confint</code>) for the intercept and slope coefficients.</p>
<p>Here, we see, for example, that the coefficient of <code>resection</code> has a point estimate of 0.7417, and a confidence interval of (0.3229, 1.208). Since this is on the logit scale, it’s not that interpretable, but we will often exponentiate the model and its confidence interval to obtain a more interpretable result on the odds ratio scale.</p>
<div class="sourceCode" id="cb712"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb712-1"><a href="logistic-regression-and-the-resect-data.html#cb712-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(res_modA, <span class="at">exponentiate =</span> <span class="cn">TRUE</span>, <span class="at">conf.int =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb712-2"><a href="logistic-regression-and-the-resect-data.html#cb712-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(term, estimate, conf.low, conf.high)</span></code></pre></div>
<pre><code># A tibble: 2 x 4
  term        estimate conf.low conf.high
  &lt;chr&gt;          &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;
1 (Intercept)   0.0119  0.00176    0.0575
2 resection     2.10    1.38       3.35  </code></pre>
<p>From this output, we can estimate the odds ratio for death associated with a 1 cm increase in resection size is 2.099, with a 95% CI of (1.38, 3.35).
- If the odds ratio was 1, it would indicate that the odds of death did not change based on the change in resection size.
- Here, it’s clear that the estimated odds of death will be larger (odds &gt; 1) for subjects with larger resection sizes. Larger odds of death also indicate larger probabilities of death. This confidence interval indicates that with 95% confidence, we conclude that increases in resection size are associated with statistically detectable increases in the odds of death.
- If the odds ratio was less than 1 (remember that it cannot be less than 0) that would mean that subjects with larger resection sizes were associated with smaller estimated odds of death.</p>
</div>
<div id="deviance-residuals" class="section level3" number="12.4.3">
<h3><span class="header-section-number">12.4.3</span> Deviance Residuals</h3>
<p>In logistic regression, it’s certainly a good idea to check to see how well the model fits the data. However, there are a few different types of residuals. The residuals presented here by default are called deviance residuals. Other types of residuals are available for generalized linear models, such as Pearson residuals, working residuals, and response residuals. Logistic regression model diagnostics often make use of multiple types of residuals.</p>
<p>The deviance residuals for each individual subject sum up to the deviance statistic for the model, and describe the contribution of each point to the model likelihood function.</p>
<p>The deviance residual, <span class="math inline">\(d_i\)</span>, for the i<sup>th</sup> observation in a model predicting <span class="math inline">\(y_i\)</span> (a binary variable), with the estimate being <span class="math inline">\(\hat{\pi}_i\)</span> is:</p>
<p><span class="math display">\[
d_i = s_i \sqrt{-2 [y_i log \hat{\pi_i} + (1 - y_i) log(1 - \hat{\pi_i})]},
\]</span></p>
<p>where <span class="math inline">\(s_i\)</span> is 1 if <span class="math inline">\(y_i = 1\)</span> and <span class="math inline">\(s_i = -1\)</span> if <span class="math inline">\(y_i = 0\)</span>.</p>
<p>Again, the sum of the deviance residuals is the deviance.</p>
</div>
<div id="dispersion-parameter" class="section level3" number="12.4.4">
<h3><span class="header-section-number">12.4.4</span> Dispersion Parameter</h3>
<p>The dispersion parameter is taken to be 1 for <code>glm</code> fit using either the <code>binomial</code> or <code>Poisson</code> families. For other sorts of generalized linear models, the dispersion parameter will be of some importance in estimating standard errors sensibly.</p>
</div>
<div id="fisher-scoring-iterations" class="section level3" number="12.4.5">
<h3><span class="header-section-number">12.4.5</span> Fisher Scoring iterations</h3>
<p>The solution of a logistic regression model involves maximizing a likelihood function. Fisher’s scoring algorithm in our <code>res_modA</code> needed five iterations to perform the logistic regression fit. All that this tells you is that the model converged, and didn’t require a lot of time to do so.</p>
</div>
</div>
<div id="plotting-a-simple-logistic-regression-model" class="section level2" number="12.5">
<h2><span class="header-section-number">12.5</span> Plotting a Simple Logistic Regression Model</h2>
<p>Let’s plot the logistic regression model <code>res_modA</code> for <code>died</code> using the extent of the resection in terms of probabilities. We can use either of two different approaches:</p>
<ul>
<li>we can plot the fitted values from our specific model against the original data, using the <code>augment</code> function from the <code>broom</code> package, or</li>
<li>we can create a smooth function called <code>binomial_smooth</code> that plots a simple logistic model in an analogous way to <code>geom_smooth(method = "lm")</code> for a simple linear regression.</li>
</ul>
<div id="using-augment-to-capture-the-fitted-probabilities" class="section level3" number="12.5.1">
<h3><span class="header-section-number">12.5.1</span> Using <code>augment</code> to capture the fitted probabilities</h3>
<div class="sourceCode" id="cb714"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb714-1"><a href="logistic-regression-and-the-resect-data.html#cb714-1" aria-hidden="true" tabindex="-1"></a>res_A_aug <span class="ot">&lt;-</span> <span class="fu">augment</span>(res_modA, resect, </span>
<span id="cb714-2"><a href="logistic-regression-and-the-resect-data.html#cb714-2" aria-hidden="true" tabindex="-1"></a>                     <span class="at">type.predict =</span> <span class="st">&quot;response&quot;</span>)</span>
<span id="cb714-3"><a href="logistic-regression-and-the-resect-data.html#cb714-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(res_A_aug)</span></code></pre></div>
<pre><code># A tibble: 6 x 12
     id   age prior resection intubated  died .fitted .resid .std.resid    .hat
  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;      &lt;dbl&gt;   &lt;dbl&gt;
1     1    34     1       2.5         0     0  0.0705 -0.382     -0.384 0.0100 
2     2    57     0       5           0     0  0.326  -0.889     -0.904 0.0337 
3     3    60     1       4           1     1  0.187   1.83       1.84  0.0120 
4     4    62     1       4.2         0     0  0.211  -0.689     -0.693 0.0143 
5     5    28     0       6           1     1  0.504   1.17       1.22  0.0818 
6     6    52     0       3           0     0  0.0990 -0.457     -0.459 0.00922
# ... with 2 more variables: .sigma &lt;dbl&gt;, .cooksd &lt;dbl&gt;</code></pre>
<p>This approach augments the <code>resect</code> data set with fitted, residual and other summaries of each observation’s impact on the fit, using the “response” type of prediction, which yields the fitted probabilities in the <code>.fitted</code> column.</p>
</div>
<div id="plotting-a-logistic-regression-models-fitted-values" class="section level3" number="12.5.2">
<h3><span class="header-section-number">12.5.2</span> Plotting a Logistic Regression Model’s Fitted Values</h3>
<div class="sourceCode" id="cb716"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb716-1"><a href="logistic-regression-and-the-resect-data.html#cb716-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(res_A_aug, <span class="fu">aes</span>(<span class="at">x =</span> resection, <span class="at">y =</span> died)) <span class="sc">+</span></span>
<span id="cb716-2"><a href="logistic-regression-and-the-resect-data.html#cb716-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_jitter</span>(<span class="at">height =</span> <span class="fl">0.05</span>) <span class="sc">+</span></span>
<span id="cb716-3"><a href="logistic-regression-and-the-resect-data.html#cb716-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> resection, <span class="at">y =</span> .fitted), </span>
<span id="cb716-4"><a href="logistic-regression-and-the-resect-data.html#cb716-4" aria-hidden="true" tabindex="-1"></a>              <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>) <span class="sc">+</span></span>
<span id="cb716-5"><a href="logistic-regression-and-the-resect-data.html#cb716-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Logistic Regression from Model res_modA&quot;</span>)</span></code></pre></div>
<p><img src="432-notes_files/figure-html/unnamed-chunk-250-1.png" width="672" /></p>
</div>
<div id="plotting-a-simple-logistic-model-using-binomial_smooth" class="section level3" number="12.5.3">
<h3><span class="header-section-number">12.5.3</span> Plotting a Simple Logistic Model using <code>binomial_smooth</code></h3>
<div class="sourceCode" id="cb717"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb717-1"><a href="logistic-regression-and-the-resect-data.html#cb717-1" aria-hidden="true" tabindex="-1"></a>binomial_smooth <span class="ot">&lt;-</span> <span class="cf">function</span>(...) {</span>
<span id="cb717-2"><a href="logistic-regression-and-the-resect-data.html#cb717-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;glm&quot;</span>, </span>
<span id="cb717-3"><a href="logistic-regression-and-the-resect-data.html#cb717-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">method.args =</span> <span class="fu">list</span>(<span class="at">family =</span> <span class="st">&quot;binomial&quot;</span>), ...)</span>
<span id="cb717-4"><a href="logistic-regression-and-the-resect-data.html#cb717-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb717-5"><a href="logistic-regression-and-the-resect-data.html#cb717-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb717-6"><a href="logistic-regression-and-the-resect-data.html#cb717-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(resect, <span class="fu">aes</span>(<span class="at">x =</span> resection, <span class="at">y =</span> died)) <span class="sc">+</span></span>
<span id="cb717-7"><a href="logistic-regression-and-the-resect-data.html#cb717-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">height =</span> <span class="fl">0.05</span>) <span class="sc">+</span></span>
<span id="cb717-8"><a href="logistic-regression-and-the-resect-data.html#cb717-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">binomial_smooth</span>() <span class="sc">+</span> <span class="do">## ...smooth(se=FALSE) to leave out interval</span></span>
<span id="cb717-9"><a href="logistic-regression-and-the-resect-data.html#cb717-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Logistic Regression from Model A&quot;</span>) <span class="sc">+</span></span>
<span id="cb717-10"><a href="logistic-regression-and-the-resect-data.html#cb717-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<pre><code>`geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="432-notes_files/figure-html/unnamed-chunk-251-1.png" width="672" /></p>
<p>As expected, we see an increase in the model probability of death as the extent of the resection grows larger.</p>
</div>
</div>
<div id="how-well-does-model-a-classify-subjects" class="section level2" number="12.6">
<h2><span class="header-section-number">12.6</span> How well does Model A classify subjects?</h2>
<p>A natural question to ask is how well does our model classify patients in terms of likelihood of death.</p>
<p>We could specify a particular rule, for example: if the predicted probability of death is 0.5 or greater, then predict “Died.”</p>
<div class="sourceCode" id="cb719"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb719-1"><a href="logistic-regression-and-the-resect-data.html#cb719-1" aria-hidden="true" tabindex="-1"></a>res_A_aug<span class="sc">$</span>rule<span class="fl">.5</span> <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(res_A_aug<span class="sc">$</span>.fitted <span class="sc">&gt;=</span> <span class="fl">0.5</span>, </span>
<span id="cb719-2"><a href="logistic-regression-and-the-resect-data.html#cb719-2" aria-hidden="true" tabindex="-1"></a>                       <span class="st">&quot;Predict Died&quot;</span>, <span class="st">&quot;Predict Alive&quot;</span>)</span>
<span id="cb719-3"><a href="logistic-regression-and-the-resect-data.html#cb719-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb719-4"><a href="logistic-regression-and-the-resect-data.html#cb719-4" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(res_A_aug<span class="sc">$</span>rule<span class="fl">.5</span>, res_A_aug<span class="sc">$</span>died)</span></code></pre></div>
<pre><code>               
                  0   1
  Predict Alive 114  16
  Predict Died    3   1</code></pre>
<p>And perhaps build the linked table of row probabilities which tells us, for example, that 87.69% of the patients predicted by the model to be alive actually did survive.</p>
<div class="sourceCode" id="cb721"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb721-1"><a href="logistic-regression-and-the-resect-data.html#cb721-1" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="dv">100</span><span class="sc">*</span><span class="fu">prop.table</span>(</span>
<span id="cb721-2"><a href="logistic-regression-and-the-resect-data.html#cb721-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">table</span>(res_A_aug<span class="sc">$</span>rule<span class="fl">.5</span>, res_A_aug<span class="sc">$</span>died), <span class="dv">1</span>), <span class="dv">2</span>)</span></code></pre></div>
<pre><code>               
                    0     1
  Predict Alive 87.69 12.31
  Predict Died  75.00 25.00</code></pre>
<p>Or the table of column probabilities which tell us, for example, that 97.44% of those who actually survived were predicted by the model to be alive.</p>
<div class="sourceCode" id="cb723"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb723-1"><a href="logistic-regression-and-the-resect-data.html#cb723-1" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="dv">100</span><span class="sc">*</span><span class="fu">prop.table</span>(</span>
<span id="cb723-2"><a href="logistic-regression-and-the-resect-data.html#cb723-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">table</span>(res_A_aug<span class="sc">$</span>rule<span class="fl">.5</span>, res_A_aug<span class="sc">$</span>died), <span class="dv">2</span>), <span class="dv">2</span>)</span></code></pre></div>
<pre><code>               
                    0     1
  Predict Alive 97.44 94.12
  Predict Died   2.56  5.88</code></pre>
<p>We’ll discuss various measures of concordance derived from this sort of classification later.</p>
</div>
<div id="the-confusion-matrix" class="section level2" number="12.7">
<h2><span class="header-section-number">12.7</span> The Confusion Matrix</h2>
<p>Let’s build this misclassification table in standard epidemiological format.</p>
<div class="sourceCode" id="cb725"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb725-1"><a href="logistic-regression-and-the-resect-data.html#cb725-1" aria-hidden="true" tabindex="-1"></a>confuseA_small <span class="ot">&lt;-</span> </span>
<span id="cb725-2"><a href="logistic-regression-and-the-resect-data.html#cb725-2" aria-hidden="true" tabindex="-1"></a>  res_A_aug <span class="sc">%&gt;%</span></span>
<span id="cb725-3"><a href="logistic-regression-and-the-resect-data.html#cb725-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">death_predicted =</span> <span class="fu">factor</span>(.fitted <span class="sc">&gt;=</span> <span class="fl">0.5</span>),</span>
<span id="cb725-4"><a href="logistic-regression-and-the-resect-data.html#cb725-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">death_actual =</span> <span class="fu">factor</span>(died <span class="sc">==</span> <span class="st">&quot;1&quot;</span>),</span>
<span id="cb725-5"><a href="logistic-regression-and-the-resect-data.html#cb725-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">death_predicted =</span> <span class="fu">fct_relevel</span>(death_predicted, <span class="st">&quot;TRUE&quot;</span>),</span>
<span id="cb725-6"><a href="logistic-regression-and-the-resect-data.html#cb725-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">death_actual =</span> <span class="fu">fct_relevel</span>(death_actual, <span class="st">&quot;TRUE&quot;</span>)) <span class="sc">%$%</span></span>
<span id="cb725-7"><a href="logistic-regression-and-the-resect-data.html#cb725-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">table</span>(death_predicted, death_actual)</span>
<span id="cb725-8"><a href="logistic-regression-and-the-resect-data.html#cb725-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb725-9"><a href="logistic-regression-and-the-resect-data.html#cb725-9" aria-hidden="true" tabindex="-1"></a>confuseA_small</span></code></pre></div>
<pre><code>               death_actual
death_predicted TRUE FALSE
          TRUE     1     3
          FALSE   16   114</code></pre>
<p>In total, we have 134 observations.</p>
<ul>
<li>115 correct predictions, or 85.8% accuracy</li>
<li>17 subjects who died, or 12.6% prevalence of death</li>
<li>4 subjects who were predicted to die, or 3.0% detection prevalence.</li>
</ul>
<p>The sensitivity (also called recall) here is 1 / (1 + 16) = 5.9%.</p>
<ul>
<li>5.9% of the subjects who actually died were predicted to die by the model.</li>
</ul>
<p>The specificity here is 114 / (114 + 3) = 97.4%.</p>
<ul>
<li>97.4% of the subjects who actually survived were predicted to survive by the model.</li>
</ul>
<p>The positive predictive value (PPV: also called precision) is 1 / (1 + 3) = 25%</p>
<ul>
<li>Our predictions of death were correct 25% of the time.</li>
</ul>
<p>The negative predictive value (NPV) is 114 / (114 + 16) = 87.7%</p>
<ul>
<li>Our predictions of survival were correct 87.7% of the time.</li>
</ul>
</div>
<div id="using-the-confusionmatrix-tool-from-the-caret-package" class="section level2" number="12.8">
<h2><span class="header-section-number">12.8</span> Using the <code>confusionMatrix</code> tool from the <code>caret</code> package</h2>
<p>This provides a more detailed summary of the classification results from our logistic regression model.</p>
<div class="sourceCode" id="cb727"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb727-1"><a href="logistic-regression-and-the-resect-data.html#cb727-1" aria-hidden="true" tabindex="-1"></a>res_A_aug <span class="sc">%$%</span></span>
<span id="cb727-2"><a href="logistic-regression-and-the-resect-data.html#cb727-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">confusionMatrix</span>(</span>
<span id="cb727-3"><a href="logistic-regression-and-the-resect-data.html#cb727-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> <span class="fu">factor</span>(.fitted <span class="sc">&gt;=</span> <span class="fl">0.5</span>),</span>
<span id="cb727-4"><a href="logistic-regression-and-the-resect-data.html#cb727-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">reference =</span> <span class="fu">factor</span>(died <span class="sc">==</span> <span class="dv">1</span>),</span>
<span id="cb727-5"><a href="logistic-regression-and-the-resect-data.html#cb727-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">positive =</span> <span class="st">&quot;TRUE&quot;</span></span>
<span id="cb727-6"><a href="logistic-regression-and-the-resect-data.html#cb727-6" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction FALSE TRUE
     FALSE   114   16
     TRUE      3    1
                                          
               Accuracy : 0.8582          
                 95% CI : (0.7875, 0.9124)
    No Information Rate : 0.8731          
    P-Value [Acc &gt; NIR] : 0.747802        
                                          
                  Kappa : 0.0493          
                                          
 Mcnemar&#39;s Test P-Value : 0.005905        
                                          
            Sensitivity : 0.058824        
            Specificity : 0.974359        
         Pos Pred Value : 0.250000        
         Neg Pred Value : 0.876923        
             Prevalence : 0.126866        
         Detection Rate : 0.007463        
   Detection Prevalence : 0.029851        
      Balanced Accuracy : 0.516591        
                                          
       &#39;Positive&#39; Class : TRUE            
                                          </code></pre>
<ul>
<li>The No Information Rate or NIR is just the percentage of correct predictions we’d get if we just predicted the more common classification (not dead) for every subject.</li>
<li>Kappa is a correlation statistic ranging from -1 to +1. It measures the inter-rater reliability of our predictions and the true classifications, in this context. Complete agreement would be +1, and complete disagreement would be -1.</li>
</ul>
</div>
<div id="receiver-operating-characteristic-curve-analysis" class="section level2" number="12.9">
<h2><span class="header-section-number">12.9</span> Receiver Operating Characteristic Curve Analysis</h2>
<p>One way to assess the predictive accuracy within the model development sample in a logistic regression is to consider an analyses based on the receiver operating characteristic (ROC) curve. ROC curves are commonly used in assessing diagnoses in medical settings, and in signal detection applications.</p>
<p>The accuracy of a “test” can be evaluated by considering two types of errors: false positives and false negatives.</p>
<p>In our <code>res_modA</code> model, we use <code>resection</code> size to predict whether the patient <code>died</code>. Suppose we established a value R, so that if the resection size was larger than R cm, we would predict that the patient <code>died</code>, and otherwise we would predict that the patient did not die.</p>
<p>A good outcome of our model’s “test,” then, would be when the resection size is larger than R for a patient who actually died. Another good outcome would be when the resection size is smaller than R for a patient who survived.</p>
<p>But we can make errors, too.</p>
<ul>
<li>A false positive error in this setting would occur when the resection size is larger than R (so we predict the patient dies) but in fact the patient does not die.</li>
<li>A false negative error in this case would occur when the resection size is smaller than R (so we predict the patient survives) but in fact the patient dies.</li>
</ul>
<p>Formally, the true positive fraction (TPF) for a specific resection cutoff <span class="math inline">\(R\)</span>, is the probability of a positive test (a prediction that the patient will die) among the people who have the outcome died = 1 (those who actually die).</p>
<p><span class="math display">\[
TPF(R) = Pr(resection &gt; R | subject died)
\]</span></p>
<p>Similarly, the false positive fraction (FPF) for a specific cutoff <span class="math inline">\(R\)</span> is the probability of a positive test (prediction that the patient will die) among the people with died = 0 (those who don’t actually die)</p>
<p><span class="math display">\[
FPF(R) = Pr(resection &gt; R | subject did not die)
\]</span></p>
<p>The True Positive Rate is referred to as the sensitivity of a diagnostic test, and the True Negative rate (1 - the False Positive rate) is referred to as the specificity of a diagnostic test.</p>
<p>Since the cutoff <span class="math inline">\(R\)</span> is not fixed in advanced, we can plot the value of TPF (on the y axis) against FPF (on the x axis) for all possible values of <span class="math inline">\(R\)</span>, and this is what the ROC curve is. Others refer to the Sensitivity on the Y axis, and 1-Specificity on the X axis, and this is the same idea.</p>
<p>Before we get too far into the weeds, let me show you some simple situations so you can understand what you might learn from the ROC curve. The web page <a href="http://blog.yhat.com/posts/roc-curves.html" class="uri">http://blog.yhat.com/posts/roc-curves.html</a> provides source materials.</p>
<div id="interpreting-the-area-under-the-roc-curve" class="section level3" number="12.9.1">
<h3><span class="header-section-number">12.9.1</span> Interpreting the Area under the ROC curve</h3>
<p>The AUC or Area under the ROC curve is the amount of space underneath the ROC curve. Often referred to as the c statistic, the AUC represents the quality of your TPR and FPR overall in a single number. The C statistic ranges from 0 to 1, with C = 0.5 for a prediction that is no better than random guessing, and C = 1 for a perfect prediction model.</p>
<p>Next, I’ll build a simulation to demonstrate several possible ROC curves in the sections that follow.</p>
<div class="sourceCode" id="cb729"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb729-1"><a href="logistic-regression-and-the-resect-data.html#cb729-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">432999</span>)</span>
<span id="cb729-2"><a href="logistic-regression-and-the-resect-data.html#cb729-2" aria-hidden="true" tabindex="-1"></a>sim.temp <span class="ot">&lt;-</span> <span class="fu">data_frame</span>(<span class="at">x =</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">200</span>), </span>
<span id="cb729-3"><a href="logistic-regression-and-the-resect-data.html#cb729-3" aria-hidden="true" tabindex="-1"></a>                       <span class="at">prob =</span> <span class="fu">exp</span>(x)<span class="sc">/</span>(<span class="dv">1</span> <span class="sc">+</span> <span class="fu">exp</span>(x)), </span>
<span id="cb729-4"><a href="logistic-regression-and-the-resect-data.html#cb729-4" aria-hidden="true" tabindex="-1"></a>                       <span class="at">y =</span> <span class="fu">as.numeric</span>(<span class="dv">1</span> <span class="sc">*</span> <span class="fu">runif</span>(<span class="dv">200</span>) <span class="sc">&lt;</span> prob))</span>
<span id="cb729-5"><a href="logistic-regression-and-the-resect-data.html#cb729-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb729-6"><a href="logistic-regression-and-the-resect-data.html#cb729-6" aria-hidden="true" tabindex="-1"></a>sim.temp <span class="ot">&lt;-</span> sim.temp <span class="sc">%&gt;%</span></span>
<span id="cb729-7"><a href="logistic-regression-and-the-resect-data.html#cb729-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">p_guess =</span> <span class="dv">1</span>,</span>
<span id="cb729-8"><a href="logistic-regression-and-the-resect-data.html#cb729-8" aria-hidden="true" tabindex="-1"></a>           <span class="at">p_perfect =</span> y, </span>
<span id="cb729-9"><a href="logistic-regression-and-the-resect-data.html#cb729-9" aria-hidden="true" tabindex="-1"></a>           <span class="at">p_bad =</span> <span class="fu">exp</span>(<span class="sc">-</span><span class="dv">2</span><span class="sc">*</span>x) <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> <span class="fu">exp</span>(<span class="sc">-</span><span class="dv">2</span><span class="sc">*</span>x)),</span>
<span id="cb729-10"><a href="logistic-regression-and-the-resect-data.html#cb729-10" aria-hidden="true" tabindex="-1"></a>           <span class="at">p_ok =</span> prob <span class="sc">+</span> (<span class="dv">1</span><span class="sc">-</span>y)<span class="sc">*</span><span class="fu">runif</span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="fl">0.05</span>),</span>
<span id="cb729-11"><a href="logistic-regression-and-the-resect-data.html#cb729-11" aria-hidden="true" tabindex="-1"></a>           <span class="at">p_good =</span> prob <span class="sc">+</span> y<span class="sc">*</span><span class="fu">runif</span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="fl">0.27</span>))</span></code></pre></div>
<div id="what-if-we-are-guessing" class="section level4" number="12.9.1.1">
<h4><span class="header-section-number">12.9.1.1</span> What if we are guessing?</h4>
<p>If we’re guessing completely at random, then the model should correctly classify a subject (as died or not died) about 50% of the time, so the TPR and FPR will be equal. This yields a diagonal line in the ROC curve, and an area under the curve (C statistic) of 0.5.</p>
<p>There are several ways to do this on the web, but I’ll show this one, which has some bizarre code, but that’s a function of using a package called <code>ROCR</code> to do the work. It comes from <a href="http://blog.yhat.com/posts/roc-curves.html">this link</a></p>
<div class="sourceCode" id="cb730"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb730-1"><a href="logistic-regression-and-the-resect-data.html#cb730-1" aria-hidden="true" tabindex="-1"></a>pred_guess <span class="ot">&lt;-</span> <span class="fu">prediction</span>(sim.temp<span class="sc">$</span>p_guess, sim.temp<span class="sc">$</span>y)</span>
<span id="cb730-2"><a href="logistic-regression-and-the-resect-data.html#cb730-2" aria-hidden="true" tabindex="-1"></a>perf_guess <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred_guess, <span class="at">measure =</span> <span class="st">&quot;tpr&quot;</span>, <span class="at">x.measure =</span> <span class="st">&quot;fpr&quot;</span>)</span>
<span id="cb730-3"><a href="logistic-regression-and-the-resect-data.html#cb730-3" aria-hidden="true" tabindex="-1"></a>auc_guess <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred_guess, <span class="at">measure=</span><span class="st">&quot;auc&quot;</span>)</span>
<span id="cb730-4"><a href="logistic-regression-and-the-resect-data.html#cb730-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb730-5"><a href="logistic-regression-and-the-resect-data.html#cb730-5" aria-hidden="true" tabindex="-1"></a>auc_guess <span class="ot">&lt;-</span> <span class="fu">round</span>(auc_guess<span class="sc">@</span>y.values[[<span class="dv">1</span>]],<span class="dv">3</span>)</span>
<span id="cb730-6"><a href="logistic-regression-and-the-resect-data.html#cb730-6" aria-hidden="true" tabindex="-1"></a>roc_guess <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">fpr=</span><span class="fu">unlist</span>(perf_guess<span class="sc">@</span>x.values),</span>
<span id="cb730-7"><a href="logistic-regression-and-the-resect-data.html#cb730-7" aria-hidden="true" tabindex="-1"></a>                        <span class="at">tpr=</span><span class="fu">unlist</span>(perf_guess<span class="sc">@</span>y.values),</span>
<span id="cb730-8"><a href="logistic-regression-and-the-resect-data.html#cb730-8" aria-hidden="true" tabindex="-1"></a>                        <span class="at">model=</span><span class="st">&quot;GLM&quot;</span>)</span>
<span id="cb730-9"><a href="logistic-regression-and-the-resect-data.html#cb730-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb730-10"><a href="logistic-regression-and-the-resect-data.html#cb730-10" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(roc_guess, <span class="fu">aes</span>(<span class="at">x=</span>fpr, <span class="at">ymin=</span><span class="dv">0</span>, <span class="at">ymax=</span>tpr)) <span class="sc">+</span></span>
<span id="cb730-11"><a href="logistic-regression-and-the-resect-data.html#cb730-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_ribbon</span>(<span class="at">alpha=</span><span class="fl">0.2</span>, <span class="at">fill =</span> <span class="st">&quot;blue&quot;</span>) <span class="sc">+</span></span>
<span id="cb730-12"><a href="logistic-regression-and-the-resect-data.html#cb730-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y=</span>tpr), <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>) <span class="sc">+</span></span>
<span id="cb730-13"><a href="logistic-regression-and-the-resect-data.html#cb730-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste0</span>(<span class="st">&quot;Guessing: ROC Curve w/ AUC=&quot;</span>, auc_guess)) <span class="sc">+</span></span>
<span id="cb730-14"><a href="logistic-regression-and-the-resect-data.html#cb730-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="432-notes_files/figure-html/unnamed-chunk-258-1.png" width="672" /></p>
</div>
<div id="what-if-we-classify-things-perfectly" class="section level4" number="12.9.1.2">
<h4><span class="header-section-number">12.9.1.2</span> What if we classify things perfectly?</h4>
<p>If we’re classifying subjects perfectly, then we have a TPR of 1 and an FPR of 0. That yields an ROC curve that looks like the upper and left edges of a box. If our model correctly classifies a subject (as died or not died) 100% of the time, the area under the curve (c statistic) will be 1.0. We’ll add in the diagonal line here (in a dashed black line) to show how this model compares to random guessing.</p>
<div class="sourceCode" id="cb731"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb731-1"><a href="logistic-regression-and-the-resect-data.html#cb731-1" aria-hidden="true" tabindex="-1"></a>pred_perf <span class="ot">&lt;-</span> <span class="fu">prediction</span>(sim.temp<span class="sc">$</span>p_perfect, sim.temp<span class="sc">$</span>y)</span>
<span id="cb731-2"><a href="logistic-regression-and-the-resect-data.html#cb731-2" aria-hidden="true" tabindex="-1"></a>perf_perf <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred_perf, <span class="at">measure =</span> <span class="st">&quot;tpr&quot;</span>, <span class="at">x.measure =</span> <span class="st">&quot;fpr&quot;</span>)</span>
<span id="cb731-3"><a href="logistic-regression-and-the-resect-data.html#cb731-3" aria-hidden="true" tabindex="-1"></a>auc_perf <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred_perf, <span class="at">measure=</span><span class="st">&quot;auc&quot;</span>)</span>
<span id="cb731-4"><a href="logistic-regression-and-the-resect-data.html#cb731-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb731-5"><a href="logistic-regression-and-the-resect-data.html#cb731-5" aria-hidden="true" tabindex="-1"></a>auc_perf <span class="ot">&lt;-</span> <span class="fu">round</span>(auc_perf<span class="sc">@</span>y.values[[<span class="dv">1</span>]],<span class="dv">3</span>)</span>
<span id="cb731-6"><a href="logistic-regression-and-the-resect-data.html#cb731-6" aria-hidden="true" tabindex="-1"></a>roc_perf <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">fpr=</span><span class="fu">unlist</span>(perf_perf<span class="sc">@</span>x.values),</span>
<span id="cb731-7"><a href="logistic-regression-and-the-resect-data.html#cb731-7" aria-hidden="true" tabindex="-1"></a>                        <span class="at">tpr=</span><span class="fu">unlist</span>(perf_perf<span class="sc">@</span>y.values),</span>
<span id="cb731-8"><a href="logistic-regression-and-the-resect-data.html#cb731-8" aria-hidden="true" tabindex="-1"></a>                        <span class="at">model=</span><span class="st">&quot;GLM&quot;</span>)</span>
<span id="cb731-9"><a href="logistic-regression-and-the-resect-data.html#cb731-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb731-10"><a href="logistic-regression-and-the-resect-data.html#cb731-10" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(roc_perf, <span class="fu">aes</span>(<span class="at">x=</span>fpr, <span class="at">ymin=</span><span class="dv">0</span>, <span class="at">ymax=</span>tpr)) <span class="sc">+</span></span>
<span id="cb731-11"><a href="logistic-regression-and-the-resect-data.html#cb731-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_ribbon</span>(<span class="at">alpha=</span><span class="fl">0.2</span>, <span class="at">fill =</span> <span class="st">&quot;blue&quot;</span>) <span class="sc">+</span></span>
<span id="cb731-12"><a href="logistic-regression-and-the-resect-data.html#cb731-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y=</span>tpr), <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>) <span class="sc">+</span></span>
<span id="cb731-13"><a href="logistic-regression-and-the-resect-data.html#cb731-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">1</span>, <span class="at">lty =</span> <span class="st">&quot;dashed&quot;</span>) <span class="sc">+</span></span>
<span id="cb731-14"><a href="logistic-regression-and-the-resect-data.html#cb731-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste0</span>(<span class="st">&quot;Perfect Prediction: ROC Curve w/ AUC=&quot;</span>, auc_perf)) <span class="sc">+</span></span>
<span id="cb731-15"><a href="logistic-regression-and-the-resect-data.html#cb731-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="432-notes_files/figure-html/unnamed-chunk-259-1.png" width="672" /></p>
</div>
<div id="what-does-worse-than-guessing-look-like" class="section level4" number="12.9.1.3">
<h4><span class="header-section-number">12.9.1.3</span> What does “worse than guessing” look like?</h4>
<p>A bad classifier will appear below and to the right of the diagonal line we’d see if we were completely guessing. Such a model will have a c statistic below 0.5, and will be valueless.</p>
<div class="sourceCode" id="cb732"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb732-1"><a href="logistic-regression-and-the-resect-data.html#cb732-1" aria-hidden="true" tabindex="-1"></a>pred_bad <span class="ot">&lt;-</span> <span class="fu">prediction</span>(sim.temp<span class="sc">$</span>p_bad, sim.temp<span class="sc">$</span>y)</span>
<span id="cb732-2"><a href="logistic-regression-and-the-resect-data.html#cb732-2" aria-hidden="true" tabindex="-1"></a>perf_bad <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred_bad, <span class="at">measure =</span> <span class="st">&quot;tpr&quot;</span>, <span class="at">x.measure =</span> <span class="st">&quot;fpr&quot;</span>)</span>
<span id="cb732-3"><a href="logistic-regression-and-the-resect-data.html#cb732-3" aria-hidden="true" tabindex="-1"></a>auc_bad <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred_bad, <span class="at">measure=</span><span class="st">&quot;auc&quot;</span>)</span>
<span id="cb732-4"><a href="logistic-regression-and-the-resect-data.html#cb732-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb732-5"><a href="logistic-regression-and-the-resect-data.html#cb732-5" aria-hidden="true" tabindex="-1"></a>auc_bad <span class="ot">&lt;-</span> <span class="fu">round</span>(auc_bad<span class="sc">@</span>y.values[[<span class="dv">1</span>]],<span class="dv">3</span>)</span>
<span id="cb732-6"><a href="logistic-regression-and-the-resect-data.html#cb732-6" aria-hidden="true" tabindex="-1"></a>roc_bad <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">fpr=</span><span class="fu">unlist</span>(perf_bad<span class="sc">@</span>x.values),</span>
<span id="cb732-7"><a href="logistic-regression-and-the-resect-data.html#cb732-7" aria-hidden="true" tabindex="-1"></a>                        <span class="at">tpr=</span><span class="fu">unlist</span>(perf_bad<span class="sc">@</span>y.values),</span>
<span id="cb732-8"><a href="logistic-regression-and-the-resect-data.html#cb732-8" aria-hidden="true" tabindex="-1"></a>                        <span class="at">model=</span><span class="st">&quot;GLM&quot;</span>)</span>
<span id="cb732-9"><a href="logistic-regression-and-the-resect-data.html#cb732-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb732-10"><a href="logistic-regression-and-the-resect-data.html#cb732-10" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(roc_bad, <span class="fu">aes</span>(<span class="at">x=</span>fpr, <span class="at">ymin=</span><span class="dv">0</span>, <span class="at">ymax=</span>tpr)) <span class="sc">+</span></span>
<span id="cb732-11"><a href="logistic-regression-and-the-resect-data.html#cb732-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_ribbon</span>(<span class="at">alpha=</span><span class="fl">0.2</span>, <span class="at">fill =</span> <span class="st">&quot;blue&quot;</span>) <span class="sc">+</span></span>
<span id="cb732-12"><a href="logistic-regression-and-the-resect-data.html#cb732-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y=</span>tpr), <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>) <span class="sc">+</span></span>
<span id="cb732-13"><a href="logistic-regression-and-the-resect-data.html#cb732-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">1</span>, <span class="at">lty =</span> <span class="st">&quot;dashed&quot;</span>) <span class="sc">+</span></span>
<span id="cb732-14"><a href="logistic-regression-and-the-resect-data.html#cb732-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste0</span>(<span class="st">&quot;A Bad Model: ROC Curve w/ AUC=&quot;</span>, auc_bad)) <span class="sc">+</span></span>
<span id="cb732-15"><a href="logistic-regression-and-the-resect-data.html#cb732-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="432-notes_files/figure-html/unnamed-chunk-260-1.png" width="672" /></p>
</div>
<div id="what-does-better-than-guessing-look-like" class="section level4" number="12.9.1.4">
<h4><span class="header-section-number">12.9.1.4</span> What does “better than guessing” look like?</h4>
<p>An “OK” classifier will appear above and to the left of the diagonal line we’d see if we were completely guessing. Such a model will have a c statistic above 0.5, and might have some value. The plot below shows a very fairly poor model, but at least it’s better than guessing.</p>
<div class="sourceCode" id="cb733"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb733-1"><a href="logistic-regression-and-the-resect-data.html#cb733-1" aria-hidden="true" tabindex="-1"></a>pred_ok <span class="ot">&lt;-</span> <span class="fu">prediction</span>(sim.temp<span class="sc">$</span>p_ok, sim.temp<span class="sc">$</span>y)</span>
<span id="cb733-2"><a href="logistic-regression-and-the-resect-data.html#cb733-2" aria-hidden="true" tabindex="-1"></a>perf_ok <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred_ok, <span class="at">measure =</span> <span class="st">&quot;tpr&quot;</span>, <span class="at">x.measure =</span> <span class="st">&quot;fpr&quot;</span>)</span>
<span id="cb733-3"><a href="logistic-regression-and-the-resect-data.html#cb733-3" aria-hidden="true" tabindex="-1"></a>auc_ok <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred_ok, <span class="at">measure=</span><span class="st">&quot;auc&quot;</span>)</span>
<span id="cb733-4"><a href="logistic-regression-and-the-resect-data.html#cb733-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb733-5"><a href="logistic-regression-and-the-resect-data.html#cb733-5" aria-hidden="true" tabindex="-1"></a>auc_ok <span class="ot">&lt;-</span> <span class="fu">round</span>(auc_ok<span class="sc">@</span>y.values[[<span class="dv">1</span>]],<span class="dv">3</span>)</span>
<span id="cb733-6"><a href="logistic-regression-and-the-resect-data.html#cb733-6" aria-hidden="true" tabindex="-1"></a>roc_ok <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">fpr=</span><span class="fu">unlist</span>(perf_ok<span class="sc">@</span>x.values),</span>
<span id="cb733-7"><a href="logistic-regression-and-the-resect-data.html#cb733-7" aria-hidden="true" tabindex="-1"></a>                        <span class="at">tpr=</span><span class="fu">unlist</span>(perf_ok<span class="sc">@</span>y.values),</span>
<span id="cb733-8"><a href="logistic-regression-and-the-resect-data.html#cb733-8" aria-hidden="true" tabindex="-1"></a>                        <span class="at">model=</span><span class="st">&quot;GLM&quot;</span>)</span>
<span id="cb733-9"><a href="logistic-regression-and-the-resect-data.html#cb733-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb733-10"><a href="logistic-regression-and-the-resect-data.html#cb733-10" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(roc_ok, <span class="fu">aes</span>(<span class="at">x=</span>fpr, <span class="at">ymin=</span><span class="dv">0</span>, <span class="at">ymax=</span>tpr)) <span class="sc">+</span></span>
<span id="cb733-11"><a href="logistic-regression-and-the-resect-data.html#cb733-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_ribbon</span>(<span class="at">alpha=</span><span class="fl">0.2</span>, <span class="at">fill =</span> <span class="st">&quot;blue&quot;</span>) <span class="sc">+</span></span>
<span id="cb733-12"><a href="logistic-regression-and-the-resect-data.html#cb733-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y=</span>tpr), <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>) <span class="sc">+</span></span>
<span id="cb733-13"><a href="logistic-regression-and-the-resect-data.html#cb733-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">1</span>, <span class="at">lty =</span> <span class="st">&quot;dashed&quot;</span>) <span class="sc">+</span></span>
<span id="cb733-14"><a href="logistic-regression-and-the-resect-data.html#cb733-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste0</span>(<span class="st">&quot;A Mediocre Model: ROC Curve w/ AUC=&quot;</span>, auc_ok)) <span class="sc">+</span></span>
<span id="cb733-15"><a href="logistic-regression-and-the-resect-data.html#cb733-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="432-notes_files/figure-html/unnamed-chunk-261-1.png" width="672" /></p>
<p>Sometimes people grasp for a rough guide as to the accuracy of a model’s predictions based on the area under the ROC curve. A common thought is to assess the C statistic much like you would a class grade.</p>
<table>
<colgroup>
<col width="19%" />
<col width="80%" />
</colgroup>
<thead>
<tr class="header">
<th align="right">C statistic</th>
<th>Interpretation</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.90 to 1.00</td>
<td>model does an excellent job at discriminating “yes” from “no” (A)</td>
</tr>
<tr class="even">
<td align="right">0.80 to 0.90</td>
<td>model does a good job (B)</td>
</tr>
<tr class="odd">
<td align="right">0.70 to 0.80</td>
<td>model does a fair job (C)</td>
</tr>
<tr class="even">
<td align="right">0.60 to 0.70</td>
<td>model does a poor job (D)</td>
</tr>
<tr class="odd">
<td align="right">0.50 to 0.60</td>
<td>model fails (F)</td>
</tr>
<tr class="even">
<td align="right">below 0.50</td>
<td>model is worse than random guessing</td>
</tr>
</tbody>
</table>
</div>
<div id="what-does-pretty-good-look-like" class="section level4" number="12.9.1.5">
<h4><span class="header-section-number">12.9.1.5</span> What does “pretty good” look like?</h4>
<p>A strong and good classifier will appear above and to the left of the diagonal line we’d see if we were completely guessing, often with a nice curve that is continually increasing and appears to be pulled up towards the top left. Such a model will have a c statistic well above 0.5, but not as large as 1. The plot below shows a stronger model, which appears substantially better than guessing.</p>
<div class="sourceCode" id="cb734"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb734-1"><a href="logistic-regression-and-the-resect-data.html#cb734-1" aria-hidden="true" tabindex="-1"></a>pred_good <span class="ot">&lt;-</span> <span class="fu">prediction</span>(sim.temp<span class="sc">$</span>p_good, sim.temp<span class="sc">$</span>y)</span>
<span id="cb734-2"><a href="logistic-regression-and-the-resect-data.html#cb734-2" aria-hidden="true" tabindex="-1"></a>perf_good <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred_good, <span class="at">measure =</span> <span class="st">&quot;tpr&quot;</span>, <span class="at">x.measure =</span> <span class="st">&quot;fpr&quot;</span>)</span>
<span id="cb734-3"><a href="logistic-regression-and-the-resect-data.html#cb734-3" aria-hidden="true" tabindex="-1"></a>auc_good <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred_good, <span class="at">measure=</span><span class="st">&quot;auc&quot;</span>)</span>
<span id="cb734-4"><a href="logistic-regression-and-the-resect-data.html#cb734-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb734-5"><a href="logistic-regression-and-the-resect-data.html#cb734-5" aria-hidden="true" tabindex="-1"></a>auc_good <span class="ot">&lt;-</span> <span class="fu">round</span>(auc_good<span class="sc">@</span>y.values[[<span class="dv">1</span>]],<span class="dv">3</span>)</span>
<span id="cb734-6"><a href="logistic-regression-and-the-resect-data.html#cb734-6" aria-hidden="true" tabindex="-1"></a>roc_good <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">fpr=</span><span class="fu">unlist</span>(perf_good<span class="sc">@</span>x.values),</span>
<span id="cb734-7"><a href="logistic-regression-and-the-resect-data.html#cb734-7" aria-hidden="true" tabindex="-1"></a>                        <span class="at">tpr=</span><span class="fu">unlist</span>(perf_good<span class="sc">@</span>y.values),</span>
<span id="cb734-8"><a href="logistic-regression-and-the-resect-data.html#cb734-8" aria-hidden="true" tabindex="-1"></a>                        <span class="at">model=</span><span class="st">&quot;GLM&quot;</span>)</span>
<span id="cb734-9"><a href="logistic-regression-and-the-resect-data.html#cb734-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb734-10"><a href="logistic-regression-and-the-resect-data.html#cb734-10" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(roc_good, <span class="fu">aes</span>(<span class="at">x=</span>fpr, <span class="at">ymin=</span><span class="dv">0</span>, <span class="at">ymax=</span>tpr)) <span class="sc">+</span></span>
<span id="cb734-11"><a href="logistic-regression-and-the-resect-data.html#cb734-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_ribbon</span>(<span class="at">alpha=</span><span class="fl">0.2</span>, <span class="at">fill =</span> <span class="st">&quot;blue&quot;</span>) <span class="sc">+</span></span>
<span id="cb734-12"><a href="logistic-regression-and-the-resect-data.html#cb734-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y=</span>tpr), <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>) <span class="sc">+</span></span>
<span id="cb734-13"><a href="logistic-regression-and-the-resect-data.html#cb734-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">1</span>, <span class="at">lty =</span> <span class="st">&quot;dashed&quot;</span>) <span class="sc">+</span></span>
<span id="cb734-14"><a href="logistic-regression-and-the-resect-data.html#cb734-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste0</span>(<span class="st">&quot;A Pretty Good Model: ROC Curve w/ AUC=&quot;</span>, auc_good)) <span class="sc">+</span></span>
<span id="cb734-15"><a href="logistic-regression-and-the-resect-data.html#cb734-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="432-notes_files/figure-html/unnamed-chunk-262-1.png" width="672" /></p>
</div>
</div>
</div>
<div id="the-roc-plot-for-res_moda" class="section level2" number="12.10">
<h2><span class="header-section-number">12.10</span> The ROC Plot for <code>res_modA</code></h2>
<p>Let me show you the ROC curve for our <code>res_modA</code> model.</p>
<div class="sourceCode" id="cb735"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb735-1"><a href="logistic-regression-and-the-resect-data.html#cb735-1" aria-hidden="true" tabindex="-1"></a><span class="do">## requires ROCR package</span></span>
<span id="cb735-2"><a href="logistic-regression-and-the-resect-data.html#cb735-2" aria-hidden="true" tabindex="-1"></a>prob <span class="ot">&lt;-</span> <span class="fu">predict</span>(res_modA, resect, <span class="at">type=</span><span class="st">&quot;response&quot;</span>)</span>
<span id="cb735-3"><a href="logistic-regression-and-the-resect-data.html#cb735-3" aria-hidden="true" tabindex="-1"></a>pred <span class="ot">&lt;-</span> <span class="fu">prediction</span>(prob, resect<span class="sc">$</span>died)</span>
<span id="cb735-4"><a href="logistic-regression-and-the-resect-data.html#cb735-4" aria-hidden="true" tabindex="-1"></a>perf <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred, <span class="at">measure =</span> <span class="st">&quot;tpr&quot;</span>, <span class="at">x.measure =</span> <span class="st">&quot;fpr&quot;</span>)</span>
<span id="cb735-5"><a href="logistic-regression-and-the-resect-data.html#cb735-5" aria-hidden="true" tabindex="-1"></a>auc <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred, <span class="at">measure=</span><span class="st">&quot;auc&quot;</span>)</span>
<span id="cb735-6"><a href="logistic-regression-and-the-resect-data.html#cb735-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb735-7"><a href="logistic-regression-and-the-resect-data.html#cb735-7" aria-hidden="true" tabindex="-1"></a>auc <span class="ot">&lt;-</span> <span class="fu">round</span>(auc<span class="sc">@</span>y.values[[<span class="dv">1</span>]],<span class="dv">3</span>)</span>
<span id="cb735-8"><a href="logistic-regression-and-the-resect-data.html#cb735-8" aria-hidden="true" tabindex="-1"></a>roc.data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">fpr=</span><span class="fu">unlist</span>(perf<span class="sc">@</span>x.values),</span>
<span id="cb735-9"><a href="logistic-regression-and-the-resect-data.html#cb735-9" aria-hidden="true" tabindex="-1"></a>                       <span class="at">tpr=</span><span class="fu">unlist</span>(perf<span class="sc">@</span>y.values),</span>
<span id="cb735-10"><a href="logistic-regression-and-the-resect-data.html#cb735-10" aria-hidden="true" tabindex="-1"></a>                       <span class="at">model=</span><span class="st">&quot;GLM&quot;</span>)</span>
<span id="cb735-11"><a href="logistic-regression-and-the-resect-data.html#cb735-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb735-12"><a href="logistic-regression-and-the-resect-data.html#cb735-12" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(roc.data, <span class="fu">aes</span>(<span class="at">x=</span>fpr, <span class="at">ymin=</span><span class="dv">0</span>, <span class="at">ymax=</span>tpr)) <span class="sc">+</span></span>
<span id="cb735-13"><a href="logistic-regression-and-the-resect-data.html#cb735-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_ribbon</span>(<span class="at">alpha=</span><span class="fl">0.2</span>, <span class="at">fill =</span> <span class="st">&quot;blue&quot;</span>) <span class="sc">+</span></span>
<span id="cb735-14"><a href="logistic-regression-and-the-resect-data.html#cb735-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y=</span>tpr), <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>) <span class="sc">+</span></span>
<span id="cb735-15"><a href="logistic-regression-and-the-resect-data.html#cb735-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">1</span>, <span class="at">lty =</span> <span class="st">&quot;dashed&quot;</span>) <span class="sc">+</span></span>
<span id="cb735-16"><a href="logistic-regression-and-the-resect-data.html#cb735-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste0</span>(<span class="st">&quot;ROC Curve w/ AUC=&quot;</span>, auc)) <span class="sc">+</span></span>
<span id="cb735-17"><a href="logistic-regression-and-the-resect-data.html#cb735-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="432-notes_files/figure-html/unnamed-chunk-263-1.png" width="672" /></p>
<p>Based on the C statistic (AUC = 0.771) this would rank somewhere near the high end of a “fair” predictive model by this standard, not quite to the level of a “good” model.</p>
<div id="another-way-to-plot-the-roc-curve" class="section level3" number="12.10.1">
<h3><span class="header-section-number">12.10.1</span> Another way to plot the ROC Curve</h3>
<p>If we’ve loaded the <code>pROC</code> package, we can also use the following (admittedly simpler) approach to plot the ROC curve, without <code>ggplot2</code>, and to obtain the C statistic, and a 95% confidence interval around that C statistic.</p>
<div class="sourceCode" id="cb736"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb736-1"><a href="logistic-regression-and-the-resect-data.html#cb736-1" aria-hidden="true" tabindex="-1"></a><span class="do">## requires pROC package</span></span>
<span id="cb736-2"><a href="logistic-regression-and-the-resect-data.html#cb736-2" aria-hidden="true" tabindex="-1"></a>roc.modA <span class="ot">&lt;-</span> </span>
<span id="cb736-3"><a href="logistic-regression-and-the-resect-data.html#cb736-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">roc</span>(resect<span class="sc">$</span>died <span class="sc">~</span> <span class="fu">predict</span>(res_modA, <span class="at">type=</span><span class="st">&quot;response&quot;</span>),</span>
<span id="cb736-4"><a href="logistic-regression-and-the-resect-data.html#cb736-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">ci =</span> <span class="cn">TRUE</span>)</span>
<span id="cb736-5"><a href="logistic-regression-and-the-resect-data.html#cb736-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb736-6"><a href="logistic-regression-and-the-resect-data.html#cb736-6" aria-hidden="true" tabindex="-1"></a>roc.modA</span></code></pre></div>
<pre><code>
Call:
roc.formula(formula = resect$died ~ predict(res_modA, type = &quot;response&quot;),     ci = TRUE)

Data: predict(res_modA, type = &quot;response&quot;) in 117 controls (resect$died 0) &lt; 17 cases (resect$died 1).
Area under the curve: 0.7707
95% CI: 0.67-0.8715 (DeLong)</code></pre>
<div class="sourceCode" id="cb738"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb738-1"><a href="logistic-regression-and-the-resect-data.html#cb738-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(roc.modA)</span></code></pre></div>
<p><img src="432-notes_files/figure-html/unnamed-chunk-264-1.png" width="672" /></p>
</div>
</div>
<div id="assessing-residual-plots-from-model-a" class="section level2" number="12.11">
<h2><span class="header-section-number">12.11</span> Assessing Residual Plots from Model A</h2>
<blockquote>
<p>Residuals are certainly less informative for logistic regression than they are for linear regression: not only do yes/no outcomes inherently contain less information than continuous ones, but the fact that the adjusted response depends on the fit hampers our ability to use residuals as external checks on the model.</p>
</blockquote>
<blockquote>
<p>This is mitigated to some extent, however, by the fact that we are also making fewer distributional assumptions in logistic regression, so there is no need to inspect residuals for, say, skewness or heteroskedasticity.</p>
</blockquote>
<ul>
<li>Patrick Breheny, University of Kentucky, <a href="https://web.as.uky.edu/statistics/users/pbreheny/760/S13/notes/3-26.pdf">Slides on GLM Residuals and Diagnostics</a></li>
</ul>
<p>The usual residual plots are available in R for a logistic regression model, but most of them are irrelevant in the logistic regression setting. The residuals shouldn’t follow a standard Normal distribution, and they will not show constant variance over the range of the predictor variables, so plots looking into those issues aren’t helpful.</p>
<p>The only plot from the standard set that we’ll look at in many settings is plot 5, which helps us assess influence (via Cook’s distance contours), and a measure related to leverage (how unusual an observation is in terms of the predictors) and standardized Pearson residuals.</p>
<div class="sourceCode" id="cb739"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb739-1"><a href="logistic-regression-and-the-resect-data.html#cb739-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(res_modA, <span class="at">which =</span> <span class="dv">5</span>)</span></code></pre></div>
<p><img src="432-notes_files/figure-html/unnamed-chunk-265-1.png" width="672" /></p>
<p>In this case, I don’t see any highly influential points, as no points fall outside of the Cook’s distance (0.5 or 1) contours.</p>
</div>
<div id="model-b-a-kitchen-sink-logistic-regression-model" class="section level2" number="12.12">
<h2><span class="header-section-number">12.12</span> Model B: A “Kitchen Sink” Logistic Regression Model</h2>
<div class="sourceCode" id="cb740"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb740-1"><a href="logistic-regression-and-the-resect-data.html#cb740-1" aria-hidden="true" tabindex="-1"></a>res_modB <span class="ot">&lt;-</span> <span class="fu">glm</span>(died <span class="sc">~</span> resection <span class="sc">+</span> age <span class="sc">+</span> prior <span class="sc">+</span> intubated,</span>
<span id="cb740-2"><a href="logistic-regression-and-the-resect-data.html#cb740-2" aria-hidden="true" tabindex="-1"></a>               <span class="at">data =</span> resect, <span class="at">family =</span> binomial)</span>
<span id="cb740-3"><a href="logistic-regression-and-the-resect-data.html#cb740-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb740-4"><a href="logistic-regression-and-the-resect-data.html#cb740-4" aria-hidden="true" tabindex="-1"></a>res_modB</span></code></pre></div>
<pre><code>
Call:  glm(formula = died ~ resection + age + prior + intubated, family = binomial, 
    data = resect)

Coefficients:
(Intercept)    resection          age        prior    intubated  
  -5.152886     0.612211     0.001173     0.814691     2.810797  

Degrees of Freedom: 133 Total (i.e. Null);  129 Residual
Null Deviance:      101.9 
Residual Deviance: 67.36    AIC: 77.36</code></pre>
<div id="comparing-model-a-to-model-b" class="section level3" number="12.12.1">
<h3><span class="header-section-number">12.12.1</span> Comparing Model A to Model B</h3>
<div class="sourceCode" id="cb742"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb742-1"><a href="logistic-regression-and-the-resect-data.html#cb742-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(res_modA, res_modB)</span></code></pre></div>
<pre><code>Analysis of Deviance Table

Model 1: died ~ resection
Model 2: died ~ resection + age + prior + intubated
  Resid. Df Resid. Dev Df Deviance
1       132     89.493            
2       129     67.359  3   22.134</code></pre>
<p>The addition of <code>age</code>, <code>prior</code> and <code>intubated</code> reduces the lack of fit by 22.134 points, at a cost of 3 degrees of freedom.</p>
<div class="sourceCode" id="cb744"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb744-1"><a href="logistic-regression-and-the-resect-data.html#cb744-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(res_modA)</span></code></pre></div>
<pre><code># A tibble: 1 x 8
  null.deviance df.null logLik   AIC   BIC deviance df.residual  nobs
          &lt;dbl&gt;   &lt;int&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;       &lt;int&gt; &lt;int&gt;
1          102.     133  -44.7  93.5  99.3     89.5         132   134</code></pre>
<div class="sourceCode" id="cb746"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb746-1"><a href="logistic-regression-and-the-resect-data.html#cb746-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(res_modB)</span></code></pre></div>
<pre><code># A tibble: 1 x 8
  null.deviance df.null logLik   AIC   BIC deviance df.residual  nobs
          &lt;dbl&gt;   &lt;int&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;       &lt;int&gt; &lt;int&gt;
1          102.     133  -33.7  77.4  91.8     67.4         129   134</code></pre>
<p>By either AIC or BIC, the larger model (<code>res_modB</code>) looks more effective.</p>
</div>
<div id="interpreting-model-b" class="section level3" number="12.12.2">
<h3><span class="header-section-number">12.12.2</span> Interpreting Model B</h3>
<div class="sourceCode" id="cb748"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb748-1"><a href="logistic-regression-and-the-resect-data.html#cb748-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(res_modB)</span></code></pre></div>
<pre><code>
Call:
glm(formula = died ~ resection + age + prior + intubated, family = binomial, 
    data = resect)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-1.7831  -0.3741  -0.2386  -0.2014   2.5228  

Coefficients:
             Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept) -5.152886   1.469453  -3.507 0.000454 ***
resection    0.612211   0.282807   2.165 0.030406 *  
age          0.001173   0.020646   0.057 0.954700    
prior        0.814691   0.704785   1.156 0.247705    
intubated    2.810797   0.658395   4.269 1.96e-05 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 101.943  on 133  degrees of freedom
Residual deviance:  67.359  on 129  degrees of freedom
AIC: 77.359

Number of Fisher Scoring iterations: 6</code></pre>
<p>It appears that the <code>intubated</code> predictor adds significant value to the model, by the Wald test.</p>
<p>Let’s focus on the impact of these variables through odds ratios.</p>
<div class="sourceCode" id="cb750"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb750-1"><a href="logistic-regression-and-the-resect-data.html#cb750-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(res_modB, <span class="at">exponentiate =</span> <span class="cn">TRUE</span>, <span class="at">conf.int =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb750-2"><a href="logistic-regression-and-the-resect-data.html#cb750-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(term, estimate, conf.low, conf.high)</span></code></pre></div>
<pre><code># A tibble: 5 x 4
  term        estimate conf.low conf.high
  &lt;chr&gt;          &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;
1 (Intercept)  0.00578 0.000241    0.0837
2 resection    1.84    1.08        3.35  
3 age          1.00    0.962       1.04  
4 prior        2.26    0.549       9.17  
5 intubated   16.6     4.75       64.6   </code></pre>
<p>At a 5% significance level, we might conclude that:</p>
<ul>
<li>larger sized <code>resection</code>s are associated with a meaningful rise (est OR: 1.84, 95% CI 1.08, 3.35) in the odds of death, holding all other predictors constant,</li>
<li>the need for <code>intubation</code> at the end of surgery is associated with a substantial rise (est OR: 16.6, 95% CI 4.7, 64.7) in the odds of death, holding all other predictors constant, but that</li>
<li>older <code>age</code> as well as having a <code>prior</code> tracheal surgery appears to be associated with an increase in death risk, but not to an extent that we can declare statistically significant.</li>
</ul>
</div>
</div>
<div id="plotting-model-b" class="section level2" number="12.13">
<h2><span class="header-section-number">12.13</span> Plotting Model B</h2>
<p>Let’s think about plotting the fitted values from our model, in terms of probabilities.</p>
<div id="using-augment-to-capture-the-fitted-probabilities-1" class="section level3" number="12.13.1">
<h3><span class="header-section-number">12.13.1</span> Using <code>augment</code> to capture the fitted probabilities</h3>
<div class="sourceCode" id="cb752"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb752-1"><a href="logistic-regression-and-the-resect-data.html#cb752-1" aria-hidden="true" tabindex="-1"></a>res_B_aug <span class="ot">&lt;-</span> <span class="fu">augment</span>(res_modB, resect, </span>
<span id="cb752-2"><a href="logistic-regression-and-the-resect-data.html#cb752-2" aria-hidden="true" tabindex="-1"></a>                     <span class="at">type.predict =</span> <span class="st">&quot;response&quot;</span>)</span>
<span id="cb752-3"><a href="logistic-regression-and-the-resect-data.html#cb752-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(res_B_aug)</span></code></pre></div>
<pre><code># A tibble: 6 x 12
     id   age prior resection intubated  died .fitted .resid .std.resid   .hat
  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;      &lt;dbl&gt;  &lt;dbl&gt;
1     1    34     1       2.5         0     0  0.0591 -0.349     -0.354 0.0267
2     2    57     0       5           0     0  0.117  -0.498     -0.508 0.0380
3     3    60     1       4           1     1  0.729   0.794      0.844 0.114 
4     4    62     1       4.2         0     0  0.155  -0.581     -0.602 0.0704
5     5    28     0       6           1     1  0.796   0.675      0.724 0.131 
6     6    52     0       3           0     0  0.0371 -0.275     -0.277 0.0105
# ... with 2 more variables: .sigma &lt;dbl&gt;, .cooksd &lt;dbl&gt;</code></pre>
</div>
<div id="plotting-model-b-fits-by-observed-mortality" class="section level3" number="12.13.2">
<h3><span class="header-section-number">12.13.2</span> Plotting Model B Fits by Observed Mortality</h3>
<div class="sourceCode" id="cb754"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb754-1"><a href="logistic-regression-and-the-resect-data.html#cb754-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(res_B_aug, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(died), <span class="at">y =</span> .fitted, <span class="at">col =</span> <span class="fu">factor</span>(died))) <span class="sc">+</span></span>
<span id="cb754-2"><a href="logistic-regression-and-the-resect-data.html#cb754-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb754-3"><a href="logistic-regression-and-the-resect-data.html#cb754-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="fl">0.1</span>) <span class="sc">+</span> </span>
<span id="cb754-4"><a href="logistic-regression-and-the-resect-data.html#cb754-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">guides</span>(<span class="at">col =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<p><img src="432-notes_files/figure-html/unnamed-chunk-272-1.png" width="672" /></p>
<p>Certainly it appears as though most of our predicted probabilities (of death) for the subjects who actually survived are quite small, but not all of them. We also have at least 6 big “misses” among the 17 subjects who actually died.</p>
</div>
<div id="confusion-matrix-for-model-b" class="section level3" number="12.13.3">
<h3><span class="header-section-number">12.13.3</span> Confusion Matrix for Model B</h3>
<div class="sourceCode" id="cb755"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb755-1"><a href="logistic-regression-and-the-resect-data.html#cb755-1" aria-hidden="true" tabindex="-1"></a>res_B_aug <span class="sc">%$%</span></span>
<span id="cb755-2"><a href="logistic-regression-and-the-resect-data.html#cb755-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">confusionMatrix</span>(</span>
<span id="cb755-3"><a href="logistic-regression-and-the-resect-data.html#cb755-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> <span class="fu">factor</span>(.fitted <span class="sc">&gt;=</span> <span class="fl">0.5</span>),</span>
<span id="cb755-4"><a href="logistic-regression-and-the-resect-data.html#cb755-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">reference =</span> <span class="fu">factor</span>(died <span class="sc">==</span> <span class="dv">1</span>),</span>
<span id="cb755-5"><a href="logistic-regression-and-the-resect-data.html#cb755-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">positive =</span> <span class="st">&quot;TRUE&quot;</span></span>
<span id="cb755-6"><a href="logistic-regression-and-the-resect-data.html#cb755-6" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction FALSE TRUE
     FALSE   113    6
     TRUE      4   11
                                         
               Accuracy : 0.9254         
                 95% CI : (0.867, 0.9636)
    No Information Rate : 0.8731         
    P-Value [Acc &gt; NIR] : 0.03897        
                                         
                  Kappa : 0.6453         
                                         
 Mcnemar&#39;s Test P-Value : 0.75183        
                                         
            Sensitivity : 0.64706        
            Specificity : 0.96581        
         Pos Pred Value : 0.73333        
         Neg Pred Value : 0.94958        
             Prevalence : 0.12687        
         Detection Rate : 0.08209        
   Detection Prevalence : 0.11194        
      Balanced Accuracy : 0.80644        
                                         
       &#39;Positive&#39; Class : TRUE           
                                         </code></pre>
</div>
<div id="the-roc-curve-for-model-b" class="section level3" number="12.13.4">
<h3><span class="header-section-number">12.13.4</span> The ROC curve for Model B</h3>
<div class="sourceCode" id="cb757"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb757-1"><a href="logistic-regression-and-the-resect-data.html#cb757-1" aria-hidden="true" tabindex="-1"></a><span class="do">## requires ROCR package</span></span>
<span id="cb757-2"><a href="logistic-regression-and-the-resect-data.html#cb757-2" aria-hidden="true" tabindex="-1"></a>prob <span class="ot">&lt;-</span> <span class="fu">predict</span>(res_modB, resect, <span class="at">type=</span><span class="st">&quot;response&quot;</span>)</span>
<span id="cb757-3"><a href="logistic-regression-and-the-resect-data.html#cb757-3" aria-hidden="true" tabindex="-1"></a>pred <span class="ot">&lt;-</span> <span class="fu">prediction</span>(prob, resect<span class="sc">$</span>died)</span>
<span id="cb757-4"><a href="logistic-regression-and-the-resect-data.html#cb757-4" aria-hidden="true" tabindex="-1"></a>perf <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred, <span class="at">measure =</span> <span class="st">&quot;tpr&quot;</span>, <span class="at">x.measure =</span> <span class="st">&quot;fpr&quot;</span>)</span>
<span id="cb757-5"><a href="logistic-regression-and-the-resect-data.html#cb757-5" aria-hidden="true" tabindex="-1"></a>auc <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred, <span class="at">measure=</span><span class="st">&quot;auc&quot;</span>)</span>
<span id="cb757-6"><a href="logistic-regression-and-the-resect-data.html#cb757-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb757-7"><a href="logistic-regression-and-the-resect-data.html#cb757-7" aria-hidden="true" tabindex="-1"></a>auc <span class="ot">&lt;-</span> <span class="fu">round</span>(auc<span class="sc">@</span>y.values[[<span class="dv">1</span>]],<span class="dv">3</span>)</span>
<span id="cb757-8"><a href="logistic-regression-and-the-resect-data.html#cb757-8" aria-hidden="true" tabindex="-1"></a>roc.data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">fpr=</span><span class="fu">unlist</span>(perf<span class="sc">@</span>x.values),</span>
<span id="cb757-9"><a href="logistic-regression-and-the-resect-data.html#cb757-9" aria-hidden="true" tabindex="-1"></a>                       <span class="at">tpr=</span><span class="fu">unlist</span>(perf<span class="sc">@</span>y.values),</span>
<span id="cb757-10"><a href="logistic-regression-and-the-resect-data.html#cb757-10" aria-hidden="true" tabindex="-1"></a>                       <span class="at">model=</span><span class="st">&quot;GLM&quot;</span>)</span>
<span id="cb757-11"><a href="logistic-regression-and-the-resect-data.html#cb757-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb757-12"><a href="logistic-regression-and-the-resect-data.html#cb757-12" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(roc.data, <span class="fu">aes</span>(<span class="at">x=</span>fpr, <span class="at">ymin=</span><span class="dv">0</span>, <span class="at">ymax=</span>tpr)) <span class="sc">+</span></span>
<span id="cb757-13"><a href="logistic-regression-and-the-resect-data.html#cb757-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_ribbon</span>(<span class="at">alpha=</span><span class="fl">0.2</span>, <span class="at">fill =</span> <span class="st">&quot;blue&quot;</span>) <span class="sc">+</span></span>
<span id="cb757-14"><a href="logistic-regression-and-the-resect-data.html#cb757-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y=</span>tpr), <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>) <span class="sc">+</span></span>
<span id="cb757-15"><a href="logistic-regression-and-the-resect-data.html#cb757-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">1</span>, <span class="at">lty =</span> <span class="st">&quot;dashed&quot;</span>) <span class="sc">+</span></span>
<span id="cb757-16"><a href="logistic-regression-and-the-resect-data.html#cb757-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste0</span>(<span class="st">&quot;Model B: ROC Curve w/ AUC=&quot;</span>, auc)) <span class="sc">+</span></span>
<span id="cb757-17"><a href="logistic-regression-and-the-resect-data.html#cb757-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="432-notes_files/figure-html/unnamed-chunk-274-1.png" width="672" /></p>
<p>The area under the curve (C-statistic) is 0.86, which certainly looks like a more discriminating fit than model A with resection alone.</p>
</div>
<div id="residuals-leverage-and-influence" class="section level3" number="12.13.5">
<h3><span class="header-section-number">12.13.5</span> Residuals, Leverage and Influence</h3>
<div class="sourceCode" id="cb758"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb758-1"><a href="logistic-regression-and-the-resect-data.html#cb758-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(res_modB, <span class="at">which =</span> <span class="dv">5</span>)</span></code></pre></div>
<p><img src="432-notes_files/figure-html/unnamed-chunk-275-1.png" width="672" /></p>
<p>Again, we see no signs of deeply influential points in this model.</p>
</div>
</div>
<div id="logistic-regression-using-lrm" class="section level2" number="12.14">
<h2><span class="header-section-number">12.14</span> Logistic Regression using <code>lrm</code></h2>
<p>To obtain the Nagelkerke <span class="math inline">\(R^2\)</span> and the C statistic, as well as some other summaries, I’ll now demonstrate the use of <code>lrm</code> from the <code>rms</code> package to fit a logistic regression model.</p>
<p>We’ll return to the original model, predicting death using resection size alone.</p>
<div class="sourceCode" id="cb759"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb759-1"><a href="logistic-regression-and-the-resect-data.html#cb759-1" aria-hidden="true" tabindex="-1"></a>dd <span class="ot">&lt;-</span> <span class="fu">datadist</span>(resect)</span>
<span id="cb759-2"><a href="logistic-regression-and-the-resect-data.html#cb759-2" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">datadist=</span><span class="st">&quot;dd&quot;</span>)</span>
<span id="cb759-3"><a href="logistic-regression-and-the-resect-data.html#cb759-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb759-4"><a href="logistic-regression-and-the-resect-data.html#cb759-4" aria-hidden="true" tabindex="-1"></a>res_modC <span class="ot">&lt;-</span> <span class="fu">lrm</span>(died <span class="sc">~</span> resection, <span class="at">data=</span>resect, <span class="at">x=</span><span class="cn">TRUE</span>, <span class="at">y=</span><span class="cn">TRUE</span>)</span>
<span id="cb759-5"><a href="logistic-regression-and-the-resect-data.html#cb759-5" aria-hidden="true" tabindex="-1"></a>res_modC</span></code></pre></div>
<pre><code>Logistic Regression Model
 
 lrm(formula = died ~ resection, data = resect, x = TRUE, y = TRUE)
 
                       Model Likelihood    Discrimination    Rank Discrim.    
                             Ratio Test           Indexes          Indexes    
 Obs           134    LR chi2     12.45    R2       0.167    C       0.771    
  0            117    d.f.            1    g        1.037    Dxy     0.541    
  1             17    Pr(&gt; chi2) 0.0004    gr       2.820    gamma   0.582    
 max |deriv| 2e-06                         gp       0.110    tau-a   0.121    
                                           Brier    0.103                     
 
           Coef    S.E.   Wald Z Pr(&gt;|Z|)
 Intercept -4.4337 0.8799 -5.04  &lt;0.0001 
 resection  0.7417 0.2230  3.33  0.0009  
 </code></pre>
<p>This output specifies the following:</p>
<ul>
<li><code>Obs</code> = The number of observations used to fit the model, with <code>0</code> = the number of zeros and <code>1</code> = the number of ones in our outcome, <code>died</code>. Also specified is the maximum absolute value of the derivative at the point where the maximum likelihood function was estimated. I wouldn’t worry about that practically, as all you will care about is whether the iterative function-fitting process converged, and R will warn you in other ways if it doesn’t.</li>
<li>A likelihood ratio test (drop in deviance test) subtracting the residual deviance from the null deviance obtain the Likelihood Ratio <span class="math inline">\(\chi^2\)</span> statistic, subtracting residual df from null df to obtain degrees of freedom, and comparing the resulting test statistic to a <span class="math inline">\(\chi^2\)</span> distribution with the appropriate degrees of freedom to determine a <em>p</em> value.</li>
<li>A series of discrimination indexes, including the Nagelkerke R<sup>2</sup>, symbolized R2, and several others we’ll discuss shortly.</li>
<li>A series of rank discrimination indexes, including the C statistic (area under the ROC curve) and Somers’ D (Dxy), and several others.</li>
<li>A table of coefficients, standard errors, Wald Z statistics and <em>p</em> values based on those Wald statistics.</li>
</ul>
<p>The C statistic is estimated to be 0.771, with an associated (Nagelkerke) <span class="math inline">\(R^2\)</span> = 0.167, both indicating at best mediocre performance for this model, as it turns out.</p>
<div id="interpreting-nagelkerke-r2" class="section level3" number="12.14.1">
<h3><span class="header-section-number">12.14.1</span> Interpreting Nagelkerke R<sup>2</sup></h3>
<p>There are many ways to calculate <span class="math inline">\(R^2\)</span> for logistic regression.</p>
<ul>
<li>At the unfortunate <a href="http://www.ats.ucla.edu/stat/mult_pkg/faq/general/Psuedo_RSquareds.htm">URL linked here</a> (unfortunate because the term “pseudo” is misspelled) there is a nice summary of the key issue, which is that there are at least three different ways to think about <span class="math inline">\(R^2\)</span> in linear regression that are equivalent in that context, but when you move to a categorical outcome, which interpretation you use leads you down a different path for extension to the new type of outcome.</li>
<li>Paul Allison, for instance, describes several at <a href="http://statisticalhorizons.com/r2logistic">this link</a> in a post entitled “What’s the Best R-Squared for Logistic Regression?”</li>
<li>Jonathan Bartlett looks at McFadden’s pseudo <span class="math inline">\(R^2\)</span> in some detail (including some R code) at <a href="http://thestatsgeek.com/2014/02/08/r-squared-in-logistic-regression/">this link</a>, in a post entitled “R squared in logistic regression”</li>
</ul>
<p>The Nagelkerke approach that is presented as <code>R2</code> in the <code>lrm</code> output is as good as most of the available approaches, and has the positive feature that it does reach 1 if the fitted model shows as much improvement as possible over the null model (which predicts the mean response for all subjects, and has R<sup>2</sup> = 0). The greater the improvement, the higher the Nagelkerke R<sup>2</sup>.</p>
<p>For model A, our Nagelkerke R<sup>2</sup> = 0.167, which is pretty poor. It doesn’t technically mean that 16.7% of any sort of variation has been explained, though.</p>
</div>
<div id="interpreting-the-c-statistic-and-plotting-the-roc-curve" class="section level3" number="12.14.2">
<h3><span class="header-section-number">12.14.2</span> Interpreting the C statistic and Plotting the ROC Curve</h3>
<p>The C statistic is a measure of the area under the receiver operating characteristic curve. <a href="http://blog.yhat.com/posts/roc-curves.html">This link</a> has some nice material that provides some insight into the C statistic and ROC curve.</p>
<ul>
<li>Recall that C ranges from 0 to 1. 0 = BAD, 1 = GOOD.
<ul>
<li>values of C less than 0.5 indicate that your prediction model is not even as good as simple random guessing of “yes” or “no” for your response.</li>
<li>C = 0.5 for random guessing</li>
<li>C = 1 indicates a perfect classification scheme - one that correctly guesses “yes” for all “yes” patients, and for none of the “no” patients.</li>
</ul></li>
<li>The closer C is to 1, the happier we’ll be, most of the time.
<ul>
<li>Often we’ll call models with 0.5 &lt; C &lt; 0.8 poor or weak in terms of predictive ability by this measure</li>
<li>0.8 <span class="math inline">\(\leq\)</span> C &lt; 0.9 are moderately strong in terms of predictive power (indicate good discrimination)</li>
<li>C <span class="math inline">\(\geq\)</span> 0.9 usually indicates a very strong model in this regard (indicate excellent discrimination)</li>
</ul></li>
</ul>
<p>We’ve seen the ROC curve for this model before, when we looked at model <code>res_modA</code> fitted using <code>glm</code> in the previous chapter. But, just for completeness, I’ll include it.</p>
<p><strong>Note.</strong> I change the initial <code>predict</code> call from <code>type = "response"</code> for a <code>glm</code> fit to <code>type = "fitted"</code> in a <code>lrm</code> fit. Otherwise, this is the same approach.</p>
<div class="sourceCode" id="cb761"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb761-1"><a href="logistic-regression-and-the-resect-data.html#cb761-1" aria-hidden="true" tabindex="-1"></a><span class="do">## requires ROCR package</span></span>
<span id="cb761-2"><a href="logistic-regression-and-the-resect-data.html#cb761-2" aria-hidden="true" tabindex="-1"></a>prob <span class="ot">&lt;-</span> <span class="fu">predict</span>(res_modC, resect, <span class="at">type=</span><span class="st">&quot;fitted&quot;</span>)</span>
<span id="cb761-3"><a href="logistic-regression-and-the-resect-data.html#cb761-3" aria-hidden="true" tabindex="-1"></a>pred <span class="ot">&lt;-</span> <span class="fu">prediction</span>(prob, resect<span class="sc">$</span>died)</span>
<span id="cb761-4"><a href="logistic-regression-and-the-resect-data.html#cb761-4" aria-hidden="true" tabindex="-1"></a>perf <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred, <span class="at">measure =</span> <span class="st">&quot;tpr&quot;</span>, <span class="at">x.measure =</span> <span class="st">&quot;fpr&quot;</span>)</span>
<span id="cb761-5"><a href="logistic-regression-and-the-resect-data.html#cb761-5" aria-hidden="true" tabindex="-1"></a>auc <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred, <span class="at">measure=</span><span class="st">&quot;auc&quot;</span>)</span>
<span id="cb761-6"><a href="logistic-regression-and-the-resect-data.html#cb761-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb761-7"><a href="logistic-regression-and-the-resect-data.html#cb761-7" aria-hidden="true" tabindex="-1"></a>auc <span class="ot">&lt;-</span> <span class="fu">round</span>(auc<span class="sc">@</span>y.values[[<span class="dv">1</span>]],<span class="dv">3</span>)</span>
<span id="cb761-8"><a href="logistic-regression-and-the-resect-data.html#cb761-8" aria-hidden="true" tabindex="-1"></a>roc.data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">fpr=</span><span class="fu">unlist</span>(perf<span class="sc">@</span>x.values),</span>
<span id="cb761-9"><a href="logistic-regression-and-the-resect-data.html#cb761-9" aria-hidden="true" tabindex="-1"></a>                       <span class="at">tpr=</span><span class="fu">unlist</span>(perf<span class="sc">@</span>y.values),</span>
<span id="cb761-10"><a href="logistic-regression-and-the-resect-data.html#cb761-10" aria-hidden="true" tabindex="-1"></a>                       <span class="at">model=</span><span class="st">&quot;GLM&quot;</span>)</span>
<span id="cb761-11"><a href="logistic-regression-and-the-resect-data.html#cb761-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb761-12"><a href="logistic-regression-and-the-resect-data.html#cb761-12" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(roc.data, <span class="fu">aes</span>(<span class="at">x=</span>fpr, <span class="at">ymin=</span><span class="dv">0</span>, <span class="at">ymax=</span>tpr)) <span class="sc">+</span></span>
<span id="cb761-13"><a href="logistic-regression-and-the-resect-data.html#cb761-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_ribbon</span>(<span class="at">alpha=</span><span class="fl">0.2</span>, <span class="at">fill =</span> <span class="st">&quot;blue&quot;</span>) <span class="sc">+</span></span>
<span id="cb761-14"><a href="logistic-regression-and-the-resect-data.html#cb761-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y=</span>tpr), <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>) <span class="sc">+</span></span>
<span id="cb761-15"><a href="logistic-regression-and-the-resect-data.html#cb761-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">1</span>, <span class="at">lty =</span> <span class="st">&quot;dashed&quot;</span>) <span class="sc">+</span></span>
<span id="cb761-16"><a href="logistic-regression-and-the-resect-data.html#cb761-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste0</span>(<span class="st">&quot;Model C: ROC Curve w/ AUC=&quot;</span>, auc)) <span class="sc">+</span></span>
<span id="cb761-17"><a href="logistic-regression-and-the-resect-data.html#cb761-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="432-notes_files/figure-html/unnamed-chunk-277-1.png" width="672" /></p>
</div>
<div id="the-c-statistic-and-somers-d" class="section level3" number="12.14.3">
<h3><span class="header-section-number">12.14.3</span> The C statistic and Somers’ D</h3>
<ul>
<li>The C statistic is directly related to <strong>Somers’ D statistic</strong>, abbreviated <span class="math inline">\(D_{xy}\)</span>, by the equation C = 0.5 + (D/2).
<ul>
<li>Somers’ D and the ROC area only measure how well predicted values from the model can rank-order the responses. For example, predicted probabilities of 0.01 and 0.99 for a pair of subjects are no better than probabilities of 0.2 and 0.8 using rank measures, if the first subject had a lower response value than the second.</li>
<li>Thus, the C statistic (or <span class="math inline">\(D_{xy}\)</span>) may not be very sensitive ways to choose between models, even though they provide reasonable summaries of the models individually.</li>
<li>This is especially true when the models are strong. The Nagelkerke R<sup>2</sup> may be more sensitive.</li>
</ul></li>
<li>But as it turns out, we sometimes have to look at the ROC shapes, as the summary statistic alone isn’t enough.</li>
</ul>
<p>In our case, Somers D (Dxy) = .541, so the C statistic is 0.771.</p>
</div>
<div id="validating-the-logistic-regression-model-summary-statistics" class="section level3" number="12.14.4">
<h3><span class="header-section-number">12.14.4</span> Validating the Logistic Regression Model Summary Statistics</h3>
<p>Like other regression-fitting tools in <code>rms</code>, the <code>lrm</code> function has a special <code>validate</code> tool to help perform resampling validation of a model, with or without backwards step-wise variable selection. Here, we’ll validate our model’s summary statistics using 100 bootstrap replications.</p>
<div class="sourceCode" id="cb762"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb762-1"><a href="logistic-regression-and-the-resect-data.html#cb762-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">432001</span>) </span>
<span id="cb762-2"><a href="logistic-regression-and-the-resect-data.html#cb762-2" aria-hidden="true" tabindex="-1"></a><span class="fu">validate</span>(res_modC, <span class="at">B =</span> <span class="dv">100</span>)</span></code></pre></div>
<pre><code>          index.orig training   test optimism index.corrected   n
Dxy           0.5415   0.5422 0.5415   0.0007          0.5408 100
R2            0.1666   0.1748 0.1666   0.0083          0.1583 100
Intercept     0.0000   0.0000 0.1631  -0.1631          0.1631 100
Slope         1.0000   1.0000 1.0463  -0.0463          1.0463 100
Emax          0.0000   0.0000 0.0428   0.0428          0.0428 100
D             0.0854   0.0909 0.0854   0.0055          0.0800 100
U            -0.0149  -0.0149 0.0017  -0.0167          0.0017 100
Q             0.1004   0.1058 0.0837   0.0221          0.0783 100
B             0.1025   0.0986 0.1051  -0.0065          0.1090 100
g             1.0369   1.0677 1.0369   0.0308          1.0061 100
gp            0.1101   0.1080 0.1101  -0.0021          0.1122 100</code></pre>
<p>Recall that our area under the curve (C statistic) = <code>0.5 + (Dxy/2)</code>, so that we can also use the first row of statistics to validate the C statistic. Accounting for optimism in this manner, our validation-corrected estimates are Dxy = 0.5408, so C = 0.7704, and, from the second row of statistics, we can read off the validated Nagelkerke R<sup>2</sup>, which is 0.1583.</p>
</div>
<div id="plotting-the-summary-of-the-lrm-approach" class="section level3" number="12.14.5">
<h3><span class="header-section-number">12.14.5</span> Plotting the Summary of the <code>lrm</code> approach</h3>
<p>The <code>summary</code> function applied to an <code>lrm</code> fit shows the effect size comparing the 25<sup>th</sup> to the 75<sup>th</sup> percentile of resection.</p>
<div class="sourceCode" id="cb764"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb764-1"><a href="logistic-regression-and-the-resect-data.html#cb764-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">summary</span>(res_modC))</span></code></pre></div>
<p><img src="432-notes_files/figure-html/unnamed-chunk-279-1.png" width="672" /></p>
<div class="sourceCode" id="cb765"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb765-1"><a href="logistic-regression-and-the-resect-data.html#cb765-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(res_modC)</span></code></pre></div>
<pre><code>             Effects              Response : died 

 Factor      Low High Diff. Effect S.E.    Lower 0.95 Upper 0.95
 resection   2   4    2     1.4834 0.44591 0.6094      2.3574   
  Odds Ratio 2   4    2     4.4078      NA 1.8393     10.5630   </code></pre>
<p>So, a move from a resection of 2 cm to a resection of 4 cm is associated with an estimated effect on the log odds of death of 1.48 (with standard error 0.45), or with an estimated effect on the odds ratio for death of 4.41, with 95% CI (1.84, 10.56).</p>
</div>
<div id="plot-in-sample-predictions-for-model-c" class="section level3" number="12.14.6">
<h3><span class="header-section-number">12.14.6</span> Plot In-Sample Predictions for Model C</h3>
<p>Here we plot the effect of <code>resection</code> (and 95% confidence intervals) across the range of observed values of <code>resection</code> on the log odds of death. Note the linear effect of <code>resection</code> size on the log odds scale.</p>
<div class="sourceCode" id="cb767"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb767-1"><a href="logistic-regression-and-the-resect-data.html#cb767-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">Predict</span>(res_modC))</span></code></pre></div>
<p><img src="432-notes_files/figure-html/unnamed-chunk-280-1.png" width="672" /></p>
<p>By applying the <code>plogis</code> function within the <code>Predict</code> command, we can plot the effect of <code>resection</code> on the estimated probability of death. Note the non-linear effect on this probability in this logistic regression model.</p>
<div class="sourceCode" id="cb768"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb768-1"><a href="logistic-regression-and-the-resect-data.html#cb768-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">Predict</span>(res_modC, <span class="at">fun =</span> plogis)) <span class="sc">+</span> </span>
<span id="cb768-2"><a href="logistic-regression-and-the-resect-data.html#cb768-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&quot;Predicted probability from Model C&quot;</span>,</span>
<span id="cb768-3"><a href="logistic-regression-and-the-resect-data.html#cb768-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">title =</span> <span class="st">&quot;Model C with the resect data&quot;</span>)</span></code></pre></div>
<p><img src="432-notes_files/figure-html/unnamed-chunk-281-1.png" width="672" /></p>
<p>The <code>Predict</code> function itself provides the raw material being captured in this plot.</p>
<div class="sourceCode" id="cb769"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb769-1"><a href="logistic-regression-and-the-resect-data.html#cb769-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">Predict</span>(res_modC, <span class="at">fun =</span> plogis))</span></code></pre></div>
<pre><code>            resection       yhat       lower      upper .predictor.
resection.1  1.000000 0.02431476 0.006636502 0.08505223   resection
resection.2  1.020101 0.02467096 0.006789313 0.08559056   resection
resection.3  1.040201 0.02503224 0.006945549 0.08613277   resection
resection.4  1.060302 0.02539867 0.007105283 0.08667889   resection
resection.5  1.080402 0.02577033 0.007268589 0.08722896   resection
resection.6  1.100503 0.02614728 0.007435542 0.08778304   resection

Response variable (y):  

Limits are 0.95 confidence limits</code></pre>
</div>
<div id="anova-from-the-lrm-approach" class="section level3" number="12.14.7">
<h3><span class="header-section-number">12.14.7</span> ANOVA from the <code>lrm</code> approach</h3>
<div class="sourceCode" id="cb771"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb771-1"><a href="logistic-regression-and-the-resect-data.html#cb771-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(res_modC)</span></code></pre></div>
<pre><code>                Wald Statistics          Response: died 

 Factor     Chi-Square d.f. P    
 resection  11.07      1    9e-04
 TOTAL      11.07      1    9e-04</code></pre>
<p>The ANOVA approach applied to a <code>lrm</code> fit provides a Wald test for the model as a whole. Here, the use of <code>resection</code> is a significant improvement over a null (intercept-only) model. The <em>p</em> value is 9 x 10<sup>-4</sup>.</p>
</div>
<div id="are-any-points-particularly-influential" class="section level3" number="12.14.8">
<h3><span class="header-section-number">12.14.8</span> Are any points particularly influential?</h3>
<p>I’ll use a cutoff for <code>dfbeta</code> here of 0.3, instead of the default 0.2, because I want to focus on truly influential points. Note that we have to use the data frame version of <code>resect</code> as <code>show.influence</code> isn’t tibble-friendly.</p>
<div class="sourceCode" id="cb773"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb773-1"><a href="logistic-regression-and-the-resect-data.html#cb773-1" aria-hidden="true" tabindex="-1"></a>inf.C <span class="ot">&lt;-</span> <span class="fu">which.influence</span>(res_modC, <span class="at">cutoff=</span><span class="fl">0.3</span>)</span>
<span id="cb773-2"><a href="logistic-regression-and-the-resect-data.html#cb773-2" aria-hidden="true" tabindex="-1"></a>inf.C</span></code></pre></div>
<pre><code>$Intercept
[1]  84 128

$resection
[1] 84</code></pre>
<div class="sourceCode" id="cb775"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb775-1"><a href="logistic-regression-and-the-resect-data.html#cb775-1" aria-hidden="true" tabindex="-1"></a><span class="fu">show.influence</span>(<span class="at">object =</span> inf.C, <span class="at">dframe =</span> <span class="fu">data.frame</span>(resect))</span></code></pre></div>
<pre><code>    Count resection
84      2      *2.0
128     1       2.5</code></pre>
<p>It appears that observation 84 may have a meaningful effect on both the intercept and the coefficient for <code>resection</code>.</p>
</div>
<div id="a-nomogram-for-model-c" class="section level3" number="12.14.9">
<h3><span class="header-section-number">12.14.9</span> A Nomogram for Model C</h3>
<p>We use the <code>plogis</code> function within a nomogram call to get R to produce fitted probabilities (of our outcome, <code>died</code>) in this case.</p>
<div class="sourceCode" id="cb777"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb777-1"><a href="logistic-regression-and-the-resect-data.html#cb777-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">nomogram</span>(res_modC, <span class="at">fun=</span>plogis, </span>
<span id="cb777-2"><a href="logistic-regression-and-the-resect-data.html#cb777-2" aria-hidden="true" tabindex="-1"></a>              <span class="at">fun.at=</span><span class="fu">c</span>(<span class="fl">0.05</span>, <span class="fu">seq</span>(<span class="fl">0.1</span>, <span class="fl">0.9</span>, <span class="at">by =</span> <span class="fl">0.1</span>), <span class="fl">0.95</span>), </span>
<span id="cb777-3"><a href="logistic-regression-and-the-resect-data.html#cb777-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">funlabel=</span><span class="st">&quot;Pr(died)&quot;</span>))</span></code></pre></div>
<p><img src="432-notes_files/figure-html/unnamed-chunk-285-1.png" width="672" /></p>
<p>Since there’s no non-linearity in the right hand side of our simple logistic regression model, the nomogram is straightforward. We calculate the points based on the resection by traveling up, and then travel down in a straight vertical line from total points through the linear (log odds) predictor straight to a fitted probability. Note that fitted probabilities above 0.5 are not possible within the range of observed <code>resection</code> values in this case.</p>
</div>
</div>
<div id="model-d-an-augmented-kitchen-sink-model" class="section level2" number="12.15">
<h2><span class="header-section-number">12.15</span> Model D: An Augmented Kitchen Sink Model</h2>
<p>Can we predict survival from the patient’s age, whether the patient had prior tracheal surgery or not, the extent of the resection, and whether intubation was required at the end of surgery?</p>
<div id="spearman-rho2-plot" class="section level3" number="12.15.1">
<h3><span class="header-section-number">12.15.1</span> Spearman <span class="math inline">\(\rho^2\)</span> Plot</h3>
<p>Let’s start by considering the limited use of non-linear terms for predictors that look important in a Spearman <span class="math inline">\(\rho^2\)</span> plot.</p>
<div class="sourceCode" id="cb778"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb778-1"><a href="logistic-regression-and-the-resect-data.html#cb778-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">spearman2</span>(died <span class="sc">~</span> age <span class="sc">+</span> prior <span class="sc">+</span> resection <span class="sc">+</span> intubated, <span class="at">data=</span>resect))</span></code></pre></div>
<p><img src="432-notes_files/figure-html/unnamed-chunk-286-1.png" width="672" /></p>
<p>The most important variable appears to be whether intubation was required, so I’ll include <code>intubated</code>’s interaction with the linear effect of the next most (apparently) important variable, <code>resection</code>, and also a cubic spline for <code>resection</code>, with three knots. Since <code>prior</code> and <code>age</code> look less important, I’ll simply add them as linear terms.</p>
</div>
<div id="fitting-model-d-using-lrm" class="section level3" number="12.15.2">
<h3><span class="header-section-number">12.15.2</span> Fitting Model D using <code>lrm</code></h3>
<p>Note the use of <code>%ia%</code> here. This insures that only the linear part of the <code>resection</code> term will be used in the interaction with <code>intubated</code>.</p>
<div class="sourceCode" id="cb779"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb779-1"><a href="logistic-regression-and-the-resect-data.html#cb779-1" aria-hidden="true" tabindex="-1"></a>dd <span class="ot">&lt;-</span> <span class="fu">datadist</span>(resect)</span>
<span id="cb779-2"><a href="logistic-regression-and-the-resect-data.html#cb779-2" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">datadist=</span><span class="st">&quot;dd&quot;</span>)</span>
<span id="cb779-3"><a href="logistic-regression-and-the-resect-data.html#cb779-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb779-4"><a href="logistic-regression-and-the-resect-data.html#cb779-4" aria-hidden="true" tabindex="-1"></a>res_modD <span class="ot">&lt;-</span> <span class="fu">lrm</span>(died <span class="sc">~</span> age <span class="sc">+</span> prior <span class="sc">+</span> <span class="fu">rcs</span>(resection, <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb779-5"><a href="logistic-regression-and-the-resect-data.html#cb779-5" aria-hidden="true" tabindex="-1"></a>                 intubated <span class="sc">+</span> intubated <span class="sc">%ia%</span> resection, </span>
<span id="cb779-6"><a href="logistic-regression-and-the-resect-data.html#cb779-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">data=</span>resect, <span class="at">x=</span><span class="cn">TRUE</span>, <span class="at">y=</span><span class="cn">TRUE</span>)</span></code></pre></div>
</div>
<div id="assessing-model-d-using-lrms-tools" class="section level3" number="12.15.3">
<h3><span class="header-section-number">12.15.3</span> Assessing Model D using <code>lrm</code>’s tools</h3>
<div class="sourceCode" id="cb780"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb780-1"><a href="logistic-regression-and-the-resect-data.html#cb780-1" aria-hidden="true" tabindex="-1"></a>res_modD</span></code></pre></div>
<pre><code>Logistic Regression Model
 
 lrm(formula = died ~ age + prior + rcs(resection, 3) + intubated + 
     intubated %ia% resection, data = resect, x = TRUE, y = TRUE)
 
                        Model Likelihood    Discrimination    Rank Discrim.    
                              Ratio Test           Indexes          Indexes    
 Obs           134    LR chi2      38.08    R2       0.464    C       0.880    
  0            117    d.f.             6    g        2.382    Dxy     0.759    
  1             17    Pr(&gt; chi2) &lt;0.0001    gr      10.825    gamma   0.770    
 max |deriv| 9e-08                          gp       0.172    tau-a   0.169    
                                            Brier    0.067                     
 
                       Coef     S.E.   Wald Z Pr(&gt;|Z|)
 Intercept             -11.3636 4.9099 -2.31  0.0206  
 age                     0.0000 0.0210  0.00  0.9988  
 prior                   0.6269 0.7367  0.85  0.3947  
 resection               3.3799 1.9700  1.72  0.0862  
 resection&#39;             -4.2104 2.7035 -1.56  0.1194  
 intubated               0.4576 2.7848  0.16  0.8695  
 intubated * resection   0.6188 0.7306  0.85  0.3970  
 </code></pre>
<ul>
<li>The model likelihood ratio test suggests that at least some of these predictors are helpful.</li>
<li>The Nagelkerke R<sup>2</sup> of 0.46, and the C statistic of 0.88 indicate a meaningful improvement in discrimination over our model with <code>resection</code> alone.</li>
<li>The Wald Z tests see some potential need to prune the model, as none of the elements reaches statistical significance without the others. The product term between <code>intubated</code> and <code>resection</code>, in particular, doesn’t appear to have helped much, once we already had the main effects.</li>
</ul>
</div>
<div id="anova-and-wald-tests-for-model-d" class="section level3" number="12.15.4">
<h3><span class="header-section-number">12.15.4</span> ANOVA and Wald Tests for Model D</h3>
<div class="sourceCode" id="cb782"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb782-1"><a href="logistic-regression-and-the-resect-data.html#cb782-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(res_modD)</span></code></pre></div>
<pre><code>                Wald Statistics          Response: died 

 Factor                                               Chi-Square d.f. P     
 age                                                   0.00      1    0.9988
 prior                                                 0.72      1    0.3947
 resection  (Factor+Higher Order Factors)              4.95      3    0.1753
  All Interactions                                     0.72      1    0.3970
  Nonlinear                                            2.43      1    0.1194
 intubated  (Factor+Higher Order Factors)             16.45      2    0.0003
  All Interactions                                     0.72      1    0.3970
 intubated * resection  (Factor+Higher Order Factors)  0.72      1    0.3970
 TOTAL NONLINEAR + INTERACTION                         2.56      2    0.2783
 TOTAL                                                23.90      6    0.0005</code></pre>
<p>Neither the interaction term nor the non-linearity from the cubic spline appears to be statistically significant, based on the Wald tests via ANOVA. However it is clear that <code>intubated</code> has a significant impact as a main effect.</p>
</div>
<div id="effect-sizes-in-model-d" class="section level3" number="12.15.5">
<h3><span class="header-section-number">12.15.5</span> Effect Sizes in Model D</h3>
<div class="sourceCode" id="cb784"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb784-1"><a href="logistic-regression-and-the-resect-data.html#cb784-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">summary</span>(res_modD))</span></code></pre></div>
<p><img src="432-notes_files/figure-html/unnamed-chunk-290-1.png" width="672" /></p>
<div class="sourceCode" id="cb785"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb785-1"><a href="logistic-regression-and-the-resect-data.html#cb785-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(res_modD)</span></code></pre></div>
<pre><code>             Effects              Response : died 

 Factor      Low High Diff. Effect      S.E.    Lower 0.95 Upper 0.95
 age         36  61   25    -0.00080933 0.52409 -1.02800     1.0264  
  Odds Ratio 36  61   25     0.99919000      NA  0.35772     2.7910  
 prior        0   1    1     0.62693000 0.73665 -0.81688     2.0707  
  Odds Ratio  0   1    1     1.87190000      NA  0.44181     7.9307  
 resection    2   4    2     2.42930000 1.43510 -0.38342     5.2419  
  Odds Ratio  2   4    2    11.35000000      NA  0.68153   189.0400  
 intubated    0   1    1     2.00470000 1.11220 -0.17513     4.1845  
  Odds Ratio  0   1    1     7.42380000      NA  0.83934    65.6610  

Adjusted to: resection=2.5 intubated=0  </code></pre>
<p>The effect sizes are perhaps best described in terms of odds ratios. The odds ratio for death isn’t significantly different from 1 for any variable, but the impact of <code>resection</code> and <code>intubated</code>, though not strong enough to be significant, look more substantial (if poorly estimated) than the effects of <code>age</code> and <code>prior</code>.</p>
</div>
<div id="plot-in-sample-predictions-for-model-d" class="section level3" number="12.15.6">
<h3><span class="header-section-number">12.15.6</span> Plot In-Sample Predictions for Model D</h3>
<p>Here are plots of the effects across the range of each predictor (holding the others constant) on the log odds scale. Note the non-linear effect of resection implied by the use of a spline there.</p>
<div class="sourceCode" id="cb787"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb787-1"><a href="logistic-regression-and-the-resect-data.html#cb787-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">Predict</span>(res_modD))</span></code></pre></div>
<p><img src="432-notes_files/figure-html/unnamed-chunk-291-1.png" width="672" /></p>
<p>We can also capture and plot these results on the probability scale, as follows<a href="#fn7" class="footnote-ref" id="fnref7"><sup>7</sup></a>.</p>
<div class="sourceCode" id="cb788"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb788-1"><a href="logistic-regression-and-the-resect-data.html#cb788-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">Predict</span>(res_modD, <span class="at">fun =</span> plogis))</span></code></pre></div>
<p><img src="432-notes_files/figure-html/unnamed-chunk-292-1.png" width="672" /></p>
</div>
<div id="plotting-the-roc-curve-for-model-d" class="section level3" number="12.15.7">
<h3><span class="header-section-number">12.15.7</span> Plotting the ROC curve for Model D</h3>
<p>Again, remember to use <code>type = "fitted"</code> with a <code>lrm</code> fit.</p>
<div class="sourceCode" id="cb789"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb789-1"><a href="logistic-regression-and-the-resect-data.html#cb789-1" aria-hidden="true" tabindex="-1"></a><span class="do">## requires ROCR package</span></span>
<span id="cb789-2"><a href="logistic-regression-and-the-resect-data.html#cb789-2" aria-hidden="true" tabindex="-1"></a>prob <span class="ot">&lt;-</span> <span class="fu">predict</span>(res_modD, resect, <span class="at">type=</span><span class="st">&quot;fitted&quot;</span>)</span>
<span id="cb789-3"><a href="logistic-regression-and-the-resect-data.html#cb789-3" aria-hidden="true" tabindex="-1"></a>pred <span class="ot">&lt;-</span> <span class="fu">prediction</span>(prob, resect<span class="sc">$</span>died)</span>
<span id="cb789-4"><a href="logistic-regression-and-the-resect-data.html#cb789-4" aria-hidden="true" tabindex="-1"></a>perf <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred, <span class="at">measure =</span> <span class="st">&quot;tpr&quot;</span>, <span class="at">x.measure =</span> <span class="st">&quot;fpr&quot;</span>)</span>
<span id="cb789-5"><a href="logistic-regression-and-the-resect-data.html#cb789-5" aria-hidden="true" tabindex="-1"></a>auc <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred, <span class="at">measure=</span><span class="st">&quot;auc&quot;</span>)</span>
<span id="cb789-6"><a href="logistic-regression-and-the-resect-data.html#cb789-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb789-7"><a href="logistic-regression-and-the-resect-data.html#cb789-7" aria-hidden="true" tabindex="-1"></a>auc <span class="ot">&lt;-</span> <span class="fu">round</span>(auc<span class="sc">@</span>y.values[[<span class="dv">1</span>]],<span class="dv">3</span>)</span>
<span id="cb789-8"><a href="logistic-regression-and-the-resect-data.html#cb789-8" aria-hidden="true" tabindex="-1"></a>roc.data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">fpr=</span><span class="fu">unlist</span>(perf<span class="sc">@</span>x.values),</span>
<span id="cb789-9"><a href="logistic-regression-and-the-resect-data.html#cb789-9" aria-hidden="true" tabindex="-1"></a>                       <span class="at">tpr=</span><span class="fu">unlist</span>(perf<span class="sc">@</span>y.values),</span>
<span id="cb789-10"><a href="logistic-regression-and-the-resect-data.html#cb789-10" aria-hidden="true" tabindex="-1"></a>                       <span class="at">model=</span><span class="st">&quot;GLM&quot;</span>)</span>
<span id="cb789-11"><a href="logistic-regression-and-the-resect-data.html#cb789-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb789-12"><a href="logistic-regression-and-the-resect-data.html#cb789-12" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(roc.data, <span class="fu">aes</span>(<span class="at">x=</span>fpr, <span class="at">ymin=</span><span class="dv">0</span>, <span class="at">ymax=</span>tpr)) <span class="sc">+</span></span>
<span id="cb789-13"><a href="logistic-regression-and-the-resect-data.html#cb789-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_ribbon</span>(<span class="at">alpha=</span><span class="fl">0.2</span>, <span class="at">fill =</span> <span class="st">&quot;blue&quot;</span>) <span class="sc">+</span></span>
<span id="cb789-14"><a href="logistic-regression-and-the-resect-data.html#cb789-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y=</span>tpr), <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>) <span class="sc">+</span></span>
<span id="cb789-15"><a href="logistic-regression-and-the-resect-data.html#cb789-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">1</span>, <span class="at">lty =</span> <span class="st">&quot;dashed&quot;</span>) <span class="sc">+</span></span>
<span id="cb789-16"><a href="logistic-regression-and-the-resect-data.html#cb789-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste0</span>(<span class="st">&quot;ROC Curve w/ AUC=&quot;</span>, auc)) <span class="sc">+</span></span>
<span id="cb789-17"><a href="logistic-regression-and-the-resect-data.html#cb789-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="432-notes_files/figure-html/unnamed-chunk-293-1.png" width="672" /></p>
<p>The AUC fitted with <code>ROCR</code> (0.883) is slightly different than what <code>lrm</code> has told us (0.880), and this also happens if we use the <code>pROC</code> approach, demonstrated below.</p>
<div class="sourceCode" id="cb790"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb790-1"><a href="logistic-regression-and-the-resect-data.html#cb790-1" aria-hidden="true" tabindex="-1"></a><span class="do">## requires pROC package</span></span>
<span id="cb790-2"><a href="logistic-regression-and-the-resect-data.html#cb790-2" aria-hidden="true" tabindex="-1"></a>roc.modD <span class="ot">&lt;-</span> </span>
<span id="cb790-3"><a href="logistic-regression-and-the-resect-data.html#cb790-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">roc</span>(resect<span class="sc">$</span>died <span class="sc">~</span> <span class="fu">predict</span>(res_modD, <span class="at">type=</span><span class="st">&quot;fitted&quot;</span>),</span>
<span id="cb790-4"><a href="logistic-regression-and-the-resect-data.html#cb790-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">ci =</span> <span class="cn">TRUE</span>)</span>
<span id="cb790-5"><a href="logistic-regression-and-the-resect-data.html#cb790-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb790-6"><a href="logistic-regression-and-the-resect-data.html#cb790-6" aria-hidden="true" tabindex="-1"></a>roc.modD</span></code></pre></div>
<pre><code>
Call:
roc.formula(formula = resect$died ~ predict(res_modD, type = &quot;fitted&quot;),     ci = TRUE)

Data: predict(res_modD, type = &quot;fitted&quot;) in 117 controls (resect$died 0) &lt; 17 cases (resect$died 1).
Area under the curve: 0.8826
95% CI: 0.7952-0.97 (DeLong)</code></pre>
<div class="sourceCode" id="cb792"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb792-1"><a href="logistic-regression-and-the-resect-data.html#cb792-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(roc.modD)</span></code></pre></div>
<p><img src="432-notes_files/figure-html/unnamed-chunk-294-1.png" width="672" /></p>
</div>
<div id="validation-of-model-d-summaries" class="section level3" number="12.15.8">
<h3><span class="header-section-number">12.15.8</span> Validation of Model D summaries</h3>
<div class="sourceCode" id="cb793"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb793-1"><a href="logistic-regression-and-the-resect-data.html#cb793-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">432002</span>)</span>
<span id="cb793-2"><a href="logistic-regression-and-the-resect-data.html#cb793-2" aria-hidden="true" tabindex="-1"></a><span class="fu">validate</span>(res_modD, <span class="at">B =</span> <span class="dv">100</span>)</span></code></pre></div>
<pre><code>
Divergence or singularity in 5 samples</code></pre>
<pre><code>          index.orig training    test optimism index.corrected  n
Dxy           0.7652   0.8080  0.7352   0.0727          0.6925 95
R2            0.4643   0.5347  0.4119   0.1228          0.3416 95
Intercept     0.0000   0.0000 -0.3533   0.3533         -0.3533 95
Slope         1.0000   1.0000  0.7658   0.2342          0.7658 95
Emax          0.0000   0.0000  0.1308   0.1308          0.1308 95
D             0.2767   0.3415  0.2407   0.1008          0.1759 95
U            -0.0149  -0.0149  0.0883  -0.1032          0.0883 95
Q             0.2916   0.3564  0.1524   0.2040          0.0876 95
B             0.0673   0.0640  0.0736  -0.0096          0.0769 95
g             2.3819   4.0387  2.4635   1.5751          0.8068 95
gp            0.1720   0.1910  0.1632   0.0278          0.1442 95</code></pre>
<p>The C statistic indicates fairly strong discrimination, at C = 0.88, although after validation, this looks much weaker (based on Dxy = 0.6925, we would have C = 0.5 + 0.6925/2 = 0.85) and the Nagelkerke <span class="math inline">\(R^2\)</span> is also reasonably good, at 0.46, although this, too, is overly optimistic, and we bias-correct through our validation study to 0.34.</p>
</div>
</div>
<div id="model-e-fitting-a-reduced-model-in-light-of-model-d" class="section level2" number="12.16">
<h2><span class="header-section-number">12.16</span> Model E: Fitting a Reduced Model in light of Model D</h2>
<p>Can you suggest a reduced model (using a subset of the independent variables in model D) that adequately predicts survival?</p>
<p>Based on the anova for model D and the Spearman rho-squared plot, it appears that a two-predictor model using intubation and resection may be sufficient. Neither of the other potential predictors shows a statistically detectable effect in its Wald test.</p>
<div class="sourceCode" id="cb796"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb796-1"><a href="logistic-regression-and-the-resect-data.html#cb796-1" aria-hidden="true" tabindex="-1"></a>res_modE <span class="ot">&lt;-</span> <span class="fu">lrm</span>(died <span class="sc">~</span> intubated <span class="sc">+</span> resection, <span class="at">data=</span>resect, </span>
<span id="cb796-2"><a href="logistic-regression-and-the-resect-data.html#cb796-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">x=</span><span class="cn">TRUE</span>, <span class="at">y=</span><span class="cn">TRUE</span>)</span>
<span id="cb796-3"><a href="logistic-regression-and-the-resect-data.html#cb796-3" aria-hidden="true" tabindex="-1"></a>res_modE</span></code></pre></div>
<pre><code>Logistic Regression Model
 
 lrm(formula = died ~ intubated + resection, data = resect, x = TRUE, 
     y = TRUE)
 
                        Model Likelihood    Discrimination    Rank Discrim.    
                              Ratio Test           Indexes          Indexes    
 Obs           134    LR chi2      33.27    R2       0.413    C       0.867    
  0            117    d.f.             2    g        1.397    Dxy     0.734    
  1             17    Pr(&gt; chi2) &lt;0.0001    gr       4.043    gamma   0.757    
 max |deriv| 5e-10                          gp       0.160    tau-a   0.164    
                                            Brier    0.073                     
 
           Coef    S.E.   Wald Z Pr(&gt;|Z|)
 Intercept -4.6370 1.0430 -4.45  &lt;0.0001 
 intubated  2.8640 0.6479  4.42  &lt;0.0001 
 resection  0.5475 0.2689  2.04  0.0418  
 </code></pre>
<p>The model equation is that the log odds of death is -4.637 + 2.864 <code>intubated</code> + 0.548 <code>resection</code>.</p>
<p>This implies that:</p>
<ul>
<li>for intubated patients, the equation is -1.773 + 0.548 <code>resection</code>, while</li>
<li>for non-intubated patients, the equation is -4.637 + 0.548 <code>resection</code>.</li>
</ul>
<p>We can use the <code>ilogit</code> function within the <code>faraway</code> package to help plot this.</p>
<div id="a-plot-comparing-the-two-intubation-groups" class="section level3" number="12.16.1">
<h3><span class="header-section-number">12.16.1</span> A Plot comparing the two intubation groups</h3>
<div class="sourceCode" id="cb798"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb798-1"><a href="logistic-regression-and-the-resect-data.html#cb798-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(resect, <span class="fu">aes</span>(<span class="at">x =</span> resection, <span class="at">y =</span> died, </span>
<span id="cb798-2"><a href="logistic-regression-and-the-resect-data.html#cb798-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">col =</span> <span class="fu">factor</span>(intubated))) <span class="sc">+</span> </span>
<span id="cb798-3"><a href="logistic-regression-and-the-resect-data.html#cb798-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;blue&quot;</span>, <span class="st">&quot;red&quot;</span>)) <span class="sc">+</span></span>
<span id="cb798-4"><a href="logistic-regression-and-the-resect-data.html#cb798-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_jitter</span>(<span class="at">size =</span> <span class="dv">2</span>, <span class="at">height =</span> <span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb798-5"><a href="logistic-regression-and-the-resect-data.html#cb798-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> resection, </span>
<span id="cb798-6"><a href="logistic-regression-and-the-resect-data.html#cb798-6" aria-hidden="true" tabindex="-1"></a>                  <span class="at">y =</span> faraway<span class="sc">::</span><span class="fu">ilogit</span>(<span class="sc">-</span><span class="fl">4.637</span> <span class="sc">+</span> <span class="fl">0.548</span><span class="sc">*</span>resection)),</span>
<span id="cb798-7"><a href="logistic-regression-and-the-resect-data.html#cb798-7" aria-hidden="true" tabindex="-1"></a>              <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>) <span class="sc">+</span></span>
<span id="cb798-8"><a href="logistic-regression-and-the-resect-data.html#cb798-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> resection,</span>
<span id="cb798-9"><a href="logistic-regression-and-the-resect-data.html#cb798-9" aria-hidden="true" tabindex="-1"></a>                  <span class="at">y =</span> faraway<span class="sc">::</span><span class="fu">ilogit</span>(<span class="sc">-</span><span class="fl">1.773</span> <span class="sc">+</span> <span class="fl">0.548</span><span class="sc">*</span>resection)),</span>
<span id="cb798-10"><a href="logistic-regression-and-the-resect-data.html#cb798-10" aria-hidden="true" tabindex="-1"></a>              <span class="at">col =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb798-11"><a href="logistic-regression-and-the-resect-data.html#cb798-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text</span>(<span class="at">x =</span> <span class="dv">4</span>, <span class="at">y =</span> <span class="fl">0.2</span>, <span class="at">label =</span> <span class="st">&quot;Not Intubated&quot;</span>, </span>
<span id="cb798-12"><a href="logistic-regression-and-the-resect-data.html#cb798-12" aria-hidden="true" tabindex="-1"></a>              <span class="at">col=</span><span class="st">&quot;blue&quot;</span>) <span class="sc">+</span></span>
<span id="cb798-13"><a href="logistic-regression-and-the-resect-data.html#cb798-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text</span>(<span class="at">x =</span> <span class="fl">2.5</span>, <span class="at">y =</span> <span class="fl">0.6</span>, <span class="at">label =</span> <span class="st">&quot;Intubated Patients&quot;</span>, </span>
<span id="cb798-14"><a href="logistic-regression-and-the-resect-data.html#cb798-14" aria-hidden="true" tabindex="-1"></a>              <span class="at">col=</span><span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb798-15"><a href="logistic-regression-and-the-resect-data.html#cb798-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Extent of Resection (in cm.)&quot;</span>,</span>
<span id="cb798-16"><a href="logistic-regression-and-the-resect-data.html#cb798-16" aria-hidden="true" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">&quot;Death (1,0) and estimated probability of death&quot;</span>,</span>
<span id="cb798-17"><a href="logistic-regression-and-the-resect-data.html#cb798-17" aria-hidden="true" tabindex="-1"></a>         <span class="at">title =</span> <span class="st">&quot;resect data, Model E&quot;</span>)</span></code></pre></div>
<p><img src="432-notes_files/figure-html/unnamed-chunk-297-1.png" width="672" /></p>
<p>The effect of <code>intubation</code> appears to be very large, compared to the resection size effect.</p>
</div>
<div id="nomogram-for-model-e" class="section level3" number="12.16.2">
<h3><span class="header-section-number">12.16.2</span> Nomogram for Model E</h3>
<p>A nomogram of the model would help, too.</p>
<div class="sourceCode" id="cb799"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb799-1"><a href="logistic-regression-and-the-resect-data.html#cb799-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">nomogram</span>(res_modE, <span class="at">fun=</span>plogis, </span>
<span id="cb799-2"><a href="logistic-regression-and-the-resect-data.html#cb799-2" aria-hidden="true" tabindex="-1"></a>              <span class="at">fun.at=</span><span class="fu">c</span>(<span class="fl">0.05</span>, <span class="fu">seq</span>(<span class="fl">0.1</span>, <span class="fl">0.9</span>, <span class="at">by=</span><span class="fl">0.1</span>), <span class="fl">0.95</span>), </span>
<span id="cb799-3"><a href="logistic-regression-and-the-resect-data.html#cb799-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">funlabel=</span><span class="st">&quot;Pr(died)&quot;</span>))</span></code></pre></div>
<p><img src="432-notes_files/figure-html/unnamed-chunk-298-1.png" width="672" /></p>
<p>Again, we see that the effect of intubation is enormous, compared to the effect of resection. Another way to see this is to plot the effect sizes directly.</p>
</div>
<div id="effect-sizes-from-model-e" class="section level3" number="12.16.3">
<h3><span class="header-section-number">12.16.3</span> Effect Sizes from Model E</h3>
<div class="sourceCode" id="cb800"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb800-1"><a href="logistic-regression-and-the-resect-data.html#cb800-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">summary</span>(res_modE))</span></code></pre></div>
<p><img src="432-notes_files/figure-html/model%20c%20effect%20plot-1.png" width="672" /></p>
<div class="sourceCode" id="cb801"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb801-1"><a href="logistic-regression-and-the-resect-data.html#cb801-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(res_modE)</span></code></pre></div>
<pre><code>             Effects              Response : died 

 Factor      Low High Diff. Effect  S.E.    Lower 0.95 Upper 0.95
 intubated   0   1    1      2.8640 0.64790 1.59410     4.1338   
  Odds Ratio 0   1    1     17.5310      NA 4.92390    62.4160   
 resection   2   4    2      1.0949 0.53783 0.04082     2.1491   
  Odds Ratio 2   4    2      2.9890      NA 1.04170     8.5769   </code></pre>
</div>
<div id="plot-in-sample-predictions-for-model-e" class="section level3" number="12.16.4">
<h3><span class="header-section-number">12.16.4</span> Plot In-Sample Predictions for Model E</h3>
<p>Here are plots of the effects across the range of each predictor (holding the other constant) on the log odds scale.</p>
<div class="sourceCode" id="cb803"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb803-1"><a href="logistic-regression-and-the-resect-data.html#cb803-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">Predict</span>(res_modE))</span></code></pre></div>
<p><img src="432-notes_files/figure-html/unnamed-chunk-299-1.png" width="672" /></p>
<p>We can also capture and plot these results on the probability scale, as follows.</p>
<div class="sourceCode" id="cb804"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb804-1"><a href="logistic-regression-and-the-resect-data.html#cb804-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">Predict</span>(res_modE, <span class="at">fun =</span> plogis))</span></code></pre></div>
<p><img src="432-notes_files/figure-html/unnamed-chunk-300-1.png" width="672" /></p>
</div>
<div id="anova-for-model-e" class="section level3" number="12.16.5">
<h3><span class="header-section-number">12.16.5</span> ANOVA for Model E</h3>
<div class="sourceCode" id="cb805"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb805-1"><a href="logistic-regression-and-the-resect-data.html#cb805-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(res_modE)</span></code></pre></div>
<pre><code>                Wald Statistics          Response: died 

 Factor     Chi-Square d.f. P     
 intubated  19.54      1    &lt;.0001
 resection   4.14      1    0.0418
 TOTAL      25.47      2    &lt;.0001</code></pre>
</div>
<div id="validation-of-model-e" class="section level3" number="12.16.6">
<h3><span class="header-section-number">12.16.6</span> Validation of Model E</h3>
<div class="sourceCode" id="cb807"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb807-1"><a href="logistic-regression-and-the-resect-data.html#cb807-1" aria-hidden="true" tabindex="-1"></a><span class="fu">validate</span>(res_modE, <span class="at">method=</span><span class="st">&quot;boot&quot;</span>, <span class="at">B=</span><span class="dv">40</span>)</span></code></pre></div>
<pre><code>          index.orig training    test optimism index.corrected  n
Dxy           0.7340   0.6896  0.7326  -0.0430          0.7771 40
R2            0.4128   0.3814  0.4025  -0.0211          0.4339 40
Intercept     0.0000   0.0000  0.1367  -0.1367          0.1367 40
Slope         1.0000   1.0000  1.0472  -0.0472          1.0472 40
Emax          0.0000   0.0000  0.0369   0.0369          0.0369 40
D             0.2408   0.2183  0.2339  -0.0157          0.2565 40
U            -0.0149  -0.0149 -0.0001  -0.0148         -0.0001 40
Q             0.2558   0.2332  0.2340  -0.0009          0.2566 40
B             0.0727   0.0727  0.0759  -0.0032          0.0759 40
g             1.3970   1.3391  1.3577  -0.0186          1.4156 40
gp            0.1597   0.1446  0.1563  -0.0117          0.1714 40</code></pre>
<p>Our bootstrap validated assessments of discrimination and goodness of fit look somewhat more reasonable now.</p>
</div>
<div id="do-any-points-seem-particularly-influential" class="section level3" number="12.16.7">
<h3><span class="header-section-number">12.16.7</span> Do any points seem particularly influential?</h3>
<p>As a last step, I’ll look at influence, and residuals, associated with model E.</p>
<div class="sourceCode" id="cb809"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb809-1"><a href="logistic-regression-and-the-resect-data.html#cb809-1" aria-hidden="true" tabindex="-1"></a>inf.E <span class="ot">&lt;-</span> <span class="fu">which.influence</span>(res_modE, <span class="at">cutoff=</span><span class="fl">0.3</span>)</span>
<span id="cb809-2"><a href="logistic-regression-and-the-resect-data.html#cb809-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb809-3"><a href="logistic-regression-and-the-resect-data.html#cb809-3" aria-hidden="true" tabindex="-1"></a>inf.E</span></code></pre></div>
<pre><code>$Intercept
[1] 84 94

$resection
[1] 84 94</code></pre>
<div class="sourceCode" id="cb811"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb811-1"><a href="logistic-regression-and-the-resect-data.html#cb811-1" aria-hidden="true" tabindex="-1"></a><span class="fu">show.influence</span>(inf.E, <span class="at">dframe =</span> <span class="fu">data.frame</span>(resect))</span></code></pre></div>
<pre><code>   Count resection
84     2        *2
94     2        *6</code></pre>
</div>
<div id="fitting-model-e-using-glm-to-get-plots-about-influence" class="section level3" number="12.16.8">
<h3><span class="header-section-number">12.16.8</span> Fitting Model E using <code>glm</code> to get plots about influence</h3>
<div class="sourceCode" id="cb813"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb813-1"><a href="logistic-regression-and-the-resect-data.html#cb813-1" aria-hidden="true" tabindex="-1"></a>res_modEglm <span class="ot">&lt;-</span> <span class="fu">glm</span>(died <span class="sc">~</span> intubated <span class="sc">+</span> resection, </span>
<span id="cb813-2"><a href="logistic-regression-and-the-resect-data.html#cb813-2" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data=</span>resect, <span class="at">family=</span><span class="st">&quot;binomial&quot;</span>)</span>
<span id="cb813-3"><a href="logistic-regression-and-the-resect-data.html#cb813-3" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb813-4"><a href="logistic-regression-and-the-resect-data.html#cb813-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(res_modEglm, <span class="at">which=</span><span class="fu">c</span>(<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>))</span></code></pre></div>
<p><img src="432-notes_files/figure-html/unnamed-chunk-304-1.png" width="672" /></p>
<p>Using this <code>glm</code> residuals approach, we again see that points 84 and 94 have the largest influence on our model E.</p>
</div>
</div>
<div id="concordance-comparing-model-c-d-and-es-predictions" class="section level2" number="12.17">
<h2><span class="header-section-number">12.17</span> Concordance: Comparing Model C, D and E’s predictions</h2>
<p>To start, we’ll gather the predictions fomade by each model (C, D and E) on the probability scale, in one place. Sadly, <code>augment</code> from <code>broom</code> doesn’t work well with <code>lrm</code> fits, so we have to do this on our own.</p>
<div class="sourceCode" id="cb814"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb814-1"><a href="logistic-regression-and-the-resect-data.html#cb814-1" aria-hidden="true" tabindex="-1"></a>resect_preds <span class="ot">&lt;-</span> resect <span class="sc">%&gt;%</span></span>
<span id="cb814-2"><a href="logistic-regression-and-the-resect-data.html#cb814-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">C =</span> <span class="fu">predict</span>(res_modC, <span class="at">type =</span> <span class="st">&quot;fitted&quot;</span>),</span>
<span id="cb814-3"><a href="logistic-regression-and-the-resect-data.html#cb814-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">D =</span> <span class="fu">predict</span>(res_modD, <span class="at">type =</span> <span class="st">&quot;fitted&quot;</span>),</span>
<span id="cb814-4"><a href="logistic-regression-and-the-resect-data.html#cb814-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">E =</span> <span class="fu">predict</span>(res_modE, <span class="at">type =</span> <span class="st">&quot;fitted&quot;</span>))</span>
<span id="cb814-5"><a href="logistic-regression-and-the-resect-data.html#cb814-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb814-6"><a href="logistic-regression-and-the-resect-data.html#cb814-6" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(resect_preds)</span></code></pre></div>
<pre><code># A tibble: 6 x 9
     id   age prior resection intubated  died      C      D      E
  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
1     1    34     1       2.5         0     0 0.0705 0.0632 0.0367
2     2    57     0       5           0     0 0.326  0.0620 0.130 
3     3    60     1       4           1     1 0.187  0.791  0.603 
4     4    62     1       4.2         0     0 0.211  0.158  0.0881
5     5    28     0       6           1     1 0.504  0.711  0.819 
6     6    52     0       3           0     0 0.0990 0.0737 0.0477</code></pre>
<p>And now, we’ll use the <code>gather</code> command to arrange the models and predicted probabilities in a more useful manner for plotting.</p>
<div class="sourceCode" id="cb816"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb816-1"><a href="logistic-regression-and-the-resect-data.html#cb816-1" aria-hidden="true" tabindex="-1"></a>res_p <span class="ot">&lt;-</span> resect_preds <span class="sc">%&gt;%</span></span>
<span id="cb816-2"><a href="logistic-regression-and-the-resect-data.html#cb816-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">gather</span>(<span class="st">&quot;model&quot;</span>, <span class="st">&quot;prediction&quot;</span>, <span class="dv">7</span><span class="sc">:</span><span class="dv">9</span>) <span class="sc">%&gt;%</span></span>
<span id="cb816-3"><a href="logistic-regression-and-the-resect-data.html#cb816-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(id, died, model, prediction)</span>
<span id="cb816-4"><a href="logistic-regression-and-the-resect-data.html#cb816-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb816-5"><a href="logistic-regression-and-the-resect-data.html#cb816-5" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(res_p)</span></code></pre></div>
<pre><code># A tibble: 6 x 4
     id  died model prediction
  &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;dbl&gt;
1     1     0 C         0.0705
2     2     0 C         0.326 
3     3     1 C         0.187 
4     4     0 C         0.211 
5     5     1 C         0.504 
6     6     0 C         0.0990</code></pre>
<p>Here’s the resulting plot.</p>
<div class="sourceCode" id="cb818"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb818-1"><a href="logistic-regression-and-the-resect-data.html#cb818-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(res_p, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(died), <span class="at">y =</span> prediction, </span>
<span id="cb818-2"><a href="logistic-regression-and-the-resect-data.html#cb818-2" aria-hidden="true" tabindex="-1"></a>                  <span class="at">group =</span> model, <span class="at">col =</span> model)) <span class="sc">+</span></span>
<span id="cb818-3"><a href="logistic-regression-and-the-resect-data.html#cb818-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="fl">0.25</span>) <span class="sc">+</span> </span>
<span id="cb818-4"><a href="logistic-regression-and-the-resect-data.html#cb818-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb818-5"><a href="logistic-regression-and-the-resect-data.html#cb818-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>( <span class="sc">~</span> model) <span class="sc">+</span> </span>
<span id="cb818-6"><a href="logistic-regression-and-the-resect-data.html#cb818-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">guides</span>(<span class="at">color =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb818-7"><a href="logistic-regression-and-the-resect-data.html#cb818-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Comparing Predictions for our Three Models&quot;</span>,</span>
<span id="cb818-8"><a href="logistic-regression-and-the-resect-data.html#cb818-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">subtitle =</span> <span class="st">&quot;A graphical view of concordance&quot;</span>,</span>
<span id="cb818-9"><a href="logistic-regression-and-the-resect-data.html#cb818-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">x =</span> <span class="st">&quot;Actual mortality status (1 = died)&quot;</span>,</span>
<span id="cb818-10"><a href="logistic-regression-and-the-resect-data.html#cb818-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">&quot;Predicted probability of death&quot;</span>)</span></code></pre></div>
<p><img src="432-notes_files/figure-html/unnamed-chunk-307-1.png" width="672" /></p>
<p>We could specify a particular rule, for example: if the predicted probability of death is 0.5 or greater, then predict “Died.”</p>
<div class="sourceCode" id="cb819"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb819-1"><a href="logistic-regression-and-the-resect-data.html#cb819-1" aria-hidden="true" tabindex="-1"></a>res_p<span class="sc">$</span>rule<span class="fl">.5</span> <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(res_p<span class="sc">$</span>prediction <span class="sc">&gt;=</span> <span class="fl">0.5</span>, </span>
<span id="cb819-2"><a href="logistic-regression-and-the-resect-data.html#cb819-2" aria-hidden="true" tabindex="-1"></a>                       <span class="st">&quot;Predict Died&quot;</span>, <span class="st">&quot;Predict Alive&quot;</span>)</span>
<span id="cb819-3"><a href="logistic-regression-and-the-resect-data.html#cb819-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb819-4"><a href="logistic-regression-and-the-resect-data.html#cb819-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ftable</span>(<span class="fu">table</span>(res_p<span class="sc">$</span>model, res_p<span class="sc">$</span>rule<span class="fl">.5</span>, res_p<span class="sc">$</span>died))</span></code></pre></div>
<pre><code>                   0   1
                        
C Predict Alive  114  16
  Predict Died     3   1
D Predict Alive  113   7
  Predict Died     4  10
E Predict Alive  114   8
  Predict Died     3   9</code></pre>
<p>And perhaps build the linked table of row probabilities…</p>
<div class="sourceCode" id="cb821"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb821-1"><a href="logistic-regression-and-the-resect-data.html#cb821-1" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="dv">100</span><span class="sc">*</span><span class="fu">prop.table</span>(</span>
<span id="cb821-2"><a href="logistic-regression-and-the-resect-data.html#cb821-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ftable</span>(<span class="fu">table</span>(res_p<span class="sc">$</span>model, res_p<span class="sc">$</span>rule<span class="fl">.5</span>, res_p<span class="sc">$</span>died))</span>
<span id="cb821-3"><a href="logistic-regression-and-the-resect-data.html#cb821-3" aria-hidden="true" tabindex="-1"></a>    ,<span class="dv">1</span>),<span class="dv">2</span>)</span></code></pre></div>
<pre><code>                     0     1
                            
C Predict Alive  87.69 12.31
  Predict Died   75.00 25.00
D Predict Alive  94.17  5.83
  Predict Died   28.57 71.43
E Predict Alive  93.44  6.56
  Predict Died   25.00 75.00</code></pre>
<p>For example, in model E, 93.44% of those predicted to be alive actually survived, and 75% of those predicted to die actually died.</p>
<ul>
<li>Model D does a little better in one direction (94.17% of those predicted by Model D to be alive actually survived) but worse in the other (71.43% of those predicted by Model D to die actually died.)</li>
<li>Model C does worse than each of the others in both predicting those who survive and those who die.</li>
</ul>
<p>Note that the approaches discussed here would be useful if we had a new sample to predict on, as well. We could then compare the errors for that new data made by this sort of classification scheme either graphically or in a table.</p>
</div>
<div id="conclusions" class="section level2" number="12.18">
<h2><span class="header-section-number">12.18</span> Conclusions</h2>
<p>It appears that <code>intubated</code> status and, to a lesser degree, the extent of the <code>resection</code> both play a meaningful role in predicting death associated with tracheal carina resection surgery. Patients who are intubated are associated with worse outcomes (greater risk of death) and more extensive resections are also associated with worse outcomes.</p>

</div>
</div>
<div class="footnotes">
<hr />
<ol start="7">
<li id="fn7"><p>Although I’ve yet to figure out how to get the y axis relabeled properly without simply dumping the Predict results into a new tibble and starting over with creating the plots.<a href="logistic-regression-and-the-resect-data.html#fnref7" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="logistic-regression-the-foundations.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="a-study-of-prostate-cancer.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["432-notes.pdf"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
