<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 20 Modeling an Ordinal Categorical Outcome in Ohio SMART | Data Science for Biological, Medical and Health Research: Notes for 432</title>
  <meta name="description" content="Course Notes for PQHS 432 in Spring 2021." />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 20 Modeling an Ordinal Categorical Outcome in Ohio SMART | Data Science for Biological, Medical and Health Research: Notes for 432" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Course Notes for PQHS 432 in Spring 2021." />
  <meta name="github-repo" content="thomaselove/432-notes" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 20 Modeling an Ordinal Categorical Outcome in Ohio SMART | Data Science for Biological, Medical and Health Research: Notes for 432" />
  
  <meta name="twitter:description" content="Course Notes for PQHS 432 in Spring 2021." />
  

<meta name="author" content="Thomas E. Love, Ph.D." />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="modeling-a-count-outcome-in-ohio-smart.html"/>
<link rel="next" href="analyzing-literary-styles-with-multinomial-logistic-regression.html"/>
<script src="libs/header-attrs-2.11/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="" data-path="r-packages-used-in-these-notes.html"><a href="r-packages-used-in-these-notes.html"><i class="fa fa-check"></i>R Packages used in these notes</a>
<ul>
<li class="chapter" data-level="" data-path="r-packages-used-in-these-notes.html"><a href="r-packages-used-in-these-notes.html#dealing-with-conflicts"><i class="fa fa-check"></i>Dealing with Conflicts</a></li>
<li><a href="r-packages-used-in-these-notes.html#general-theme-for-ggplot-work">General Theme for <code>ggplot</code> work</a></li>
<li class="chapter" data-level="" data-path="r-packages-used-in-these-notes.html"><a href="r-packages-used-in-these-notes.html#data-used-in-these-notes"><i class="fa fa-check"></i>Data used in these notes</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="building-table-1.html"><a href="building-table-1.html"><i class="fa fa-check"></i><b>1</b> Building Table 1</a>
<ul>
<li class="chapter" data-level="1.1" data-path="building-table-1.html"><a href="building-table-1.html#data-load"><i class="fa fa-check"></i><b>1.1</b> Data load</a></li>
<li class="chapter" data-level="1.2" data-path="building-table-1.html"><a href="building-table-1.html#two-examples-from-the-new-england-journal-of-medicine"><i class="fa fa-check"></i><b>1.2</b> Two examples from the <em>New England Journal of Medicine</em></a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="building-table-1.html"><a href="building-table-1.html#a-simple-table-1"><i class="fa fa-check"></i><b>1.2.1</b> A simple Table 1</a></li>
<li class="chapter" data-level="1.2.2" data-path="building-table-1.html"><a href="building-table-1.html#a-group-comparison"><i class="fa fa-check"></i><b>1.2.2</b> A group comparison</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="building-table-1.html"><a href="building-table-1.html#the-mr-clean-trial"><i class="fa fa-check"></i><b>1.3</b> The MR CLEAN trial</a></li>
<li class="chapter" data-level="1.4" data-path="building-table-1.html"><a href="building-table-1.html#simulated-fakestroke-data"><i class="fa fa-check"></i><b>1.4</b> Simulated <code>fakestroke</code> data</a></li>
<li class="chapter" data-level="1.5" data-path="building-table-1.html"><a href="building-table-1.html#building-table-1-for-fakestroke-attempt-1"><i class="fa fa-check"></i><b>1.5</b> Building Table 1 for <code>fakestroke</code>: Attempt 1</a>
<ul>
<li class="chapter" data-level="1.5.1" data-path="building-table-1.html"><a href="building-table-1.html#some-of-this-is-very-useful-and-other-parts-need-to-be-fixed."><i class="fa fa-check"></i><b>1.5.1</b> Some of this is very useful, and other parts need to be fixed.</a></li>
<li class="chapter" data-level="1.5.2" data-path="building-table-1.html"><a href="building-table-1.html#fakestroke-cleaning-up-categorical-variables"><i class="fa fa-check"></i><b>1.5.2</b> <code>fakestroke</code> Cleaning Up Categorical Variables</a></li>
</ul></li>
<li class="chapter" data-level="1.6" data-path="building-table-1.html"><a href="building-table-1.html#fakestroke-table-1-attempt-2"><i class="fa fa-check"></i><b>1.6</b> <code>fakestroke</code> Table 1: Attempt 2</a>
<ul>
<li class="chapter" data-level="1.6.1" data-path="building-table-1.html"><a href="building-table-1.html#what-summaries-should-we-show"><i class="fa fa-check"></i><b>1.6.1</b> What summaries should we show?</a></li>
</ul></li>
<li class="chapter" data-level="1.7" data-path="building-table-1.html"><a href="building-table-1.html#obtaining-a-more-detailed-summary"><i class="fa fa-check"></i><b>1.7</b> Obtaining a more detailed Summary</a></li>
<li class="chapter" data-level="1.8" data-path="building-table-1.html"><a href="building-table-1.html#exporting-the-completed-table-1-from-r-to-excel-or-word"><i class="fa fa-check"></i><b>1.8</b> Exporting the Completed Table 1 from R to Excel or Word</a>
<ul>
<li class="chapter" data-level="1.8.1" data-path="building-table-1.html"><a href="building-table-1.html#approach-a-save-and-open-in-excel"><i class="fa fa-check"></i><b>1.8.1</b> Approach A: Save and open in Excel</a></li>
<li class="chapter" data-level="1.8.2" data-path="building-table-1.html"><a href="building-table-1.html#approach-b-produce-the-table-so-you-can-cut-and-paste-it"><i class="fa fa-check"></i><b>1.8.2</b> Approach B: Produce the Table so you can cut and paste it</a></li>
</ul></li>
<li class="chapter" data-level="1.9" data-path="building-table-1.html"><a href="building-table-1.html#a-controlled-biological-experiment---the-blood-brain-barrier"><i class="fa fa-check"></i><b>1.9</b> A Controlled Biological Experiment - The Blood-Brain Barrier</a></li>
<li class="chapter" data-level="1.10" data-path="building-table-1.html"><a href="building-table-1.html#the-bloodbrain.csv-file"><i class="fa fa-check"></i><b>1.10</b> The <code>bloodbrain.csv</code> file</a></li>
<li class="chapter" data-level="1.11" data-path="building-table-1.html"><a href="building-table-1.html#a-table-1-for-bloodbrain"><i class="fa fa-check"></i><b>1.11</b> A Table 1 for <code>bloodbrain</code></a>
<ul>
<li class="chapter" data-level="1.11.1" data-path="building-table-1.html"><a href="building-table-1.html#generate-final-table-1-for-bloodbrain"><i class="fa fa-check"></i><b>1.11.1</b> Generate final Table 1 for <code>bloodbrain</code></a></li>
<li class="chapter" data-level="1.11.2" data-path="building-table-1.html"><a href="building-table-1.html#a-more-finished-version-after-cleanup-in-word"><i class="fa fa-check"></i><b>1.11.2</b> A More Finished Version (after Cleanup in Word)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="brfss-smart-data-building.html"><a href="brfss-smart-data-building.html"><i class="fa fa-check"></i><b>2</b> BRFSS SMART Data Building</a>
<ul>
<li class="chapter" data-level="2.1" data-path="brfss-smart-data-building.html"><a href="brfss-smart-data-building.html#key-resources"><i class="fa fa-check"></i><b>2.1</b> Key resources</a></li>
<li class="chapter" data-level="2.2" data-path="brfss-smart-data-building.html"><a href="brfss-smart-data-building.html#ingesting-the-raw-data"><i class="fa fa-check"></i><b>2.2</b> Ingesting the Raw Data</a></li>
<li class="chapter" data-level="2.3" data-path="brfss-smart-data-building.html"><a href="brfss-smart-data-building.html#ingesting-from-our-csv-file"><i class="fa fa-check"></i><b>2.3</b> Ingesting from our CSV file</a></li>
<li class="chapter" data-level="2.4" data-path="brfss-smart-data-building.html"><a href="brfss-smart-data-building.html#what-does-the-raw-data-look-like"><i class="fa fa-check"></i><b>2.4</b> What does the raw data look like?</a></li>
<li class="chapter" data-level="2.5" data-path="brfss-smart-data-building.html"><a href="brfss-smart-data-building.html#cleaning-the-brfss-data"><i class="fa fa-check"></i><b>2.5</b> Cleaning the BRFSS Data</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="brfss-smart-data-building.html"><a href="brfss-smart-data-building.html#identifying-information"><i class="fa fa-check"></i><b>2.5.1</b> Identifying Information</a></li>
<li class="chapter" data-level="2.5.2" data-path="brfss-smart-data-building.html"><a href="brfss-smart-data-building.html#survey-method"><i class="fa fa-check"></i><b>2.5.2</b> Survey Method</a></li>
<li class="chapter" data-level="2.5.3" data-path="brfss-smart-data-building.html"><a href="brfss-smart-data-building.html#health-status-1-item"><i class="fa fa-check"></i><b>2.5.3</b> Health Status (1 item)</a></li>
<li class="chapter" data-level="2.5.4" data-path="brfss-smart-data-building.html"><a href="brfss-smart-data-building.html#healthy-days---health-related-quality-of-life-3-items"><i class="fa fa-check"></i><b>2.5.4</b> Healthy Days - Health-Related Quality of Life (3 items)</a></li>
<li class="chapter" data-level="2.5.5" data-path="brfss-smart-data-building.html"><a href="brfss-smart-data-building.html#health-care-access-4-items"><i class="fa fa-check"></i><b>2.5.5</b> Health Care Access (4 items)</a></li>
<li class="chapter" data-level="2.5.6" data-path="brfss-smart-data-building.html"><a href="brfss-smart-data-building.html#blood-pressure-2-measures"><i class="fa fa-check"></i><b>2.5.6</b> Blood Pressure (2 measures)</a></li>
<li class="chapter" data-level="2.5.7" data-path="brfss-smart-data-building.html"><a href="brfss-smart-data-building.html#cholesterol-3-items"><i class="fa fa-check"></i><b>2.5.7</b> Cholesterol (3 items)</a></li>
<li class="chapter" data-level="2.5.8" data-path="brfss-smart-data-building.html"><a href="brfss-smart-data-building.html#chronic-health-conditions-14-items"><i class="fa fa-check"></i><b>2.5.8</b> Chronic Health Conditions (14 items)</a></li>
<li class="chapter" data-level="2.5.9" data-path="brfss-smart-data-building.html"><a href="brfss-smart-data-building.html#arthritis-burden-4-items"><i class="fa fa-check"></i><b>2.5.9</b> Arthritis Burden (4 items)</a></li>
<li class="chapter" data-level="2.5.10" data-path="brfss-smart-data-building.html"><a href="brfss-smart-data-building.html#demographics-25-items"><i class="fa fa-check"></i><b>2.5.10</b> Demographics (25 items)</a></li>
<li class="chapter" data-level="2.5.11" data-path="brfss-smart-data-building.html"><a href="brfss-smart-data-building.html#tobacco-use-2-items"><i class="fa fa-check"></i><b>2.5.11</b> Tobacco Use (2 items)</a></li>
<li class="chapter" data-level="2.5.12" data-path="brfss-smart-data-building.html"><a href="brfss-smart-data-building.html#e-cigarettes-2-items"><i class="fa fa-check"></i><b>2.5.12</b> E-Cigarettes (2 items)</a></li>
<li class="chapter" data-level="2.5.13" data-path="brfss-smart-data-building.html"><a href="brfss-smart-data-building.html#alcohol-consumption-6-items"><i class="fa fa-check"></i><b>2.5.13</b> Alcohol Consumption (6 items)</a></li>
<li class="chapter" data-level="2.5.14" data-path="brfss-smart-data-building.html"><a href="brfss-smart-data-building.html#fruits-and-vegetables-8-items"><i class="fa fa-check"></i><b>2.5.14</b> Fruits and Vegetables (8 items)</a></li>
<li class="chapter" data-level="2.5.15" data-path="brfss-smart-data-building.html"><a href="brfss-smart-data-building.html#exercise-and-physical-activity-8-items"><i class="fa fa-check"></i><b>2.5.15</b> Exercise and Physical Activity (8 items)</a></li>
<li class="chapter" data-level="2.5.16" data-path="brfss-smart-data-building.html"><a href="brfss-smart-data-building.html#seatbelt-use-1-item"><i class="fa fa-check"></i><b>2.5.16</b> Seatbelt Use (1 item)</a></li>
<li class="chapter" data-level="2.5.17" data-path="brfss-smart-data-building.html"><a href="brfss-smart-data-building.html#immunization-3-items"><i class="fa fa-check"></i><b>2.5.17</b> Immunization (3 items)</a></li>
<li class="chapter" data-level="2.5.18" data-path="brfss-smart-data-building.html"><a href="brfss-smart-data-building.html#hivaids-2-items"><i class="fa fa-check"></i><b>2.5.18</b> HIV/AIDS (2 items)</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="brfss-smart-data-building.html"><a href="brfss-smart-data-building.html#imputing-age-and-income-as-quantitative-from-thin-air"><i class="fa fa-check"></i><b>2.6</b> Imputing Age and Income as Quantitative from Thin Air</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="brfss-smart-data-building.html"><a href="brfss-smart-data-building.html#age_imp-imputing-age-data"><i class="fa fa-check"></i><b>2.6.1</b> <code>age_imp</code>: Imputing Age Data</a></li>
<li class="chapter" data-level="2.6.2" data-path="brfss-smart-data-building.html"><a href="brfss-smart-data-building.html#inc_imp-imputing-income-data"><i class="fa fa-check"></i><b>2.6.2</b> <code>inc_imp</code>: Imputing Income Data</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="brfss-smart-data-building.html"><a href="brfss-smart-data-building.html#clean-data-in-the-state-of-ohio"><i class="fa fa-check"></i><b>2.7</b> Clean Data in the State of Ohio</a></li>
<li class="chapter" data-level="2.8" data-path="brfss-smart-data-building.html"><a href="brfss-smart-data-building.html#clean-cleveland-elyria-data"><i class="fa fa-check"></i><b>2.8</b> Clean Cleveland-Elyria Data</a>
<ul>
<li class="chapter" data-level="2.8.1" data-path="brfss-smart-data-building.html"><a href="brfss-smart-data-building.html#cleveland---elyria-data"><i class="fa fa-check"></i><b>2.8.1</b> Cleveland - Elyria Data</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="dealing-with-missingness-single-imputation.html"><a href="dealing-with-missingness-single-imputation.html"><i class="fa fa-check"></i><b>3</b> Dealing with Missingness: Single Imputation</a>
<ul>
<li class="chapter" data-level="3.1" data-path="dealing-with-missingness-single-imputation.html"><a href="dealing-with-missingness-single-imputation.html#selecting-some-variables-from-the-smart_cle-data"><i class="fa fa-check"></i><b>3.1</b> Selecting Some Variables from the <code>smart_cle</code> data</a></li>
<li class="chapter" data-level="3.2" data-path="dealing-with-missingness-single-imputation.html"><a href="dealing-with-missingness-single-imputation.html#smart_cle1-seeing-our-missing-data"><i class="fa fa-check"></i><b>3.2</b> <code>smart_cle1</code>: Seeing our Missing Data</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="dealing-with-missingness-single-imputation.html"><a href="dealing-with-missingness-single-imputation.html#plotting-missingness"><i class="fa fa-check"></i><b>3.2.1</b> Plotting Missingness</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="dealing-with-missingness-single-imputation.html"><a href="dealing-with-missingness-single-imputation.html#missing-data-mechanisms"><i class="fa fa-check"></i><b>3.3</b> Missing-data mechanisms</a></li>
<li class="chapter" data-level="3.4" data-path="dealing-with-missingness-single-imputation.html"><a href="dealing-with-missingness-single-imputation.html#options-for-dealing-with-missingness"><i class="fa fa-check"></i><b>3.4</b> Options for Dealing with Missingness</a></li>
<li class="chapter" data-level="3.5" data-path="dealing-with-missingness-single-imputation.html"><a href="dealing-with-missingness-single-imputation.html#complete-case-and-available-case-analyses"><i class="fa fa-check"></i><b>3.5</b> Complete Case (and Available Case) analyses</a></li>
<li class="chapter" data-level="3.6" data-path="dealing-with-missingness-single-imputation.html"><a href="dealing-with-missingness-single-imputation.html#single-imputation"><i class="fa fa-check"></i><b>3.6</b> Single Imputation</a></li>
<li class="chapter" data-level="3.7" data-path="dealing-with-missingness-single-imputation.html"><a href="dealing-with-missingness-single-imputation.html#multiple-imputation"><i class="fa fa-check"></i><b>3.7</b> Multiple Imputation</a></li>
<li class="chapter" data-level="3.8" data-path="dealing-with-missingness-single-imputation.html"><a href="dealing-with-missingness-single-imputation.html#approach-1-building-a-complete-case-analysis-smart_cle1_cc"><i class="fa fa-check"></i><b>3.8</b> Approach 1: Building a Complete Case Analysis: <code>smart_cle1_cc</code></a></li>
<li class="chapter" data-level="3.9" data-path="dealing-with-missingness-single-imputation.html"><a href="dealing-with-missingness-single-imputation.html#approach-2-single-imputation-to-create-smart_cle1_sh"><i class="fa fa-check"></i><b>3.9</b> Approach 2: Single Imputation to create <code>smart_cle1_sh</code></a>
<ul>
<li class="chapter" data-level="3.9.1" data-path="dealing-with-missingness-single-imputation.html"><a href="dealing-with-missingness-single-imputation.html#what-type-of-missingness-do-we-have"><i class="fa fa-check"></i><b>3.9.1</b> What Type of Missingness Do We Have?</a></li>
<li class="chapter" data-level="3.9.2" data-path="dealing-with-missingness-single-imputation.html"><a href="dealing-with-missingness-single-imputation.html#single-imputation-into-smart_cle1_sh"><i class="fa fa-check"></i><b>3.9.2</b> Single imputation into <code>smart_cle1_sh</code></a></li>
<li class="chapter" data-level="3.9.3" data-path="dealing-with-missingness-single-imputation.html"><a href="dealing-with-missingness-single-imputation.html#imputing-binary-categorical-variables"><i class="fa fa-check"></i><b>3.9.3</b> Imputing Binary Categorical Variables</a></li>
<li class="chapter" data-level="3.9.4" data-path="dealing-with-missingness-single-imputation.html"><a href="dealing-with-missingness-single-imputation.html#imputing-quantitative-variables"><i class="fa fa-check"></i><b>3.9.4</b> Imputing Quantitative Variables</a></li>
<li class="chapter" data-level="3.9.5" data-path="dealing-with-missingness-single-imputation.html"><a href="dealing-with-missingness-single-imputation.html#imputation-results"><i class="fa fa-check"></i><b>3.9.5</b> Imputation Results</a></li>
<li class="chapter" data-level="3.9.6" data-path="dealing-with-missingness-single-imputation.html"><a href="dealing-with-missingness-single-imputation.html#imputing-multi-categorical-variables"><i class="fa fa-check"></i><b>3.9.6</b> Imputing Multi-Categorical Variables</a></li>
<li class="chapter" data-level="3.9.7" data-path="dealing-with-missingness-single-imputation.html"><a href="dealing-with-missingness-single-imputation.html#saving-the-new-tibbles"><i class="fa fa-check"></i><b>3.9.7</b> Saving the new tibbles</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="summarizing-the-smart_cle1-data.html"><a href="summarizing-the-smart_cle1-data.html"><i class="fa fa-check"></i><b>4</b> Summarizing the <code>smart_cle1</code> data</a>
<ul>
<li class="chapter" data-level="4.1" data-path="summarizing-the-smart_cle1-data.html"><a href="summarizing-the-smart_cle1-data.html#general-approaches-to-obtaining-numeric-summaries"><i class="fa fa-check"></i><b>4.1</b> General Approaches to Obtaining Numeric Summaries</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="summarizing-the-smart_cle1-data.html"><a href="summarizing-the-smart_cle1-data.html#summary-for-a-data-frame"><i class="fa fa-check"></i><b>4.1.1</b> <code>summary</code> for a data frame</a></li>
<li class="chapter" data-level="4.1.2" data-path="summarizing-the-smart_cle1-data.html"><a href="summarizing-the-smart_cle1-data.html#the-inspect-function-from-the-mosaic-package"><i class="fa fa-check"></i><b>4.1.2</b> The <code>inspect</code> function from the <code>mosaic</code> package</a></li>
<li class="chapter" data-level="4.1.3" data-path="summarizing-the-smart_cle1-data.html"><a href="summarizing-the-smart_cle1-data.html#the-describe-function-in-hmisc"><i class="fa fa-check"></i><b>4.1.3</b> The <code>describe</code> function in <code>Hmisc</code></a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="summarizing-the-smart_cle1-data.html"><a href="summarizing-the-smart_cle1-data.html#counting-as-exploratory-data-analysis"><i class="fa fa-check"></i><b>4.2</b> Counting as exploratory data analysis</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="summarizing-the-smart_cle1-data.html"><a href="summarizing-the-smart_cle1-data.html#did-genhealth-vary-by-smoking-status"><i class="fa fa-check"></i><b>4.2.1</b> Did <code>genhealth</code> vary by smoking status?</a></li>
<li class="chapter" data-level="4.2.2" data-path="summarizing-the-smart_cle1-data.html"><a href="summarizing-the-smart_cle1-data.html#whats-the-distribution-of-physhealth"><i class="fa fa-check"></i><b>4.2.2</b> What’s the distribution of <code>physhealth</code>?</a></li>
<li class="chapter" data-level="4.2.3" data-path="summarizing-the-smart_cle1-data.html"><a href="summarizing-the-smart_cle1-data.html#whats-the-distribution-of-bmi"><i class="fa fa-check"></i><b>4.2.3</b> What’s the distribution of <code>bmi</code>?</a></li>
<li class="chapter" data-level="4.2.4" data-path="summarizing-the-smart_cle1-data.html"><a href="summarizing-the-smart_cle1-data.html#how-many-of-the-respondents-have-a-bmi-below-30"><i class="fa fa-check"></i><b>4.2.4</b> How many of the respondents have a BMI below 30?</a></li>
<li class="chapter" data-level="4.2.5" data-path="summarizing-the-smart_cle1-data.html"><a href="summarizing-the-smart_cle1-data.html#how-many-of-the-respondents-with-a-bmi-30-are-highly-active"><i class="fa fa-check"></i><b>4.2.5</b> How many of the respondents with a BMI &lt; 30 are highly active?</a></li>
<li class="chapter" data-level="4.2.6" data-path="summarizing-the-smart_cle1-data.html"><a href="summarizing-the-smart_cle1-data.html#is-obesity-associated-with-smoking-history"><i class="fa fa-check"></i><b>4.2.6</b> Is obesity associated with smoking history?</a></li>
<li class="chapter" data-level="4.2.7" data-path="summarizing-the-smart_cle1-data.html"><a href="summarizing-the-smart_cle1-data.html#comparing-drinks_wk-summaries-by-obesity-status"><i class="fa fa-check"></i><b>4.2.7</b> Comparing <code>drinks_wk</code> summaries by obesity status</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="summarizing-the-smart_cle1-data.html"><a href="summarizing-the-smart_cle1-data.html#can-bmi-predict-physhealth"><i class="fa fa-check"></i><b>4.3</b> Can <code>bmi</code> predict <code>physhealth</code>?</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="summarizing-the-smart_cle1-data.html"><a href="summarizing-the-smart_cle1-data.html#fitting-a-simple-regression-model"><i class="fa fa-check"></i><b>4.3.1</b> Fitting a Simple Regression Model</a></li>
<li class="chapter" data-level="4.3.2" data-path="summarizing-the-smart_cle1-data.html"><a href="summarizing-the-smart_cle1-data.html#model-summary-for-a-simple-one-predictor-regression"><i class="fa fa-check"></i><b>4.3.2</b> Model Summary for a Simple (One-Predictor) Regression</a></li>
<li class="chapter" data-level="4.3.3" data-path="summarizing-the-smart_cle1-data.html"><a href="summarizing-the-smart_cle1-data.html#using-the-broom-package"><i class="fa fa-check"></i><b>4.3.3</b> Using the <code>broom</code> package</a></li>
<li class="chapter" data-level="4.3.4" data-path="summarizing-the-smart_cle1-data.html"><a href="summarizing-the-smart_cle1-data.html#how-does-the-model-do-residuals-vs.-fitted-values"><i class="fa fa-check"></i><b>4.3.4</b> How does the model do? (Residuals vs. Fitted Values)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="analysis-of-variance-with-smart.html"><a href="analysis-of-variance-with-smart.html"><i class="fa fa-check"></i><b>5</b> Analysis of Variance with SMART</a>
<ul>
<li class="chapter" data-level="5.1" data-path="analysis-of-variance-with-smart.html"><a href="analysis-of-variance-with-smart.html#a-one-factor-analysis-of-variance"><i class="fa fa-check"></i><b>5.1</b> A One-Factor Analysis of Variance</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="analysis-of-variance-with-smart.html"><a href="analysis-of-variance-with-smart.html#can-activity-be-used-to-predict-bmi"><i class="fa fa-check"></i><b>5.1.1</b> Can <code>activity</code> be used to predict <code>bmi</code>?</a></li>
<li class="chapter" data-level="5.1.2" data-path="analysis-of-variance-with-smart.html"><a href="analysis-of-variance-with-smart.html#should-we-transform-bmi"><i class="fa fa-check"></i><b>5.1.2</b> Should we transform <code>bmi</code>?</a></li>
<li class="chapter" data-level="5.1.3" data-path="analysis-of-variance-with-smart.html"><a href="analysis-of-variance-with-smart.html#building-the-anova-model"><i class="fa fa-check"></i><b>5.1.3</b> Building the ANOVA model</a></li>
<li class="chapter" data-level="5.1.4" data-path="analysis-of-variance-with-smart.html"><a href="analysis-of-variance-with-smart.html#the-anova-table"><i class="fa fa-check"></i><b>5.1.4</b> The ANOVA table</a></li>
<li class="chapter" data-level="5.1.5" data-path="analysis-of-variance-with-smart.html"><a href="analysis-of-variance-with-smart.html#the-model-coefficients"><i class="fa fa-check"></i><b>5.1.5</b> The Model Coefficients</a></li>
<li class="chapter" data-level="5.1.6" data-path="analysis-of-variance-with-smart.html"><a href="analysis-of-variance-with-smart.html#using-broomtidy-to-explore-the-coefficients"><i class="fa fa-check"></i><b>5.1.6</b> Using <code>broom::tidy</code> to explore the coefficients</a></li>
<li class="chapter" data-level="5.1.7" data-path="analysis-of-variance-with-smart.html"><a href="analysis-of-variance-with-smart.html#using-broomglance-to-summarize-the-models-fit"><i class="fa fa-check"></i><b>5.1.7</b> Using <code>broom::glance</code> to summarize the model’s fit</a></li>
<li class="chapter" data-level="5.1.8" data-path="analysis-of-variance-with-smart.html"><a href="analysis-of-variance-with-smart.html#using-broomaugment-to-make-predictions"><i class="fa fa-check"></i><b>5.1.8</b> Using <code>broom::augment</code> to make predictions</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="analysis-of-variance-with-smart.html"><a href="analysis-of-variance-with-smart.html#a-two-factor-anova-without-interaction"><i class="fa fa-check"></i><b>5.2</b> A Two-Factor ANOVA (without Interaction)</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="analysis-of-variance-with-smart.html"><a href="analysis-of-variance-with-smart.html#model-coefficients"><i class="fa fa-check"></i><b>5.2.1</b> Model Coefficients</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="analysis-of-variance-with-smart.html"><a href="analysis-of-variance-with-smart.html#a-two-factor-anova-with-interaction"><i class="fa fa-check"></i><b>5.3</b> A Two-Factor ANOVA (with Interaction)</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="analysis-of-variance-with-smart.html"><a href="analysis-of-variance-with-smart.html#model-coefficients-1"><i class="fa fa-check"></i><b>5.3.1</b> Model Coefficients</a></li>
<li class="chapter" data-level="5.3.2" data-path="analysis-of-variance-with-smart.html"><a href="analysis-of-variance-with-smart.html#is-the-interaction-term-necessary"><i class="fa fa-check"></i><b>5.3.2</b> Is the interaction term necessary?</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="analysis-of-variance.html"><a href="analysis-of-variance.html"><i class="fa fa-check"></i><b>6</b> Analysis of Variance</a>
<ul>
<li class="chapter" data-level="6.1" data-path="analysis-of-variance.html"><a href="analysis-of-variance.html#the-bonding-data-a-designed-dental-experiment"><i class="fa fa-check"></i><b>6.1</b> The <code>bonding</code> data: A Designed Dental Experiment</a></li>
<li class="chapter" data-level="6.2" data-path="analysis-of-variance.html"><a href="analysis-of-variance.html#a-one-factor-analysis-of-variance-1"><i class="fa fa-check"></i><b>6.2</b> A One-Factor Analysis of Variance</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="analysis-of-variance.html"><a href="analysis-of-variance.html#look-at-the-data"><i class="fa fa-check"></i><b>6.2.1</b> Look at the Data!</a></li>
<li class="chapter" data-level="6.2.2" data-path="analysis-of-variance.html"><a href="analysis-of-variance.html#table-of-summary-statistics"><i class="fa fa-check"></i><b>6.2.2</b> Table of Summary Statistics</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="analysis-of-variance.html"><a href="analysis-of-variance.html#a-two-way-anova-looking-at-two-factors"><i class="fa fa-check"></i><b>6.3</b> A Two-Way ANOVA: Looking at Two Factors</a></li>
<li class="chapter" data-level="6.4" data-path="analysis-of-variance.html"><a href="analysis-of-variance.html#a-means-plot-with-standard-deviations-to-check-for-interaction"><i class="fa fa-check"></i><b>6.4</b> A Means Plot (with standard deviations) to check for interaction</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="analysis-of-variance.html"><a href="analysis-of-variance.html#summarizing-the-data-after-grouping-by-resin-and-light"><i class="fa fa-check"></i><b>6.4.1</b> Summarizing the data after grouping by <code>resin</code> and <code>light</code></a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="analysis-of-variance.html"><a href="analysis-of-variance.html#fitting-the-two-way-anova-model-with-interaction"><i class="fa fa-check"></i><b>6.5</b> Fitting the Two-Way ANOVA model with Interaction</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="analysis-of-variance.html"><a href="analysis-of-variance.html#the-anova-table-for-our-model"><i class="fa fa-check"></i><b>6.5.1</b> The ANOVA table for our model</a></li>
<li class="chapter" data-level="6.5.2" data-path="analysis-of-variance.html"><a href="analysis-of-variance.html#is-the-interaction-important"><i class="fa fa-check"></i><b>6.5.2</b> Is the interaction important?</a></li>
<li class="chapter" data-level="6.5.3" data-path="analysis-of-variance.html"><a href="analysis-of-variance.html#interpreting-the-interaction"><i class="fa fa-check"></i><b>6.5.3</b> Interpreting the Interaction</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="analysis-of-variance.html"><a href="analysis-of-variance.html#comparing-individual-combinations-of-resin-and-light"><i class="fa fa-check"></i><b>6.6</b> Comparing Individual Combinations of <code>resin</code> and <code>light</code></a></li>
<li class="chapter" data-level="6.7" data-path="analysis-of-variance.html"><a href="analysis-of-variance.html#the-bonding-model-without-interaction"><i class="fa fa-check"></i><b>6.7</b> The <code>bonding</code> model without Interaction</a></li>
<li class="chapter" data-level="6.8" data-path="analysis-of-variance.html"><a href="analysis-of-variance.html#cortisol-a-hypothetical-clinical-trial"><i class="fa fa-check"></i><b>6.8</b> <code>cortisol</code>: A Hypothetical Clinical Trial</a>
<ul>
<li class="chapter" data-level="6.8.1" data-path="analysis-of-variance.html"><a href="analysis-of-variance.html#codebook-and-raw-data-for-cortisol"><i class="fa fa-check"></i><b>6.8.1</b> Codebook and Raw Data for <code>cortisol</code></a></li>
</ul></li>
<li class="chapter" data-level="6.9" data-path="analysis-of-variance.html"><a href="analysis-of-variance.html#creating-a-factor-combining-sex-and-waist"><i class="fa fa-check"></i><b>6.9</b> Creating a factor combining sex and waist</a></li>
<li class="chapter" data-level="6.10" data-path="analysis-of-variance.html"><a href="analysis-of-variance.html#a-means-plot-for-the-cortisol-trial-with-standard-errors"><i class="fa fa-check"></i><b>6.10</b> A Means Plot for the <code>cortisol</code> trial (with standard errors)</a></li>
<li class="chapter" data-level="6.11" data-path="analysis-of-variance.html"><a href="analysis-of-variance.html#a-two-way-anova-model-for-cortisol-with-interaction"><i class="fa fa-check"></i><b>6.11</b> A Two-Way ANOVA model for <code>cortisol</code> with Interaction</a>
<ul>
<li class="chapter" data-level="6.11.1" data-path="analysis-of-variance.html"><a href="analysis-of-variance.html#notes-on-this-question"><i class="fa fa-check"></i><b>6.11.1</b> Notes on this Question</a></li>
</ul></li>
<li class="chapter" data-level="6.12" data-path="analysis-of-variance.html"><a href="analysis-of-variance.html#a-two-way-anova-model-for-cortisol-without-interaction"><i class="fa fa-check"></i><b>6.12</b> A Two-Way ANOVA model for <code>cortisol</code> without Interaction</a>
<ul>
<li class="chapter" data-level="6.12.1" data-path="analysis-of-variance.html"><a href="analysis-of-variance.html#the-graph"><i class="fa fa-check"></i><b>6.12.1</b> The Graph</a></li>
<li class="chapter" data-level="6.12.2" data-path="analysis-of-variance.html"><a href="analysis-of-variance.html#the-anova-model"><i class="fa fa-check"></i><b>6.12.2</b> The ANOVA Model</a></li>
<li class="chapter" data-level="6.12.3" data-path="analysis-of-variance.html"><a href="analysis-of-variance.html#the-regression-summary"><i class="fa fa-check"></i><b>6.12.3</b> The Regression Summary</a></li>
<li class="chapter" data-level="6.12.4" data-path="analysis-of-variance.html"><a href="analysis-of-variance.html#tukey-hsd-comparisons"><i class="fa fa-check"></i><b>6.12.4</b> Tukey HSD Comparisons</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="analysis-of-covariance.html"><a href="analysis-of-covariance.html"><i class="fa fa-check"></i><b>7</b> Analysis of Covariance</a>
<ul>
<li class="chapter" data-level="7.1" data-path="analysis-of-covariance.html"><a href="analysis-of-covariance.html#an-emphysema-study"><i class="fa fa-check"></i><b>7.1</b> An Emphysema Study</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="analysis-of-covariance.html"><a href="analysis-of-covariance.html#codebook"><i class="fa fa-check"></i><b>7.1.1</b> Codebook</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="analysis-of-covariance.html"><a href="analysis-of-covariance.html#does-sex-affect-the-mean-change-in-theophylline"><i class="fa fa-check"></i><b>7.2</b> Does <code>sex</code> affect the mean change in theophylline?</a></li>
<li class="chapter" data-level="7.3" data-path="analysis-of-covariance.html"><a href="analysis-of-covariance.html#is-there-an-association-between-age-and-sex-in-this-study"><i class="fa fa-check"></i><b>7.3</b> Is there an association between <code>age</code> and <code>sex</code> in this study?</a></li>
<li class="chapter" data-level="7.4" data-path="analysis-of-covariance.html"><a href="analysis-of-covariance.html#adding-a-quantitative-covariate-age-to-the-model"><i class="fa fa-check"></i><b>7.4</b> Adding a quantitative covariate, <code>age</code>, to the model</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="analysis-of-covariance.html"><a href="analysis-of-covariance.html#the-ancova-model"><i class="fa fa-check"></i><b>7.4.1</b> The ANCOVA model</a></li>
<li class="chapter" data-level="7.4.2" data-path="analysis-of-covariance.html"><a href="analysis-of-covariance.html#the-ancova-table"><i class="fa fa-check"></i><b>7.4.2</b> The ANCOVA Table</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="analysis-of-covariance.html"><a href="analysis-of-covariance.html#rerunning-the-ancova-model-after-simple-imputation"><i class="fa fa-check"></i><b>7.5</b> Rerunning the ANCOVA model after simple imputation</a></li>
<li class="chapter" data-level="7.6" data-path="analysis-of-covariance.html"><a href="analysis-of-covariance.html#looking-at-a-factor-covariate-interaction"><i class="fa fa-check"></i><b>7.6</b> Looking at a factor-covariate interaction</a></li>
<li class="chapter" data-level="7.7" data-path="analysis-of-covariance.html"><a href="analysis-of-covariance.html#centering-the-covariate-to-facilitate-ancova-interpretation"><i class="fa fa-check"></i><b>7.7</b> Centering the Covariate to Facilitate ANCOVA Interpretation</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="analysis-of-covariance-with-the-smart-data.html"><a href="analysis-of-covariance-with-the-smart-data.html"><i class="fa fa-check"></i><b>8</b> Analysis of Covariance with the SMART data</a>
<ul>
<li class="chapter" data-level="8.1" data-path="analysis-of-covariance-with-the-smart-data.html"><a href="analysis-of-covariance-with-the-smart-data.html#a-new-small-study-predicting-bmi"><i class="fa fa-check"></i><b>8.1</b> A New Small Study: Predicting BMI</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="analysis-of-covariance-with-the-smart-data.html"><a href="analysis-of-covariance-with-the-smart-data.html#does-smoke100-predict-bmi-well"><i class="fa fa-check"></i><b>8.1.1</b> Does <code>smoke100</code> predict <code>bmi</code> well?</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="analysis-of-covariance-with-the-smart-data.html"><a href="analysis-of-covariance-with-the-smart-data.html#c8_m1-a-simple-t-test-model"><i class="fa fa-check"></i><b>8.2</b> <code>c8_m1</code>: A simple t-test model</a></li>
<li class="chapter" data-level="8.3" data-path="analysis-of-covariance-with-the-smart-data.html"><a href="analysis-of-covariance-with-the-smart-data.html#c8_m2-adding-another-predictor-two-way-anova-without-interaction"><i class="fa fa-check"></i><b>8.3</b> <code>c8_m2</code>: Adding another predictor (two-way ANOVA without interaction)</a></li>
<li class="chapter" data-level="8.4" data-path="analysis-of-covariance-with-the-smart-data.html"><a href="analysis-of-covariance-with-the-smart-data.html#c8_m3-adding-the-interaction-term-two-way-anova-with-interaction"><i class="fa fa-check"></i><b>8.4</b> <code>c8_m3</code>: Adding the interaction term (Two-way ANOVA with interaction)</a></li>
<li class="chapter" data-level="8.5" data-path="analysis-of-covariance-with-the-smart-data.html"><a href="analysis-of-covariance-with-the-smart-data.html#c8_m4-using-female-and-physhealth-in-a-model-for-bmi"><i class="fa fa-check"></i><b>8.5</b> <code>c8_m4</code>: Using <code>female</code> and <code>physhealth</code> in a model for <code>bmi</code></a></li>
<li class="chapter" data-level="8.6" data-path="analysis-of-covariance-with-the-smart-data.html"><a href="analysis-of-covariance-with-the-smart-data.html#making-predictions-with-a-linear-regression-model"><i class="fa fa-check"></i><b>8.6</b> Making Predictions with a Linear Regression Model</a>
<ul>
<li class="chapter" data-level="8.6.1" data-path="analysis-of-covariance-with-the-smart-data.html"><a href="analysis-of-covariance-with-the-smart-data.html#fitting-an-individual-prediction-and-95-prediction-interval"><i class="fa fa-check"></i><b>8.6.1</b> Fitting an Individual Prediction and 95% Prediction Interval</a></li>
<li class="chapter" data-level="8.6.2" data-path="analysis-of-covariance-with-the-smart-data.html"><a href="analysis-of-covariance-with-the-smart-data.html#confidence-interval-for-an-average-prediction"><i class="fa fa-check"></i><b>8.6.2</b> Confidence Interval for an Average Prediction</a></li>
<li class="chapter" data-level="8.6.3" data-path="analysis-of-covariance-with-the-smart-data.html"><a href="analysis-of-covariance-with-the-smart-data.html#fitting-multiple-individual-predictions-to-new-data"><i class="fa fa-check"></i><b>8.6.3</b> Fitting Multiple Individual Predictions to New Data</a></li>
</ul></li>
<li class="chapter" data-level="8.7" data-path="analysis-of-covariance-with-the-smart-data.html"><a href="analysis-of-covariance-with-the-smart-data.html#centering-the-model"><i class="fa fa-check"></i><b>8.7</b> Centering the model</a>
<ul>
<li class="chapter" data-level="8.7.1" data-path="analysis-of-covariance-with-the-smart-data.html"><a href="analysis-of-covariance-with-the-smart-data.html#plot-of-model-4-on-centered-physhealth-c8_m4_c"><i class="fa fa-check"></i><b>8.7.1</b> Plot of Model 4 on Centered <code>physhealth</code>: <code>c8_m4_c</code></a></li>
</ul></li>
<li class="chapter" data-level="8.8" data-path="analysis-of-covariance-with-the-smart-data.html"><a href="analysis-of-covariance-with-the-smart-data.html#rescaling-an-input-by-subtracting-the-mean-and-dividing-by-2-standard-deviations"><i class="fa fa-check"></i><b>8.8</b> Rescaling an input by subtracting the mean and dividing by 2 standard deviations</a>
<ul>
<li class="chapter" data-level="8.8.1" data-path="analysis-of-covariance-with-the-smart-data.html"><a href="analysis-of-covariance-with-the-smart-data.html#refitting-model-c8_m4-to-the-rescaled-data"><i class="fa fa-check"></i><b>8.8.1</b> Refitting model <code>c8_m4</code> to the rescaled data</a></li>
<li class="chapter" data-level="8.8.2" data-path="analysis-of-covariance-with-the-smart-data.html"><a href="analysis-of-covariance-with-the-smart-data.html#interpreting-the-model-on-rescaled-data"><i class="fa fa-check"></i><b>8.8.2</b> Interpreting the model on rescaled data</a></li>
<li class="chapter" data-level="8.8.3" data-path="analysis-of-covariance-with-the-smart-data.html"><a href="analysis-of-covariance-with-the-smart-data.html#plot-of-model-on-rescaled-data"><i class="fa fa-check"></i><b>8.8.3</b> Plot of model on rescaled data</a></li>
</ul></li>
<li class="chapter" data-level="8.9" data-path="analysis-of-covariance-with-the-smart-data.html"><a href="analysis-of-covariance-with-the-smart-data.html#c8_m5-what-if-we-add-more-variables"><i class="fa fa-check"></i><b>8.9</b> <code>c8_m5</code>: What if we add more variables?</a></li>
<li class="chapter" data-level="8.10" data-path="analysis-of-covariance-with-the-smart-data.html"><a href="analysis-of-covariance-with-the-smart-data.html#c8_m6-would-adding-self-reported-health-help"><i class="fa fa-check"></i><b>8.10</b> <code>c8_m6</code>: Would adding self-reported health help?</a></li>
<li class="chapter" data-level="8.11" data-path="analysis-of-covariance-with-the-smart-data.html"><a href="analysis-of-covariance-with-the-smart-data.html#key-regression-assumptions-for-building-effective-prediction-models"><i class="fa fa-check"></i><b>8.11</b> Key Regression Assumptions for Building Effective Prediction Models</a>
<ul>
<li class="chapter" data-level="8.11.1" data-path="analysis-of-covariance-with-the-smart-data.html"><a href="analysis-of-covariance-with-the-smart-data.html#checking-assumptions-in-model-c8_m6"><i class="fa fa-check"></i><b>8.11.1</b> Checking Assumptions in model <code>c8_m6</code></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="adding-non-linear-terms-to-a-linear-regression-model.html"><a href="adding-non-linear-terms-to-a-linear-regression-model.html"><i class="fa fa-check"></i><b>9</b> Adding Non-linear Terms to a Linear Regression Model</a>
<ul>
<li class="chapter" data-level="9.1" data-path="adding-non-linear-terms-to-a-linear-regression-model.html"><a href="adding-non-linear-terms-to-a-linear-regression-model.html#the-pollution-data"><i class="fa fa-check"></i><b>9.1</b> The <code>pollution</code> data</a></li>
<li class="chapter" data-level="9.2" data-path="adding-non-linear-terms-to-a-linear-regression-model.html"><a href="adding-non-linear-terms-to-a-linear-regression-model.html#fitting-a-straight-line-model-to-predict-y-from-x2"><i class="fa fa-check"></i><b>9.2</b> Fitting a straight line model to predict <code>y</code> from <code>x2</code></a></li>
<li class="chapter" data-level="9.3" data-path="adding-non-linear-terms-to-a-linear-regression-model.html"><a href="adding-non-linear-terms-to-a-linear-regression-model.html#quadratic-polynomial-model-to-predict-y-using-x2"><i class="fa fa-check"></i><b>9.3</b> Quadratic polynomial model to predict <code>y</code> using <code>x2</code></a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="adding-non-linear-terms-to-a-linear-regression-model.html"><a href="adding-non-linear-terms-to-a-linear-regression-model.html#the-raw-quadratic-model"><i class="fa fa-check"></i><b>9.3.1</b> The raw quadratic model</a></li>
<li class="chapter" data-level="9.3.2" data-path="adding-non-linear-terms-to-a-linear-regression-model.html"><a href="adding-non-linear-terms-to-a-linear-regression-model.html#raw-quadratic-fit-after-centering-x2"><i class="fa fa-check"></i><b>9.3.2</b> Raw quadratic fit after centering <code>x2</code></a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="adding-non-linear-terms-to-a-linear-regression-model.html"><a href="adding-non-linear-terms-to-a-linear-regression-model.html#orthogonal-polynomials"><i class="fa fa-check"></i><b>9.4</b> Orthogonal Polynomials</a></li>
<li class="chapter" data-level="9.5" data-path="adding-non-linear-terms-to-a-linear-regression-model.html"><a href="adding-non-linear-terms-to-a-linear-regression-model.html#fit-a-cubic-polynomial-to-predict-y-from-x3"><i class="fa fa-check"></i><b>9.5</b> Fit a cubic polynomial to predict <code>y</code> from <code>x3</code></a></li>
<li class="chapter" data-level="9.6" data-path="adding-non-linear-terms-to-a-linear-regression-model.html"><a href="adding-non-linear-terms-to-a-linear-regression-model.html#fitting-a-restricted-cubic-spline-in-a-linear-regression"><i class="fa fa-check"></i><b>9.6</b> Fitting a restricted cubic spline in a linear regression</a></li>
<li class="chapter" data-level="9.7" data-path="adding-non-linear-terms-to-a-linear-regression-model.html"><a href="adding-non-linear-terms-to-a-linear-regression-model.html#spending-degrees-of-freedom"><i class="fa fa-check"></i><b>9.7</b> “Spending” Degrees of Freedom</a>
<ul>
<li class="chapter" data-level="9.7.1" data-path="adding-non-linear-terms-to-a-linear-regression-model.html"><a href="adding-non-linear-terms-to-a-linear-regression-model.html#overfitting-and-limits-on-the-of-predictors"><i class="fa fa-check"></i><b>9.7.1</b> Overfitting and Limits on the # of Predictors</a></li>
<li class="chapter" data-level="9.7.2" data-path="adding-non-linear-terms-to-a-linear-regression-model.html"><a href="adding-non-linear-terms-to-a-linear-regression-model.html#the-importance-of-collinearity"><i class="fa fa-check"></i><b>9.7.2</b> The Importance of Collinearity</a></li>
<li class="chapter" data-level="9.7.3" data-path="adding-non-linear-terms-to-a-linear-regression-model.html"><a href="adding-non-linear-terms-to-a-linear-regression-model.html#collinearity-in-an-explanatory-model"><i class="fa fa-check"></i><b>9.7.3</b> Collinearity in an Explanatory Model</a></li>
<li class="chapter" data-level="9.7.4" data-path="adding-non-linear-terms-to-a-linear-regression-model.html"><a href="adding-non-linear-terms-to-a-linear-regression-model.html#collinearity-in-a-prediction-model"><i class="fa fa-check"></i><b>9.7.4</b> Collinearity in a Prediction Model</a></li>
</ul></li>
<li class="chapter" data-level="9.8" data-path="adding-non-linear-terms-to-a-linear-regression-model.html"><a href="adding-non-linear-terms-to-a-linear-regression-model.html#spending-df-on-non-linearity-the-spearman-plot"><i class="fa fa-check"></i><b>9.8</b> Spending DF on Non-Linearity: The Spearman Plot</a>
<ul>
<li class="chapter" data-level="9.8.1" data-path="adding-non-linear-terms-to-a-linear-regression-model.html"><a href="adding-non-linear-terms-to-a-linear-regression-model.html#fitting-a-big-model-to-the-pollution-data"><i class="fa fa-check"></i><b>9.8.1</b> Fitting a Big Model to the <code>pollution</code> data</a></li>
<li class="chapter" data-level="9.8.2" data-path="adding-non-linear-terms-to-a-linear-regression-model.html"><a href="adding-non-linear-terms-to-a-linear-regression-model.html#limitations-of-lm-for-fitting-complex-linear-regression-models"><i class="fa fa-check"></i><b>9.8.2</b> Limitations of <code>lm</code> for fitting complex linear regression models</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="using-ols-from-the-rms-package-to-fit-linear-models.html"><a href="using-ols-from-the-rms-package-to-fit-linear-models.html"><i class="fa fa-check"></i><b>10</b> Using <code>ols</code> from the <code>rms</code> package to fit linear models</a>
<ul>
<li class="chapter" data-level="10.1" data-path="using-ols-from-the-rms-package-to-fit-linear-models.html"><a href="using-ols-from-the-rms-package-to-fit-linear-models.html#fitting-a-model-with-ols"><i class="fa fa-check"></i><b>10.1</b> Fitting a model with <code>ols</code></a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="using-ols-from-the-rms-package-to-fit-linear-models.html"><a href="using-ols-from-the-rms-package-to-fit-linear-models.html#the-model-likelihood-ratio-test"><i class="fa fa-check"></i><b>10.1.1</b> The Model Likelihood Ratio Test</a></li>
<li class="chapter" data-level="10.1.2" data-path="using-ols-from-the-rms-package-to-fit-linear-models.html"><a href="using-ols-from-the-rms-package-to-fit-linear-models.html#the-g-statistic"><i class="fa fa-check"></i><b>10.1.2</b> The g statistic</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="using-ols-from-the-rms-package-to-fit-linear-models.html"><a href="using-ols-from-the-rms-package-to-fit-linear-models.html#anova-for-an-ols-model"><i class="fa fa-check"></i><b>10.2</b> ANOVA for an <code>ols</code> model</a></li>
<li class="chapter" data-level="10.3" data-path="using-ols-from-the-rms-package-to-fit-linear-models.html"><a href="using-ols-from-the-rms-package-to-fit-linear-models.html#effect-estimates"><i class="fa fa-check"></i><b>10.3</b> Effect Estimates</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="using-ols-from-the-rms-package-to-fit-linear-models.html"><a href="using-ols-from-the-rms-package-to-fit-linear-models.html#simultaneous-confidence-intervals"><i class="fa fa-check"></i><b>10.3.1</b> Simultaneous Confidence Intervals</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="using-ols-from-the-rms-package-to-fit-linear-models.html"><a href="using-ols-from-the-rms-package-to-fit-linear-models.html#the-predict-function-for-an-ols-model"><i class="fa fa-check"></i><b>10.4</b> The <code>Predict</code> function for an <code>ols</code> model</a></li>
<li class="chapter" data-level="10.5" data-path="using-ols-from-the-rms-package-to-fit-linear-models.html"><a href="using-ols-from-the-rms-package-to-fit-linear-models.html#checking-influence-via-dfbeta"><i class="fa fa-check"></i><b>10.5</b> Checking Influence via <code>dfbeta</code></a>
<ul>
<li class="chapter" data-level="10.5.1" data-path="using-ols-from-the-rms-package-to-fit-linear-models.html"><a href="using-ols-from-the-rms-package-to-fit-linear-models.html#using-the-residuals-command-for-dfbetas"><i class="fa fa-check"></i><b>10.5.1</b> Using the <code>residuals</code> command for <code>dfbetas</code></a></li>
<li class="chapter" data-level="10.5.2" data-path="using-ols-from-the-rms-package-to-fit-linear-models.html"><a href="using-ols-from-the-rms-package-to-fit-linear-models.html#using-the-residuals-command-for-other-summaries"><i class="fa fa-check"></i><b>10.5.2</b> Using the <code>residuals</code> command for other summaries</a></li>
</ul></li>
<li class="chapter" data-level="10.6" data-path="using-ols-from-the-rms-package-to-fit-linear-models.html"><a href="using-ols-from-the-rms-package-to-fit-linear-models.html#model-validation-and-correcting-for-optimism"><i class="fa fa-check"></i><b>10.6</b> Model Validation and Correcting for Optimism</a></li>
<li class="chapter" data-level="10.7" data-path="using-ols-from-the-rms-package-to-fit-linear-models.html"><a href="using-ols-from-the-rms-package-to-fit-linear-models.html#building-a-nomogram-for-our-model"><i class="fa fa-check"></i><b>10.7</b> Building a Nomogram for Our Model</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="logistic-regression-the-foundations.html"><a href="logistic-regression-the-foundations.html"><i class="fa fa-check"></i><b>11</b> Logistic Regression: The Foundations</a>
<ul>
<li class="chapter" data-level="11.1" data-path="logistic-regression-the-foundations.html"><a href="logistic-regression-the-foundations.html#a-first-attempt-a-linear-probability-model"><i class="fa fa-check"></i><b>11.1</b> A First Attempt: A Linear Probability Model</a></li>
<li class="chapter" data-level="11.2" data-path="logistic-regression-the-foundations.html"><a href="logistic-regression-the-foundations.html#logistic-regression"><i class="fa fa-check"></i><b>11.2</b> Logistic Regression</a></li>
<li class="chapter" data-level="11.3" data-path="logistic-regression-the-foundations.html"><a href="logistic-regression-the-foundations.html#the-logistic-regression-model"><i class="fa fa-check"></i><b>11.3</b> The Logistic Regression Model</a></li>
<li class="chapter" data-level="11.4" data-path="logistic-regression-the-foundations.html"><a href="logistic-regression-the-foundations.html#the-link-function"><i class="fa fa-check"></i><b>11.4</b> The Link Function</a></li>
<li class="chapter" data-level="11.5" data-path="logistic-regression-the-foundations.html"><a href="logistic-regression-the-foundations.html#the-logit-or-log-odds"><i class="fa fa-check"></i><b>11.5</b> The logit or log odds</a></li>
<li class="chapter" data-level="11.6" data-path="logistic-regression-the-foundations.html"><a href="logistic-regression-the-foundations.html#interpreting-the-coefficients-of-a-logistic-regression-model"><i class="fa fa-check"></i><b>11.6</b> Interpreting the Coefficients of a Logistic Regression Model</a></li>
<li class="chapter" data-level="11.7" data-path="logistic-regression-the-foundations.html"><a href="logistic-regression-the-foundations.html#the-logistic-regression-has-non-constant-variance"><i class="fa fa-check"></i><b>11.7</b> The Logistic Regression has non-constant variance</a></li>
<li class="chapter" data-level="11.8" data-path="logistic-regression-the-foundations.html"><a href="logistic-regression-the-foundations.html#fitting-a-logistic-regression-model-to-our-simulated-data"><i class="fa fa-check"></i><b>11.8</b> Fitting a Logistic Regression Model to our Simulated Data</a></li>
<li class="chapter" data-level="11.9" data-path="logistic-regression-the-foundations.html"><a href="logistic-regression-the-foundations.html#plotting-the-logistic-regression-model"><i class="fa fa-check"></i><b>11.9</b> Plotting the Logistic Regression Model</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html"><i class="fa fa-check"></i><b>12</b> Logistic Regression and the <code>resect</code> data</a>
<ul>
<li class="chapter" data-level="12.1" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#the-resect-data"><i class="fa fa-check"></i><b>12.1</b> The <code>resect</code> data</a></li>
<li class="chapter" data-level="12.2" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#running-a-simple-logistic-regression-model"><i class="fa fa-check"></i><b>12.2</b> Running A Simple Logistic Regression Model</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#logistic-regression-can-be-harder-than-linear-regression"><i class="fa fa-check"></i><b>12.2.1</b> Logistic Regression Can Be Harder than Linear Regression</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#logistic-regression-using-glm"><i class="fa fa-check"></i><b>12.3</b> Logistic Regression using <code>glm</code></a>
<ul>
<li class="chapter" data-level="12.3.1" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#interpreting-the-coefficients-of-a-logistic-regression-model-1"><i class="fa fa-check"></i><b>12.3.1</b> Interpreting the Coefficients of a Logistic Regression Model</a></li>
<li class="chapter" data-level="12.3.2" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#using-predict-to-describe-the-models-fits"><i class="fa fa-check"></i><b>12.3.2</b> Using <code>predict</code> to describe the model’s fits</a></li>
<li class="chapter" data-level="12.3.3" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#odds-ratio-interpretation-of-coefficients"><i class="fa fa-check"></i><b>12.3.3</b> Odds Ratio interpretation of Coefficients</a></li>
<li class="chapter" data-level="12.3.4" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#interpreting-the-rest-of-the-model-output-from-glm"><i class="fa fa-check"></i><b>12.3.4</b> Interpreting the rest of the model output from <code>glm</code></a></li>
<li class="chapter" data-level="12.3.5" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#deviance-and-comparing-our-model-to-the-null-model"><i class="fa fa-check"></i><b>12.3.5</b> Deviance and Comparing Our Model to the Null Model</a></li>
<li class="chapter" data-level="12.3.6" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#using-glance-with-a-logistic-regression-model"><i class="fa fa-check"></i><b>12.3.6</b> Using <code>glance</code> with a logistic regression model</a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#interpreting-the-model-summary"><i class="fa fa-check"></i><b>12.4</b> Interpreting the Model Summary</a>
<ul>
<li class="chapter" data-level="12.4.1" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#wald-z-tests-for-coefficients-in-a-logistic-regression"><i class="fa fa-check"></i><b>12.4.1</b> Wald Z tests for Coefficients in a Logistic Regression</a></li>
<li class="chapter" data-level="12.4.2" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#confidence-intervals-for-the-coefficients"><i class="fa fa-check"></i><b>12.4.2</b> Confidence Intervals for the Coefficients</a></li>
<li class="chapter" data-level="12.4.3" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#deviance-residuals"><i class="fa fa-check"></i><b>12.4.3</b> Deviance Residuals</a></li>
<li class="chapter" data-level="12.4.4" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#dispersion-parameter"><i class="fa fa-check"></i><b>12.4.4</b> Dispersion Parameter</a></li>
<li class="chapter" data-level="12.4.5" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#fisher-scoring-iterations"><i class="fa fa-check"></i><b>12.4.5</b> Fisher Scoring iterations</a></li>
</ul></li>
<li class="chapter" data-level="12.5" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#plotting-a-simple-logistic-regression-model"><i class="fa fa-check"></i><b>12.5</b> Plotting a Simple Logistic Regression Model</a>
<ul>
<li class="chapter" data-level="12.5.1" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#using-augment-to-capture-the-fitted-probabilities"><i class="fa fa-check"></i><b>12.5.1</b> Using <code>augment</code> to capture the fitted probabilities</a></li>
<li class="chapter" data-level="12.5.2" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#plotting-a-logistic-regression-models-fitted-values"><i class="fa fa-check"></i><b>12.5.2</b> Plotting a Logistic Regression Model’s Fitted Values</a></li>
<li class="chapter" data-level="12.5.3" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#plotting-a-simple-logistic-model-using-binomial_smooth"><i class="fa fa-check"></i><b>12.5.3</b> Plotting a Simple Logistic Model using <code>binomial_smooth</code></a></li>
</ul></li>
<li class="chapter" data-level="12.6" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#how-well-does-model-a-classify-subjects"><i class="fa fa-check"></i><b>12.6</b> How well does Model A classify subjects?</a></li>
<li class="chapter" data-level="12.7" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#the-confusion-matrix"><i class="fa fa-check"></i><b>12.7</b> The Confusion Matrix</a></li>
<li class="chapter" data-level="12.8" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#using-the-confusionmatrix-tool-from-the-caret-package"><i class="fa fa-check"></i><b>12.8</b> Using the <code>confusionMatrix</code> tool from the <code>caret</code> package</a></li>
<li class="chapter" data-level="12.9" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#receiver-operating-characteristic-curve-analysis"><i class="fa fa-check"></i><b>12.9</b> Receiver Operating Characteristic Curve Analysis</a>
<ul>
<li class="chapter" data-level="12.9.1" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#interpreting-the-area-under-the-roc-curve"><i class="fa fa-check"></i><b>12.9.1</b> Interpreting the Area under the ROC curve</a></li>
</ul></li>
<li class="chapter" data-level="12.10" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#the-roc-plot-for-res_moda"><i class="fa fa-check"></i><b>12.10</b> The ROC Plot for <code>res_modA</code></a>
<ul>
<li class="chapter" data-level="12.10.1" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#another-way-to-plot-the-roc-curve"><i class="fa fa-check"></i><b>12.10.1</b> Another way to plot the ROC Curve</a></li>
</ul></li>
<li class="chapter" data-level="12.11" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#assessing-residual-plots-from-model-a"><i class="fa fa-check"></i><b>12.11</b> Assessing Residual Plots from Model A</a></li>
<li class="chapter" data-level="12.12" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#model-b-a-kitchen-sink-logistic-regression-model"><i class="fa fa-check"></i><b>12.12</b> Model B: A “Kitchen Sink” Logistic Regression Model</a>
<ul>
<li class="chapter" data-level="12.12.1" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#comparing-model-a-to-model-b"><i class="fa fa-check"></i><b>12.12.1</b> Comparing Model A to Model B</a></li>
<li class="chapter" data-level="12.12.2" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#interpreting-model-b"><i class="fa fa-check"></i><b>12.12.2</b> Interpreting Model B</a></li>
</ul></li>
<li class="chapter" data-level="12.13" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#plotting-model-b"><i class="fa fa-check"></i><b>12.13</b> Plotting Model B</a>
<ul>
<li class="chapter" data-level="12.13.1" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#using-augment-to-capture-the-fitted-probabilities-1"><i class="fa fa-check"></i><b>12.13.1</b> Using <code>augment</code> to capture the fitted probabilities</a></li>
<li class="chapter" data-level="12.13.2" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#plotting-model-b-fits-by-observed-mortality"><i class="fa fa-check"></i><b>12.13.2</b> Plotting Model B Fits by Observed Mortality</a></li>
<li class="chapter" data-level="12.13.3" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#confusion-matrix-for-model-b"><i class="fa fa-check"></i><b>12.13.3</b> Confusion Matrix for Model B</a></li>
<li class="chapter" data-level="12.13.4" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#the-roc-curve-for-model-b"><i class="fa fa-check"></i><b>12.13.4</b> The ROC curve for Model B</a></li>
<li class="chapter" data-level="12.13.5" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#residuals-leverage-and-influence"><i class="fa fa-check"></i><b>12.13.5</b> Residuals, Leverage and Influence</a></li>
</ul></li>
<li class="chapter" data-level="12.14" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#logistic-regression-using-lrm"><i class="fa fa-check"></i><b>12.14</b> Logistic Regression using <code>lrm</code></a>
<ul>
<li class="chapter" data-level="12.14.1" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#interpreting-nagelkerke-r2"><i class="fa fa-check"></i><b>12.14.1</b> Interpreting Nagelkerke <span class="math inline">\(R^2\)</span></a></li>
<li class="chapter" data-level="12.14.2" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#interpreting-the-c-statistic-and-plotting-the-roc-curve"><i class="fa fa-check"></i><b>12.14.2</b> Interpreting the C statistic and Plotting the ROC Curve</a></li>
<li class="chapter" data-level="12.14.3" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#the-c-statistic-and-somers-d"><i class="fa fa-check"></i><b>12.14.3</b> The C statistic and Somers’ D</a></li>
<li class="chapter" data-level="12.14.4" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#validating-the-logistic-regression-model-summary-statistics"><i class="fa fa-check"></i><b>12.14.4</b> Validating the Logistic Regression Model Summary Statistics</a></li>
<li class="chapter" data-level="12.14.5" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#plotting-the-summary-of-the-lrm-approach"><i class="fa fa-check"></i><b>12.14.5</b> Plotting the Summary of the <code>lrm</code> approach</a></li>
<li class="chapter" data-level="12.14.6" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#plot-in-sample-predictions-for-model-c"><i class="fa fa-check"></i><b>12.14.6</b> Plot In-Sample Predictions for Model C</a></li>
<li class="chapter" data-level="12.14.7" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#anova-from-the-lrm-approach"><i class="fa fa-check"></i><b>12.14.7</b> ANOVA from the <code>lrm</code> approach</a></li>
<li class="chapter" data-level="12.14.8" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#are-any-points-particularly-influential"><i class="fa fa-check"></i><b>12.14.8</b> Are any points particularly influential?</a></li>
<li class="chapter" data-level="12.14.9" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#a-nomogram-for-model-c"><i class="fa fa-check"></i><b>12.14.9</b> A Nomogram for Model C</a></li>
</ul></li>
<li class="chapter" data-level="12.15" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#model-d-an-augmented-kitchen-sink-model"><i class="fa fa-check"></i><b>12.15</b> Model D: An Augmented Kitchen Sink Model</a>
<ul>
<li class="chapter" data-level="12.15.1" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#spearman-rho2-plot"><i class="fa fa-check"></i><b>12.15.1</b> Spearman <span class="math inline">\(\rho^2\)</span> Plot</a></li>
<li class="chapter" data-level="12.15.2" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#fitting-model-d-using-lrm"><i class="fa fa-check"></i><b>12.15.2</b> Fitting Model D using <code>lrm</code></a></li>
<li class="chapter" data-level="12.15.3" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#assessing-model-d-using-lrms-tools"><i class="fa fa-check"></i><b>12.15.3</b> Assessing Model D using <code>lrm</code>’s tools</a></li>
<li class="chapter" data-level="12.15.4" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#anova-and-wald-tests-for-model-d"><i class="fa fa-check"></i><b>12.15.4</b> ANOVA and Wald Tests for Model D</a></li>
<li class="chapter" data-level="12.15.5" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#effect-sizes-in-model-d"><i class="fa fa-check"></i><b>12.15.5</b> Effect Sizes in Model D</a></li>
<li class="chapter" data-level="12.15.6" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#plot-in-sample-predictions-for-model-d"><i class="fa fa-check"></i><b>12.15.6</b> Plot In-Sample Predictions for Model D</a></li>
<li class="chapter" data-level="12.15.7" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#plotting-the-roc-curve-for-model-d"><i class="fa fa-check"></i><b>12.15.7</b> Plotting the ROC curve for Model D</a></li>
<li class="chapter" data-level="12.15.8" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#validation-of-model-d-summaries"><i class="fa fa-check"></i><b>12.15.8</b> Validation of Model D summaries</a></li>
</ul></li>
<li class="chapter" data-level="12.16" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#model-e-fitting-a-reduced-model-in-light-of-model-d"><i class="fa fa-check"></i><b>12.16</b> Model E: Fitting a Reduced Model in light of Model D</a>
<ul>
<li class="chapter" data-level="12.16.1" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#a-plot-comparing-the-two-intubation-groups"><i class="fa fa-check"></i><b>12.16.1</b> A Plot comparing the two intubation groups</a></li>
<li class="chapter" data-level="12.16.2" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#nomogram-for-model-e"><i class="fa fa-check"></i><b>12.16.2</b> Nomogram for Model E</a></li>
<li class="chapter" data-level="12.16.3" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#effect-sizes-from-model-e"><i class="fa fa-check"></i><b>12.16.3</b> Effect Sizes from Model E</a></li>
<li class="chapter" data-level="12.16.4" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#plot-in-sample-predictions-for-model-e"><i class="fa fa-check"></i><b>12.16.4</b> Plot In-Sample Predictions for Model E</a></li>
<li class="chapter" data-level="12.16.5" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#anova-for-model-e"><i class="fa fa-check"></i><b>12.16.5</b> ANOVA for Model E</a></li>
<li class="chapter" data-level="12.16.6" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#validation-of-model-e"><i class="fa fa-check"></i><b>12.16.6</b> Validation of Model E</a></li>
<li class="chapter" data-level="12.16.7" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#do-any-points-seem-particularly-influential"><i class="fa fa-check"></i><b>12.16.7</b> Do any points seem particularly influential?</a></li>
<li class="chapter" data-level="12.16.8" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#fitting-model-e-using-glm-to-get-plots-about-influence"><i class="fa fa-check"></i><b>12.16.8</b> Fitting Model E using <code>glm</code> to get plots about influence</a></li>
</ul></li>
<li class="chapter" data-level="12.17" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#concordance-comparing-model-c-d-and-es-predictions"><i class="fa fa-check"></i><b>12.17</b> Concordance: Comparing Model C, D and E’s predictions</a></li>
<li class="chapter" data-level="12.18" data-path="logistic-regression-and-the-resect-data.html"><a href="logistic-regression-and-the-resect-data.html#conclusions"><i class="fa fa-check"></i><b>12.18</b> Conclusions</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="a-study-of-prostate-cancer.html"><a href="a-study-of-prostate-cancer.html"><i class="fa fa-check"></i><b>13</b> A Study of Prostate Cancer</a>
<ul>
<li class="chapter" data-level="13.1" data-path="a-study-of-prostate-cancer.html"><a href="a-study-of-prostate-cancer.html#data-load-and-background"><i class="fa fa-check"></i><b>13.1</b> Data Load and Background</a></li>
<li class="chapter" data-level="13.2" data-path="a-study-of-prostate-cancer.html"><a href="a-study-of-prostate-cancer.html#code-book"><i class="fa fa-check"></i><b>13.2</b> Code Book</a></li>
<li class="chapter" data-level="13.3" data-path="a-study-of-prostate-cancer.html"><a href="a-study-of-prostate-cancer.html#additions-for-later-use"><i class="fa fa-check"></i><b>13.3</b> Additions for Later Use</a></li>
<li class="chapter" data-level="13.4" data-path="a-study-of-prostate-cancer.html"><a href="a-study-of-prostate-cancer.html#fitting-and-evaluating-a-two-predictor-model"><i class="fa fa-check"></i><b>13.4</b> Fitting and Evaluating a Two-Predictor Model</a>
<ul>
<li class="chapter" data-level="13.4.1" data-path="a-study-of-prostate-cancer.html"><a href="a-study-of-prostate-cancer.html#using-tidy"><i class="fa fa-check"></i><b>13.4.1</b> Using <code>tidy</code></a></li>
<li class="chapter" data-level="13.4.2" data-path="a-study-of-prostate-cancer.html"><a href="a-study-of-prostate-cancer.html#interpretation"><i class="fa fa-check"></i><b>13.4.2</b> Interpretation</a></li>
</ul></li>
<li class="chapter" data-level="13.5" data-path="a-study-of-prostate-cancer.html"><a href="a-study-of-prostate-cancer.html#exploring-model-c11_prost_a"><i class="fa fa-check"></i><b>13.5</b> Exploring Model <code>c11_prost_A</code></a>
<ul>
<li class="chapter" data-level="13.5.1" data-path="a-study-of-prostate-cancer.html"><a href="a-study-of-prostate-cancer.html#summary-for-model-c11_prost_a"><i class="fa fa-check"></i><b>13.5.1</b> <code>summary</code> for Model <code>c11_prost_A</code></a></li>
<li class="chapter" data-level="13.5.2" data-path="a-study-of-prostate-cancer.html"><a href="a-study-of-prostate-cancer.html#adjusted-r2"><i class="fa fa-check"></i><b>13.5.2</b> Adjusted <span class="math inline">\(R^2\)</span></a></li>
<li class="chapter" data-level="13.5.3" data-path="a-study-of-prostate-cancer.html"><a href="a-study-of-prostate-cancer.html#coefficient-confidence-intervals"><i class="fa fa-check"></i><b>13.5.3</b> Coefficient Confidence Intervals</a></li>
<li class="chapter" data-level="13.5.4" data-path="a-study-of-prostate-cancer.html"><a href="a-study-of-prostate-cancer.html#anova-for-model-c11_prost_a"><i class="fa fa-check"></i><b>13.5.4</b> ANOVA for Model <code>c11_prost_A</code></a></li>
<li class="chapter" data-level="13.5.5" data-path="a-study-of-prostate-cancer.html"><a href="a-study-of-prostate-cancer.html#residuals-fitted-values-and-standard-errors-with-augment"><i class="fa fa-check"></i><b>13.5.5</b> Residuals, Fitted Values and Standard Errors with <code>augment</code></a></li>
<li class="chapter" data-level="13.5.6" data-path="a-study-of-prostate-cancer.html"><a href="a-study-of-prostate-cancer.html#making-predictions-with-c11_prost_a"><i class="fa fa-check"></i><b>13.5.6</b> Making Predictions with <code>c11_prost_A</code></a></li>
</ul></li>
<li class="chapter" data-level="13.6" data-path="a-study-of-prostate-cancer.html"><a href="a-study-of-prostate-cancer.html#plotting-model-c11_prost_a"><i class="fa fa-check"></i><b>13.6</b> Plotting Model <code>c11_prost_A</code></a>
<ul>
<li class="chapter" data-level="13.6.1" data-path="a-study-of-prostate-cancer.html"><a href="a-study-of-prostate-cancer.html#residual-plots-of-c11_prost_a"><i class="fa fa-check"></i><b>13.6.1</b> Residual Plots of <code>c11_prost_A</code></a></li>
</ul></li>
<li class="chapter" data-level="13.7" data-path="a-study-of-prostate-cancer.html"><a href="a-study-of-prostate-cancer.html#cross-validation-of-model-c11_prost_a"><i class="fa fa-check"></i><b>13.7</b> Cross-Validation of Model <code>c11_prost_A</code></a>
<ul>
<li class="chapter" data-level="13.7.1" data-path="a-study-of-prostate-cancer.html"><a href="a-study-of-prostate-cancer.html#a-validation-split-approach"><i class="fa fa-check"></i><b>13.7.1</b> A Validation Split Approach</a></li>
<li class="chapter" data-level="13.7.2" data-path="a-study-of-prostate-cancer.html"><a href="a-study-of-prostate-cancer.html#k-fold-cross-validation"><i class="fa fa-check"></i><b>13.7.2</b> K-Fold Cross-Validation</a></li>
<li class="chapter" data-level="13.7.3" data-path="a-study-of-prostate-cancer.html"><a href="a-study-of-prostate-cancer.html#comparing-models-with-5-fold-cross-validation"><i class="fa fa-check"></i><b>13.7.3</b> Comparing Models with 5-fold Cross-Validation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="14" data-path="multiple-imputation-and-linear-regression.html"><a href="multiple-imputation-and-linear-regression.html"><i class="fa fa-check"></i><b>14</b> Multiple Imputation and Linear Regression</a>
<ul>
<li class="chapter" data-level="14.1" data-path="multiple-imputation-and-linear-regression.html"><a href="multiple-imputation-and-linear-regression.html#developing-a-smart_16-data-set"><i class="fa fa-check"></i><b>14.1</b> Developing a <code>smart_16</code> data set</a>
<ul>
<li class="chapter" data-level="14.1.1" data-path="multiple-imputation-and-linear-regression.html"><a href="multiple-imputation-and-linear-regression.html#any-missing-values"><i class="fa fa-check"></i><b>14.1.1</b> Any missing values?</a></li>
</ul></li>
<li class="chapter" data-level="14.2" data-path="multiple-imputation-and-linear-regression.html"><a href="multiple-imputation-and-linear-regression.html#obtaining-a-simple-imputation-with-mice"><i class="fa fa-check"></i><b>14.2</b> Obtaining a Simple Imputation with <code>mice</code></a></li>
<li class="chapter" data-level="14.3" data-path="multiple-imputation-and-linear-regression.html"><a href="multiple-imputation-and-linear-regression.html#linear-regression-considering-a-transformation-of-the-outcome"><i class="fa fa-check"></i><b>14.3</b> Linear Regression: Considering a Transformation of the Outcome</a></li>
<li class="chapter" data-level="14.4" data-path="multiple-imputation-and-linear-regression.html"><a href="multiple-imputation-and-linear-regression.html#linear-regression-considering-non-linearity-in-the-predictors"><i class="fa fa-check"></i><b>14.4</b> Linear Regression: Considering Non-Linearity in the Predictors</a></li>
<li class="chapter" data-level="14.5" data-path="multiple-imputation-and-linear-regression.html"><a href="multiple-imputation-and-linear-regression.html#main-effects-linear-regression-with-lm-on-the-complete-cases"><i class="fa fa-check"></i><b>14.5</b> “Main Effects” Linear Regression with <code>lm</code> on the Complete Cases</a>
<ul>
<li class="chapter" data-level="14.5.1" data-path="multiple-imputation-and-linear-regression.html"><a href="multiple-imputation-and-linear-regression.html#quality-of-fit-statistics"><i class="fa fa-check"></i><b>14.5.1</b> Quality of Fit Statistics</a></li>
<li class="chapter" data-level="14.5.2" data-path="multiple-imputation-and-linear-regression.html"><a href="multiple-imputation-and-linear-regression.html#interpreting-effect-sizes"><i class="fa fa-check"></i><b>14.5.2</b> Interpreting Effect Sizes</a></li>
<li class="chapter" data-level="14.5.3" data-path="multiple-imputation-and-linear-regression.html"><a href="multiple-imputation-and-linear-regression.html#making-predictions-with-the-model"><i class="fa fa-check"></i><b>14.5.3</b> Making Predictions with the Model</a></li>
</ul></li>
<li class="chapter" data-level="14.6" data-path="multiple-imputation-and-linear-regression.html"><a href="multiple-imputation-and-linear-regression.html#augmented-linear-regression-with-lm-on-the-complete-cases"><i class="fa fa-check"></i><b>14.6</b> “Augmented” Linear Regression with <code>lm</code> on the Complete Cases</a>
<ul>
<li class="chapter" data-level="14.6.1" data-path="multiple-imputation-and-linear-regression.html"><a href="multiple-imputation-and-linear-regression.html#quality-of-fit-statistics-1"><i class="fa fa-check"></i><b>14.6.1</b> Quality of Fit Statistics</a></li>
<li class="chapter" data-level="14.6.2" data-path="multiple-imputation-and-linear-regression.html"><a href="multiple-imputation-and-linear-regression.html#anova-assessing-the-impact-of-the-non-linear-terms"><i class="fa fa-check"></i><b>14.6.2</b> ANOVA assessing the impact of the non-linear terms</a></li>
<li class="chapter" data-level="14.6.3" data-path="multiple-imputation-and-linear-regression.html"><a href="multiple-imputation-and-linear-regression.html#interpreting-effect-sizes-1"><i class="fa fa-check"></i><b>14.6.3</b> Interpreting Effect Sizes</a></li>
<li class="chapter" data-level="14.6.4" data-path="multiple-imputation-and-linear-regression.html"><a href="multiple-imputation-and-linear-regression.html#making-predictions-with-the-model-1"><i class="fa fa-check"></i><b>14.6.4</b> Making Predictions with the Model</a></li>
</ul></li>
<li class="chapter" data-level="14.7" data-path="multiple-imputation-and-linear-regression.html"><a href="multiple-imputation-and-linear-regression.html#using-mice-to-perform-multiple-imputation"><i class="fa fa-check"></i><b>14.7</b> Using <code>mice</code> to perform Multiple Imputation</a></li>
<li class="chapter" data-level="14.8" data-path="multiple-imputation-and-linear-regression.html"><a href="multiple-imputation-and-linear-regression.html#running-the-linear-regression-in-lm-with-multiple-imputation"><i class="fa fa-check"></i><b>14.8</b> Running the Linear Regression in <code>lm</code> with Multiple Imputation</a></li>
<li class="chapter" data-level="14.9" data-path="multiple-imputation-and-linear-regression.html"><a href="multiple-imputation-and-linear-regression.html#fit-the-multiple-imputation-model-with-aregimpute"><i class="fa fa-check"></i><b>14.9</b> Fit the Multiple Imputation Model with <code>aregImpute</code></a></li>
<li class="chapter" data-level="14.10" data-path="multiple-imputation-and-linear-regression.html"><a href="multiple-imputation-and-linear-regression.html#fit-linear-regression-using-ols-and-fit.mult.impute"><i class="fa fa-check"></i><b>14.10</b> Fit Linear Regression using <code>ols</code> and <code>fit.mult.impute</code></a>
<ul>
<li class="chapter" data-level="14.10.1" data-path="multiple-imputation-and-linear-regression.html"><a href="multiple-imputation-and-linear-regression.html#summaries-and-coefficients"><i class="fa fa-check"></i><b>14.10.1</b> Summaries and Coefficients</a></li>
<li class="chapter" data-level="14.10.2" data-path="multiple-imputation-and-linear-regression.html"><a href="multiple-imputation-and-linear-regression.html#effect-sizes"><i class="fa fa-check"></i><b>14.10.2</b> Effect Sizes</a></li>
<li class="chapter" data-level="14.10.3" data-path="multiple-imputation-and-linear-regression.html"><a href="multiple-imputation-and-linear-regression.html#making-predictions-with-this-model"><i class="fa fa-check"></i><b>14.10.3</b> Making Predictions with this Model</a></li>
<li class="chapter" data-level="14.10.4" data-path="multiple-imputation-and-linear-regression.html"><a href="multiple-imputation-and-linear-regression.html#nomogram"><i class="fa fa-check"></i><b>14.10.4</b> Nomogram</a></li>
<li class="chapter" data-level="14.10.5" data-path="multiple-imputation-and-linear-regression.html"><a href="multiple-imputation-and-linear-regression.html#validating-summary-statistics"><i class="fa fa-check"></i><b>14.10.5</b> Validating Summary Statistics</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="15" data-path="using-tidymodels-to-fit-linear-regressions.html"><a href="using-tidymodels-to-fit-linear-regressions.html"><i class="fa fa-check"></i><b>15</b> Using tidymodels to fit linear regressions</a></li>
<li class="chapter" data-level="16" data-path="using-tidymodels-to-fit-logistic-regressions.html"><a href="using-tidymodels-to-fit-logistic-regressions.html"><i class="fa fa-check"></i><b>16</b> Using tidymodels to fit logistic regressions</a></li>
<li class="chapter" data-level="17" data-path="using-tidymodels-approaches-next-steps.html"><a href="using-tidymodels-approaches-next-steps.html"><i class="fa fa-check"></i><b>17</b> Using tidymodels approaches: Next Steps</a></li>
<li class="chapter" data-level="18" data-path="colorectal-cancer-screening-and-some-special-cases.html"><a href="colorectal-cancer-screening-and-some-special-cases.html"><i class="fa fa-check"></i><b>18</b> Colorectal Cancer Screening and Some Special Cases</a>
<ul>
<li class="chapter" data-level="18.1" data-path="colorectal-cancer-screening-and-some-special-cases.html"><a href="colorectal-cancer-screening-and-some-special-cases.html#logistic-regression-for-aggregated-data"><i class="fa fa-check"></i><b>18.1</b> Logistic Regression for Aggregated Data</a>
<ul>
<li class="chapter" data-level="18.1.1" data-path="colorectal-cancer-screening-and-some-special-cases.html"><a href="colorectal-cancer-screening-and-some-special-cases.html#colorectal-cancer-screening-data"><i class="fa fa-check"></i><b>18.1.1</b> Colorectal Cancer Screening Data</a></li>
<li class="chapter" data-level="18.1.2" data-path="colorectal-cancer-screening-and-some-special-cases.html"><a href="colorectal-cancer-screening-and-some-special-cases.html#fitting-a-logistic-regression-model-to-proportion-data"><i class="fa fa-check"></i><b>18.1.2</b> Fitting a Logistic Regression Model to Proportion Data</a></li>
<li class="chapter" data-level="18.1.3" data-path="colorectal-cancer-screening-and-some-special-cases.html"><a href="colorectal-cancer-screening-and-some-special-cases.html#fitting-a-logistic-regression-model-to-counts-of-successes-and-failures"><i class="fa fa-check"></i><b>18.1.3</b> Fitting a Logistic Regression Model to Counts of Successes and Failures</a></li>
<li class="chapter" data-level="18.1.4" data-path="colorectal-cancer-screening-and-some-special-cases.html"><a href="colorectal-cancer-screening-and-some-special-cases.html#how-does-one-address-this-problem-in-rms"><i class="fa fa-check"></i><b>18.1.4</b> How does one address this problem in <code>rms</code>?</a></li>
</ul></li>
<li class="chapter" data-level="18.2" data-path="colorectal-cancer-screening-and-some-special-cases.html"><a href="colorectal-cancer-screening-and-some-special-cases.html#probit-regression"><i class="fa fa-check"></i><b>18.2</b> Probit Regression</a>
<ul>
<li class="chapter" data-level="18.2.1" data-path="colorectal-cancer-screening-and-some-special-cases.html"><a href="colorectal-cancer-screening-and-some-special-cases.html#colorectal-cancer-screening-data-on-individuals"><i class="fa fa-check"></i><b>18.2.1</b> Colorectal Cancer Screening Data on Individuals</a></li>
<li class="chapter" data-level="18.2.2" data-path="colorectal-cancer-screening-and-some-special-cases.html"><a href="colorectal-cancer-screening-and-some-special-cases.html#a-logistic-regression-model"><i class="fa fa-check"></i><b>18.2.2</b> A logistic regression model</a></li>
<li class="chapter" data-level="18.2.3" data-path="colorectal-cancer-screening-and-some-special-cases.html"><a href="colorectal-cancer-screening-and-some-special-cases.html#predicting-status-for-harry-and-sally"><i class="fa fa-check"></i><b>18.2.3</b> Predicting status for Harry and Sally</a></li>
<li class="chapter" data-level="18.2.4" data-path="colorectal-cancer-screening-and-some-special-cases.html"><a href="colorectal-cancer-screening-and-some-special-cases.html#a-probit-regression-model"><i class="fa fa-check"></i><b>18.2.4</b> A probit regression model</a></li>
<li class="chapter" data-level="18.2.5" data-path="colorectal-cancer-screening-and-some-special-cases.html"><a href="colorectal-cancer-screening-and-some-special-cases.html#interpreting-the-probit-models-coefficients"><i class="fa fa-check"></i><b>18.2.5</b> Interpreting the Probit Model’s Coefficients</a></li>
<li class="chapter" data-level="18.2.6" data-path="colorectal-cancer-screening-and-some-special-cases.html"><a href="colorectal-cancer-screening-and-some-special-cases.html#what-about-harry-and-sally"><i class="fa fa-check"></i><b>18.2.6</b> What about Harry and Sally?</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="19" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html"><i class="fa fa-check"></i><b>19</b> Modeling a Count Outcome in Ohio SMART</a>
<ul>
<li class="chapter" data-level="19.1" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#preliminaries"><i class="fa fa-check"></i><b>19.1</b> Preliminaries</a></li>
<li class="chapter" data-level="19.2" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#a-subset-of-the-ohio-smart-data"><i class="fa fa-check"></i><b>19.2</b> A subset of the Ohio SMART data</a>
<ul>
<li class="chapter" data-level="19.2.1" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#is-age-group-associated-with-physhealth"><i class="fa fa-check"></i><b>19.2.1</b> Is age group associated with <code>physhealth</code>?</a></li>
</ul></li>
<li class="chapter" data-level="19.3" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#exploratory-data-analysis-in-the-18-49-group"><i class="fa fa-check"></i><b>19.3</b> Exploratory Data Analysis (in the 18-49 group)</a>
<ul>
<li class="chapter" data-level="19.3.1" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#build-a-subset-of-those-ages-18-49"><i class="fa fa-check"></i><b>19.3.1</b> Build a subset of those ages 18-49</a></li>
<li class="chapter" data-level="19.3.2" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#centering-bmi"><i class="fa fa-check"></i><b>19.3.2</b> Centering <code>bmi</code></a></li>
<li class="chapter" data-level="19.3.3" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#distribution-of-the-outcome"><i class="fa fa-check"></i><b>19.3.3</b> Distribution of the Outcome</a></li>
<li class="chapter" data-level="19.3.4" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#scatterplot-matrix"><i class="fa fa-check"></i><b>19.3.4</b> Scatterplot Matrix</a></li>
<li class="chapter" data-level="19.3.5" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#summary-of-the-final-subset-of-data"><i class="fa fa-check"></i><b>19.3.5</b> Summary of the final subset of data</a></li>
</ul></li>
<li class="chapter" data-level="19.4" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#modeling-strategies-explored-here"><i class="fa fa-check"></i><b>19.4</b> Modeling Strategies Explored Here</a>
<ul>
<li class="chapter" data-level="19.4.1" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#what-will-we-demonstrate"><i class="fa fa-check"></i><b>19.4.1</b> What Will We Demonstrate?</a></li>
<li class="chapter" data-level="19.4.2" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#extra-data-file-for-harry-and-sally"><i class="fa fa-check"></i><b>19.4.2</b> Extra Data File for Harry and Sally</a></li>
</ul></li>
<li class="chapter" data-level="19.5" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#the-ols-approach"><i class="fa fa-check"></i><b>19.5</b> The OLS Approach</a>
<ul>
<li class="chapter" data-level="19.5.1" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#interpreting-the-coefficients"><i class="fa fa-check"></i><b>19.5.1</b> Interpreting the Coefficients</a></li>
<li class="chapter" data-level="19.5.2" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#store-fitted-values-and-residuals"><i class="fa fa-check"></i><b>19.5.2</b> Store fitted values and residuals</a></li>
<li class="chapter" data-level="19.5.3" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#specify-the-r2-and-loglikelihood-values"><i class="fa fa-check"></i><b>19.5.3</b> Specify the <span class="math inline">\(R^2\)</span> and log(likelihood) values</a></li>
<li class="chapter" data-level="19.5.4" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#check-model-assumptions"><i class="fa fa-check"></i><b>19.5.4</b> Check model assumptions</a></li>
<li class="chapter" data-level="19.5.5" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#predictions-for-harry-and-sally"><i class="fa fa-check"></i><b>19.5.5</b> Predictions for Harry and Sally</a></li>
<li class="chapter" data-level="19.5.6" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#notes"><i class="fa fa-check"></i><b>19.5.6</b> Notes</a></li>
</ul></li>
<li class="chapter" data-level="19.6" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#ols-model-on-logphyshealth-1-days"><i class="fa fa-check"></i><b>19.6</b> OLS model on log(<code>physhealth</code> + 1) days</a>
<ul>
<li class="chapter" data-level="19.6.1" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#interpreting-the-coefficients-1"><i class="fa fa-check"></i><b>19.6.1</b> Interpreting the Coefficients</a></li>
<li class="chapter" data-level="19.6.2" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#store-fitted-values-and-residuals-1"><i class="fa fa-check"></i><b>19.6.2</b> Store fitted values and residuals</a></li>
<li class="chapter" data-level="19.6.3" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#specify-the-r2-and-loglikelihood-values-1"><i class="fa fa-check"></i><b>19.6.3</b> Specify the <span class="math inline">\(R^2\)</span> and log(likelihood) values</a></li>
<li class="chapter" data-level="19.6.4" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#getting-r2-on-the-scale-of-physhealth"><i class="fa fa-check"></i><b>19.6.4</b> Getting <span class="math inline">\(R^2\)</span> on the scale of <code>physhealth</code></a></li>
<li class="chapter" data-level="19.6.5" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#check-model-assumptions-1"><i class="fa fa-check"></i><b>19.6.5</b> Check model assumptions</a></li>
<li class="chapter" data-level="19.6.6" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#predictions-for-harry-and-sally-1"><i class="fa fa-check"></i><b>19.6.6</b> Predictions for Harry and Sally</a></li>
</ul></li>
<li class="chapter" data-level="19.7" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#a-poisson-regression-model"><i class="fa fa-check"></i><b>19.7</b> A Poisson Regression Model</a>
<ul>
<li class="chapter" data-level="19.7.1" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#the-fitted-equation"><i class="fa fa-check"></i><b>19.7.1</b> The Fitted Equation</a></li>
<li class="chapter" data-level="19.7.2" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#interpreting-the-coefficients-2"><i class="fa fa-check"></i><b>19.7.2</b> Interpreting the Coefficients</a></li>
<li class="chapter" data-level="19.7.3" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#testing-the-predictors"><i class="fa fa-check"></i><b>19.7.3</b> Testing the Predictors</a></li>
<li class="chapter" data-level="19.7.4" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#correcting-for-overdispersion-with-coeftestcoefci"><i class="fa fa-check"></i><b>19.7.4</b> Correcting for Overdispersion with <code>coeftest</code>/<code>coefci</code></a></li>
<li class="chapter" data-level="19.7.5" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#store-fitted-values-and-residuals-2"><i class="fa fa-check"></i><b>19.7.5</b> Store fitted values and residuals</a></li>
<li class="chapter" data-level="19.7.6" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#rootogram-see-the-fit-of-a-count-regression-model"><i class="fa fa-check"></i><b>19.7.6</b> Rootogram: see the fit of a count regression model</a></li>
<li class="chapter" data-level="19.7.7" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#specify-the-r2-and-loglikelihood-values-2"><i class="fa fa-check"></i><b>19.7.7</b> Specify the <span class="math inline">\(R^2\)</span> and log(likelihood) values</a></li>
<li class="chapter" data-level="19.7.8" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#check-model-assumptions-2"><i class="fa fa-check"></i><b>19.7.8</b> Check model assumptions</a></li>
<li class="chapter" data-level="19.7.9" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#using-glm.diag.plots-from-the-boot-package"><i class="fa fa-check"></i><b>19.7.9</b> Using <code>glm.diag.plots</code> from the <code>boot</code> package</a></li>
<li class="chapter" data-level="19.7.10" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#predictions-for-harry-and-sally-2"><i class="fa fa-check"></i><b>19.7.10</b> Predictions for Harry and Sally</a></li>
</ul></li>
<li class="chapter" data-level="19.8" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#overdispersion-in-a-poisson-model"><i class="fa fa-check"></i><b>19.8</b> Overdispersion in a Poisson Model</a>
<ul>
<li class="chapter" data-level="19.8.1" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#testing-for-overdispersion"><i class="fa fa-check"></i><b>19.8.1</b> Testing for Overdispersion?</a></li>
</ul></li>
<li class="chapter" data-level="19.9" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#fitting-the-quasi-poisson-model"><i class="fa fa-check"></i><b>19.9</b> Fitting the Quasi-Poisson Model</a>
<ul>
<li class="chapter" data-level="19.9.1" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#the-fitted-equation-1"><i class="fa fa-check"></i><b>19.9.1</b> The Fitted Equation</a></li>
<li class="chapter" data-level="19.9.2" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#interpreting-the-coefficients-3"><i class="fa fa-check"></i><b>19.9.2</b> Interpreting the Coefficients</a></li>
<li class="chapter" data-level="19.9.3" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#testing-the-predictors-1"><i class="fa fa-check"></i><b>19.9.3</b> Testing the Predictors</a></li>
<li class="chapter" data-level="19.9.4" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#store-fitted-values-and-residuals-3"><i class="fa fa-check"></i><b>19.9.4</b> Store fitted values and residuals</a></li>
<li class="chapter" data-level="19.9.5" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#specify-the-r2-and-loglikelihood-values-3"><i class="fa fa-check"></i><b>19.9.5</b> Specify the <span class="math inline">\(R^2\)</span> and log(likelihood) values</a></li>
<li class="chapter" data-level="19.9.6" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#check-model-assumptions-3"><i class="fa fa-check"></i><b>19.9.6</b> Check model assumptions</a></li>
<li class="chapter" data-level="19.9.7" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#predictions-for-harry-and-sally-3"><i class="fa fa-check"></i><b>19.9.7</b> Predictions for Harry and Sally</a></li>
</ul></li>
<li class="chapter" data-level="19.10" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#poisson-and-quasi-poisson-models-using-glm-from-the-rms-package"><i class="fa fa-check"></i><b>19.10</b> Poisson and Quasi-Poisson models using <code>Glm</code> from the <code>rms</code> package</a>
<ul>
<li class="chapter" data-level="19.10.1" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#refitting-the-original-poisson-regression-with-glm"><i class="fa fa-check"></i><b>19.10.1</b> Refitting the original Poisson regression with <code>Glm</code></a></li>
<li class="chapter" data-level="19.10.2" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#refitting-the-overdispersed-poisson-regression-with-glm"><i class="fa fa-check"></i><b>19.10.2</b> Refitting the overdispersed Poisson regression with <code>Glm</code></a></li>
<li class="chapter" data-level="19.10.3" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#anova-on-a-glm-fit"><i class="fa fa-check"></i><b>19.10.3</b> ANOVA on a <code>Glm</code> fit</a></li>
<li class="chapter" data-level="19.10.4" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#ggplots-from-glm-fit"><i class="fa fa-check"></i><b>19.10.4</b> ggplots from <code>Glm</code> fit</a></li>
<li class="chapter" data-level="19.10.5" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#summary-of-a-glm-fit"><i class="fa fa-check"></i><b>19.10.5</b> Summary of a <code>Glm</code> fit</a></li>
<li class="chapter" data-level="19.10.6" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#plot-of-the-summary"><i class="fa fa-check"></i><b>19.10.6</b> Plot of the Summary</a></li>
<li class="chapter" data-level="19.10.7" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#nomogram-of-a-glm-fit"><i class="fa fa-check"></i><b>19.10.7</b> Nomogram of a <code>Glm</code> fit</a></li>
</ul></li>
<li class="chapter" data-level="19.11" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#negative-binomial-model"><i class="fa fa-check"></i><b>19.11</b> Negative Binomial Model</a>
<ul>
<li class="chapter" data-level="19.11.1" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#the-fitted-equation-2"><i class="fa fa-check"></i><b>19.11.1</b> The Fitted Equation</a></li>
<li class="chapter" data-level="19.11.2" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#comparison-with-the-raw-poisson-model"><i class="fa fa-check"></i><b>19.11.2</b> Comparison with the (raw) Poisson model</a></li>
<li class="chapter" data-level="19.11.3" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#interpreting-the-coefficients-4"><i class="fa fa-check"></i><b>19.11.3</b> Interpreting the Coefficients</a></li>
<li class="chapter" data-level="19.11.4" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#interpretation-of-coefficients-in-terms-of-irrs"><i class="fa fa-check"></i><b>19.11.4</b> Interpretation of Coefficients in terms of IRRs</a></li>
<li class="chapter" data-level="19.11.5" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#testing-the-predictors-2"><i class="fa fa-check"></i><b>19.11.5</b> Testing the Predictors</a></li>
<li class="chapter" data-level="19.11.6" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#store-fitted-values-and-residuals-4"><i class="fa fa-check"></i><b>19.11.6</b> Store fitted values and residuals</a></li>
<li class="chapter" data-level="19.11.7" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#rootogram-for-negative-binomial-model"><i class="fa fa-check"></i><b>19.11.7</b> Rootogram for Negative Binomial model</a></li>
<li class="chapter" data-level="19.11.8" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#simulating-what-the-negative-binomial-model-predicts"><i class="fa fa-check"></i><b>19.11.8</b> Simulating what the Negative Binomial model predicts</a></li>
<li class="chapter" data-level="19.11.9" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#specify-the-r2-and-loglikelihood-values-4"><i class="fa fa-check"></i><b>19.11.9</b> Specify the <span class="math inline">\(R^2\)</span> and log(likelihood) values</a></li>
<li class="chapter" data-level="19.11.10" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#check-model-assumptions-4"><i class="fa fa-check"></i><b>19.11.10</b> Check model assumptions</a></li>
<li class="chapter" data-level="19.11.11" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#predictions-for-harry-and-sally-4"><i class="fa fa-check"></i><b>19.11.11</b> Predictions for Harry and Sally</a></li>
</ul></li>
<li class="chapter" data-level="19.12" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#the-problem-too-few-zeros"><i class="fa fa-check"></i><b>19.12</b> The Problem: Too Few Zeros</a></li>
<li class="chapter" data-level="19.13" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#the-zero-inflated-poisson-regression-model"><i class="fa fa-check"></i><b>19.13</b> The Zero-Inflated Poisson Regression Model</a>
<ul>
<li class="chapter" data-level="19.13.1" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#comparison-to-a-null-model"><i class="fa fa-check"></i><b>19.13.1</b> Comparison to a null model</a></li>
<li class="chapter" data-level="19.13.2" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#comparison-to-a-poisson-model-with-the-vuong-test"><i class="fa fa-check"></i><b>19.13.2</b> Comparison to a Poisson Model with the Vuong test</a></li>
<li class="chapter" data-level="19.13.3" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#the-fitted-equation-3"><i class="fa fa-check"></i><b>19.13.3</b> The Fitted Equation</a></li>
<li class="chapter" data-level="19.13.4" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#interpreting-the-coefficients-5"><i class="fa fa-check"></i><b>19.13.4</b> Interpreting the Coefficients</a></li>
<li class="chapter" data-level="19.13.5" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#testing-the-predictors-3"><i class="fa fa-check"></i><b>19.13.5</b> Testing the Predictors</a></li>
<li class="chapter" data-level="19.13.6" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#store-fitted-values-and-residuals-5"><i class="fa fa-check"></i><b>19.13.6</b> Store fitted values and residuals</a></li>
<li class="chapter" data-level="19.13.7" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#modeled-number-of-zero-counts"><i class="fa fa-check"></i><b>19.13.7</b> Modeled Number of Zero Counts</a></li>
<li class="chapter" data-level="19.13.8" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#rootogram-for-zip-model"><i class="fa fa-check"></i><b>19.13.8</b> Rootogram for ZIP model</a></li>
<li class="chapter" data-level="19.13.9" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#specify-the-r2-and-log-likelihood-values"><i class="fa fa-check"></i><b>19.13.9</b> Specify the <span class="math inline">\(R^2\)</span> and log (likelihood) values</a></li>
<li class="chapter" data-level="19.13.10" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#check-model-assumptions-5"><i class="fa fa-check"></i><b>19.13.10</b> Check model assumptions</a></li>
<li class="chapter" data-level="19.13.11" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#predictions-for-harry-and-sally-5"><i class="fa fa-check"></i><b>19.13.11</b> Predictions for Harry and Sally</a></li>
</ul></li>
<li class="chapter" data-level="19.14" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#the-zero-inflated-negative-binomial-regression-model"><i class="fa fa-check"></i><b>19.14</b> The Zero-Inflated Negative Binomial Regression Model</a>
<ul>
<li class="chapter" data-level="19.14.1" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#comparison-to-a-null-model-1"><i class="fa fa-check"></i><b>19.14.1</b> Comparison to a null model</a></li>
<li class="chapter" data-level="19.14.2" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#comparison-to-a-negative-binomial-model-vuong-test"><i class="fa fa-check"></i><b>19.14.2</b> Comparison to a Negative Binomial Model: Vuong test</a></li>
<li class="chapter" data-level="19.14.3" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#the-fitted-equation-4"><i class="fa fa-check"></i><b>19.14.3</b> The Fitted Equation</a></li>
<li class="chapter" data-level="19.14.4" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#interpreting-the-coefficients-6"><i class="fa fa-check"></i><b>19.14.4</b> Interpreting the Coefficients</a></li>
<li class="chapter" data-level="19.14.5" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#testing-the-predictors-4"><i class="fa fa-check"></i><b>19.14.5</b> Testing the Predictors</a></li>
<li class="chapter" data-level="19.14.6" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#store-fitted-values-and-residuals-6"><i class="fa fa-check"></i><b>19.14.6</b> Store fitted values and residuals</a></li>
<li class="chapter" data-level="19.14.7" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#modeled-number-of-zero-counts-1"><i class="fa fa-check"></i><b>19.14.7</b> Modeled Number of Zero Counts</a></li>
<li class="chapter" data-level="19.14.8" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#rootogram-for-zero-inflated-negative-binomial-model"><i class="fa fa-check"></i><b>19.14.8</b> Rootogram for Zero-Inflated Negative Binomial model</a></li>
<li class="chapter" data-level="19.14.9" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#specify-the-r2-and-log-likelihood-values-1"><i class="fa fa-check"></i><b>19.14.9</b> Specify the <span class="math inline">\(R^2\)</span> and log (likelihood) values</a></li>
<li class="chapter" data-level="19.14.10" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#check-model-assumptions-6"><i class="fa fa-check"></i><b>19.14.10</b> Check model assumptions</a></li>
<li class="chapter" data-level="19.14.11" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#predictions-for-harry-and-sally-6"><i class="fa fa-check"></i><b>19.14.11</b> Predictions for Harry and Sally</a></li>
</ul></li>
<li class="chapter" data-level="19.15" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#a-hurdle-model-with-poisson"><i class="fa fa-check"></i><b>19.15</b> A “hurdle” model (with Poisson)</a>
<ul>
<li class="chapter" data-level="19.15.1" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#comparison-to-a-null-model-2"><i class="fa fa-check"></i><b>19.15.1</b> Comparison to a null model</a></li>
<li class="chapter" data-level="19.15.2" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#comparison-to-a-poisson-model-vuong-test"><i class="fa fa-check"></i><b>19.15.2</b> Comparison to a Poisson Model: Vuong test</a></li>
<li class="chapter" data-level="19.15.3" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#comparison-to-a-zero-inflated-poisson-model-vuong-test"><i class="fa fa-check"></i><b>19.15.3</b> Comparison to a Zero-Inflated Poisson Model: Vuong test</a></li>
<li class="chapter" data-level="19.15.4" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#the-fitted-equation-5"><i class="fa fa-check"></i><b>19.15.4</b> The Fitted Equation</a></li>
<li class="chapter" data-level="19.15.5" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#interpreting-the-coefficients-7"><i class="fa fa-check"></i><b>19.15.5</b> Interpreting the Coefficients</a></li>
<li class="chapter" data-level="19.15.6" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#testing-the-predictors-5"><i class="fa fa-check"></i><b>19.15.6</b> Testing the Predictors</a></li>
<li class="chapter" data-level="19.15.7" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#store-fitted-values-and-residuals-7"><i class="fa fa-check"></i><b>19.15.7</b> Store fitted values and residuals</a></li>
<li class="chapter" data-level="19.15.8" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#modeled-number-of-zero-counts-2"><i class="fa fa-check"></i><b>19.15.8</b> Modeled Number of Zero Counts</a></li>
<li class="chapter" data-level="19.15.9" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#rootogram-for-hurdle-model"><i class="fa fa-check"></i><b>19.15.9</b> Rootogram for Hurdle Model</a></li>
<li class="chapter" data-level="19.15.10" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#understanding-the-modeled-counts-in-detail"><i class="fa fa-check"></i><b>19.15.10</b> Understanding the Modeled Counts in Detail</a></li>
<li class="chapter" data-level="19.15.11" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#specify-the-r2-and-log-likelihood-values-2"><i class="fa fa-check"></i><b>19.15.11</b> Specify the <span class="math inline">\(R^2\)</span> and log (likelihood) values</a></li>
<li class="chapter" data-level="19.15.12" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#check-model-assumptions-7"><i class="fa fa-check"></i><b>19.15.12</b> Check model assumptions</a></li>
<li class="chapter" data-level="19.15.13" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#predictions-for-harry-and-sally-7"><i class="fa fa-check"></i><b>19.15.13</b> Predictions for Harry and Sally</a></li>
</ul></li>
<li class="chapter" data-level="19.16" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#a-hurdle-model-with-negative-binomial-for-overdispersion"><i class="fa fa-check"></i><b>19.16</b> A “hurdle” model (with negative binomial for overdispersion)</a>
<ul>
<li class="chapter" data-level="19.16.1" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#comparison-to-a-null-model-3"><i class="fa fa-check"></i><b>19.16.1</b> Comparison to a null model</a></li>
<li class="chapter" data-level="19.16.2" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#comparison-to-a-negative-binomial-model-vuong-test-1"><i class="fa fa-check"></i><b>19.16.2</b> Comparison to a Negative Binomial Model: Vuong test</a></li>
<li class="chapter" data-level="19.16.3" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#comparison-to-a-zero-inflated-nb-model-vuong-test"><i class="fa fa-check"></i><b>19.16.3</b> Comparison to a Zero-Inflated NB Model: Vuong test</a></li>
<li class="chapter" data-level="19.16.4" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#comparing-the-hurdle-models-with-aic-and-bic"><i class="fa fa-check"></i><b>19.16.4</b> Comparing the Hurdle Models with AIC and BIC</a></li>
<li class="chapter" data-level="19.16.5" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#the-fitted-equation-6"><i class="fa fa-check"></i><b>19.16.5</b> The Fitted Equation</a></li>
<li class="chapter" data-level="19.16.6" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#interpreting-the-coefficients-8"><i class="fa fa-check"></i><b>19.16.6</b> Interpreting the Coefficients</a></li>
<li class="chapter" data-level="19.16.7" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#testing-the-predictors-6"><i class="fa fa-check"></i><b>19.16.7</b> Testing the Predictors</a></li>
<li class="chapter" data-level="19.16.8" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#store-fitted-values-and-residuals-8"><i class="fa fa-check"></i><b>19.16.8</b> Store fitted values and residuals</a></li>
<li class="chapter" data-level="19.16.9" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#rootogram-for-nb-hurdle-model"><i class="fa fa-check"></i><b>19.16.9</b> Rootogram for NB Hurdle Model</a></li>
<li class="chapter" data-level="19.16.10" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#specify-the-r2-and-log-likelihood-values-3"><i class="fa fa-check"></i><b>19.16.10</b> Specify the <span class="math inline">\(R^2\)</span> and log (likelihood) values</a></li>
<li class="chapter" data-level="19.16.11" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#check-model-assumptions-8"><i class="fa fa-check"></i><b>19.16.11</b> Check model assumptions</a></li>
<li class="chapter" data-level="19.16.12" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#predictions-for-harry-and-sally-8"><i class="fa fa-check"></i><b>19.16.12</b> Predictions for Harry and Sally</a></li>
<li class="chapter" data-level="19.16.13" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#note-fitting-a-different-hurdle-model-for-counts-and-przero"><i class="fa fa-check"></i><b>19.16.13</b> Note: Fitting a Different Hurdle Model for Counts and Pr(zero)</a></li>
<li class="chapter" data-level="19.16.14" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#hanging-rootogram-for-this-new-hurdle-model"><i class="fa fa-check"></i><b>19.16.14</b> Hanging Rootogram for this new Hurdle Model</a></li>
</ul></li>
<li class="chapter" data-level="19.17" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#a-tobit-censored-regression-model"><i class="fa fa-check"></i><b>19.17</b> A Tobit (Censored) Regression Model</a>
<ul>
<li class="chapter" data-level="19.17.1" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#the-fitted-equation-7"><i class="fa fa-check"></i><b>19.17.1</b> The Fitted Equation</a></li>
<li class="chapter" data-level="19.17.2" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#interpreting-the-coefficients-9"><i class="fa fa-check"></i><b>19.17.2</b> Interpreting the Coefficients</a></li>
<li class="chapter" data-level="19.17.3" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#testing-the-predictors-7"><i class="fa fa-check"></i><b>19.17.3</b> Testing the Predictors</a></li>
<li class="chapter" data-level="19.17.4" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#store-fitted-values-and-residuals-9"><i class="fa fa-check"></i><b>19.17.4</b> Store fitted values and residuals</a></li>
<li class="chapter" data-level="19.17.5" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#building-something-like-a-rootogram"><i class="fa fa-check"></i><b>19.17.5</b> Building Something Like a Rootogram</a></li>
<li class="chapter" data-level="19.17.6" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#tables-of-the-observed-and-fitted-physhealth-from-tobit"><i class="fa fa-check"></i><b>19.17.6</b> Tables of the Observed and Fitted <code>physhealth</code> from Tobit</a></li>
<li class="chapter" data-level="19.17.7" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#specify-the-r2-and-log-likelihood-values-4"><i class="fa fa-check"></i><b>19.17.7</b> Specify the <span class="math inline">\(R^2\)</span> and log (likelihood) values</a></li>
<li class="chapter" data-level="19.17.8" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#check-model-assumptions-9"><i class="fa fa-check"></i><b>19.17.8</b> Check model assumptions</a></li>
<li class="chapter" data-level="19.17.9" data-path="modeling-a-count-outcome-in-ohio-smart.html"><a href="modeling-a-count-outcome-in-ohio-smart.html#predictions-for-harry-and-sally-9"><i class="fa fa-check"></i><b>19.17.9</b> Predictions for Harry and Sally</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="20" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><i class="fa fa-check"></i><b>20</b> Modeling an Ordinal Categorical Outcome in Ohio SMART</a>
<ul>
<li class="chapter" data-level="20.1" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#preliminaries-1"><i class="fa fa-check"></i><b>20.1</b> Preliminaries</a></li>
<li class="chapter" data-level="20.2" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#a-subset-of-the-ohio-smart-data-1"><i class="fa fa-check"></i><b>20.2</b> A subset of the Ohio SMART data</a>
<ul>
<li class="chapter" data-level="20.2.1" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#several-ways-of-storing-multi-categorical-data"><i class="fa fa-check"></i><b>20.2.1</b> Several Ways of Storing Multi-Categorical data</a></li>
</ul></li>
<li class="chapter" data-level="20.3" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#building-cross-tabulations"><i class="fa fa-check"></i><b>20.3</b> Building Cross-Tabulations</a>
<ul>
<li class="chapter" data-level="20.3.1" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#using-base-table-functions"><i class="fa fa-check"></i><b>20.3.1</b> Using base <code>table</code> functions</a></li>
<li class="chapter" data-level="20.3.2" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#using-xtabs"><i class="fa fa-check"></i><b>20.3.2</b> Using <code>xtabs</code></a></li>
<li class="chapter" data-level="20.3.3" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#storing-a-table-in-a-tibble"><i class="fa fa-check"></i><b>20.3.3</b> Storing a table in a tibble</a></li>
<li class="chapter" data-level="20.3.4" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#using-crosstable-from-the-gmodels-package"><i class="fa fa-check"></i><b>20.3.4</b> Using <code>CrossTable</code> from the <code>gmodels</code> package</a></li>
</ul></li>
<li class="chapter" data-level="20.4" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#graphing-categorical-data"><i class="fa fa-check"></i><b>20.4</b> Graphing Categorical Data</a>
<ul>
<li class="chapter" data-level="20.4.1" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#a-bar-chart-for-a-single-variable"><i class="fa fa-check"></i><b>20.4.1</b> A Bar Chart for a Single Variable</a></li>
<li class="chapter" data-level="20.4.2" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#a-counts-chart-for-a-2-way-cross-tabulation"><i class="fa fa-check"></i><b>20.4.2</b> A Counts Chart for a 2-Way Cross-Tabulation</a></li>
</ul></li>
<li class="chapter" data-level="20.5" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#building-a-model-for-genh-using-veg_day"><i class="fa fa-check"></i><b>20.5</b> Building a Model for <code>genh</code> using <code>veg_day</code></a>
<ul>
<li class="chapter" data-level="20.5.1" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#a-little-eda"><i class="fa fa-check"></i><b>20.5.1</b> A little EDA</a></li>
<li class="chapter" data-level="20.5.2" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#describing-the-proportional-odds-cumulative-logit-model"><i class="fa fa-check"></i><b>20.5.2</b> Describing the Proportional-Odds Cumulative Logit Model</a></li>
<li class="chapter" data-level="20.5.3" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#fitting-a-proportional-odds-logistic-regression-with-polr"><i class="fa fa-check"></i><b>20.5.3</b> Fitting a Proportional Odds Logistic Regression with <code>polr</code></a></li>
</ul></li>
<li class="chapter" data-level="20.6" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#interpreting-model-m1"><i class="fa fa-check"></i><b>20.6</b> Interpreting Model <code>m1</code></a>
<ul>
<li class="chapter" data-level="20.6.1" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#looking-at-predictions"><i class="fa fa-check"></i><b>20.6.1</b> Looking at Predictions</a></li>
<li class="chapter" data-level="20.6.2" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#making-predictions-for-harry-and-sally-with-predict"><i class="fa fa-check"></i><b>20.6.2</b> Making Predictions for Harry (and Sally) with <code>predict</code></a></li>
<li class="chapter" data-level="20.6.3" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#predicting-the-actual-classification-of-genh"><i class="fa fa-check"></i><b>20.6.3</b> Predicting the actual classification of <code>genh</code></a></li>
<li class="chapter" data-level="20.6.4" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#a-cross-tabulation-of-predictions"><i class="fa fa-check"></i><b>20.6.4</b> A Cross-Tabulation of Predictions?</a></li>
<li class="chapter" data-level="20.6.5" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#the-fitted-model-equations"><i class="fa fa-check"></i><b>20.6.5</b> The Fitted Model Equations</a></li>
<li class="chapter" data-level="20.6.6" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#interpreting-the-veg_day-coefficient"><i class="fa fa-check"></i><b>20.6.6</b> Interpreting the <code>veg_day</code> coefficient</a></li>
<li class="chapter" data-level="20.6.7" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#exponentiating-the-slope-coefficient-to-facilitate-interpretation"><i class="fa fa-check"></i><b>20.6.7</b> Exponentiating the Slope Coefficient to facilitate Interpretation</a></li>
<li class="chapter" data-level="20.6.8" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#comparison-to-a-null-model-4"><i class="fa fa-check"></i><b>20.6.8</b> Comparison to a Null Model</a></li>
</ul></li>
<li class="chapter" data-level="20.7" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#the-assumption-of-proportional-odds"><i class="fa fa-check"></i><b>20.7</b> The Assumption of Proportional Odds</a>
<ul>
<li class="chapter" data-level="20.7.1" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#testing-the-proportional-odds-assumption"><i class="fa fa-check"></i><b>20.7.1</b> Testing the Proportional Odds Assumption</a></li>
</ul></li>
<li class="chapter" data-level="20.8" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#can-model-m1-be-fit-using-rms-tools"><i class="fa fa-check"></i><b>20.8</b> Can model <code>m1</code> be fit using <code>rms</code> tools?</a></li>
<li class="chapter" data-level="20.9" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#building-a-three-predictor-model"><i class="fa fa-check"></i><b>20.9</b> Building a Three-Predictor Model</a>
<ul>
<li class="chapter" data-level="20.9.1" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#scatterplot-matrix-1"><i class="fa fa-check"></i><b>20.9.1</b> Scatterplot Matrix</a></li>
<li class="chapter" data-level="20.9.2" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#our-three-predictor-model-m2"><i class="fa fa-check"></i><b>20.9.2</b> Our Three-Predictor Model, <code>m2</code></a></li>
<li class="chapter" data-level="20.9.3" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#does-the-three-predictor-model-outperform-m1"><i class="fa fa-check"></i><b>20.9.3</b> Does the three-predictor model outperform <code>m1</code>?</a></li>
<li class="chapter" data-level="20.9.4" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#wald-tests-for-individual-predictors"><i class="fa fa-check"></i><b>20.9.4</b> Wald tests for individual predictors</a></li>
<li class="chapter" data-level="20.9.5" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#a-cross-tabulation-of-predictions-1"><i class="fa fa-check"></i><b>20.9.5</b> A Cross-Tabulation of Predictions?</a></li>
<li class="chapter" data-level="20.9.6" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#interpreting-the-effect-sizes"><i class="fa fa-check"></i><b>20.9.6</b> Interpreting the Effect Sizes</a></li>
<li class="chapter" data-level="20.9.7" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#quality-of-the-model-fit"><i class="fa fa-check"></i><b>20.9.7</b> Quality of the Model Fit</a></li>
<li class="chapter" data-level="20.9.8" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#validating-the-summary-statistics-in-m2_lrm"><i class="fa fa-check"></i><b>20.9.8</b> Validating the Summary Statistics in <code>m2_lrm</code></a></li>
<li class="chapter" data-level="20.9.9" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#testing-the-proportional-odds-assumption-1"><i class="fa fa-check"></i><b>20.9.9</b> Testing the Proportional Odds Assumption</a></li>
<li class="chapter" data-level="20.9.10" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#plotting-the-fitted-model"><i class="fa fa-check"></i><b>20.9.10</b> Plotting the Fitted Model</a></li>
</ul></li>
<li class="chapter" data-level="20.10" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#a-larger-model-including-income-group"><i class="fa fa-check"></i><b>20.10</b> A Larger Model, including income group</a>
<ul>
<li class="chapter" data-level="20.10.1" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#cross-tabulation-of-predictedobserved-classifications"><i class="fa fa-check"></i><b>20.10.1</b> Cross-Tabulation of Predicted/Observed Classifications</a></li>
<li class="chapter" data-level="20.10.2" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#nomogram-2"><i class="fa fa-check"></i><b>20.10.2</b> Nomogram</a></li>
<li class="chapter" data-level="20.10.3" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#using-predict-and-showing-mean-prediction-on-1-5-scale-1"><i class="fa fa-check"></i><b>20.10.3</b> Using Predict and showing mean prediction on 1-5 scale</a></li>
<li class="chapter" data-level="20.10.4" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#validating-the-summary-statistics-in-m3_lrm"><i class="fa fa-check"></i><b>20.10.4</b> Validating the Summary Statistics in <code>m3_lrm</code></a></li>
</ul></li>
<li class="chapter" data-level="20.11" data-path="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#references-for-this-chapter"><i class="fa fa-check"></i><b>20.11</b> References for this Chapter</a></li>
</ul></li>
<li class="chapter" data-level="21" data-path="analyzing-literary-styles-with-multinomial-logistic-regression.html"><a href="analyzing-literary-styles-with-multinomial-logistic-regression.html"><i class="fa fa-check"></i><b>21</b> Analyzing Literary Styles with Multinomial Logistic Regression</a>
<ul>
<li class="chapter" data-level="21.1" data-path="analyzing-literary-styles-with-multinomial-logistic-regression.html"><a href="analyzing-literary-styles-with-multinomial-logistic-regression.html#the-authorship-example"><i class="fa fa-check"></i><b>21.1</b> The Authorship Example</a></li>
<li class="chapter" data-level="21.2" data-path="analyzing-literary-styles-with-multinomial-logistic-regression.html"><a href="analyzing-literary-styles-with-multinomial-logistic-regression.html#focus-on-11-key-words"><i class="fa fa-check"></i><b>21.2</b> Focus on 11 key words</a>
<ul>
<li class="chapter" data-level="21.2.1" data-path="analyzing-literary-styles-with-multinomial-logistic-regression.html"><a href="analyzing-literary-styles-with-multinomial-logistic-regression.html#side-by-side-boxplots"><i class="fa fa-check"></i><b>21.2.1</b> Side by Side Boxplots</a></li>
</ul></li>
<li class="chapter" data-level="21.3" data-path="analyzing-literary-styles-with-multinomial-logistic-regression.html"><a href="analyzing-literary-styles-with-multinomial-logistic-regression.html#a-multinomial-logistic-regression-model"><i class="fa fa-check"></i><b>21.3</b> A Multinomial Logistic Regression Model</a>
<ul>
<li class="chapter" data-level="21.3.1" data-path="analyzing-literary-styles-with-multinomial-logistic-regression.html"><a href="analyzing-literary-styles-with-multinomial-logistic-regression.html#testing-model-1"><i class="fa fa-check"></i><b>21.3.1</b> Testing Model 1</a></li>
</ul></li>
<li class="chapter" data-level="21.4" data-path="analyzing-literary-styles-with-multinomial-logistic-regression.html"><a href="analyzing-literary-styles-with-multinomial-logistic-regression.html#model-2"><i class="fa fa-check"></i><b>21.4</b> Model 2</a>
<ul>
<li class="chapter" data-level="21.4.1" data-path="analyzing-literary-styles-with-multinomial-logistic-regression.html"><a href="analyzing-literary-styles-with-multinomial-logistic-regression.html#comparing-model-2-to-model-1"><i class="fa fa-check"></i><b>21.4.1</b> Comparing Model 2 to Model 1</a></li>
<li class="chapter" data-level="21.4.2" data-path="analyzing-literary-styles-with-multinomial-logistic-regression.html"><a href="analyzing-literary-styles-with-multinomial-logistic-regression.html#testing-model-2"><i class="fa fa-check"></i><b>21.4.2</b> Testing Model 2</a></li>
<li class="chapter" data-level="21.4.3" data-path="analyzing-literary-styles-with-multinomial-logistic-regression.html"><a href="analyzing-literary-styles-with-multinomial-logistic-regression.html#a-little-history"><i class="fa fa-check"></i><b>21.4.3</b> A little history</a></li>
</ul></li>
<li class="chapter" data-level="21.5" data-path="analyzing-literary-styles-with-multinomial-logistic-regression.html"><a href="analyzing-literary-styles-with-multinomial-logistic-regression.html#classification-table"><i class="fa fa-check"></i><b>21.5</b> Classification Table</a></li>
<li class="chapter" data-level="21.6" data-path="analyzing-literary-styles-with-multinomial-logistic-regression.html"><a href="analyzing-literary-styles-with-multinomial-logistic-regression.html#probability-curves-based-on-a-single-predictor"><i class="fa fa-check"></i><b>21.6</b> Probability Curves based on a Single Predictor</a>
<ul>
<li class="chapter" data-level="21.6.1" data-path="analyzing-literary-styles-with-multinomial-logistic-regression.html"><a href="analyzing-literary-styles-with-multinomial-logistic-regression.html#produce-the-plot-of-estimated-probabilities-based-on-been-counts"><i class="fa fa-check"></i><b>21.6.1</b> Produce the Plot of Estimated Probabilities based on “been” counts</a></li>
<li class="chapter" data-level="21.6.2" data-path="analyzing-literary-styles-with-multinomial-logistic-regression.html"><a href="analyzing-literary-styles-with-multinomial-logistic-regression.html#boxplot-of-been-counts"><i class="fa fa-check"></i><b>21.6.2</b> Boxplot of “been” counts</a></li>
<li class="chapter" data-level="21.6.3" data-path="analyzing-literary-styles-with-multinomial-logistic-regression.html"><a href="analyzing-literary-styles-with-multinomial-logistic-regression.html#quote-sources"><i class="fa fa-check"></i><b>21.6.3</b> Quote Sources</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="22" data-path="exploring-time-to-event-survival-data.html"><a href="exploring-time-to-event-survival-data.html"><i class="fa fa-check"></i><b>22</b> Exploring Time To Event / Survival Data</a>
<ul>
<li class="chapter" data-level="22.1" data-path="exploring-time-to-event-survival-data.html"><a href="exploring-time-to-event-survival-data.html#an-outline-of-key-topics-discussed-in-these-notes"><i class="fa fa-check"></i><b>22.1</b> An Outline of Key Topics Discussed in these Notes</a></li>
<li class="chapter" data-level="22.2" data-path="exploring-time-to-event-survival-data.html"><a href="exploring-time-to-event-survival-data.html#foundations-of-survival-analysis"><i class="fa fa-check"></i><b>22.2</b> Foundations of Survival Analysis</a>
<ul>
<li class="chapter" data-level="22.2.1" data-path="exploring-time-to-event-survival-data.html"><a href="exploring-time-to-event-survival-data.html#the-survival-function-st"><i class="fa fa-check"></i><b>22.2.1</b> The Survival Function, <span class="math inline">\(S(t)\)</span></a></li>
<li class="chapter" data-level="22.2.2" data-path="exploring-time-to-event-survival-data.html"><a href="exploring-time-to-event-survival-data.html#kaplan-meier-estimator-of-the-survival-function"><i class="fa fa-check"></i><b>22.2.2</b> Kaplan-Meier Estimator of the Survival Function</a></li>
<li class="chapter" data-level="22.2.3" data-path="exploring-time-to-event-survival-data.html"><a href="exploring-time-to-event-survival-data.html#creating-a-survival-object-in-r"><i class="fa fa-check"></i><b>22.2.3</b> Creating a Survival Object in R</a></li>
</ul></li>
<li class="chapter" data-level="22.3" data-path="exploring-time-to-event-survival-data.html"><a href="exploring-time-to-event-survival-data.html#a-first-example-recurrent-lobar-intracerebral-hemorrhage"><i class="fa fa-check"></i><b>22.3</b> A First Example: Recurrent Lobar Intracerebral Hemorrhage</a>
<ul>
<li class="chapter" data-level="22.3.1" data-path="exploring-time-to-event-survival-data.html"><a href="exploring-time-to-event-survival-data.html#building-a-survival-object"><i class="fa fa-check"></i><b>22.3.1</b> Building a Survival Object</a></li>
<li class="chapter" data-level="22.3.2" data-path="exploring-time-to-event-survival-data.html"><a href="exploring-time-to-event-survival-data.html#kaplan-meier-estimate-of-the-survival-function"><i class="fa fa-check"></i><b>22.3.2</b> Kaplan-Meier Estimate of the Survival Function</a></li>
<li class="chapter" data-level="22.3.3" data-path="exploring-time-to-event-survival-data.html"><a href="exploring-time-to-event-survival-data.html#the-kaplan-meier-plot-using-base-r"><i class="fa fa-check"></i><b>22.3.3</b> The Kaplan-Meier Plot, using Base R</a></li>
<li class="chapter" data-level="22.3.4" data-path="exploring-time-to-event-survival-data.html"><a href="exploring-time-to-event-survival-data.html#using-survminer-to-draw-survival-curves"><i class="fa fa-check"></i><b>22.3.4</b> Using <code>survminer</code> to draw survival curves</a></li>
<li class="chapter" data-level="22.3.5" data-path="exploring-time-to-event-survival-data.html"><a href="exploring-time-to-event-survival-data.html#a-fancy-k-m-plot-with-a-number-at-risk-table"><i class="fa fa-check"></i><b>22.3.5</b> A “Fancy” K-M Plot with a number at risk table</a></li>
</ul></li>
<li class="chapter" data-level="22.4" data-path="exploring-time-to-event-survival-data.html"><a href="exploring-time-to-event-survival-data.html#comparing-survival-across-the-two-genotypes"><i class="fa fa-check"></i><b>22.4</b> Comparing Survival Across the Two Genotypes</a>
<ul>
<li class="chapter" data-level="22.4.1" data-path="exploring-time-to-event-survival-data.html"><a href="exploring-time-to-event-survival-data.html#kaplan-meier-survival-function-estimates-by-genotype"><i class="fa fa-check"></i><b>22.4.1</b> Kaplan-Meier Survival Function Estimates, by Genotype</a></li>
</ul></li>
<li class="chapter" data-level="22.5" data-path="exploring-time-to-event-survival-data.html"><a href="exploring-time-to-event-survival-data.html#testing-the-difference-between-two-survival-curves"><i class="fa fa-check"></i><b>22.5</b> Testing the difference between two survival curves</a>
<ul>
<li class="chapter" data-level="22.5.1" data-path="exploring-time-to-event-survival-data.html"><a href="exploring-time-to-event-survival-data.html#alternative-log-rank-tests"><i class="fa fa-check"></i><b>22.5.1</b> Alternative log rank tests</a></li>
</ul></li>
<li class="chapter" data-level="22.6" data-path="exploring-time-to-event-survival-data.html"><a href="exploring-time-to-event-survival-data.html#a-fancy-k-m-plot-with-a-number-at-risk-table-1"><i class="fa fa-check"></i><b>22.6</b> A “Fancy” K-M Plot with a number at risk table</a>
<ul>
<li class="chapter" data-level="22.6.1" data-path="exploring-time-to-event-survival-data.html"><a href="exploring-time-to-event-survival-data.html#customizing-the-kaplan-meier-plot-presentation-further"><i class="fa fa-check"></i><b>22.6.1</b> Customizing the Kaplan-Meier Plot Presentation Further</a></li>
</ul></li>
<li class="chapter" data-level="22.7" data-path="exploring-time-to-event-survival-data.html"><a href="exploring-time-to-event-survival-data.html#the-hazard-function"><i class="fa fa-check"></i><b>22.7</b> The Hazard Function</a>
<ul>
<li class="chapter" data-level="22.7.1" data-path="exploring-time-to-event-survival-data.html"><a href="exploring-time-to-event-survival-data.html#the-inverse-kaplan-meier-estimator-of-ht"><i class="fa fa-check"></i><b>22.7.1</b> The Inverse Kaplan-Meier Estimator of <span class="math inline">\(H(t)\)</span></a></li>
<li class="chapter" data-level="22.7.2" data-path="exploring-time-to-event-survival-data.html"><a href="exploring-time-to-event-survival-data.html#cumulative-hazard-function-from-inverse-k-m"><i class="fa fa-check"></i><b>22.7.2</b> Cumulative Hazard Function from Inverse K-M</a></li>
<li class="chapter" data-level="22.7.3" data-path="exploring-time-to-event-survival-data.html"><a href="exploring-time-to-event-survival-data.html#the-nelson-aalen-estimator-of-ht"><i class="fa fa-check"></i><b>22.7.3</b> The Nelson-Aalen Estimator of <span class="math inline">\(H(t)\)</span></a></li>
<li class="chapter" data-level="22.7.4" data-path="exploring-time-to-event-survival-data.html"><a href="exploring-time-to-event-survival-data.html#convert-wide-data-to-long"><i class="fa fa-check"></i><b>22.7.4</b> Convert Wide Data to Long</a></li>
<li class="chapter" data-level="22.7.5" data-path="exploring-time-to-event-survival-data.html"><a href="exploring-time-to-event-survival-data.html#plot-comparison-of-hazard-estimates"><i class="fa fa-check"></i><b>22.7.5</b> Plot Comparison of Hazard Estimates</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="23" data-path="cox-regression-models-for-survival-data-example-1.html"><a href="cox-regression-models-for-survival-data-example-1.html"><i class="fa fa-check"></i><b>23</b> Cox Regression Models for Survival Data: Example 1</a>
<ul>
<li class="chapter" data-level="23.1" data-path="cox-regression-models-for-survival-data-example-1.html"><a href="cox-regression-models-for-survival-data-example-1.html#sources-used-in-building-this-material"><i class="fa fa-check"></i><b>23.1</b> Sources used in building this material</a></li>
<li class="chapter" data-level="23.2" data-path="cox-regression-models-for-survival-data-example-1.html"><a href="cox-regression-models-for-survival-data-example-1.html#fitting-a-cox-model-in-r-with-coxph"><i class="fa fa-check"></i><b>23.2</b> Fitting a Cox Model in R with <code>coxph</code></a>
<ul>
<li class="chapter" data-level="23.2.1" data-path="cox-regression-models-for-survival-data-example-1.html"><a href="cox-regression-models-for-survival-data-example-1.html#summarizing-the-fit"><i class="fa fa-check"></i><b>23.2.1</b> Summarizing the Fit</a></li>
<li class="chapter" data-level="23.2.2" data-path="cox-regression-models-for-survival-data-example-1.html"><a href="cox-regression-models-for-survival-data-example-1.html#glancing-at-the-model"><i class="fa fa-check"></i><b>23.2.2</b> Glancing at the model?</a></li>
<li class="chapter" data-level="23.2.3" data-path="cox-regression-models-for-survival-data-example-1.html"><a href="cox-regression-models-for-survival-data-example-1.html#plot-the-baseline-survival-function"><i class="fa fa-check"></i><b>23.2.3</b> Plot the baseline survival function</a></li>
<li class="chapter" data-level="23.2.4" data-path="cox-regression-models-for-survival-data-example-1.html"><a href="cox-regression-models-for-survival-data-example-1.html#plot-the-genotype-effect"><i class="fa fa-check"></i><b>23.2.4</b> Plot the genotype effect</a></li>
<li class="chapter" data-level="23.2.5" data-path="cox-regression-models-for-survival-data-example-1.html"><a href="cox-regression-models-for-survival-data-example-1.html#testing-the-key-assumption-proportional-hazards"><i class="fa fa-check"></i><b>23.2.5</b> Testing the Key Assumption: Proportional Hazards</a></li>
<li class="chapter" data-level="23.2.6" data-path="cox-regression-models-for-survival-data-example-1.html"><a href="cox-regression-models-for-survival-data-example-1.html#plotting-the-cox.zph-results-for-the-cfit-model"><i class="fa fa-check"></i><b>23.2.6</b> Plotting the <code>cox.zph</code> results for the <code>cfit</code> model</a></li>
</ul></li>
<li class="chapter" data-level="23.3" data-path="cox-regression-models-for-survival-data-example-1.html"><a href="cox-regression-models-for-survival-data-example-1.html#fitting-a-cox-model-using-cph-from-the-rms-package"><i class="fa fa-check"></i><b>23.3</b> Fitting a Cox Model using <code>cph</code> from the <code>rms</code> package</a>
<ul>
<li class="chapter" data-level="23.3.1" data-path="cox-regression-models-for-survival-data-example-1.html"><a href="cox-regression-models-for-survival-data-example-1.html#the-main-cph-results"><i class="fa fa-check"></i><b>23.3.1</b> The Main <code>cph</code> results</a></li>
<li class="chapter" data-level="23.3.2" data-path="cox-regression-models-for-survival-data-example-1.html"><a href="cox-regression-models-for-survival-data-example-1.html#using-anova-with-cph"><i class="fa fa-check"></i><b>23.3.2</b> Using <code>anova</code> with <code>cph</code></a></li>
<li class="chapter" data-level="23.3.3" data-path="cox-regression-models-for-survival-data-example-1.html"><a href="cox-regression-models-for-survival-data-example-1.html#effect-sizes-after-cph-fit"><i class="fa fa-check"></i><b>23.3.3</b> Effect Sizes after <code>cph</code> fit</a></li>
<li class="chapter" data-level="23.3.4" data-path="cox-regression-models-for-survival-data-example-1.html"><a href="cox-regression-models-for-survival-data-example-1.html#validating-cph-summaries"><i class="fa fa-check"></i><b>23.3.4</b> Validating <code>cph</code> summaries</a></li>
<li class="chapter" data-level="23.3.5" data-path="cox-regression-models-for-survival-data-example-1.html"><a href="cox-regression-models-for-survival-data-example-1.html#plotting-survival-functions-for-each-genotype"><i class="fa fa-check"></i><b>23.3.5</b> Plotting Survival Functions for each Genotype</a></li>
<li class="chapter" data-level="23.3.6" data-path="cox-regression-models-for-survival-data-example-1.html"><a href="cox-regression-models-for-survival-data-example-1.html#genotypes-effect-on-log-relative-hazard"><i class="fa fa-check"></i><b>23.3.6</b> Genotype’s effect on log relative hazard</a></li>
<li class="chapter" data-level="23.3.7" data-path="cox-regression-models-for-survival-data-example-1.html"><a href="cox-regression-models-for-survival-data-example-1.html#nomogram-of-our-simple-hem-model"><i class="fa fa-check"></i><b>23.3.7</b> Nomogram of our simple <code>hem</code> model</a></li>
<li class="chapter" data-level="23.3.8" data-path="cox-regression-models-for-survival-data-example-1.html"><a href="cox-regression-models-for-survival-data-example-1.html#assessing-the-proportional-hazards-assumption"><i class="fa fa-check"></i><b>23.3.8</b> Assessing the Proportional Hazards Assumption</a></li>
<li class="chapter" data-level="23.3.9" data-path="cox-regression-models-for-survival-data-example-1.html"><a href="cox-regression-models-for-survival-data-example-1.html#plot-to-check-ph-assumption"><i class="fa fa-check"></i><b>23.3.9</b> Plot to Check PH Assumption</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="24" data-path="cox-regression-models-for-survival-data-example-2.html"><a href="cox-regression-models-for-survival-data-example-2.html"><i class="fa fa-check"></i><b>24</b> Cox Regression Models for Survival Data: Example 2</a>
<ul>
<li class="chapter" data-level="24.1" data-path="cox-regression-models-for-survival-data-example-2.html"><a href="cox-regression-models-for-survival-data-example-2.html#a-second-example-the-leukem-data"><i class="fa fa-check"></i><b>24.1</b> A Second Example: The <code>leukem</code> data</a>
<ul>
<li class="chapter" data-level="24.1.1" data-path="cox-regression-models-for-survival-data-example-2.html"><a href="cox-regression-models-for-survival-data-example-2.html#creating-our-response-a-survival-time-object"><i class="fa fa-check"></i><b>24.1.1</b> Creating our response: A survival time object</a></li>
<li class="chapter" data-level="24.1.2" data-path="cox-regression-models-for-survival-data-example-2.html"><a href="cox-regression-models-for-survival-data-example-2.html#models-well-fit"><i class="fa fa-check"></i><b>24.1.2</b> Models We’ll Fit</a></li>
</ul></li>
<li class="chapter" data-level="24.2" data-path="cox-regression-models-for-survival-data-example-2.html"><a href="cox-regression-models-for-survival-data-example-2.html#model-a-coxph-model-for-survival-time-using-age-at-diagnosis"><i class="fa fa-check"></i><b>24.2</b> Model A: <code>coxph</code> Model for Survival Time using <code>age</code> at diagnosis</a>
<ul>
<li class="chapter" data-level="24.2.1" data-path="cox-regression-models-for-survival-data-example-2.html"><a href="cox-regression-models-for-survival-data-example-2.html#plotting-the-survival-curve-implied-by-model-a"><i class="fa fa-check"></i><b>24.2.1</b> Plotting the Survival Curve implied by Model A</a></li>
<li class="chapter" data-level="24.2.2" data-path="cox-regression-models-for-survival-data-example-2.html"><a href="cox-regression-models-for-survival-data-example-2.html#testing-the-proportional-hazards-assumption"><i class="fa fa-check"></i><b>24.2.2</b> Testing the Proportional Hazards Assumption</a></li>
</ul></li>
<li class="chapter" data-level="24.3" data-path="cox-regression-models-for-survival-data-example-2.html"><a href="cox-regression-models-for-survival-data-example-2.html#building-model-a-with-cph-for-the-leukem-data"><i class="fa fa-check"></i><b>24.3</b> Building Model A with <code>cph</code> for the <code>leukem</code> data</a>
<ul>
<li class="chapter" data-level="24.3.1" data-path="cox-regression-models-for-survival-data-example-2.html"><a href="cox-regression-models-for-survival-data-example-2.html#plotting-the-age-effect-implied-by-our-model."><i class="fa fa-check"></i><b>24.3.1</b> Plotting the <code>age</code> effect implied by our model.</a></li>
<li class="chapter" data-level="24.3.2" data-path="cox-regression-models-for-survival-data-example-2.html"><a href="cox-regression-models-for-survival-data-example-2.html#survival-plots-kaplan-meier-of-the-age-effect"><i class="fa fa-check"></i><b>24.3.2</b> Survival Plots (Kaplan-Meier) of the <code>age</code> effect</a></li>
<li class="chapter" data-level="24.3.3" data-path="cox-regression-models-for-survival-data-example-2.html"><a href="cox-regression-models-for-survival-data-example-2.html#anova-test-for-the-cph-built-model-for-leukem"><i class="fa fa-check"></i><b>24.3.3</b> ANOVA test for the <code>cph</code>-built model for <code>leukem</code></a></li>
<li class="chapter" data-level="24.3.4" data-path="cox-regression-models-for-survival-data-example-2.html"><a href="cox-regression-models-for-survival-data-example-2.html#summarizing-the-effect-sizes-from-moda_cph"><i class="fa fa-check"></i><b>24.3.4</b> Summarizing the Effect Sizes from <code>modA_cph</code></a></li>
<li class="chapter" data-level="24.3.5" data-path="cox-regression-models-for-survival-data-example-2.html"><a href="cox-regression-models-for-survival-data-example-2.html#validating-the-cox-model-summary-statistics"><i class="fa fa-check"></i><b>24.3.5</b> Validating the Cox Model Summary Statistics</a></li>
<li class="chapter" data-level="24.3.6" data-path="cox-regression-models-for-survival-data-example-2.html"><a href="cox-regression-models-for-survival-data-example-2.html#looking-for-influential-points"><i class="fa fa-check"></i><b>24.3.6</b> Looking for Influential Points</a></li>
<li class="chapter" data-level="24.3.7" data-path="cox-regression-models-for-survival-data-example-2.html"><a href="cox-regression-models-for-survival-data-example-2.html#checking-the-proportional-hazards-assumption"><i class="fa fa-check"></i><b>24.3.7</b> Checking the Proportional Hazards Assumption</a></li>
</ul></li>
<li class="chapter" data-level="24.4" data-path="cox-regression-models-for-survival-data-example-2.html"><a href="cox-regression-models-for-survival-data-example-2.html#model-b-fitting-a-5-predictor-model-with-coxph"><i class="fa fa-check"></i><b>24.4</b> Model B: Fitting a 5-Predictor Model with <code>coxph</code></a>
<ul>
<li class="chapter" data-level="24.4.1" data-path="cox-regression-models-for-survival-data-example-2.html"><a href="cox-regression-models-for-survival-data-example-2.html#interpreting-the-results-from-model-b"><i class="fa fa-check"></i><b>24.4.1</b> Interpreting the Results from Model B</a></li>
<li class="chapter" data-level="24.4.2" data-path="cox-regression-models-for-survival-data-example-2.html"><a href="cox-regression-models-for-survival-data-example-2.html#plotting-the-survival-curve-implied-by-model-b"><i class="fa fa-check"></i><b>24.4.2</b> Plotting the Survival Curve implied by Model B</a></li>
<li class="chapter" data-level="24.4.3" data-path="cox-regression-models-for-survival-data-example-2.html"><a href="cox-regression-models-for-survival-data-example-2.html#testing-the-proportional-hazards-assumption-1"><i class="fa fa-check"></i><b>24.4.3</b> Testing the Proportional Hazards Assumption</a></li>
<li class="chapter" data-level="24.4.4" data-path="cox-regression-models-for-survival-data-example-2.html"><a href="cox-regression-models-for-survival-data-example-2.html#assessing-collinearity"><i class="fa fa-check"></i><b>24.4.4</b> Assessing Collinearity</a></li>
</ul></li>
<li class="chapter" data-level="24.5" data-path="cox-regression-models-for-survival-data-example-2.html"><a href="cox-regression-models-for-survival-data-example-2.html#model-b2-a-stepwise-reduction-of-model-b"><i class="fa fa-check"></i><b>24.5</b> Model B2: A Stepwise Reduction of Model B</a>
<ul>
<li class="chapter" data-level="24.5.1" data-path="cox-regression-models-for-survival-data-example-2.html"><a href="cox-regression-models-for-survival-data-example-2.html#the-survival-curve-implied-by-model-b2"><i class="fa fa-check"></i><b>24.5.1</b> The Survival Curve implied by Model B2</a></li>
<li class="chapter" data-level="24.5.2" data-path="cox-regression-models-for-survival-data-example-2.html"><a href="cox-regression-models-for-survival-data-example-2.html#checking-proportional-hazards-for-model-b2"><i class="fa fa-check"></i><b>24.5.2</b> Checking Proportional Hazards for Model B2</a></li>
</ul></li>
<li class="chapter" data-level="24.6" data-path="cox-regression-models-for-survival-data-example-2.html"><a href="cox-regression-models-for-survival-data-example-2.html#model-c-using-a-spearman-plot-to-pick-a-model"><i class="fa fa-check"></i><b>24.6</b> Model C: Using a Spearman Plot to pick a model</a>
<ul>
<li class="chapter" data-level="24.6.1" data-path="cox-regression-models-for-survival-data-example-2.html"><a href="cox-regression-models-for-survival-data-example-2.html#fitting-model-c"><i class="fa fa-check"></i><b>24.6.1</b> Fitting Model C</a></li>
<li class="chapter" data-level="24.6.2" data-path="cox-regression-models-for-survival-data-example-2.html"><a href="cox-regression-models-for-survival-data-example-2.html#anova-for-model-c"><i class="fa fa-check"></i><b>24.6.2</b> ANOVA for Model C</a></li>
<li class="chapter" data-level="24.6.3" data-path="cox-regression-models-for-survival-data-example-2.html"><a href="cox-regression-models-for-survival-data-example-2.html#summarizing-model-c-effect-sizes"><i class="fa fa-check"></i><b>24.6.3</b> Summarizing Model C Effect Sizes</a></li>
<li class="chapter" data-level="24.6.4" data-path="cox-regression-models-for-survival-data-example-2.html"><a href="cox-regression-models-for-survival-data-example-2.html#plotting-the-diagnosis-age-effect-in-model-c"><i class="fa fa-check"></i><b>24.6.4</b> Plotting the diagnosis <code>age</code> effect in Model C</a></li>
<li class="chapter" data-level="24.6.5" data-path="cox-regression-models-for-survival-data-example-2.html"><a href="cox-regression-models-for-survival-data-example-2.html#survival-plot-associated-with-model-c"><i class="fa fa-check"></i><b>24.6.5</b> Survival Plot associated with Model C</a></li>
<li class="chapter" data-level="24.6.6" data-path="cox-regression-models-for-survival-data-example-2.html"><a href="cox-regression-models-for-survival-data-example-2.html#checking-the-proportional-hazards-assumption-1"><i class="fa fa-check"></i><b>24.6.6</b> Checking the Proportional Hazards Assumption</a></li>
<li class="chapter" data-level="24.6.7" data-path="cox-regression-models-for-survival-data-example-2.html"><a href="cox-regression-models-for-survival-data-example-2.html#model-c-nomogram"><i class="fa fa-check"></i><b>24.6.7</b> Model C Nomogram</a></li>
<li class="chapter" data-level="24.6.8" data-path="cox-regression-models-for-survival-data-example-2.html"><a href="cox-regression-models-for-survival-data-example-2.html#validating-model-cs-summary-statistics"><i class="fa fa-check"></i><b>24.6.8</b> Validating Model C’s Summary Statistics</a></li>
<li class="chapter" data-level="24.6.9" data-path="cox-regression-models-for-survival-data-example-2.html"><a href="cox-regression-models-for-survival-data-example-2.html#calibration-of-model-c-12-month-survival-estimates"><i class="fa fa-check"></i><b>24.6.9</b> Calibration of Model C (12-month survival estimates)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Data Science for Biological, Medical and Health Research: Notes for 432</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="modeling-an-ordinal-categorical-outcome-in-ohio-smart" class="section level1" number="20">
<h1><span class="header-section-number">Chapter 20</span> Modeling an Ordinal Categorical Outcome in Ohio SMART</h1>
<div id="preliminaries-1" class="section level2" number="20.1">
<h2><span class="header-section-number">20.1</span> Preliminaries</h2>
<div class="sourceCode" id="cb1319"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1319-1"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#cb1319-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gmodels)</span>
<span id="cb1319-2"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#cb1319-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(nnet)</span></code></pre></div>
<div class="sourceCode" id="cb1320"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1320-1"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#cb1320-1" aria-hidden="true" tabindex="-1"></a>smart_oh <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="fu">here</span>(<span class="st">&quot;data&quot;</span>, <span class="st">&quot;smart_ohio.Rds&quot;</span>))</span></code></pre></div>
</div>
<div id="a-subset-of-the-ohio-smart-data-1" class="section level2" number="20.2">
<h2><span class="header-section-number">20.2</span> A subset of the Ohio SMART data</h2>
<p>Let’s consider the following data. The outcome we’ll study now is <code>genhealth</code>, which has five ordered categories. I’ll include the subset of all observations in <code>smart_oh</code> with complete data on these 7 variables.</p>
<table>
<colgroup>
<col width="16%" />
<col width="83%" />
</colgroup>
<thead>
<tr class="header">
<th align="right">Variable</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right"><code>SEQNO</code></td>
<td>Subject identification code</td>
</tr>
<tr class="even">
<td align="right"><code>genhealth</code></td>
<td>Five categories (1 = Excellent, 2 = Very Good, 3 = Good, 4 = Fair, 5 = Poor) on general health</td>
</tr>
<tr class="odd">
<td align="right"><code>physhealth</code></td>
<td>Now thinking about your physical health, which includes physical illness and injury, for how many days during the past 30 days was your physical health not good?</td>
</tr>
<tr class="even">
<td align="right"><code>veg_day</code></td>
<td>mean number of vegetable servings consumed per day</td>
</tr>
<tr class="odd">
<td align="right"><code>costprob</code></td>
<td>1 indicates Yes to “Was there a time in the past 12 months when you needed to see a doctor but could not because of cost?” and 0 otherwise.</td>
</tr>
<tr class="even">
<td align="right"><code>incomegroup</code></td>
<td>8 income groups from &lt; 10,000 to 75,000 or more</td>
</tr>
<tr class="odd">
<td align="right"><code>bmi</code></td>
<td>body-mass index</td>
</tr>
</tbody>
</table>
<p>To make my life easier later, I’m going to drop any subjects with missing data on these variables. I’m also going to drop the subjects who have no missing data, but have a listed <code>bmi</code> above 60.</p>
<div class="sourceCode" id="cb1321"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1321-1"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#cb1321-1" aria-hidden="true" tabindex="-1"></a>sm1 <span class="ot">&lt;-</span> smart_oh <span class="sc">%&gt;%</span></span>
<span id="cb1321-2"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#cb1321-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(SEQNO, genhealth, physhealth, costprob, veg_day,</span>
<span id="cb1321-3"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#cb1321-3" aria-hidden="true" tabindex="-1"></a>           incomegroup, bmi) <span class="sc">%&gt;%</span></span>
<span id="cb1321-4"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#cb1321-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(bmi <span class="sc">&lt;=</span> <span class="dv">60</span>) <span class="sc">%&gt;%</span></span>
<span id="cb1321-5"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#cb1321-5" aria-hidden="true" tabindex="-1"></a>    drop_na</span></code></pre></div>
<p>In total, we have 5394 subjects in the <code>sm1</code> sample.</p>
<div id="several-ways-of-storing-multi-categorical-data" class="section level3" number="20.2.1">
<h3><span class="header-section-number">20.2.1</span> Several Ways of Storing Multi-Categorical data</h3>
<p>We will store the information in our outcome, <code>genhealth</code> in both a numeric form (<code>gen_n</code>) and an ordered factor (<code>gen_h</code>) with some abbreviated labels) because we’ll have some use for each approach in this material.</p>
<div class="sourceCode" id="cb1322"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1322-1"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#cb1322-1" aria-hidden="true" tabindex="-1"></a>sm1 <span class="ot">&lt;-</span> sm1 <span class="sc">%&gt;%</span></span>
<span id="cb1322-2"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#cb1322-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">genh =</span> <span class="fu">fct_recode</span>(genhealth,</span>
<span id="cb1322-3"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#cb1322-3" aria-hidden="true" tabindex="-1"></a>                             <span class="st">&quot;1-E&quot;</span> <span class="ot">=</span> <span class="st">&quot;1_Excellent&quot;</span>,</span>
<span id="cb1322-4"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#cb1322-4" aria-hidden="true" tabindex="-1"></a>                             <span class="st">&quot;2_VG&quot;</span> <span class="ot">=</span> <span class="st">&quot;2_VeryGood&quot;</span>,</span>
<span id="cb1322-5"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#cb1322-5" aria-hidden="true" tabindex="-1"></a>                             <span class="st">&quot;3_G&quot;</span> <span class="ot">=</span> <span class="st">&quot;3_Good&quot;</span>,</span>
<span id="cb1322-6"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#cb1322-6" aria-hidden="true" tabindex="-1"></a>                             <span class="st">&quot;4_F&quot;</span> <span class="ot">=</span> <span class="st">&quot;4_Fair&quot;</span>,</span>
<span id="cb1322-7"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#cb1322-7" aria-hidden="true" tabindex="-1"></a>                             <span class="st">&quot;5_P&quot;</span> <span class="ot">=</span> <span class="st">&quot;5_Poor&quot;</span>),</span>
<span id="cb1322-8"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#cb1322-8" aria-hidden="true" tabindex="-1"></a>           <span class="at">genh =</span> <span class="fu">factor</span>(genh, <span class="at">ordered =</span> <span class="cn">TRUE</span>),</span>
<span id="cb1322-9"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#cb1322-9" aria-hidden="true" tabindex="-1"></a>           <span class="at">gen_n =</span> <span class="fu">as.numeric</span>(genhealth))</span>
<span id="cb1322-10"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#cb1322-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1322-11"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#cb1322-11" aria-hidden="true" tabindex="-1"></a>sm1 <span class="sc">%&gt;%</span> <span class="fu">count</span>(genh, gen_n, genhealth)</span></code></pre></div>
<pre><code># A tibble: 5 x 4
  genh  gen_n genhealth       n
  &lt;ord&gt; &lt;dbl&gt; &lt;fct&gt;       &lt;int&gt;
1 1-E       1 1_Excellent   822
2 2_VG      2 2_VeryGood   1805
3 3_G       3 3_Good       1667
4 4_F       4 4_Fair        801
5 5_P       5 5_Poor        299</code></pre>
</div>
</div>
<div id="building-cross-tabulations" class="section level2" number="20.3">
<h2><span class="header-section-number">20.3</span> Building Cross-Tabulations</h2>
<p>Is income group associated with general health?</p>
<div id="using-base-table-functions" class="section level3" number="20.3.1">
<h3><span class="header-section-number">20.3.1</span> Using base <code>table</code> functions</h3>
<div class="sourceCode" id="cb1324"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1324-1"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#cb1324-1" aria-hidden="true" tabindex="-1"></a><span class="fu">addmargins</span>(<span class="fu">table</span>(sm1<span class="sc">$</span>incomegroup, sm1<span class="sc">$</span>genh))</span></code></pre></div>
<pre><code>        
          1-E 2_VG  3_G  4_F  5_P  Sum
  0-9K     14   45   60   74   40  233
  10-14K   12   41   66   93   46  258
  15-19K   40   76  119   96   61  392
  20-24K   51  129  175  100   50  505
  25-34K   51  172  215  123   36  597
  35-49K   97  270  303  118   24  812
  50-74K  128  337  265   94   16  840
  75K+    429  735  464  103   26 1757
  Sum     822 1805 1667  801  299 5394</code></pre>
<p>More people answer Very Good and Good than choose the other categories. It might be easier to look at percentages here.</p>
<div id="adding-percentages-within-each-row" class="section level4" number="20.3.1.1">
<h4><span class="header-section-number">20.3.1.1</span> Adding percentages within each row</h4>
<p>Here are the percentages giving each <code>genhealth</code> response within each income group.</p>
<div class="sourceCode" id="cb1326"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1326-1"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#cb1326-1" aria-hidden="true" tabindex="-1"></a><span class="fu">addmargins</span>(</span>
<span id="cb1326-2"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#cb1326-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(<span class="dv">100</span><span class="sc">*</span><span class="fu">prop.table</span>(</span>
<span id="cb1326-3"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#cb1326-3" aria-hidden="true" tabindex="-1"></a>        <span class="fu">table</span>(sm1<span class="sc">$</span>incomegroup, sm1<span class="sc">$</span>genh)</span>
<span id="cb1326-4"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#cb1326-4" aria-hidden="true" tabindex="-1"></a>        ,<span class="dv">1</span>)</span>
<span id="cb1326-5"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#cb1326-5" aria-hidden="true" tabindex="-1"></a>        ,<span class="dv">1</span>)</span>
<span id="cb1326-6"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#cb1326-6" aria-hidden="true" tabindex="-1"></a>    )</span></code></pre></div>
<pre><code>        
           1-E  2_VG   3_G   4_F   5_P   Sum
  0-9K     6.0  19.3  25.8  31.8  17.2 100.1
  10-14K   4.7  15.9  25.6  36.0  17.8 100.0
  15-19K  10.2  19.4  30.4  24.5  15.6 100.1
  20-24K  10.1  25.5  34.7  19.8   9.9 100.0
  25-34K   8.5  28.8  36.0  20.6   6.0  99.9
  35-49K  11.9  33.3  37.3  14.5   3.0 100.0
  50-74K  15.2  40.1  31.5  11.2   1.9  99.9
  75K+    24.4  41.8  26.4   5.9   1.5 100.0
  Sum     91.0 224.1 247.7 164.3  72.9 800.0</code></pre>
<p>So, for example, 11.3% of the <code>genhealth</code> responses in subjects with incomes between 25 and 34 thousand dollars were Excellent.</p>
</div>
<div id="adding-percentages-within-each-column" class="section level4" number="20.3.1.2">
<h4><span class="header-section-number">20.3.1.2</span> Adding percentages within each column</h4>
<p>Here are the percentages in each <code>incomegroup</code> within each <code>genhealth</code> response.</p>
<div class="sourceCode" id="cb1328"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1328-1"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#cb1328-1" aria-hidden="true" tabindex="-1"></a><span class="fu">addmargins</span>(</span>
<span id="cb1328-2"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#cb1328-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(<span class="dv">100</span><span class="sc">*</span><span class="fu">prop.table</span>(</span>
<span id="cb1328-3"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#cb1328-3" aria-hidden="true" tabindex="-1"></a>        <span class="fu">table</span>(sm1<span class="sc">$</span>incomegroup, sm1<span class="sc">$</span>genh)</span>
<span id="cb1328-4"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#cb1328-4" aria-hidden="true" tabindex="-1"></a>        ,<span class="dv">2</span>)</span>
<span id="cb1328-5"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#cb1328-5" aria-hidden="true" tabindex="-1"></a>        ,<span class="dv">1</span>)</span>
<span id="cb1328-6"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#cb1328-6" aria-hidden="true" tabindex="-1"></a>    )</span></code></pre></div>
<pre><code>        
           1-E  2_VG   3_G   4_F   5_P   Sum
  0-9K     1.7   2.5   3.6   9.2  13.4  30.4
  10-14K   1.5   2.3   4.0  11.6  15.4  34.8
  15-19K   4.9   4.2   7.1  12.0  20.4  48.6
  20-24K   6.2   7.1  10.5  12.5  16.7  53.0
  25-34K   6.2   9.5  12.9  15.4  12.0  56.0
  35-49K  11.8  15.0  18.2  14.7   8.0  67.7
  50-74K  15.6  18.7  15.9  11.7   5.4  67.3
  75K+    52.2  40.7  27.8  12.9   8.7 142.3
  Sum    100.1 100.0 100.0 100.0 100.0 500.1</code></pre>
<p>From this table, we see that 7.4% of the Excellent <code>genhealth</code> responses were given by people with incomes between 25 and 34 thousand dollars.</p>
</div>
</div>
<div id="using-xtabs" class="section level3" number="20.3.2">
<h3><span class="header-section-number">20.3.2</span> Using <code>xtabs</code></h3>
<p>The <code>xtabs</code> function provides a formula method for obtaining cross-tabulations.</p>
<div class="sourceCode" id="cb1330"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1330-1"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#cb1330-1" aria-hidden="true" tabindex="-1"></a><span class="fu">xtabs</span>(<span class="sc">~</span> incomegroup <span class="sc">+</span> genh, <span class="at">data =</span> sm1)</span></code></pre></div>
<pre><code>           genh
incomegroup 1-E 2_VG 3_G 4_F 5_P
     0-9K    14   45  60  74  40
     10-14K  12   41  66  93  46
     15-19K  40   76 119  96  61
     20-24K  51  129 175 100  50
     25-34K  51  172 215 123  36
     35-49K  97  270 303 118  24
     50-74K 128  337 265  94  16
     75K+   429  735 464 103  26</code></pre>
</div>
<div id="storing-a-table-in-a-tibble" class="section level3" number="20.3.3">
<h3><span class="header-section-number">20.3.3</span> Storing a table in a tibble</h3>
<p>We can store the elements of a cross-tabulation in a tibble, like this:</p>
<div class="sourceCode" id="cb1332"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1332-1"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#cb1332-1" aria-hidden="true" tabindex="-1"></a>(sm1.tableA <span class="ot">&lt;-</span> sm1 <span class="sc">%&gt;%</span> <span class="fu">count</span>(incomegroup, genh))</span></code></pre></div>
<pre><code># A tibble: 40 x 3
   incomegroup genh      n
   &lt;fct&gt;       &lt;ord&gt; &lt;int&gt;
 1 0-9K        1-E      14
 2 0-9K        2_VG     45
 3 0-9K        3_G      60
 4 0-9K        4_F      74
 5 0-9K        5_P      40
 6 10-14K      1-E      12
 7 10-14K      2_VG     41
 8 10-14K      3_G      66
 9 10-14K      4_F      93
10 10-14K      5_P      46
# ... with 30 more rows</code></pre>
<p>From such a tibble, we can visualize the data in many ways, but we can also return to <code>xtabs</code> and include the frequencies (<code>n</code>) in that setup.</p>
<div class="sourceCode" id="cb1334"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1334-1"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#cb1334-1" aria-hidden="true" tabindex="-1"></a><span class="fu">xtabs</span>(n <span class="sc">~</span> incomegroup <span class="sc">+</span> genh, <span class="at">data =</span> sm1.tableA)</span></code></pre></div>
<pre><code>           genh
incomegroup 1-E 2_VG 3_G 4_F 5_P
     0-9K    14   45  60  74  40
     10-14K  12   41  66  93  46
     15-19K  40   76 119  96  61
     20-24K  51  129 175 100  50
     25-34K  51  172 215 123  36
     35-49K  97  270 303 118  24
     50-74K 128  337 265  94  16
     75K+   429  735 464 103  26</code></pre>
<p>And, we can get the <span class="math inline">\(\chi^2\)</span> test of independence, with:</p>
<div class="sourceCode" id="cb1336"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1336-1"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#cb1336-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">xtabs</span>(n <span class="sc">~</span> incomegroup <span class="sc">+</span> genh, <span class="at">data =</span> sm1.tableA))</span></code></pre></div>
<pre><code>Call: xtabs(formula = n ~ incomegroup + genh, data = sm1.tableA)
Number of cases in table: 5394 
Number of factors: 2 
Test for independence of all factors:
    Chisq = 894.2, df = 28, p-value = 3.216e-170</code></pre>
</div>
<div id="using-crosstable-from-the-gmodels-package" class="section level3" number="20.3.4">
<h3><span class="header-section-number">20.3.4</span> Using <code>CrossTable</code> from the <code>gmodels</code> package</h3>
<p>The <code>CrossTable</code> function from the <code>gmodels</code> package produces a cross-tabulation with various counts and proportions like people often generate with SPSS and SAS.</p>
<div class="sourceCode" id="cb1338"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1338-1"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#cb1338-1" aria-hidden="true" tabindex="-1"></a><span class="fu">CrossTable</span>(sm1<span class="sc">$</span>incomegroup, sm1<span class="sc">$</span>genh, <span class="at">chisq =</span> T)</span></code></pre></div>
<pre><code>
 
   Cell Contents
|-------------------------|
|                       N |
| Chi-square contribution |
|           N / Row Total |
|           N / Col Total |
|         N / Table Total |
|-------------------------|

 
Total Observations in Table:  5394 

 
                | sm1$genh 
sm1$incomegroup |       1-E |      2_VG |       3_G |       4_F |       5_P | Row Total | 
----------------|-----------|-----------|-----------|-----------|-----------|-----------|
           0-9K |        14 |        45 |        60 |        74 |        40 |       233 | 
                |    13.027 |    13.941 |     2.002 |    44.865 |    56.796 |           | 
                |     0.060 |     0.193 |     0.258 |     0.318 |     0.172 |     0.043 | 
                |     0.017 |     0.025 |     0.036 |     0.092 |     0.134 |           | 
                |     0.003 |     0.008 |     0.011 |     0.014 |     0.007 |           | 
----------------|-----------|-----------|-----------|-----------|-----------|-----------|
         10-14K |        12 |        41 |        66 |        93 |        46 |       258 | 
                |    18.980 |    23.806 |     2.366 |    78.061 |    70.259 |           | 
                |     0.047 |     0.159 |     0.256 |     0.360 |     0.178 |     0.048 | 
                |     0.015 |     0.023 |     0.040 |     0.116 |     0.154 |           | 
                |     0.002 |     0.008 |     0.012 |     0.017 |     0.009 |           | 
----------------|-----------|-----------|-----------|-----------|-----------|-----------|
         15-19K |        40 |        76 |       119 |        96 |        61 |       392 | 
                |     6.521 |    23.208 |     0.038 |    24.531 |    70.973 |           | 
                |     0.102 |     0.194 |     0.304 |     0.245 |     0.156 |     0.073 | 
                |     0.049 |     0.042 |     0.071 |     0.120 |     0.204 |           | 
                |     0.007 |     0.014 |     0.022 |     0.018 |     0.011 |           | 
----------------|-----------|-----------|-----------|-----------|-----------|-----------|
         20-24K |        51 |       129 |       175 |       100 |        50 |       505 | 
                |     8.756 |     9.463 |     2.296 |     8.340 |    17.301 |           | 
                |     0.101 |     0.255 |     0.347 |     0.198 |     0.099 |     0.094 | 
                |     0.062 |     0.071 |     0.105 |     0.125 |     0.167 |           | 
                |     0.009 |     0.024 |     0.032 |     0.019 |     0.009 |           | 
----------------|-----------|-----------|-----------|-----------|-----------|-----------|
         25-34K |        51 |       172 |       215 |       123 |        36 |       597 | 
                |    17.567 |     3.862 |     5.042 |    13.307 |     0.255 |           | 
                |     0.085 |     0.288 |     0.360 |     0.206 |     0.060 |     0.111 | 
                |     0.062 |     0.095 |     0.129 |     0.154 |     0.120 |           | 
                |     0.009 |     0.032 |     0.040 |     0.023 |     0.007 |           | 
----------------|-----------|-----------|-----------|-----------|-----------|-----------|
         35-49K |        97 |       270 |       303 |       118 |        24 |       812 | 
                |     5.779 |     0.011 |    10.798 |     0.055 |     9.808 |           | 
                |     0.119 |     0.333 |     0.373 |     0.145 |     0.030 |     0.151 | 
                |     0.118 |     0.150 |     0.182 |     0.147 |     0.080 |           | 
                |     0.018 |     0.050 |     0.056 |     0.022 |     0.004 |           | 
----------------|-----------|-----------|-----------|-----------|-----------|-----------|
         50-74K |       128 |       337 |       265 |        94 |        16 |       840 | 
                |     0.000 |    11.121 |     0.112 |     7.575 |    20.061 |           | 
                |     0.152 |     0.401 |     0.315 |     0.112 |     0.019 |     0.156 | 
                |     0.156 |     0.187 |     0.159 |     0.117 |     0.054 |           | 
                |     0.024 |     0.062 |     0.049 |     0.017 |     0.003 |           | 
----------------|-----------|-----------|-----------|-----------|-----------|-----------|
           75K+ |       429 |       735 |       464 |       103 |        26 |      1757 | 
                |    97.108 |    36.780 |    11.492 |    95.573 |    52.335 |           | 
                |     0.244 |     0.418 |     0.264 |     0.059 |     0.015 |     0.326 | 
                |     0.522 |     0.407 |     0.278 |     0.129 |     0.087 |           | 
                |     0.080 |     0.136 |     0.086 |     0.019 |     0.005 |           | 
----------------|-----------|-----------|-----------|-----------|-----------|-----------|
   Column Total |       822 |      1805 |      1667 |       801 |       299 |      5394 | 
                |     0.152 |     0.335 |     0.309 |     0.148 |     0.055 |           | 
----------------|-----------|-----------|-----------|-----------|-----------|-----------|

 
Statistics for All Table Factors


Pearson&#39;s Chi-squared test 
------------------------------------------------------------
Chi^2 =  894.1685     d.f. =  28     p =  3.216132e-170 


 </code></pre>
</div>
</div>
<div id="graphing-categorical-data" class="section level2" number="20.4">
<h2><span class="header-section-number">20.4</span> Graphing Categorical Data</h2>
<div id="a-bar-chart-for-a-single-variable" class="section level3" number="20.4.1">
<h3><span class="header-section-number">20.4.1</span> A Bar Chart for a Single Variable</h3>
<div class="sourceCode" id="cb1340"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1340-1"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#cb1340-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(sm1, <span class="fu">aes</span>(<span class="at">x =</span> genhealth, <span class="at">fill =</span> genhealth)) <span class="sc">+</span> </span>
<span id="cb1340-2"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#cb1340-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_bar</span>() <span class="sc">+</span></span>
<span id="cb1340-3"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#cb1340-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">&quot;Set1&quot;</span>) <span class="sc">+</span></span>
<span id="cb1340-4"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#cb1340-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">guides</span>(<span class="at">fill =</span> <span class="st">&quot;none&quot;</span>)</span></code></pre></div>
<p><img src="432-notes_files/figure-html/unnamed-chunk-550-1.png" width="672" /></p>
<p>or, you might prefer to plot percentages, perhaps like this:</p>
<div class="sourceCode" id="cb1341"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1341-1"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#cb1341-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(sm1, <span class="fu">aes</span>(<span class="at">x =</span> genhealth, <span class="at">fill =</span> genhealth)) <span class="sc">+</span> </span>
<span id="cb1341-2"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#cb1341-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">y =</span> (..count..)<span class="sc">/</span><span class="fu">sum</span>(..count..))) <span class="sc">+</span></span>
<span id="cb1341-3"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#cb1341-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">y =</span> (..count..)<span class="sc">/</span><span class="fu">sum</span>(..count..), </span>
<span id="cb1341-4"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#cb1341-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">label =</span> scales<span class="sc">::</span><span class="fu">percent</span>((..count..) <span class="sc">/</span> </span>
<span id="cb1341-5"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#cb1341-5" aria-hidden="true" tabindex="-1"></a>                                        <span class="fu">sum</span>(..count..))),</span>
<span id="cb1341-6"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#cb1341-6" aria-hidden="true" tabindex="-1"></a>              <span class="at">stat =</span> <span class="st">&quot;count&quot;</span>, <span class="at">vjust =</span> <span class="dv">1</span>, </span>
<span id="cb1341-7"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#cb1341-7" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">&quot;white&quot;</span>, <span class="at">size =</span> <span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb1341-8"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#cb1341-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span>percent) <span class="sc">+</span></span>
<span id="cb1341-9"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#cb1341-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">&quot;Dark2&quot;</span>) <span class="sc">+</span></span>
<span id="cb1341-10"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#cb1341-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">guides</span>(<span class="at">fill =</span> <span class="st">&quot;none&quot;</span>) <span class="sc">+</span> </span>
<span id="cb1341-11"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#cb1341-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&quot;Percentage&quot;</span>)</span></code></pre></div>
<p><img src="432-notes_files/figure-html/unnamed-chunk-551-1.png" width="672" /></p>
<p>Use bar charts, rather than pie charts.</p>
</div>
<div id="a-counts-chart-for-a-2-way-cross-tabulation" class="section level3" number="20.4.2">
<h3><span class="header-section-number">20.4.2</span> A Counts Chart for a 2-Way Cross-Tabulation</h3>
<div class="sourceCode" id="cb1342"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1342-1"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#cb1342-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(sm1, <span class="fu">aes</span>(<span class="at">x =</span> genhealth, <span class="at">y =</span> incomegroup)) <span class="sc">+</span> </span>
<span id="cb1342-2"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#cb1342-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_count</span>() </span></code></pre></div>
<p><img src="432-notes_files/figure-html/unnamed-chunk-552-1.png" width="672" /></p>
</div>
</div>
<div id="building-a-model-for-genh-using-veg_day" class="section level2" number="20.5">
<h2><span class="header-section-number">20.5</span> Building a Model for <code>genh</code> using <code>veg_day</code></h2>
<p>To begin, we’ll predict each subject’s <code>genh</code> response using just one predictor, <code>veg_day</code>.</p>
<div id="a-little-eda" class="section level3" number="20.5.1">
<h3><span class="header-section-number">20.5.1</span> A little EDA</h3>
<p>Let’s start with a quick table of summary statistics.</p>
<div class="sourceCode" id="cb1343"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1343-1"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#cb1343-1" aria-hidden="true" tabindex="-1"></a>sm1 <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(genh) <span class="sc">%&gt;%</span></span>
<span id="cb1343-2"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#cb1343-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="fu">n</span>(), <span class="fu">mean</span>(veg_day), <span class="fu">sd</span>(veg_day), <span class="fu">median</span>(veg_day))</span></code></pre></div>
<pre><code># A tibble: 5 x 5
  genh  `n()` `mean(veg_day)` `sd(veg_day)` `median(veg_day)`
  &lt;ord&gt; &lt;int&gt;           &lt;dbl&gt;         &lt;dbl&gt;             &lt;dbl&gt;
1 1-E     822            2.16          1.46              1.87
2 2_VG   1805            1.99          1.13              1.78
3 3_G    1667            1.86          1.11              1.71
4 4_F     801            1.74          1.18              1.57
5 5_P     299            1.71          1.06              1.57</code></pre>
<p>To actually see what’s going on, we might build a comparison boxplot, or violin plot. The plot below shows both, together, with the violin plot helping to indicate the skewed nature of the <code>veg_day</code> data and the boxplot indicating quartiles and outlying values within each <code>genhealth</code> category.</p>
<div class="sourceCode" id="cb1345"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1345-1"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#cb1345-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(sm1, <span class="fu">aes</span>(<span class="at">x =</span> genhealth, <span class="at">y =</span> veg_day)) <span class="sc">+</span></span>
<span id="cb1345-2"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#cb1345-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_violin</span>(<span class="fu">aes</span>(<span class="at">fill =</span> genhealth), <span class="at">trim =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb1345-3"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#cb1345-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_boxplot</span>(<span class="at">width =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb1345-4"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#cb1345-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">guides</span>(<span class="at">fill =</span> <span class="st">&quot;none&quot;</span>, <span class="at">color =</span> <span class="st">&quot;none&quot;</span>) <span class="sc">+</span></span>
<span id="cb1345-5"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#cb1345-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="432-notes_files/figure-html/unnamed-chunk-554-1.png" width="672" /></p>
</div>
<div id="describing-the-proportional-odds-cumulative-logit-model" class="section level3" number="20.5.2">
<h3><span class="header-section-number">20.5.2</span> Describing the Proportional-Odds Cumulative Logit Model</h3>
<p>To fit the ordinal logistic regression model (specifically, a proportional-odds cumulative-logit model) in this situation, we’ll use the <code>polr</code> function in the <code>MASS</code> library.</p>
<ul>
<li>Our outcome is <code>genh</code>, which has five ordered levels, with <code>1-E</code> best and <code>5-P</code> worst.</li>
<li>Our model will include one quantitative predictor, <code>veg_day</code>.</li>
</ul>
<p>The model will have four logit equations:</p>
<ul>
<li>one estimating the log odds that <code>genh</code> will be less than or equal to 1 (i.e. <code>genhealth</code> = 1_Excellent,)</li>
<li>one estimating the log odds that <code>genh</code> <span class="math inline">\(\leq\)</span> 2 (i.e. <code>genhealth</code> = 1_Excellent or 2_VeryGood,)</li>
<li>another estimating the log odds that <code>genh</code> <span class="math inline">\(\leq\)</span> 3 (i.e. <code>genhealth</code> = 1_Excellent, 2_VeryGood or 3_Good,) and, finally,</li>
<li>one estimating the log odds that <code>genh</code> <span class="math inline">\(\leq\)</span> 4 (i.e. <code>genhealth</code> = 1_Excellent, 2_VeryGood, 3_Good or 4_Fair)</li>
</ul>
<p>That’s all we need to estimate the five categories, since Pr(<code>genh</code> <span class="math inline">\(\leq\)</span> 5) = 1, because (5_Poor) is the maximum category for <code>genhealth</code>.</p>
<p>We’ll have a total of five free parameters when we add in the slope for <code>veg_day</code>, and I’ll label these parameters as <span class="math inline">\(\zeta_1, \zeta_2, \zeta_3, \zeta_4\)</span> and <span class="math inline">\(\beta_1\)</span>. The <span class="math inline">\(\zeta\)</span>s are read as “zeta” values, and the people who built the <code>polr</code> function use that term.</p>
<p>The four logistic equations that will be fit differ only by their intercepts. They are:</p>
<p><span class="math display">\[ 
logit[Pr(genh \leq 1)] = log \frac{Pr(genh \leq 1}{Pr(genh &gt; 1)} = \zeta_1 - \beta_1 veg_day
\]</span></p>
<p>which describes the log odds of a <code>genh</code> value of 1 (Excellent) as compared to a <code>genh</code> value greater than 1 (which includes Very Good, Good, Fair and Poor).</p>
<p>The second logit model is:</p>
<p><span class="math display">\[ 
logit[Pr(genh \leq 2)] = log \frac{Pr(genh \leq 2}{Pr(genh &gt; 2)} = \zeta_2 - \beta_1 veg_day
\]</span></p>
<p>which describes the log odds of a <code>genh</code> value of 1 (Excellent) or 2 (Very Good) as compared to a <code>genh</code> value greater than 2 (which includes Good, Fair and Poor).</p>
<p>Next we have:</p>
<p><span class="math display">\[ 
logit[Pr(genh \leq 3)] = log \frac{Pr(genh \leq 3}{Pr(genh &gt; 3)} = \zeta_3 - \beta_1 veg_day
\]</span></p>
<p>which describes the log odds of a <code>genh</code> value of 1 (Excellent) or 2 (Very Good) or 3 (Good) as compared to a <code>genh</code> value greater than 3 (which includes Fair and Poor).</p>
<p>Finally, we have</p>
<p><span class="math display">\[ 
logit[Pr(genh \leq 4)] = log \frac{Pr(genh \leq 4}{Pr(genh &gt; 4)} = \zeta_4 - \beta_1 veg_day
\]</span></p>
<p>which describes the log odds of a <code>genh</code> value of 4 or less, which includes Excellent, Very Good, Good and Fair as compared to a <code>genh</code> value greater than 4 (which is Poor).</p>
<p>Again, the intercept term is the only piece that varies across the four equations.</p>
<p>In this case, a positive coefficient <span class="math inline">\(\beta_1\)</span> for <code>veg_day</code> means that increasing the value of <code>veg_day</code> would increase the <code>genh</code> category (describing a worse level of general health, since higher values of <code>genh</code> are associated with worse health.)</p>
</div>
<div id="fitting-a-proportional-odds-logistic-regression-with-polr" class="section level3" number="20.5.3">
<h3><span class="header-section-number">20.5.3</span> Fitting a Proportional Odds Logistic Regression with <code>polr</code></h3>
<p>Our model <code>m1</code> will use proportional odds logistic regression (sometimes called an <em>ordered logit</em> model) to predict <code>genh</code> on the basis of <code>veg_day</code>. The <code>polr</code> function can help us do this. Note that we include <code>Hess = TRUE</code> to retain what is called the <em>Hessian</em> matrix, which lets R calculate standard errors more effectively in <code>summary</code> and other follow-up descriptions of the model.</p>
<div class="sourceCode" id="cb1346"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1346-1"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#cb1346-1" aria-hidden="true" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="fu">polr</span>(genh <span class="sc">~</span> veg_day, </span>
<span id="cb1346-2"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#cb1346-2" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> sm1, <span class="at">Hess =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1346-3"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#cb1346-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1346-4"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#cb1346-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m1)</span></code></pre></div>
<pre><code>Call:
polr(formula = genh ~ veg_day, data = sm1, Hess = TRUE)

Coefficients:
          Value Std. Error t value
veg_day -0.1847    0.02178   -8.48

Intercepts:
         Value    Std. Error t value 
1-E|2_VG  -2.0866   0.0584   -35.7590
2_VG|3_G  -0.4065   0.0498    -8.1621
3_G|4_F    1.0202   0.0521    19.5771
4_F|5_P    2.5002   0.0710    35.2163

Residual Deviance: 15669.85 
AIC: 15679.85 </code></pre>
<div class="sourceCode" id="cb1348"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1348-1"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#cb1348-1" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(m1)</span></code></pre></div>
<pre><code>Waiting for profiling to be done...</code></pre>
<pre><code>     2.5 %     97.5 % 
-0.2277073 -0.1423088 </code></pre>
</div>
</div>
<div id="interpreting-model-m1" class="section level2" number="20.6">
<h2><span class="header-section-number">20.6</span> Interpreting Model <code>m1</code></h2>
<div id="looking-at-predictions" class="section level3" number="20.6.1">
<h3><span class="header-section-number">20.6.1</span> Looking at Predictions</h3>
<p>Consider two individuals:</p>
<ul>
<li>Harry, who eats an average of 2.0 servings of vegetables per day, so Harry’s <code>veg_day</code> = 2, and</li>
<li>Sally, who eats an average of 1.0 serving of vegetables per day, so Sally’s <code>veg_day</code> = 1.</li>
</ul>
<p>We’re going to start by using our model <code>m1</code> to predict the <code>genh</code> for Harry and Sally, so we can see the effect (on the predicted <code>genh</code> probabilities) of a change of one unit in <code>veg_day</code>.</p>
<p>For example, what are the log odds that Harry, with <code>veg_day</code> = 2, will describe his <code>genh</code> as Excellent (<code>genh</code> <span class="math inline">\(\leq\)</span> 1)?</p>
<p><span class="math display">\[
logit[Pr(genh \leq 1)] = \zeta_1 - \beta_1 veg\_day \\
logit[Pr(genh \leq 1)] = -2.0866 - (-0.1847) veg\_day \\
logit[Pr(genh \leq 1)] = -2.0866 - (-0.1847) (2) = -1.7172
\]</span></p>
<p>That’s not much help. So we’ll convert it to a probability by taking the inverse logit. The formula is</p>
<p><span class="math display">\[
Pr(genh \leq 1) = \frac{exp(\zeta_1 + \beta_1 veg_day)}{1 + exp(\zeta_1 + \beta_1 veg_day)} = 
\frac{exp(-1.7172)}{1 + exp(-1.7172)} = \frac{0.180}{1.180} = 0.15
\]</span></p>
<p>So the model estimates a 15% probability that Harry will describe his <code>genh</code> as Excellent.</p>
<p>OK. Now, what are the log odds that Harry, who eats 2 servings per day, will describe his <code>genh</code> as either Excellent or Very Good (<code>genh</code> <span class="math inline">\(\leq\)</span> 2)?</p>
<p><span class="math display">\[
logit[Pr(genh \leq 2)] = \zeta_2 - \beta_1 veg\_day \\
logit[Pr(genh \leq 2)] = -0.4065 - (-0.1847) veg\_day \\
logit[Pr(genh \leq 2)] = -0.4065 - (-0.1847) (2) = -0.0371
\]</span></p>
<p>Again, we’ll convert this to a probability by taking the inverse logit.</p>
<p><span class="math display">\[
Pr(genh \leq 2) = \frac{exp(\zeta_2 + \beta_1 veg_day)}{1 + exp(\zeta_2 + \beta_1 veg_day)} = 
\frac{exp(-0.0371)}{1 + exp(-0.0371)} = \frac{0.964}{1.964} = 0.49
\]</span></p>
<p>So, the model estimates a probability of .49 that Harry will describe his <code>genh</code> as either Excellent or Very Good, so by subtraction, that’s a probability of .34 that Harry describes his <code>genh</code> as Very Good.</p>
<p>Happily, that’s the last time we’ll calculate this by hand.</p>
</div>
<div id="making-predictions-for-harry-and-sally-with-predict" class="section level3" number="20.6.2">
<h3><span class="header-section-number">20.6.2</span> Making Predictions for Harry (and Sally) with <code>predict</code></h3>
<p>Suppose Harry eats 2 servings of vegetables per day on average, and Sally eats 1.</p>
<div class="sourceCode" id="cb1351"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1351-1"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#cb1351-1" aria-hidden="true" tabindex="-1"></a>temp.dat <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">name =</span> <span class="fu">c</span>(<span class="st">&quot;Harry&quot;</span>, <span class="st">&quot;Sally&quot;</span>), </span>
<span id="cb1351-2"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#cb1351-2" aria-hidden="true" tabindex="-1"></a>                       <span class="at">veg_day =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">1</span>))</span>
<span id="cb1351-3"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#cb1351-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1351-4"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#cb1351-4" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(m1, temp.dat, <span class="at">type =</span> <span class="st">&quot;p&quot;</span>)</span></code></pre></div>
<pre><code>        1-E      2_VG       3_G       4_F        5_P
1 0.1522351 0.3385119 0.3097906 0.1457864 0.05367596
2 0.1298931 0.3148971 0.3246105 0.1667285 0.06387071</code></pre>
<p>The predicted probabilities of falling into each category of <code>genh</code> are:</p>
<table>
<thead>
<tr class="header">
<th align="right">Subject</th>
<th align="right"><code>veg_day</code></th>
<th align="right">Pr(1_E)</th>
<th align="right">Pr(2_VG)</th>
<th align="right">Pr(3_G)</th>
<th align="right">Pr(4_F)</th>
<th align="right">Pr(5_P)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">Harry</td>
<td align="right">2</td>
<td align="right">15.2</td>
<td align="right">33.9</td>
<td align="right">31.0</td>
<td align="right">14.6</td>
<td align="right">5.4</td>
</tr>
<tr class="even">
<td align="right">Sally</td>
<td align="right">1</td>
<td align="right">13.0</td>
<td align="right">31.4</td>
<td align="right">32.5</td>
<td align="right">16.7</td>
<td align="right">6.4</td>
</tr>
</tbody>
</table>
<ul>
<li>Harry has a higher predicted probability of lower (healthier) values of <code>genh</code>. Specifically, Harry has a higher predicted probability than Sally of falling into the Excellent and Very Good categories, and a lower probability than Sally of falling into the Good, Fair and Poor categories.</li>
<li>This means that Harry, with a higher <code>veg_day</code> is predicted to have, on average, a lower (that is to say, healthier) value of <code>genh</code>.</li>
<li>As we’ll see, this association will be indicated by a negative coefficient of <code>veg_day</code> in the proportional odds logistic regression model.</li>
</ul>
</div>
<div id="predicting-the-actual-classification-of-genh" class="section level3" number="20.6.3">
<h3><span class="header-section-number">20.6.3</span> Predicting the actual classification of <code>genh</code></h3>
<p>The default prediction approach actually returns the predicted <code>genh</code> classification for Harry and Sally, which is just the classification with the largest predicted probability. Here, for Harry that is Very Good, and for Sally, that’s Good.</p>
<div class="sourceCode" id="cb1353"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1353-1"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#cb1353-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(m1, temp.dat)</span></code></pre></div>
<pre><code>[1] 2_VG 3_G 
Levels: 1-E 2_VG 3_G 4_F 5_P</code></pre>
</div>
<div id="a-cross-tabulation-of-predictions" class="section level3" number="20.6.4">
<h3><span class="header-section-number">20.6.4</span> A Cross-Tabulation of Predictions?</h3>
<div class="sourceCode" id="cb1355"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1355-1"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#cb1355-1" aria-hidden="true" tabindex="-1"></a><span class="fu">addmargins</span>(<span class="fu">table</span>(<span class="fu">predict</span>(m1), sm1<span class="sc">$</span>genh))</span></code></pre></div>
<pre><code>      
        1-E 2_VG  3_G  4_F  5_P  Sum
  1-E     6    3    3    3    0   15
  2_VG  647 1398 1198  525  192 3960
  3_G   169  404  466  273  107 1419
  4_F     0    0    0    0    0    0
  5_P     0    0    0    0    0    0
  Sum   822 1805 1667  801  299 5394</code></pre>
<p>The <code>m1</code> model classifies all subjects in the <code>sm1</code> sample as either Excellent, Very Good or Good, and most subjects as Very Good or Good.</p>
</div>
<div id="the-fitted-model-equations" class="section level3" number="20.6.5">
<h3><span class="header-section-number">20.6.5</span> The Fitted Model Equations</h3>
<div class="sourceCode" id="cb1357"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1357-1"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#cb1357-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m1)</span></code></pre></div>
<pre><code>Call:
polr(formula = genh ~ veg_day, data = sm1, Hess = TRUE)

Coefficients:
          Value Std. Error t value
veg_day -0.1847    0.02178   -8.48

Intercepts:
         Value    Std. Error t value 
1-E|2_VG  -2.0866   0.0584   -35.7590
2_VG|3_G  -0.4065   0.0498    -8.1621
3_G|4_F    1.0202   0.0521    19.5771
4_F|5_P    2.5002   0.0710    35.2163

Residual Deviance: 15669.85 
AIC: 15679.85 </code></pre>
<p>The first part of the output provides coefficient estimates for the <code>veg_day</code> predictor, and these are followed by the estimates for the various model intercepts. Plugging in the estimates, we have:</p>
<p><span class="math display">\[ 
logit[Pr(genh \leq 1)] = -2.0866 - (-0.1847) veg_day \\
logit[Pr(genh \leq 2)]  = -0.4065 - (-0.1847) veg_day \\
logit[Pr(genh \leq 3)]  =  1.0202 - (-0.1847) veg_day \\
logit[Pr(genh \leq 4)] =  2.5002 - (-0.1847) veg_day 
\]</span></p>
<p>Note that we can obtain these pieces separately as follows:</p>
<div class="sourceCode" id="cb1359"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1359-1"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#cb1359-1" aria-hidden="true" tabindex="-1"></a>m1<span class="sc">$</span>zeta</span></code></pre></div>
<pre><code>  1-E|2_VG   2_VG|3_G    3_G|4_F    4_F|5_P 
-2.0866313 -0.4064704  1.0202035  2.5001655 </code></pre>
<p>shows the boundary intercepts, and</p>
<div class="sourceCode" id="cb1361"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1361-1"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#cb1361-1" aria-hidden="true" tabindex="-1"></a>m1<span class="sc">$</span>coefficients</span></code></pre></div>
<pre><code>   veg_day 
-0.1847272 </code></pre>
<p>shows the regression coefficient for <code>veg_day</code>.</p>
</div>
<div id="interpreting-the-veg_day-coefficient" class="section level3" number="20.6.6">
<h3><span class="header-section-number">20.6.6</span> Interpreting the <code>veg_day</code> coefficient</h3>
<p>The first part of the output provides coefficient estimates for the <code>veg_day</code> predictor.</p>
<ul>
<li>The estimated slope for <code>veg_day</code> is -0.1847
<ul>
<li>Remember Harry and Sally, who have the same values of <code>bmi</code> and <code>costprob</code>, but Harry eats one more serving than Sally does. We noted that Harry is predicted by the model to have a smaller (i.e. healthier) <code>genh</code> response than Sally.</li>
<li>So a negative coefficient here means that higher values of <code>veg_day</code> are associated with more of the probability distribution falling in lower values of <code>genh</code>.</li>
<li>We usually don’t interpret this slope (on the log odds scale) directly, but rather exponentiate it.</li>
</ul></li>
</ul>
</div>
<div id="exponentiating-the-slope-coefficient-to-facilitate-interpretation" class="section level3" number="20.6.7">
<h3><span class="header-section-number">20.6.7</span> Exponentiating the Slope Coefficient to facilitate Interpretation</h3>
<p>We can compute the odds ratio associated with <code>veg_day</code> and its confidence interval as follows…</p>
<div class="sourceCode" id="cb1363"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1363-1"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#cb1363-1" aria-hidden="true" tabindex="-1"></a><span class="fu">exp</span>(<span class="fu">coef</span>(m1))</span></code></pre></div>
<pre><code>  veg_day 
0.8313311 </code></pre>
<div class="sourceCode" id="cb1365"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1365-1"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#cb1365-1" aria-hidden="true" tabindex="-1"></a><span class="fu">exp</span>(<span class="fu">confint</span>(m1))</span></code></pre></div>
<pre><code>Waiting for profiling to be done...</code></pre>
<pre><code>    2.5 %    97.5 % 
0.7963573 0.8673534 </code></pre>
<ul>
<li>So, if Harry eats one more serving of vegetables than Sally, our model predicts that Harry will have 83.1% of the odds of Sally of having a larger <code>genh</code> score. That means that Harry is likelier to have a smaller <code>genh</code> score.
<ul>
<li>Since <code>genh</code> gets larger as a person’s general health gets worse (moves from Excellent towards Poor), this means that since Harry is predicted to have smaller odds of a larger <code>genh</code> score, he is also predicted to have smaller odds of worse general health.</li>
<li>Our 95% confidence interval around that estimated odds ratio of 0.831 is (0.796, 0.867). Since that interval is entirely below 1, the odds of having the larger (worse) <code>genh</code> for Harry are detectably lower than the odds for Sally.</li>
<li>So, an increase in <code>veg_day</code> is associated with smaller (better) <code>genh</code> scores.</li>
</ul></li>
</ul>
</div>
<div id="comparison-to-a-null-model-4" class="section level3" number="20.6.8">
<h3><span class="header-section-number">20.6.8</span> Comparison to a Null Model</h3>
<p>We can fit a model with intercepts only to test the significance of <code>veg_day</code> in our model <code>m1</code>, using the <code>anova</code> function.</p>
<div class="sourceCode" id="cb1368"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1368-1"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#cb1368-1" aria-hidden="true" tabindex="-1"></a>m0 <span class="ot">&lt;-</span> <span class="fu">polr</span>(genh <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> sm1)</span>
<span id="cb1368-2"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#cb1368-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1368-3"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#cb1368-3" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(m1, m0)</span></code></pre></div>
<pre><code>Likelihood ratio tests of ordinal regression models

Response: genh
    Model Resid. df Resid. Dev   Test    Df LR stat. Pr(Chi)
1       1      5390   15744.89                              
2 veg_day      5389   15669.85 1 vs 2     1 75.04297       0</code></pre>
<p>We could also compare model <code>m1</code> to the null model <code>m0</code> with AIC or BIC.</p>
<div class="sourceCode" id="cb1370"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1370-1"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#cb1370-1" aria-hidden="true" tabindex="-1"></a><span class="fu">AIC</span>(m1, m0)</span></code></pre></div>
<pre><code>   df      AIC
m1  5 15679.85
m0  4 15752.89</code></pre>
<div class="sourceCode" id="cb1372"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1372-1"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#cb1372-1" aria-hidden="true" tabindex="-1"></a><span class="fu">BIC</span>(m1,m0)</span></code></pre></div>
<pre><code>   df      BIC
m1  5 15712.81
m0  4 15779.26</code></pre>
</div>
</div>
<div id="the-assumption-of-proportional-odds" class="section level2" number="20.7">
<h2><span class="header-section-number">20.7</span> The Assumption of Proportional Odds</h2>
<p>Let us calculate the odds for all levels of <code>genh</code> if a person eats two servings of vegetables. First, we’ll get the probabilities, in another way, to demonstrate how to do so…</p>
<div class="sourceCode" id="cb1374"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1374-1"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#cb1374-1" aria-hidden="true" tabindex="-1"></a>(prob<span class="fl">.2</span> <span class="ot">&lt;-</span> <span class="fu">exp</span>(m1<span class="sc">$</span>zeta <span class="sc">-</span> <span class="dv">2</span><span class="sc">*</span>m1<span class="sc">$</span>coefficients)<span class="sc">/</span>(<span class="dv">1</span> <span class="sc">+</span> <span class="fu">exp</span>(m1<span class="sc">$</span>zeta <span class="sc">-</span> <span class="dv">2</span><span class="sc">*</span>m1<span class="sc">$</span>coefficients)))</span></code></pre></div>
<pre><code> 1-E|2_VG  2_VG|3_G   3_G|4_F   4_F|5_P 
0.1522351 0.4907471 0.8005376 0.9463240 </code></pre>
<div class="sourceCode" id="cb1376"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1376-1"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#cb1376-1" aria-hidden="true" tabindex="-1"></a>(prob<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">exp</span>(m1<span class="sc">$</span>zeta <span class="sc">-</span> <span class="dv">1</span><span class="sc">*</span>m1<span class="sc">$</span>coefficients)<span class="sc">/</span>(<span class="dv">1</span> <span class="sc">+</span> <span class="fu">exp</span>(m1<span class="sc">$</span>zeta <span class="sc">-</span> <span class="dv">1</span><span class="sc">*</span>m1<span class="sc">$</span>coefficients)))</span></code></pre></div>
<pre><code> 1-E|2_VG  2_VG|3_G   3_G|4_F   4_F|5_P 
0.1298931 0.4447902 0.7694008 0.9361293 </code></pre>
<p>Now, we’ll calculate the odds, first for a subject eating two servings:</p>
<div class="sourceCode" id="cb1378"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1378-1"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#cb1378-1" aria-hidden="true" tabindex="-1"></a>(<span class="at">odds.2 =</span> prob<span class="fl">.2</span><span class="sc">/</span>(<span class="dv">1</span><span class="sc">-</span>prob<span class="fl">.2</span>))</span></code></pre></div>
<pre><code>  1-E|2_VG   2_VG|3_G    3_G|4_F    4_F|5_P 
 0.1795724  0.9636607  4.0134766 17.6303153 </code></pre>
<p>And here are the odds, for a subject eating one serving per day:</p>
<div class="sourceCode" id="cb1380"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1380-1"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#cb1380-1" aria-hidden="true" tabindex="-1"></a>(<span class="at">odds.1 =</span> prob<span class="fl">.1</span><span class="sc">/</span>(<span class="dv">1</span><span class="sc">-</span>prob<span class="fl">.1</span>))</span></code></pre></div>
<pre><code>  1-E|2_VG   2_VG|3_G    3_G|4_F    4_F|5_P 
 0.1492841  0.8011211  3.3365277 14.6566285 </code></pre>
<p>Now, let’s take the ratio of the odds for someone who eats two servings over the odds for someone who eats one.</p>
<div class="sourceCode" id="cb1382"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1382-1"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#cb1382-1" aria-hidden="true" tabindex="-1"></a>odds<span class="fl">.2</span><span class="sc">/</span>odds<span class="fl">.1</span></span></code></pre></div>
<pre><code>1-E|2_VG 2_VG|3_G  3_G|4_F  4_F|5_P 
 1.20289  1.20289  1.20289  1.20289 </code></pre>
<p>They are all the same. The odds ratios are equal, which means they are proportional. For any level of <code>genh</code>, the estimated odds that a person who eats 2 servings has better (lower) <code>genh</code> is about 1.2 times the odds for someone who eats one serving. Those who eat more vegetables have higher odds of better (lower) <code>genh</code>. Less than 1 means lower odds, and more than 1 means greater odds.</p>
<p>Now, let’s take the log of the odds ratios:</p>
<div class="sourceCode" id="cb1384"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1384-1"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#cb1384-1" aria-hidden="true" tabindex="-1"></a><span class="fu">log</span>(odds<span class="fl">.2</span><span class="sc">/</span>odds<span class="fl">.1</span>)</span></code></pre></div>
<pre><code> 1-E|2_VG  2_VG|3_G   3_G|4_F   4_F|5_P 
0.1847272 0.1847272 0.1847272 0.1847272 </code></pre>
<p>That should be familiar. It is the slope coefficient in the model summary, without the minus sign. R tacks on a minus sign so that higher levels of predictors correspond to the ordinal outcome falling in the higher end of its scale.</p>
<p>If we exponentiate the slope estimated by R (-0.1847), we get 0.83. If we have two people, and A eats one more serving of vegetables on average than B, then the estimated odds of A having a higher ‘genh’ (i.e. worse general health) are 83% as high as B’s.</p>
<div id="testing-the-proportional-odds-assumption" class="section level3" number="20.7.1">
<h3><span class="header-section-number">20.7.1</span> Testing the Proportional Odds Assumption</h3>
<p>One way to test the proportional odds assumption is to compare the fit of the proportional odds logistic regression to a model that does not make that assumption. A natural candidate is a <strong>multinomial logit</strong> model, which is typically used to model unordered multi-categorical outcomes, and fits a slope to each level of the <code>genh</code> outcome in this case, as opposed to the proportional odds logit, which fits only one slope across all levels.</p>
<p>Since the proportional odds logistic regression model is nested in the multinomial logit, we can perform a likelihood ratio test. To do this, we first fit the multinomial logit model, with the <code>multinom</code> function from the <code>nnet</code> package.</p>
<div class="sourceCode" id="cb1386"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1386-1"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#cb1386-1" aria-hidden="true" tabindex="-1"></a>(m1_multi <span class="ot">&lt;-</span> <span class="fu">multinom</span>(genh <span class="sc">~</span> veg_day, <span class="at">data =</span> sm1))</span></code></pre></div>
<pre><code># weights:  15 (8 variable)
initial  value 8681.308100 
iter  10 value 7890.985276
final  value 7835.248471 
converged</code></pre>
<pre><code>Call:
multinom(formula = genh ~ veg_day, data = sm1)

Coefficients:
     (Intercept)     veg_day
2_VG   0.9791063 -0.09296694
3_G    1.0911990 -0.19260067
4_F    0.5708594 -0.31080687
5_P   -0.3583310 -0.34340619

Residual Deviance: 15670.5 
AIC: 15686.5 </code></pre>
<p>The multinomial logit fits four intercepts and four slopes, for a total of 8 estimated parameters. The proportional odds logit, as we’ve seen, fits four intercepts and one slope, for a total of 5. The difference is 3, and we use that number in the sequence below to build our test of the proportional odds assumption.</p>
<div class="sourceCode" id="cb1389"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1389-1"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#cb1389-1" aria-hidden="true" tabindex="-1"></a>LL_1 <span class="ot">&lt;-</span> <span class="fu">logLik</span>(m1)</span>
<span id="cb1389-2"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#cb1389-2" aria-hidden="true" tabindex="-1"></a>LL_1m <span class="ot">&lt;-</span> <span class="fu">logLik</span>(m1_multi)</span>
<span id="cb1389-3"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#cb1389-3" aria-hidden="true" tabindex="-1"></a>(G <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">2</span> <span class="sc">*</span> (LL_1[<span class="dv">1</span>] <span class="sc">-</span> LL_1m[<span class="dv">1</span>]))</span></code></pre></div>
<pre><code>[1] -0.6488392</code></pre>
<div class="sourceCode" id="cb1391"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1391-1"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#cb1391-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pchisq</span>(G, <span class="dv">3</span>, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>[1] 1</code></pre>
<p>The <em>p</em> value is very large, so it indicates that the proportional odds model fits about as well as the more complex multinomial logit. A non-significant <em>p</em> value here isn’t always the best way to assess the proportional odds assumption, but it does provide some evidence of model adequacy.</p>
</div>
</div>
<div id="can-model-m1-be-fit-using-rms-tools" class="section level2" number="20.8">
<h2><span class="header-section-number">20.8</span> Can model <code>m1</code> be fit using <code>rms</code> tools?</h2>
<p>Yes.</p>
<div class="sourceCode" id="cb1393"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1393-1"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#cb1393-1" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">datadist</span>(sm1)</span>
<span id="cb1393-2"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#cb1393-2" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">datadist =</span> <span class="st">&quot;d&quot;</span>)</span>
<span id="cb1393-3"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#cb1393-3" aria-hidden="true" tabindex="-1"></a>m1_lrm <span class="ot">&lt;-</span> <span class="fu">lrm</span>(genh <span class="sc">~</span> veg_day, <span class="at">data =</span> sm1, <span class="at">x =</span> T, <span class="at">y =</span> T)</span>
<span id="cb1393-4"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#cb1393-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1393-5"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#cb1393-5" aria-hidden="true" tabindex="-1"></a>m1_lrm</span></code></pre></div>
<pre><code>Logistic Regression Model
 
 lrm(formula = genh ~ veg_day, data = sm1, x = T, y = T)
 
 
 Frequencies of Responses
 
  1-E 2_VG  3_G  4_F  5_P 
  822 1805 1667  801  299 
 
                        Model Likelihood    Discrimination    Rank Discrim.    
                              Ratio Test           Indexes          Indexes    
 Obs          5394    LR chi2      75.04    R2       0.015    C       0.555    
 max |deriv| 3e-13    d.f.             1    g        0.216    Dxy     0.111    
                      Pr(&gt; chi2) &lt;0.0001    gr       1.241    gamma   0.111    
                                            gp       0.053    tau-a   0.082    
                                            Brier    0.247                     
 
         Coef    S.E.   Wald Z Pr(&gt;|Z|)
 y&gt;=2_VG  2.0866 0.0584  35.76 &lt;0.0001 
 y&gt;=3_G   0.4065 0.0498   8.16 &lt;0.0001 
 y&gt;=4_F  -1.0202 0.0521 -19.58 &lt;0.0001 
 y&gt;=5_P  -2.5002 0.0710 -35.22 &lt;0.0001 
 veg_day -0.1847 0.0218  -8.48 &lt;0.0001 
 </code></pre>
<p>The model is highly significant (remember the large sample size) but very weak, with a Nagelkerke <span class="math inline">\(R^2\)</span> of 0.015, and a C statistic of 0.555.</p>
<div class="sourceCode" id="cb1395"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1395-1"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#cb1395-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m1_lrm)</span></code></pre></div>
<pre><code>             Effects              Response : genh 

 Factor      Low  High Diff. Effect   S.E.     Lower 0.95 Upper 0.95
 veg_day     1.21 2.36 1.15  -0.21243 0.025051 -0.26153   -0.16334  
  Odds Ratio 1.21 2.36 1.15   0.80861       NA  0.76987    0.84931  </code></pre>
<p>A change from 1.21 to 2.36 servings in <code>veg_day</code> is associated with an odds ratio of 0.81, with 95% confidence interval (0.77, 0.85). Since these values are all below 1, we have a clear indication of a statistically detectable effect of <code>veg_day</code> with higher <code>veg_day</code> associated with lower <code>genh</code>, which means, in this case, better health.</p>
<p>There is also a tool in <code>rms</code> called <code>orm</code> which may be used to fit a wide array of ordinal regression models. I suggest you read Frank Harrell’s book on <em>Regression Modeling Strategies</em> if you want to learn more.</p>
</div>
<div id="building-a-three-predictor-model" class="section level2" number="20.9">
<h2><span class="header-section-number">20.9</span> Building a Three-Predictor Model</h2>
<p>Now, we’ll model <code>genh</code> using <code>veg_day</code>, <code>bmi</code> and <code>costprob</code>.</p>
<div id="scatterplot-matrix-1" class="section level3" number="20.9.1">
<h3><span class="header-section-number">20.9.1</span> Scatterplot Matrix</h3>
<div class="sourceCode" id="cb1397"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1397-1"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#cb1397-1" aria-hidden="true" tabindex="-1"></a>GGally<span class="sc">::</span><span class="fu">ggpairs</span>(sm1 <span class="sc">%&gt;%</span> </span>
<span id="cb1397-2"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#cb1397-2" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">select</span>(bmi, veg_day, costprob, genh))</span></code></pre></div>
<p><img src="432-notes_files/figure-html/unnamed-chunk-575-1.png" width="672" /></p>
<p>We might choose to plot the <code>costprob</code> data as a binary factor, rather than the raw 0-1 numbers included above, but not at this time.</p>
</div>
<div id="our-three-predictor-model-m2" class="section level3" number="20.9.2">
<h3><span class="header-section-number">20.9.2</span> Our Three-Predictor Model, <code>m2</code></h3>
<div class="sourceCode" id="cb1398"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1398-1"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#cb1398-1" aria-hidden="true" tabindex="-1"></a>m2 <span class="ot">&lt;-</span> <span class="fu">polr</span>(genh <span class="sc">~</span> veg_day <span class="sc">+</span> bmi <span class="sc">+</span> costprob, <span class="at">data =</span> sm1)</span>
<span id="cb1398-2"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#cb1398-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1398-3"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#cb1398-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m2)</span></code></pre></div>
<pre><code>
Re-fitting to get Hessian</code></pre>
<pre><code>Call:
polr(formula = genh ~ veg_day + bmi + costprob, data = sm1)

Coefficients:
            Value Std. Error t value
veg_day  -0.17130   0.021783  -7.864
bmi       0.06673   0.003855  17.311
costprob  0.96825   0.084871  11.409

Intercepts:
         Value   Std. Error t value
1-E|2_VG -0.1252  0.1229    -1.0183
2_VG|3_G  1.6358  0.1234    13.2572
3_G|4_F   3.1534  0.1294    24.3755
4_F|5_P   4.6881  0.1412    33.1928

Residual Deviance: 15229.24 
AIC: 15243.24 </code></pre>
<p>This model contains four intercepts (to cover the five <code>genh</code> categories) and three slopes (one each for <code>veg_day</code>, <code>bmi</code> and <code>costprob</code>.)</p>
</div>
<div id="does-the-three-predictor-model-outperform-m1" class="section level3" number="20.9.3">
<h3><span class="header-section-number">20.9.3</span> Does the three-predictor model outperform <code>m1</code>?</h3>
<div class="sourceCode" id="cb1401"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1401-1"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#cb1401-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(m1, m2)</span></code></pre></div>
<pre><code>Likelihood ratio tests of ordinal regression models

Response: genh
                     Model Resid. df Resid. Dev   Test    Df LR stat. Pr(Chi)
1                  veg_day      5389   15669.85                              
2 veg_day + bmi + costprob      5387   15229.24 1 vs 2     2 440.6041       0</code></pre>
<p>There is a statistically significant improvement in fit from model 1 to model 2. The AIC and BIC are also better for the three-predictor model than they were for the model with <code>veg_day</code> alone.</p>
<div class="sourceCode" id="cb1403"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1403-1"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#cb1403-1" aria-hidden="true" tabindex="-1"></a><span class="fu">AIC</span>(m1, m2)</span></code></pre></div>
<pre><code>   df      AIC
m1  5 15679.85
m2  7 15243.24</code></pre>
<div class="sourceCode" id="cb1405"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1405-1"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#cb1405-1" aria-hidden="true" tabindex="-1"></a><span class="fu">BIC</span>(m1, m2)</span></code></pre></div>
<pre><code>   df      BIC
m1  5 15712.81
m2  7 15289.40</code></pre>
</div>
<div id="wald-tests-for-individual-predictors" class="section level3" number="20.9.4">
<h3><span class="header-section-number">20.9.4</span> Wald tests for individual predictors</h3>
<p>To obtain the appropriate Wald tests, we can use <code>lrm</code> to fit the model instead.</p>
<div class="sourceCode" id="cb1407"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1407-1"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#cb1407-1" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">datadist</span>(sm1)</span>
<span id="cb1407-2"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#cb1407-2" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">datadist =</span> <span class="st">&quot;d&quot;</span>)</span>
<span id="cb1407-3"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#cb1407-3" aria-hidden="true" tabindex="-1"></a>m2_lrm <span class="ot">&lt;-</span> <span class="fu">lrm</span>(genh <span class="sc">~</span> veg_day <span class="sc">+</span> bmi <span class="sc">+</span> costprob, </span>
<span id="cb1407-4"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#cb1407-4" aria-hidden="true" tabindex="-1"></a>              <span class="at">data =</span> sm1, <span class="at">x =</span> T, <span class="at">y =</span> T)</span>
<span id="cb1407-5"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#cb1407-5" aria-hidden="true" tabindex="-1"></a>m2_lrm</span></code></pre></div>
<pre><code>Logistic Regression Model
 
 lrm(formula = genh ~ veg_day + bmi + costprob, data = sm1, x = T, 
     y = T)
 
 
 Frequencies of Responses
 
  1-E 2_VG  3_G  4_F  5_P 
  822 1805 1667  801  299 
 
                        Model Likelihood    Discrimination    Rank Discrim.    
                              Ratio Test           Indexes          Indexes    
 Obs          5394    LR chi2     515.65    R2       0.096    C       0.629    
 max |deriv| 4e-09    d.f.             3    g        0.620    Dxy     0.258    
                      Pr(&gt; chi2) &lt;0.0001    gr       1.859    gamma   0.258    
                                            gp       0.143    tau-a   0.192    
                                            Brier    0.231                     
 
          Coef    S.E.   Wald Z Pr(&gt;|Z|)
 y&gt;=2_VG   0.1252 0.1229   1.02 0.3085  
 y&gt;=3_G   -1.6358 0.1234 -13.26 &lt;0.0001 
 y&gt;=4_F   -3.1534 0.1294 -24.38 &lt;0.0001 
 y&gt;=5_P   -4.6881 0.1412 -33.19 &lt;0.0001 
 veg_day  -0.1713 0.0218  -7.86 &lt;0.0001 
 bmi       0.0667 0.0039  17.31 &lt;0.0001 
 costprob  0.9683 0.0849  11.41 &lt;0.0001 
 </code></pre>
<p>It appears that each of the added predictors (<code>bmi</code> and <code>costprob</code>) adds statistically detectable value to the model.</p>
</div>
<div id="a-cross-tabulation-of-predictions-1" class="section level3" number="20.9.5">
<h3><span class="header-section-number">20.9.5</span> A Cross-Tabulation of Predictions?</h3>
<div class="sourceCode" id="cb1409"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1409-1"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#cb1409-1" aria-hidden="true" tabindex="-1"></a><span class="fu">addmargins</span>(<span class="fu">table</span>(<span class="fu">predict</span>(m2), sm1<span class="sc">$</span>genh))</span></code></pre></div>
<pre><code>      
        1-E 2_VG  3_G  4_F  5_P  Sum
  1-E     6    5    4    1    0   16
  2_VG  686 1295  950  388  141 3460
  3_G   128  495  672  374  135 1804
  4_F     1    9   38   36   20  104
  5_P     1    1    3    2    3   10
  Sum   822 1805 1667  801  299 5394</code></pre>
<p>At least the <code>m2</code> model predicted that a few of the cases will fall in the Fair and Poor categories, but still, this isn’t impressive.</p>
</div>
<div id="interpreting-the-effect-sizes" class="section level3" number="20.9.6">
<h3><span class="header-section-number">20.9.6</span> Interpreting the Effect Sizes</h3>
<p>We can do this in two ways:</p>
<ul>
<li>By exponentiating the <code>polr</code> output, which shows the effect of increasing each predictor by a single unit
<ul>
<li>Increasing <code>veg_day</code> by 1 serving while holding the other predictors constant is associated with reducing the odds (by a factor of 0.84 with 95% CI 0.81, 0.88)) of higher values of <code>genh</code>: hence increasing <code>veg_day</code> is associated with increasing the odds of a response indicating better health.</li>
<li>Increasing <code>bmi</code> by 1 kg/m<sup>2</sup> while holding the other predictors constant is associated with increasing the odds (by a factor of 1.07 with 95% CI 1.06, 1.08)) of higher values of <code>genh</code>: hence increasing <code>bmi</code> is associated with reducing the odds of a response indicating better health.</li>
<li>Increasing <code>costprob</code> from 0 to 1 while holding the other predictors constant is associated with an increase (by a factor of 2.63 with 95% CI 2.23, 3.11)) of a higher <code>genh</code> value. Since higher <code>genh</code> values indicate worse health, those with <code>costprob</code> = 1 are modeled to have generally worse health.</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb1411"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1411-1"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#cb1411-1" aria-hidden="true" tabindex="-1"></a><span class="fu">exp</span>(<span class="fu">coef</span>(m2))</span></code></pre></div>
<pre><code>  veg_day       bmi  costprob 
0.8425722 1.0690045 2.6333356 </code></pre>
<div class="sourceCode" id="cb1413"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1413-1"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#cb1413-1" aria-hidden="true" tabindex="-1"></a><span class="fu">exp</span>(<span class="fu">confint</span>(m2))</span></code></pre></div>
<pre><code>Waiting for profiling to be done...</code></pre>
<pre><code>
Re-fitting to get Hessian</code></pre>
<pre><code>             2.5 %   97.5 %
veg_day  0.8071346 0.879096
bmi      1.0609722 1.077126
costprob 2.2301783 3.110633</code></pre>
<ul>
<li>Or by looking at the summary provided by <code>lrm</code>, which like all such summaries produced by <code>rms</code> shows the impact of moving from the 25th to the 75th percentile on all continuous predictors.</li>
</ul>
<div class="sourceCode" id="cb1417"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1417-1"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#cb1417-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m2_lrm)</span></code></pre></div>
<pre><code>             Effects              Response : genh 

 Factor      Low   High   Diff.  Effect   S.E.     Lower 0.95 Upper 0.95
 veg_day      1.21  2.360 1.1500 -0.19699 0.025051 -0.24609   -0.14789  
  Odds Ratio  1.21  2.360 1.1500  0.82120       NA  0.78185    0.86252  
 bmi         24.33 31.988 7.6575  0.51097 0.029515  0.45312    0.56882  
  Odds Ratio 24.33 31.988 7.6575  1.66690       NA  1.57320    1.76620  
 costprob     0.00  1.000 1.0000  0.96825 0.084871  0.80191    1.13460  
  Odds Ratio  0.00  1.000 1.0000  2.63330       NA  2.22980    3.10990  </code></pre>
<div class="sourceCode" id="cb1419"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1419-1"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#cb1419-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">summary</span>(m2_lrm))</span></code></pre></div>
<p><img src="432-notes_files/figure-html/unnamed-chunk-582-1.png" width="672" /></p>
</div>
<div id="quality-of-the-model-fit" class="section level3" number="20.9.7">
<h3><span class="header-section-number">20.9.7</span> Quality of the Model Fit</h3>
<p>Model <code>m2</code>, as we can see from the <code>m2_lrm</code> output, is still weak, with a Nagelkerke <span class="math inline">\(R^2\)</span> of 0.10, and a C statistic of 0.63.</p>
</div>
<div id="validating-the-summary-statistics-in-m2_lrm" class="section level3" number="20.9.8">
<h3><span class="header-section-number">20.9.8</span> Validating the Summary Statistics in <code>m2_lrm</code></h3>
<div class="sourceCode" id="cb1420"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1420-1"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#cb1420-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">43203</span>); <span class="fu">validate</span>(m2_lrm)</span></code></pre></div>
<pre><code>          index.orig training    test optimism index.corrected  n
Dxy           0.2583   0.2625  0.2579   0.0046          0.2537 40
R2            0.0964   0.0989  0.0960   0.0029          0.0935 40
Intercept     0.0000   0.0000 -0.0023   0.0023         -0.0023 40
Slope         1.0000   1.0000  0.9876   0.0124          0.9876 40
Emax          0.0000   0.0000  0.0031   0.0031          0.0031 40
D             0.0954   0.0980  0.0950   0.0030          0.0924 40
U            -0.0004  -0.0004 -1.5149   1.5146         -1.5149 40
Q             0.0958   0.0984  1.6099  -1.5115          1.6073 40
B             0.2314   0.2308  0.2315  -0.0007          0.2321 40
g             0.6199   0.6278  0.6182   0.0096          0.6103 40
gp            0.1434   0.1448  0.1430   0.0018          0.1417 40</code></pre>
<p>As in our work with binary logistic regression, we can convert the index-corrected Dxy to an index-corrected C with C = 0.5 + (Dxy/2). Both the <span class="math inline">\(R^2\)</span> and C statistics are pretty consistent with what we saw above.</p>
</div>
<div id="testing-the-proportional-odds-assumption-1" class="section level3" number="20.9.9">
<h3><span class="header-section-number">20.9.9</span> Testing the Proportional Odds Assumption</h3>
<p>Again, we’ll fit the analogous multinomial logit model, with the <code>multinom</code> function from the <code>nnet</code> package.</p>
<div class="sourceCode" id="cb1422"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1422-1"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#cb1422-1" aria-hidden="true" tabindex="-1"></a>(m2_multi <span class="ot">&lt;-</span> <span class="fu">multinom</span>(genh <span class="sc">~</span> veg_day <span class="sc">+</span> bmi <span class="sc">+</span> costprob, </span>
<span id="cb1422-2"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#cb1422-2" aria-hidden="true" tabindex="-1"></a>                      <span class="at">data =</span> sm1))</span></code></pre></div>
<pre><code># weights:  25 (16 variable)
initial  value 8681.308100 
iter  10 value 8025.745934
iter  20 value 7605.878993
final  value 7595.767250 
converged</code></pre>
<pre><code>Call:
multinom(formula = genh ~ veg_day + bmi + costprob, data = sm1)

Coefficients:
     (Intercept)    veg_day        bmi  costprob
2_VG  -0.9126285 -0.0905958 0.06947231 0.3258568
3_G   -2.1886806 -0.1893454 0.11552563 1.0488262
4_F   -3.4095145 -0.3056028 0.13679908 1.4422074
5_P   -4.2629564 -0.3384199 0.13178846 1.8612088

Residual Deviance: 15191.53 
AIC: 15223.53 </code></pre>
<p>The multinomial logit fits four intercepts and 12 slopes, for a total of 16 estimated parameters. The proportional odds logit in model <code>m2</code>, as we’ve seen, fits four intercepts and three slopes, for a total of 7. The difference is 9, and we use that number in the sequence below to build our test of the proportional odds assumption.</p>
<div class="sourceCode" id="cb1425"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1425-1"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#cb1425-1" aria-hidden="true" tabindex="-1"></a>LL_2 <span class="ot">&lt;-</span> <span class="fu">logLik</span>(m2)</span>
<span id="cb1425-2"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#cb1425-2" aria-hidden="true" tabindex="-1"></a>LL_2m <span class="ot">&lt;-</span> <span class="fu">logLik</span>(m2_multi)</span>
<span id="cb1425-3"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#cb1425-3" aria-hidden="true" tabindex="-1"></a>(G <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">2</span> <span class="sc">*</span> (LL_2[<span class="dv">1</span>] <span class="sc">-</span> LL_2m[<span class="dv">1</span>]))</span></code></pre></div>
<pre><code>[1] 37.70952</code></pre>
<div class="sourceCode" id="cb1427"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1427-1"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#cb1427-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pchisq</span>(G, <span class="dv">9</span>, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>[1] 1.965186e-05</code></pre>
<p>The result is highly significant, suggesting that we have a problem somewhere with the proportional odds assumption. When this happens, I suggest you build the following plot of score residuals:</p>
<div class="sourceCode" id="cb1429"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1429-1"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#cb1429-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb1429-2"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#cb1429-2" aria-hidden="true" tabindex="-1"></a><span class="fu">resid</span>(m2_lrm, <span class="st">&#39;score.binary&#39;</span>, <span class="at">pl=</span><span class="cn">TRUE</span>)</span>
<span id="cb1429-3"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#cb1429-3" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span></code></pre></div>
<p><img src="432-notes_files/figure-html/unnamed-chunk-586-1.png" width="672" /></p>
<p>From this plot, <code>bmi</code> (especially) and <code>costprob</code> vary as we move from the Very Good toward the Poor cutpoints, relative to <code>veg_day</code>, which is more stable.</p>
</div>
<div id="plotting-the-fitted-model" class="section level3" number="20.9.10">
<h3><span class="header-section-number">20.9.10</span> Plotting the Fitted Model</h3>
<div id="nomogram-1" class="section level4" number="20.9.10.1">
<h4><span class="header-section-number">20.9.10.1</span> Nomogram</h4>
<div class="sourceCode" id="cb1430"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1430-1"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#cb1430-1" aria-hidden="true" tabindex="-1"></a>fun.ge3 <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fu">plogis</span>(x <span class="sc">-</span> m2_lrm<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> m2_lrm<span class="sc">$</span>coef[<span class="dv">2</span>])</span>
<span id="cb1430-2"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#cb1430-2" aria-hidden="true" tabindex="-1"></a>fun.ge4 <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fu">plogis</span>(x <span class="sc">-</span> m2_lrm<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> m2_lrm<span class="sc">$</span>coef[<span class="dv">3</span>])</span>
<span id="cb1430-3"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#cb1430-3" aria-hidden="true" tabindex="-1"></a>fun.ge5 <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fu">plogis</span>(x <span class="sc">-</span> m2_lrm<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> m2_lrm<span class="sc">$</span>coef[<span class="dv">4</span>])</span>
<span id="cb1430-4"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#cb1430-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1430-5"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#cb1430-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">nomogram</span>(m2_lrm, <span class="at">fun=</span><span class="fu">list</span>(<span class="st">&#39;Prob Y &gt;= 2 (VG or worse)&#39;</span> <span class="ot">=</span> plogis, </span>
<span id="cb1430-6"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#cb1430-6" aria-hidden="true" tabindex="-1"></a>                               <span class="st">&#39;Prob Y &gt;= 3 (Good or worse)&#39;</span> <span class="ot">=</span> fun.ge3,</span>
<span id="cb1430-7"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#cb1430-7" aria-hidden="true" tabindex="-1"></a>                               <span class="st">&#39;Prob Y &gt;= 4 (Fair or Poor)&#39;</span> <span class="ot">=</span> fun.ge4,</span>
<span id="cb1430-8"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#cb1430-8" aria-hidden="true" tabindex="-1"></a>                               <span class="st">&#39;Prob Y = 5 (Poor)&#39;</span> <span class="ot">=</span> fun.ge5)))</span></code></pre></div>
<p><img src="432-notes_files/figure-html/unnamed-chunk-587-1.png" width="960" /></p>
</div>
<div id="using-predict-and-showing-mean-prediction-on-1-5-scale" class="section level4" number="20.9.10.2">
<h4><span class="header-section-number">20.9.10.2</span> Using Predict and showing mean prediction on 1-5 scale</h4>
<div class="sourceCode" id="cb1431"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1431-1"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#cb1431-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">Predict</span>(m2_lrm, <span class="at">fun =</span> <span class="fu">Mean</span>(m2_lrm, <span class="at">code =</span> <span class="cn">TRUE</span>)))</span></code></pre></div>
<p><img src="432-notes_files/figure-html/unnamed-chunk-588-1.png" width="672" /></p>
<p>The nomogram and Predict results would be more interesting, of course, if we included a spline or interaction term. Let’s do that in model <code>m3_lrm</code>, and also add the <code>incomegroup</code> information.</p>
</div>
</div>
</div>
<div id="a-larger-model-including-income-group" class="section level2" number="20.10">
<h2><span class="header-section-number">20.10</span> A Larger Model, including income group</h2>
<div class="sourceCode" id="cb1432"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1432-1"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#cb1432-1" aria-hidden="true" tabindex="-1"></a>m3_lrm <span class="ot">&lt;-</span> <span class="fu">lrm</span>(gen_n <span class="sc">~</span> <span class="fu">rcs</span>(veg_day,<span class="dv">3</span>) <span class="sc">+</span> <span class="fu">rcs</span>(bmi, <span class="dv">4</span>) <span class="sc">+</span> </span>
<span id="cb1432-2"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#cb1432-2" aria-hidden="true" tabindex="-1"></a>                  incomegroup <span class="sc">+</span> <span class="fu">catg</span>(costprob) <span class="sc">+</span> </span>
<span id="cb1432-3"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#cb1432-3" aria-hidden="true" tabindex="-1"></a>                  bmi <span class="sc">%ia%</span> costprob, </span>
<span id="cb1432-4"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#cb1432-4" aria-hidden="true" tabindex="-1"></a>              <span class="at">data =</span> sm1, <span class="at">x =</span> T, <span class="at">y =</span> T)</span>
<span id="cb1432-5"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#cb1432-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1432-6"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#cb1432-6" aria-hidden="true" tabindex="-1"></a>m3_lrm</span></code></pre></div>
<pre><code>Logistic Regression Model
 
 lrm(formula = gen_n ~ rcs(veg_day, 3) + rcs(bmi, 4) + incomegroup + 
     catg(costprob) + bmi %ia% costprob, data = sm1, x = T, y = T)
 
 
 Frequencies of Responses
 
    1    2    3    4    5 
  822 1805 1667  801  299 
 
                        Model Likelihood    Discrimination    Rank Discrim.    
                              Ratio Test           Indexes          Indexes    
 Obs          5394    LR chi2    1190.35    R2       0.209    C       0.696    
 max |deriv| 7e-12    d.f.            14    g        1.036    Dxy     0.391    
                      Pr(&gt; chi2) &lt;0.0001    gr       2.819    gamma   0.392    
                                            gp       0.226    tau-a   0.291    
                                            Brier    0.214                     
 
                    Coef    S.E.   Wald Z Pr(&gt;|Z|)
 y&gt;=2                3.7535 0.4852   7.74 &lt;0.0001 
 y&gt;=3                1.8717 0.4838   3.87 0.0001  
 y&gt;=4                0.2035 0.4831   0.42 0.6737  
 y&gt;=5               -1.4386 0.4846  -2.97 0.0030  
 veg_day            -0.2602 0.0633  -4.11 &lt;0.0001 
 veg_day&#39;            0.1756 0.0693   2.53 0.0113  
 bmi                -0.0325 0.0203  -1.60 0.1086  
 bmi&#39;                0.5422 0.0989   5.48 &lt;0.0001 
 bmi&#39;&#39;              -1.4579 0.2663  -5.47 &lt;0.0001 
 incomegroup=10-14K  0.2445 0.1705   1.43 0.1516  
 incomegroup=15-19K -0.2626 0.1582  -1.66 0.0969  
 incomegroup=20-24K -0.6434 0.1501  -4.29 &lt;0.0001 
 incomegroup=25-34K -0.7427 0.1459  -5.09 &lt;0.0001 
 incomegroup=35-49K -1.1621 0.1415  -8.21 &lt;0.0001 
 incomegroup=50-74K -1.4579 0.1418 -10.28 &lt;0.0001 
 incomegroup=75K+   -1.8592 0.1361 -13.66 &lt;0.0001 
 costprob=1          1.4576 0.3528   4.13 &lt;0.0001 
 bmi * costprob     -0.0259 0.0116  -2.24 0.0250  
 </code></pre>
<p>Another option here would have been to consider building <code>incomegroup</code> as a <code>scored</code> variable, with an order on its own, but I won’t force that here. Here’s the <code>polr</code> version…</p>
<div class="sourceCode" id="cb1434"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1434-1"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#cb1434-1" aria-hidden="true" tabindex="-1"></a>m3 <span class="ot">&lt;-</span> <span class="fu">polr</span>(genh <span class="sc">~</span> <span class="fu">rcs</span>(veg_day,<span class="dv">3</span>) <span class="sc">+</span> <span class="fu">rcs</span>(bmi, <span class="dv">4</span>) <span class="sc">+</span> </span>
<span id="cb1434-2"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#cb1434-2" aria-hidden="true" tabindex="-1"></a>               incomegroup <span class="sc">+</span> costprob <span class="sc">+</span> </span>
<span id="cb1434-3"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#cb1434-3" aria-hidden="true" tabindex="-1"></a>               bmi <span class="sc">%ia%</span> costprob, <span class="at">data =</span> sm1)</span></code></pre></div>
<div id="cross-tabulation-of-predictedobserved-classifications" class="section level3" number="20.10.1">
<h3><span class="header-section-number">20.10.1</span> Cross-Tabulation of Predicted/Observed Classifications</h3>
<div class="sourceCode" id="cb1435"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1435-1"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#cb1435-1" aria-hidden="true" tabindex="-1"></a><span class="fu">addmargins</span>(<span class="fu">table</span>(<span class="fu">predict</span>(m3), sm1<span class="sc">$</span>genh))</span></code></pre></div>
<pre><code>      
        1-E 2_VG  3_G  4_F  5_P  Sum
  1-E     3    2    0    0    0    5
  2_VG  642 1200  815  221   49 2927
  3_G   170  565  754  468  182 2139
  4_F     7   37   96  108   65  313
  5_P     0    1    2    4    3   10
  Sum   822 1805 1667  801  299 5394</code></pre>
<p>This model predicts more Fair results, but still far too many Very Good with no Excellent at all.</p>
</div>
<div id="nomogram-2" class="section level3" number="20.10.2">
<h3><span class="header-section-number">20.10.2</span> Nomogram</h3>
<div class="sourceCode" id="cb1437"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1437-1"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#cb1437-1" aria-hidden="true" tabindex="-1"></a>fun.ge3 <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fu">plogis</span>(x <span class="sc">-</span> m3_lrm<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> m3_lrm<span class="sc">$</span>coef[<span class="dv">2</span>])</span>
<span id="cb1437-2"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#cb1437-2" aria-hidden="true" tabindex="-1"></a>fun.ge4 <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fu">plogis</span>(x <span class="sc">-</span> m3_lrm<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> m3_lrm<span class="sc">$</span>coef[<span class="dv">3</span>])</span>
<span id="cb1437-3"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#cb1437-3" aria-hidden="true" tabindex="-1"></a>fun.ge5 <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fu">plogis</span>(x <span class="sc">-</span> m3_lrm<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> m3_lrm<span class="sc">$</span>coef[<span class="dv">4</span>])</span>
<span id="cb1437-4"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#cb1437-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1437-5"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#cb1437-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">nomogram</span>(m3_lrm, <span class="at">fun=</span><span class="fu">list</span>(<span class="st">&#39;Prob Y &gt;= 2 (VG or worse)&#39;</span> <span class="ot">=</span> plogis, </span>
<span id="cb1437-6"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#cb1437-6" aria-hidden="true" tabindex="-1"></a>                               <span class="st">&#39;Prob Y &gt;= 3 (Good or worse)&#39;</span> <span class="ot">=</span> fun.ge3,</span>
<span id="cb1437-7"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#cb1437-7" aria-hidden="true" tabindex="-1"></a>                               <span class="st">&#39;Prob Y &gt;= 4 (Fair or Poor)&#39;</span> <span class="ot">=</span> fun.ge4,</span>
<span id="cb1437-8"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#cb1437-8" aria-hidden="true" tabindex="-1"></a>                               <span class="st">&#39;Prob Y = 5 (Poor)&#39;</span> <span class="ot">=</span> fun.ge5)))</span></code></pre></div>
<p><img src="432-notes_files/figure-html/unnamed-chunk-592-1.png" width="960" /></p>
</div>
<div id="using-predict-and-showing-mean-prediction-on-1-5-scale-1" class="section level3" number="20.10.3">
<h3><span class="header-section-number">20.10.3</span> Using Predict and showing mean prediction on 1-5 scale</h3>
<div class="sourceCode" id="cb1438"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1438-1"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#cb1438-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">Predict</span>(m3_lrm, <span class="at">fun =</span> <span class="fu">Mean</span>(m3_lrm, <span class="at">code =</span> <span class="cn">TRUE</span>)))</span></code></pre></div>
<p><img src="432-notes_files/figure-html/unnamed-chunk-593-1.png" width="672" /></p>
<p>Here, we’re plotting the mean score on the 1-5 <code>gen_n</code> scale.</p>
</div>
<div id="validating-the-summary-statistics-in-m3_lrm" class="section level3" number="20.10.4">
<h3><span class="header-section-number">20.10.4</span> Validating the Summary Statistics in <code>m3_lrm</code></h3>
<div class="sourceCode" id="cb1439"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1439-1"><a href="modeling-an-ordinal-categorical-outcome-in-ohio-smart.html#cb1439-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">43221</span>); <span class="fu">validate</span>(m3_lrm)</span></code></pre></div>
<pre><code>          index.orig training    test optimism index.corrected  n
Dxy           0.3915   0.3928  0.3899   0.0029          0.3886 40
R2            0.2093   0.2112  0.2071   0.0041          0.2053 40
Intercept     0.0000   0.0000  0.0019  -0.0019          0.0019 40
Slope         1.0000   1.0000  0.9871   0.0129          0.9871 40
Emax          0.0000   0.0000  0.0032   0.0032          0.0032 40
D             0.2205   0.2227  0.2179   0.0049          0.2156 40
U            -0.0004  -0.0004 -1.4667   1.4663         -1.4667 40
Q             0.2209   0.2231  1.6845  -1.4614          1.6823 40
B             0.2137   0.2134  0.2142  -0.0007          0.2145 40
g             1.0363   1.0410  1.0276   0.0133          1.0229 40
gp            0.2262   0.2265  0.2244   0.0022          0.2240 40</code></pre>
<p>Still not very impressive, but much better than where we started. It’s not crazy to suggest that in new data, we might expect a Nagelkerke <span class="math inline">\(R^2\)</span> of 0.205 and a C statistic of 0.5 + (0.3886/2) = 0.6943.</p>
</div>
</div>
<div id="references-for-this-chapter" class="section level2" number="20.11">
<h2><span class="header-section-number">20.11</span> References for this Chapter</h2>
<ol style="list-style-type: decimal">
<li><p>Some of the material here is adapted from <a href="http://stats.idre.ucla.edu/r/dae/ordinal-logistic-regression/" class="uri">http://stats.idre.ucla.edu/r/dae/ordinal-logistic-regression/</a>.</p></li>
<li><p>I also found great guidance at <a href="http://data.library.virginia.edu/fitting-and-interpreting-a-proportional-odds-model/" class="uri">http://data.library.virginia.edu/fitting-and-interpreting-a-proportional-odds-model/</a></p></li>
<li><p>Other parts are based on the work of Jeffrey S. Simonoff (2003) <em>Analyzing Categorical Data</em> in Chapter 10. Related data and R code are available at <a href="http://people.stern.nyu.edu/jsimonof/AnalCatData/Splus/" class="uri">http://people.stern.nyu.edu/jsimonof/AnalCatData/Splus/</a>.</p></li>
<li><p>Another good source for a simple example is <a href="https://onlinecourses.science.psu.edu/stat504/node/177" class="uri">https://onlinecourses.science.psu.edu/stat504/node/177</a>.</p></li>
<li><p>Also helpful is <a href="https://onlinecourses.science.psu.edu/stat504/node/178" class="uri">https://onlinecourses.science.psu.edu/stat504/node/178</a> which shows a more complex example nicely.</p></li>
</ol>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="modeling-a-count-outcome-in-ohio-smart.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="analyzing-literary-styles-with-multinomial-logistic-regression.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["432-notes.pdf"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
